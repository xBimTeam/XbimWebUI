{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///xbim.bundle.min.js","webpack:///webpack/bootstrap a0e985e8cc170c1a8190","webpack:///./index.ts","webpack:///./Viewer/xbim-binary-reader.ts","webpack:///./Viewer/xbim-model-geometry.ts","webpack:///./Viewer/xbim-state.ts","webpack:///./Viewer/xbim-product-type.ts","webpack:///./Viewer/xbim-triangulated-shape.ts","webpack:///./Viewer/xbim-model-handle.ts","webpack:///./Viewer/xbim-product-inheritance.ts","webpack:///./Viewer/xbim-shaders.ts","webpack:///./Viewer/xbim-viewer.ts","webpack:///./Libs/gl-matrix.js","webpack:///./Libs/webgl-utils.js","webpack:///./Plugins/NavigationCube/xbim-navigation-cube-shaders.ts","webpack:///./Plugins/NavigationCube/xbim-navigation-cube-textures.ts","webpack:///./Plugins/NavigationCube/xbim-navigation-cube.ts","webpack:///./Plugins/NavigationHome/xbim-navigation-home-textures.ts","webpack:///./Plugins/NavigationHome/xbim-navigation-home.ts","webpack:///./Browser/xbim-attribute-dictionary.ts","webpack:///./Browser/xbim-browser.ts","webpack:///./Browser/xbim-visual-templates.ts","webpack:///./Browser/xbim-visual-model.ts","webpack:///./Browser/xbim-cobieuk-utils.ts","webpack:///./Browser/xbim-visual-entity.ts","webpack:///./Browser/xbim-visual-assignment-set.ts","webpack:///./Browser/xbim-visual-attribute.ts","webpack:///./Browser/xbim-visual-property.ts","webpack:///./Browser/xbim-cobie-utils.ts","webpack:///./Resources/doctemplate/static/styles/xbrowser-styles.css"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","i","Object","prototype","hasOwnProperty","_m","args","slice","fn","a","b","apply","concat","__export","xBinaryReader","_buffer","_position","onloaded","onerror","message","load","source","self","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","fReader","FileReader","onloadend","result","readAsArrayBuffer","response","msg","responseType","send","Blob","File","ArrayBuffer","getIsEOF","type","count","byteLength","read","arity","ctor","length","offset","readByte","Uint8Array","readUint8","readInt16","Int16Array","readUint16","Uint16Array","readInt32","Int32Array","readUint32","Uint32Array","readFloat32","Float32Array","readFloat64","Float64Array","readChar","bytes","Array","String","fromCharCode","readPoint","coords","point","buffer","readRgba","values","colour","readPackedNormal","uv","readMatrix4x4","matrix","readMatrix4x4_64","xbim_state_1","xbim_product_type_1","xbim_triangulated_shape_1","xbim_binary_reader_1","xModelGeometry","meter","productMap","parse","binReader","br","magicNumber","version","numShapes","numVertices","numTriangles","numMatrices","numProducts","numStyles","numRegions","square","imgSide","Math","ceil","sqrt","vertices","normals","indices","styleIndices","styles","products","states","transformations","matrices","regions","iVertex","iIndexForward","iIndexBackward","iTransform","iMatrix","stateEnum","xState","typeEnum","xProductType","population","centre","bbox","styleMap","item","iStyle","styleId","R","G","B","A","set","push","index","transparent","defaultStyle","productLabel","prodType","bBox","map","productID","spans","iShape","repetition","shapeList","iProduct","prodLabel","instanceLabel","transformation","styleItem","pLabel","iLabel","style","transform","shapeGeom","xTriangulatedShape","forEach","shape","iIndex","begin","IFCOPENINGELEMENT","state","IFCSPACE","HIDDEN","end","transparentIndex","UNDEFINED","HIGHLIGHTED","XRAYVISIBLE","UNSTYLED","IFCDISTRIBUTIONELEMENT","IFCDISTRIBUTIONFLOWELEMENT","IFCDISTRIBUTIONCHAMBERELEMENT","IFCENERGYCONVERSIONDEVICE","IFCAIRTOAIRHEATRECOVERY","IFCBOILER","IFCBURNER","IFCCHILLER","IFCCOIL","IFCCONDENSER","IFCCOOLEDBEAM","IFCCOOLINGTOWER","IFCENGINE","IFCEVAPORATIVECOOLER","IFCEVAPORATOR","IFCHEATEXCHANGER","IFCHUMIDIFIER","IFCTUBEBUNDLE","IFCUNITARYEQUIPMENT","IFCELECTRICGENERATOR","IFCELECTRICMOTOR","IFCMOTORCONNECTION","IFCSOLARDEVICE","IFCTRANSFORMER","IFCFLOWCONTROLLER","IFCELECTRICDISTRIBUTIONPOINT","IFCAIRTERMINALBOX","IFCDAMPER","IFCFLOWMETER","IFCVALVE","IFCELECTRICDISTRIBUTIONBOARD","IFCELECTRICTIMECONTROL","IFCPROTECTIVEDEVICE","IFCSWITCHINGDEVICE","IFCFLOWFITTING","IFCDUCTFITTING","IFCPIPEFITTING","IFCCABLECARRIERFITTING","IFCCABLEFITTING","IFCJUNCTIONBOX","IFCFLOWMOVINGDEVICE","IFCCOMPRESSOR","IFCFAN","IFCPUMP","IFCFLOWSEGMENT","IFCDUCTSEGMENT","IFCPIPESEGMENT","IFCCABLECARRIERSEGMENT","IFCCABLESEGMENT","IFCFLOWSTORAGEDEVICE","IFCTANK","IFCELECTRICFLOWSTORAGEDEVICE","IFCFLOWTERMINAL","IFCFIRESUPPRESSIONTERMINAL","IFCSANITARYTERMINAL","IFCSTACKTERMINAL","IFCWASTETERMINAL","IFCAIRTERMINAL","IFCMEDICALDEVICE","IFCSPACEHEATER","IFCAUDIOVISUALAPPLIANCE","IFCCOMMUNICATIONSAPPLIANCE","IFCELECTRICAPPLIANCE","IFCLAMP","IFCLIGHTFIXTURE","IFCOUTLET","IFCFLOWTREATMENTDEVICE","IFCINTERCEPTOR","IFCDUCTSILENCER","IFCFILTER","IFCDISTRIBUTIONCONTROLELEMENT","IFCPROTECTIVEDEVICETRIPPINGUNIT","IFCACTUATOR","IFCALARM","IFCCONTROLLER","IFCFLOWINSTRUMENT","IFCSENSOR","IFCUNITARYCONTROLELEMENT","IFCDISCRETEACCESSORY","IFCFASTENER","IFCMECHANICALFASTENER","IFCREINFORCINGBAR","IFCREINFORCINGMESH","IFCTENDON","IFCTENDONANCHOR","IFCBUILDINGELEMENTPART","IFCVIBRATIONISOLATOR","IFCCHAMFEREDGEFEATURE","IFCROUNDEDEDGEFEATURE","IFCOPENINGSTANDARDCASE","IFCVOIDINGFEATURE","IFCPROJECTIONELEMENT","IFCSURFACEFEATURE","IFCFOOTING","IFCPILE","IFCBEAM","IFCBEAMSTANDARDCASE","IFCCOLUMN","IFCCOLUMNSTANDARDCASE","IFCCURTAINWALL","IFCDOOR","IFCDOORSTANDARDCASE","IFCMEMBER","IFCMEMBERSTANDARDCASE","IFCPLATE","IFCPLATESTANDARDCASE","IFCRAILING","IFCRAMP","IFCRAMPFLIGHT","IFCROOF","IFCSLAB","IFCSLABELEMENTEDCASE","IFCSLABSTANDARDCASE","IFCSTAIR","IFCSTAIRFLIGHT","IFCWALL","IFCWALLSTANDARDCASE","IFCWALLELEMENTEDCASE","IFCWINDOW","IFCWINDOWSTANDARDCASE","IFCBUILDINGELEMENTPROXY","IFCCOVERING","IFCCHIMNEY","IFCSHADINGDEVICE","IFCELEMENTASSEMBLY","IFCFURNISHINGELEMENT","IFCFURNITURE","IFCSYSTEMFURNITUREELEMENT","IFCTRANSPORTELEMENT","IFCVIRTUALELEMENT","IFCELECTRICALELEMENT","IFCEQUIPMENTELEMENT","IFCCIVILELEMENT","IFCGEOGRAPHICELEMENT","IFCDISTRIBUTIONPORT","IFCPROXY","IFCSTRUCTURALLINEARACTION","IFCSTRUCTURALLINEARACTIONVARYING","IFCSTRUCTURALPLANARACTION","IFCSTRUCTURALPLANARACTIONVARYING","IFCSTRUCTURALPOINTACTION","IFCSTRUCTURALCURVEACTION","IFCSTRUCTURALSURFACEACTION","IFCSTRUCTURALPOINTREACTION","IFCSTRUCTURALCURVEREACTION","IFCSTRUCTURALSURFACEREACTION","IFCSTRUCTURALCURVECONNECTION","IFCSTRUCTURALPOINTCONNECTION","IFCSTRUCTURALSURFACECONNECTION","IFCSTRUCTURALCURVEMEMBER","IFCSTRUCTURALCURVEMEMBERVARYING","IFCSTRUCTURALSURFACEMEMBER","IFCSTRUCTURALSURFACEMEMBERVARYING","IFCANNOTATION","IFCBUILDING","IFCBUILDINGSTOREY","IFCSITE","IFCGRID","IFCEXTERNALSPATIALELEMENT","IFCSPATIALZONE","numOfTriangles","readIndex","numFaces","numTrianglesInFace","isPlanar","abs","normal","planarIndices","j","xModelHandle","gl","model","fpt","_gl","_model","_fpt","_instancesNum","stopped","vertexTexture","createTexture","matrixTexture","styleTexture","stateStyleTexture","vertexTextureSize","matrixTextureSize","styleTextureSize","normalBuffer","createBuffer","indexBuffer","productBuffer","styleBuffer","stateBuffer","transformationBuffer","stateStyle","_feedCompleted","region","setActive","pointers","activeTexture","TEXTURE1","bindTexture","TEXTURE_2D","TEXTURE2","TEXTURE3","TEXTURE4","bindBuffer","ARRAY_BUFFER","vertexAttribPointer","normalAttrPointer","UNSIGNED_BYTE","indexlAttrPointer","FLOAT","productAttrPointer","stateAttrPointer","styleAttrPointer","UNSIGNED_SHORT","transformationAttrPointer","uniform1i","vertexSamplerUniform","matrixSamplerUniform","styleSamplerUniform","stateStyleSamplerUniform","vertexTextureSizeUniform","matrixTextureSizeUniform","styleTextureSizeUniform","draw","mode","drawArrays","TRIANGLES","drawProduct","ID","getProductMap","span","unload","deleteTexture","deleteBuffer","feedGPU","_bufferData","_bufferTexture","refreshStyles","pointer","data","bufferData","STATIC_DRAW","fp","size","maxSize","getParameter","MAX_TEXTURE_SIZE","dim","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_COLORSPACE_CONVERSION_WEBGL","image","ALPHA","RGB","RGBA","texImage2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","getState","getStyle","setState","maps","n","l","shift","k","resetStates","resetStyles","getModelState","restoreModelState","s","xProductInheritance","name","children","xShaders","fragment_shader","vertex_shader","vertex_shader_noFPT","xbim_model_geometry_1","xbim_model_handle_1","xbim_shaders_1","glMatrix","xViewer","canvas","_canvas","document","getElementById","perspectiveCamera","fov","near","far","orthogonalCamera","left","right","top","bottom","camera","background","highlightingColour","lightA","lightB","navigationMode","renderingMode","clippingPlane","_lastClippingPoint","WebGLUtils","setupWebGL","getExtension","enable","DEPTH_TEST","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","BLEND","_width","width","offsetWidth","_height","height","offsetHeight","_geometryLoaded","_numberOfActiveModels","_lastStates","_visualStateAttributes","_stylingChanged","_userAction","_events","_plugins","_mvMatrixUniformPointer","_pMatrixUniformPointer","_lightAUniformPointer","_lightBUniformPointer","_colorCodingUniformPointer","_clippingPlaneUniformPointer","_meterUniformPointer","_renderingModeUniformPointer","_highlightingColourUniformPointer","_mvMatrix","mat4","create","_pMatrix","_origin","_distance","_shaderProgram","_handles","_stateStyles","_isRunning","_initShaders","_initAttributesAndUniforms","_initMouseEvents","check","warnings","errors","noErrors","noWarnings","createElement","vertTextUnits","MAX_VERTEX_TEXTURE_IMAGE_UNITS","window","implementation","hasFeature","addPlugin","plugin","init","removePlugin","indexOf","splice","defineStyle","colData","handle","target","hideSpaces","setStyle","console","warn","getProductType","prodId","pType","setCameraPosition","coordinates","lookAt","setCameraTarget","viewer","setDistance","max","ratio","min","tan","PI","every","settings","key","tag","geometry","_addHandle","_error","uniform1f","dist","_fire","modelId","filter","h","pop","compile","shader","code","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","fragmentShader","createShader","FRAGMENT_SHADER","vertexShader","VERTEX_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","useProgram","getUniformLocation","_pointers","getAttribLocation","enableVertexAttribArray","handleMouseDown","event","mouseDown","lastMouseX","clientX","lastMouseY","clientY","startX","startY","r","getBoundingClientRect","viewX","viewY","_getID","button","_disableTextSelection","handleMouseUp","endX","endY","deltaX","deltaY","handled","onBeforePick","_enableTextSelection","handleMouseMove","newX","newY","navigate","handleMouseScroll","sign","x","isNaN","stopPropagation","preventDefault","degToRad","deg","origin","getCameraPosition","mvOrigin","vec3","transformMat4","distanceVec","subtract","distance","translate","rotate","mvZ","transformMat3","mat3","fromMat4","normalize","translation","negate","multiply","elementHeight","elementWidth","setInterval","addEventListener","_isChanged","onBeforeDraw","viewport","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","perspective","ortho","uniformMatrix4fv","uniform4fv","disable","CULL_FACE","onAfterDraw","theSame","visualStateAttribute","JSON","stringify","lastState","inv","invert","eye","zoomTo","found","dir","scale","add","show","heading","toOrigin","rotationY","rotateY","rotationZ","rotateZ","y","onBeforeDrawId","factor","frameBuffer","createFramebuffer","bindFramebuffer","FRAMEBUFFER","renderBuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","texture","TEXTURE0","framebufferRenderbuffer","DEPTH_ATTACHMENT","framebufferTexture2D","COLOR_ATTACHMENT0","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","onAfterDrawId","readPixels","deleteRenderbuffer","deleteFramebuffer","hasValue","onBeforeGetId","start","tick","counter","newTime","Date","getTime","lastTime","fps","floor","requestAnimFrame","stop","on","eventName","callback","events","off","callbacks","handlers","handler","documentElement","_getSVGOverlay","getOffsetRect","elem","box","body","docElem","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","clientBottom","clientRight","round","ns","svg","createElementNS","cRect","position","setAttribute","toString","getClip","cp","e","lp","test","z","clip","d","down","g","angle","appendChild","line","inverse","x1","y1","x2","cos","y2","sin","C","BA","BC","N","cross","parentNode","removeChild","removeEventListener","dX","dY","atan2","stopClipping","unclip","_global","shim","GLMAT_EPSILON","GLMAT_ARRAY_TYPE","GLMAT_RANDOM","random","setMatrixArrayType","degree","toRadian","vec2","out","clone","fromValues","copy","sub","mul","divide","div","scaleAndAdd","squaredDistance","sqrDist","len","squaredLength","sqrLen","dot","lerp","t","ax","ay","transformMat2","transformMat2d","vec","stride","arg","str","az","bx","by","bz","zScale","w","transformQuat","q","qx","qy","qz","qw","ix","iy","iz","iw","rotateX","vec4","aw","mat2","identity","transpose","a1","a0","a2","a3","det","adjoint","determinant","b0","b1","b2","b3","rad","v","v0","v1","frob","pow","LDU","L","D","U","mat2d","aa","ab","ac","ad","atx","aty","a4","a5","b4","b5","a01","a02","a12","a00","a10","a11","a20","a21","a22","b01","b11","b21","b00","b02","b10","b12","b20","b22","fromMat2d","fromQuat","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","axis","fromRotationTranslation","xy","xz","yz","frustum","rl","tb","nf","fovy","aspect","f","lr","bt","center","up","x0","y0","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","quat","rotationTo","tmpvec3","xUnitVec3","yUnitVec3","setAxisAngle","setAxes","matr","view","fromMat3","bw","calculateW","slerp","omega","cosom","sinom","scale0","scale1","acos","invDot","conjugate","fRoot","fTrace","makeFailHTML","GET_A_WEBGL_BROWSER","OTHER_PROBLEM","opt_attribs","opt_onError","handleCreationError","container","WebGLRenderingContext","innerHTML","statusMessage","context","create3DContext","names","ii","getContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","element","setTimeout","xCubeShaders","cube_fshader","cube_vshader","xCubeTextures","en","xbim_navigation_cube_textures_1","xbim_navigation_cube_shaders_1","xNavigationCube","TOP","BOTTOM","LEFT","RIGHT","FRONT","BACK","TOP_LEFT_FRONT","TOP_RIGHT_FRONT","TOP_LEFT_BACK","TOP_RIGHT_BACK","BOTTOM_LEFT_FRONT","BOTTOM_RIGHT_FRONT","BOTTOM_LEFT_BACK","BOTTOM_RIGHT_BACK","TOP_LEFT","TOP_RIGHT","TOP_FRONT","TOP_BACK","BOTTOM_LEFT","BOTTOM_RIGHT","BOTTOM_FRONT","BOTTOM_BACK","FRONT_RIGHT","FRONT_LEFT","BACK_RIGHT","BACK_LEFT","_initialized","highlighting","activeAlpha","passiveAlpha","txtCoords","_image","xviewer","_shader","_initShader","_alpha","_selection","_rotationUniformPointer","_colourCodingUniformPointer","_alphaUniformPointer","_selectionUniformPointer","_textureUniformPointer","_highlightingUniformPointer","_vertexAttrPointer","_texCoordAttrPointer","_idAttrPointer","_indexBuffer","_vertexBuffer","_texCoordBuffer","_idBuffer","ELEMENT_ARRAY_BUFFER","ids","_texture","Image","LINEAR","LINEAR_MIPMAP_NEAREST","generateMipmap","src","_drag","_originalNavigation","diagonalRatio","o","setInactive","pMatrix","rotation","uniformMatrix3fv","cfEnabled","drawElements","xHomeTextures","xbim_navigation_home_textures_1","xNavigationHome","placementX","placementY","viewDirection","_viewer","_adjust","normDirection","opacity","rect","xAttributeDictionary","lang","culture","dictionaries","terms","AssetDescription","AssetInstallationDate","AssetName","AssetSerialNumber","AssetTypeCategory","AssetTypeColorCode","AssetTypeDescription","AssetTypeFeaturesDescription","AssetTypeGradeDescription","AssetTypeMaterialDescription","AssetTypeName","AssetTypeShapeDescription","AssetTypeSizeDescription","AssetWarrantyStartDate","AttributeCategory","AttributeDescription","AttributeName","FacilityCategory","FacilityDefaultAreaUnit","FacilityDefaultLinearUnit","FacilityDefaultVolumeUnit","FacilityDeliverablePhaseName","FacilityDescription","FacilityName","FloorCategory","FloorDescription","FloorName","ProjectDescription","ProjectName","SiteDescription","SpaceCategory","SpaceDescription","SpaceName","SpaceSignageName","StringValue","SystemCategory","SystemDescription","SystemName","UnitName","ZoneCategory","ZoneDescription","ZoneName","externalID","externalIDReference","propertySetName","True","False","def","candidates","candidates2","xbim_visual_templates_1","xbim_visual_model_1","xbim_cobieuk_utils_1","xbim_cobie_utils_1","xBrowser","_iconMap","facility","space","assettype","asset","issue","contact","system","zone","xVisualModel","_templates","_lang","_culture","templateStrings","xVisualTemplates","templateString","_compileTemplate","Function","replace","split","join","renderSpatialStructure","initTree","_renderTreeView","renderAssetTypes","assetTypes","renderContacts","_renderListView","contacts","renderSystems","systems","renderZones","zones","renderAssignments","entity","_getContainer","sets","assignments","classList","header","renderDocuments","docs","documents","renderIssues","issues","renderAttributes","html","attribute","renderProperties","property","renderPropertiesAttributes","propertyattribute","_registerEntityCallBacks","_uiTree","jQuery","ui","$container","$","elements","find","hasClass","addClass","iconOpen","iconClosed","prepend","css","hide","parent","slideToggle","removeClass","firstLevel","click","entities","entityTemplate","table","tr","td","icon","roots","initSimpleTree","renderEntities","ul","li","inUl","activateEntity","getEntity","uk","utils","xCobieUkUtils","xCobieUtils","getVisualModel","readAsText","onRemove","get","collection","xbim_visual_entity_1","xbim_attribute_dictionary_1","xbim_visual_assignment_set_1","xbim_visual_attribute_1","xbim_visual_property_1","_contacts","decimalPlaces","_dictionary","getVisualEntity","xVisualEntity","ExternalId","getValidationStatus","Name","description","Description","attributes","getAttributes","properties","getProperties","getAssignments","getDocuments","getIssues","Categories","category","Code","toLowerCase","getContacts","types","getAssetTypes","getSpatialStructure","getZones","getSystems","Contacts","vContact","floors","Floors","vFloor","spaces","vSpace","instance","assignmentSet","spaceProp","spaceName","value","Zones","vZone","keys","Spaces","ki","xVisualAssignmentSet","Systems","instances","vSystem","componentKeys","Components","getTranslator","AssetTypes","vType","Assets","vInstance","assignment","attr","valStr","getValueString","nameStr","xVisualProperty","catProperties","getCategoryProperties","cats","cat","Classification","Attributes","xVisualAttribute","propertySet","ExternalEntity","categories","Issues","attrName","KeyType","findContact","vAssignment","isKey","vEntity","Email","email","emailProp","Documents","doc","vDoc","vIssue","setLanguage","units","Unit","StringAttributeValue","Value","BooleanAttributeValue","DateTimeAttributeValue","number","DecimalAttributeValue","toFixed","IntegerAttributeValue","term","warranties","Contact","Floor","Space","floorProp","floorName","Zone","System","AssetType","Asset","Attribute","AttributeValue","AttributeIssues","RegExp","Document","Issue","Item","AttributeBooleanValue","AttributeDateValue","AttributeDateTimeValue","AttributeDecimalValue","AttributeIntegerValue","AttributeMonetaryValue","AttributeStringValue","AttributeTimeValue","baseVal","BooleanValue","DecimalValue","IntegerValue"],"mappings":"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AM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAG9B,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,EAAM,EAAM,GAC1C,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAC9B,GAAwB,EAAM,GAG9B,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAG9B,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAG1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAC1C,EAAM,EAAM,EAAM,GAAM,EAAM,EAAM,EAAM,GAG1C,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,GAAM,EAAM,GAClB,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAG9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,EAAM,EAAM,GAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EAAM,GAAM,EAAM,EAAM,EAAM,GAC9B,EA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ACL7gC,KAAK6gC,cACL7gC,KAAK6gC,cACL7gC,KAAK6gC,cACL7gC,KAAK6gC,cACL7gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK8gC,eACL9gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAK+gC,kBACL/gC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKghC,mBACLhhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKihC,iBACLjhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKkhC,kBACLlhC,KAAKohC,UACLphC,KAAKohC,UACLphC,KAAKohC,UACLphC,KAAKohC,UACLphC,KAAKohC,UACLphC,KAAKohC,UACLphC,KAAKohC,UACLphC,KAAKohC,U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","file":"xbim.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"xbim-webui\"] = factory();\n\telse\n\t\troot[\"xbim-webui\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"xbim-webui\"] = factory();\n\telse\n\t\troot[\"xbim-webui\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ((function(modules) {\n\t// Check all modules for deduplicated modules\n\tfor(var i in modules) {\n\t\tif(Object.prototype.hasOwnProperty.call(modules, i)) {\n\t\t\tswitch(typeof modules[i]) {\n\t\t\tcase \"function\": break;\n\t\t\tcase \"object\":\n\t\t\t\t// Module can be created from a template\n\t\t\t\tmodules[i] = (function(_m) {\n\t\t\t\t\tvar args = _m.slice(1), fn = modules[_m[0]];\n\t\t\t\t\treturn function (a,b,c) {\n\t\t\t\t\t\tfn.apply(this, [a,b,c].concat(args));\n\t\t\t\t\t};\n\t\t\t\t}(modules[i]));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// Module is a copy of another module\n\t\t\t\tmodules[i] = modules[modules[i]];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn modules;\n}([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(1);\n\t__webpack_require__(28);\n\tmodule.exports = __webpack_require__(30);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t// Viewer\r\n\t__export(__webpack_require__(2));\r\n\t__export(__webpack_require__(3));\r\n\t__export(__webpack_require__(7));\r\n\t__export(__webpack_require__(8));\r\n\t__export(__webpack_require__(5));\r\n\t__export(__webpack_require__(9));\r\n\t__export(__webpack_require__(4));\r\n\t__export(__webpack_require__(6));\r\n\t__export(__webpack_require__(10));\r\n\t// Plugins\r\n\t__export(__webpack_require__(13));\r\n\t__export(__webpack_require__(14));\r\n\t__export(__webpack_require__(15));\r\n\t__export(__webpack_require__(16));\r\n\t__export(__webpack_require__(17));\r\n\t// Browser\r\n\t__export(__webpack_require__(18));\r\n\t__export(__webpack_require__(19));\r\n\t__export(__webpack_require__(27));\r\n\t__export(__webpack_require__(22));\r\n\t__export(__webpack_require__(24));\r\n\t__export(__webpack_require__(25));\r\n\t__export(__webpack_require__(23));\r\n\t__export(__webpack_require__(21));\r\n\t__export(__webpack_require__(26));\r\n\t__export(__webpack_require__(20));\r\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar xBinaryReader = (function () {\r\n\t    function xBinaryReader() {\r\n\t        this._buffer = null;\r\n\t        this._position = 0;\r\n\t    }\r\n\t    xBinaryReader.prototype.onloaded = function () { };\r\n\t    xBinaryReader.prototype.onerror = function (message) { };\r\n\t    xBinaryReader.prototype.load = function (source) {\r\n\t        this._position = 0;\r\n\t        var self = this;\r\n\t        if (typeof (source) == 'undefined' || source == null)\r\n\t            throw 'Source must be defined';\r\n\t        if (typeof (source) == 'string') {\r\n\t            var xhr;\r\n\t            xhr = new XMLHttpRequest();\r\n\t            xhr.open(\"GET\", source, true);\r\n\t            xhr.onreadystatechange = function () {\r\n\t                if (xhr.readyState == 4 && xhr.status == 200) {\r\n\t                    var fReader = new FileReader();\r\n\t                    fReader.onloadend = function () {\r\n\t                        if (fReader.result) {\r\n\t                            //set data buffer for next processing\r\n\t                            self._buffer = fReader.result;\r\n\t                            //do predefined processing of the data\r\n\t                            if (self.onloaded) {\r\n\t                                self.onloaded();\r\n\t                            }\r\n\t                        }\r\n\t                    };\r\n\t                    fReader.readAsArrayBuffer(xhr.response);\r\n\t                }\r\n\t                //throw exception as a warning\r\n\t                if (xhr.readyState == 4 && xhr.status != 200) {\r\n\t                    var msg = 'Failed to fetch binary data from server. Server code: ' +\r\n\t                        xhr.status +\r\n\t                        '. This might be due to CORS policy of your browser if you run this as a local file.';\r\n\t                    if (self.onerror)\r\n\t                        self.onerror(msg);\r\n\t                    throw msg;\r\n\t                }\r\n\t            };\r\n\t            xhr.responseType = 'blob';\r\n\t            xhr.send();\r\n\t        }\r\n\t        else if (source instanceof Blob || source instanceof File) {\r\n\t            var fReader = new FileReader();\r\n\t            fReader.onloadend = function () {\r\n\t                if (fReader.result) {\r\n\t                    //set data buffer for next processing\r\n\t                    self._buffer = fReader.result;\r\n\t                    //do predefined processing of the data\r\n\t                    if (self.onloaded) {\r\n\t                        self.onloaded();\r\n\t                    }\r\n\t                }\r\n\t            };\r\n\t            fReader.readAsArrayBuffer(source);\r\n\t        }\r\n\t        else if (source instanceof ArrayBuffer) {\r\n\t            this._buffer = source;\r\n\t        }\r\n\t    };\r\n\t    xBinaryReader.prototype.getIsEOF = function (type, count) {\r\n\t        if (typeof (this._position) === \"undefined\")\r\n\t            throw \"Position is not defined\";\r\n\t        return this._position == this._buffer.byteLength;\r\n\t    };\r\n\t    xBinaryReader.prototype.read = function (arity, count, ctor) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var length = arity * count;\r\n\t        var offset = this._position;\r\n\t        this._position += length;\r\n\t        var result;\r\n\t        return count === 1\r\n\t            ? new ctor(this._buffer.slice(offset, offset + length))[0]\r\n\t            : new ctor(this._buffer.slice(offset, offset + length));\r\n\t    };\r\n\t    xBinaryReader.prototype.readByte = function (count) {\r\n\t        return this.read(1, count, Uint8Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readUint8 = function (count) {\r\n\t        return this.read(1, count, Uint8Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readInt16 = function (count) {\r\n\t        return this.read(2, count, Int16Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readUint16 = function (count) {\r\n\t        return this.read(2, count, Uint16Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readInt32 = function (count) {\r\n\t        return this.read(4, count, Int32Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readUint32 = function (count) {\r\n\t        return this.read(4, count, Uint32Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readFloat32 = function (count) {\r\n\t        return this.read(4, count, Float32Array);\r\n\t    };\r\n\t    xBinaryReader.prototype.readFloat64 = function (count) {\r\n\t        return this.read(8, count, Float64Array);\r\n\t    };\r\n\t    //functions for a higher objects like points, colours and matrices\r\n\t    xBinaryReader.prototype.readChar = function (count) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var bytes = this.readByte(count);\r\n\t        var result = new Array(count);\r\n\t        for (var i in bytes) {\r\n\t            result[i] = String.fromCharCode(bytes[i]);\r\n\t        }\r\n\t        return count === 1 ? result[0] : result;\r\n\t    };\r\n\t    xBinaryReader.prototype.readPoint = function (count) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var coords = this.readFloat32(count * 3);\r\n\t        var result = new Array(count);\r\n\t        for (var i = 0; i < count; i++) {\r\n\t            var offset = i * 3 * 4;\r\n\t            //only create new view on the buffer so that no new memory is allocated\r\n\t            var point = new Float32Array(coords.buffer, offset, 3);\r\n\t            result[i] = point;\r\n\t        }\r\n\t        return count === 1 ? result[0] : result;\r\n\t    };\r\n\t    xBinaryReader.prototype.readRgba = function (count) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var values = this.readByte(count * 4);\r\n\t        var result = new Array(count);\r\n\t        for (var i = 0; i < count; i++) {\r\n\t            var offset = i * 4;\r\n\t            var colour = new Uint8Array(values.buffer, offset, 4);\r\n\t            result[i] = colour;\r\n\t        }\r\n\t        return count === 1 ? result[0] : result;\r\n\t    };\r\n\t    xBinaryReader.prototype.readPackedNormal = function (count) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var values = this.readUint8(count * 2);\r\n\t        var result = new Array(count);\r\n\t        for (var i = 0; i < count; i++) {\r\n\t            var uv = new Uint8Array(values.buffer, i * 2, 2);\r\n\t            result[i] = uv;\r\n\t        }\r\n\t        return count === 1 ? result[0] : result;\r\n\t    };\r\n\t    xBinaryReader.prototype.readMatrix4x4 = function (count) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var values = this.readFloat32(count * 16);\r\n\t        var result = new Array(count);\r\n\t        for (var i = 0; i < count; i++) {\r\n\t            var offset = i * 16 * 4;\r\n\t            var matrix = new Float32Array(values.buffer, offset, 16);\r\n\t            result[i] = matrix;\r\n\t        }\r\n\t        return count === 1 ? result[0] : result;\r\n\t    };\r\n\t    xBinaryReader.prototype.readMatrix4x4_64 = function (count) {\r\n\t        if (typeof (count) === \"undefined\")\r\n\t            count = 1;\r\n\t        var values = this.readFloat64(count * 16);\r\n\t        var result = new Array(count);\r\n\t        for (var i = 0; i < count; i++) {\r\n\t            var offset = i * 16 * 8;\r\n\t            var matrix = new Float64Array(values.buffer, offset, 16);\r\n\t            result[i] = matrix;\r\n\t        }\r\n\t        return count === 1 ? result[0] : result;\r\n\t    };\r\n\t    return xBinaryReader;\r\n\t}());\r\n\texports.xBinaryReader = xBinaryReader;\r\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_state_1 = __webpack_require__(4);\r\n\tvar xbim_product_type_1 = __webpack_require__(5);\r\n\tvar xbim_triangulated_shape_1 = __webpack_require__(6);\r\n\tvar xbim_binary_reader_1 = __webpack_require__(2);\r\n\tvar xModelGeometry = (function () {\r\n\t    function xModelGeometry() {\r\n\t        this.meter = 1000;\r\n\t        //this will be used to change appearance of the objects\r\n\t        //map objects have a format: \r\n\t        //map = {\r\n\t        //\tproductID: int,\r\n\t        //\ttype: int,\r\n\t        //\tbBox: Float32Array(6),\r\n\t        //\tspans: [Int32Array([int, int]),Int32Array([int, int]), ...] //spanning indexes defining shapes of product and it's state\r\n\t        //};\r\n\t        this.productMap = {};\r\n\t    }\r\n\t    xModelGeometry.prototype.parse = function (binReader) {\r\n\t        var br = binReader;\r\n\t        var magicNumber = br.readInt32();\r\n\t        if (magicNumber != 94132117)\r\n\t            throw 'Magic number mismatch.';\r\n\t        var version = br.readByte();\r\n\t        var numShapes = br.readInt32();\r\n\t        var numVertices = br.readInt32();\r\n\t        var numTriangles = br.readInt32();\r\n\t        var numMatrices = br.readInt32();\r\n\t        ;\r\n\t        var numProducts = br.readInt32();\r\n\t        ;\r\n\t        var numStyles = br.readInt32();\r\n\t        ;\r\n\t        this.meter = br.readFloat32();\r\n\t        ;\r\n\t        var numRegions = br.readInt16();\r\n\t        //set size of arrays to be square usable for texture data\r\n\t        //TODO: reflect support for floating point textures\r\n\t        var square = function (arity, count) {\r\n\t            if (typeof (arity) == 'undefined' || typeof (count) == 'undefined') {\r\n\t                throw 'Wrong arguments';\r\n\t            }\r\n\t            if (count == 0)\r\n\t                return 0;\r\n\t            var byteLength = count * arity;\r\n\t            var imgSide = Math.ceil(Math.sqrt(byteLength / 4));\r\n\t            //clamp to parity\r\n\t            while ((imgSide * 4) % arity != 0) {\r\n\t                imgSide++;\r\n\t            }\r\n\t            var result = imgSide * imgSide * 4 / arity;\r\n\t            return result;\r\n\t        };\r\n\t        //create target buffers of correct size (avoid reallocation of memory)\r\n\t        this.vertices = new Float32Array(square(4, numVertices * 3));\r\n\t        this.normals = new Uint8Array(numTriangles * 6);\r\n\t        this.indices = new Float32Array(numTriangles * 3);\r\n\t        this.styleIndices = new Uint16Array(numTriangles * 3);\r\n\t        this.styles = new Uint8Array(square(1, (numStyles + 1) * 4)); //+1 is for a default style\r\n\t        this.products = new Float32Array(numTriangles * 3);\r\n\t        this.states = new Uint8Array(numTriangles * 3 * 2); //place for state and restyling\r\n\t        this.transformations = new Float32Array(numTriangles * 3);\r\n\t        this.matrices = new Float32Array(square(4, numMatrices * 16));\r\n\t        this.productMap = {};\r\n\t        this.regions = new Array(numRegions);\r\n\t        var iVertex = 0;\r\n\t        var iIndexForward = 0;\r\n\t        var iIndexBackward = numTriangles * 3;\r\n\t        var iTransform = 0;\r\n\t        var iMatrix = 0;\r\n\t        var stateEnum = xbim_state_1.xState;\r\n\t        var typeEnum = xbim_product_type_1.xProductType;\r\n\t        for (var i = 0; i < numRegions; i++) {\r\n\t            this.regions[i] = {\r\n\t                population: br.readInt32(),\r\n\t                centre: br.readFloat32(3),\r\n\t                bbox: br.readFloat32(6)\r\n\t            };\r\n\t        }\r\n\t        var styleMap = [];\r\n\t        styleMap['getStyle'] = function (id) {\r\n\t            for (var i = 0; i < this.length; i++) {\r\n\t                var item = this[i];\r\n\t                if (item.id == id)\r\n\t                    return item;\r\n\t            }\r\n\t            return null;\r\n\t        };\r\n\t        var iStyle = 0;\r\n\t        for (iStyle; iStyle < numStyles; iStyle++) {\r\n\t            var styleId = br.readInt32();\r\n\t            var R = br.readFloat32() * 255;\r\n\t            var G = br.readFloat32() * 255;\r\n\t            var B = br.readFloat32() * 255;\r\n\t            var A = br.readFloat32() * 255;\r\n\t            this.styles.set([R, G, B, A], iStyle * 4);\r\n\t            styleMap.push({ id: styleId, index: iStyle, transparent: A < 254 });\r\n\t        }\r\n\t        this.styles.set([255, 255, 255, 255], iStyle * 4);\r\n\t        var defaultStyle = { id: -1, index: iStyle, transparent: A < 254 };\r\n\t        styleMap.push(defaultStyle);\r\n\t        for (var i = 0; i < numProducts; i++) {\r\n\t            var productLabel = br.readInt32();\r\n\t            var prodType = br.readInt16();\r\n\t            var bBox = br.readFloat32(6);\r\n\t            var map = {\r\n\t                productID: productLabel,\r\n\t                type: prodType,\r\n\t                bBox: bBox,\r\n\t                spans: []\r\n\t            };\r\n\t            this.productMap[productLabel] = map;\r\n\t        }\r\n\t        for (var iShape = 0; iShape < numShapes; iShape++) {\r\n\t            var repetition = br.readInt32();\r\n\t            var shapeList = [];\r\n\t            for (var iProduct = 0; iProduct < repetition; iProduct++) {\r\n\t                var prodLabel = br.readInt32();\r\n\t                var instanceTypeId = br.readInt16();\r\n\t                var instanceLabel = br.readInt32();\r\n\t                var styleId = br.readInt32();\r\n\t                var transformation = null;\r\n\t                if (repetition > 1) {\r\n\t                    transformation = version === 1 ? br.readFloat32(16) : br.readFloat64(16);\r\n\t                    this.matrices.set(transformation, iMatrix);\r\n\t                    iMatrix += 16;\r\n\t                }\r\n\t                var styleItem = styleMap['getStyle'](styleId);\r\n\t                if (styleItem === null)\r\n\t                    styleItem = defaultStyle;\r\n\t                shapeList.push({\r\n\t                    pLabel: prodLabel,\r\n\t                    iLabel: instanceLabel,\r\n\t                    style: styleItem.index,\r\n\t                    transparent: styleItem.transparent,\r\n\t                    transform: transformation != null ? iTransform++ : 0xFFFF\r\n\t                });\r\n\t            }\r\n\t            //read shape geometry\r\n\t            var shapeGeom = new xbim_triangulated_shape_1.xTriangulatedShape();\r\n\t            shapeGeom.parse(br);\r\n\t            //copy shape data into inner array and set to null so it can be garbage collected\r\n\t            shapeList.forEach(function (shape) {\r\n\t                var iIndex = 0;\r\n\t                //set iIndex according to transparency either from beginning or at the end\r\n\t                if (shape.transparent) {\r\n\t                    iIndex = iIndexBackward - shapeGeom.indices.length;\r\n\t                }\r\n\t                else {\r\n\t                    iIndex = iIndexForward;\r\n\t                }\r\n\t                var begin = iIndex;\r\n\t                var map = this.productMap[shape.pLabel];\r\n\t                if (typeof (map) === \"undefined\") {\r\n\t                    //throw \"Product hasn't been defined before.\";\r\n\t                    map = {\r\n\t                        productID: 0,\r\n\t                        type: typeEnum.IFCOPENINGELEMENT,\r\n\t                        bBox: new Float32Array(6),\r\n\t                        spans: []\r\n\t                    };\r\n\t                    this.productMap[shape.pLabel] = map;\r\n\t                }\r\n\t                this.normals.set(shapeGeom.normals, iIndex * 2);\r\n\t                //switch spaces and openings off by default \r\n\t                var state = map.type == typeEnum.IFCSPACE || map.type == typeEnum.IFCOPENINGELEMENT\r\n\t                    ? stateEnum.HIDDEN\r\n\t                    : 0xFF; //0xFF is for the default state\r\n\t                //fix indices to right absolute position. It is relative to the shape.\r\n\t                for (var i = 0; i < shapeGeom.indices.length; i++) {\r\n\t                    this.indices[iIndex] = shapeGeom.indices[i] + iVertex / 3;\r\n\t                    this.products[iIndex] = shape.pLabel;\r\n\t                    this.styleIndices[iIndex] = shape.style;\r\n\t                    this.transformations[iIndex] = shape.transform;\r\n\t                    this.states[2 * iIndex] = state; //set state\r\n\t                    this.states[2 * iIndex + 1] = 0xFF; //default style\r\n\t                    iIndex++;\r\n\t                }\r\n\t                var end = iIndex;\r\n\t                map.spans.push(new Int32Array([begin, end]));\r\n\t                if (shape.transparent)\r\n\t                    iIndexBackward -= shapeGeom.indices.length;\r\n\t                else\r\n\t                    iIndexForward += shapeGeom.indices.length;\r\n\t            }, this);\r\n\t            //copy geometry and keep track of amount so that we can fix indices to right position\r\n\t            //this must be the last step to have correct iVertex number above\r\n\t            this.vertices.set(shapeGeom.vertices, iVertex);\r\n\t            iVertex += shapeGeom.vertices.length;\r\n\t            shapeGeom = null;\r\n\t        }\r\n\t        //binary reader should be at the end by now\r\n\t        if (!br.getIsEOF()) {\r\n\t        }\r\n\t        this.transparentIndex = iIndexForward;\r\n\t    };\r\n\t    //Source has to be either URL of wexBIM file or Blob representing wexBIM file\r\n\t    xModelGeometry.prototype.load = function (source) {\r\n\t        //binary reading\r\n\t        var br = new xbim_binary_reader_1.xBinaryReader();\r\n\t        var self = this;\r\n\t        br.onloaded = function () {\r\n\t            self.parse(br);\r\n\t            if (self.onloaded) {\r\n\t                self.onloaded();\r\n\t            }\r\n\t        };\r\n\t        br.onerror = function (msg) {\r\n\t            if (self.onerror)\r\n\t                self.onerror(msg);\r\n\t        };\r\n\t        br.load(source);\r\n\t    };\r\n\t    xModelGeometry.prototype.onloaded = function () { };\r\n\t    xModelGeometry.prototype.onerror = function (message) { };\r\n\t    return xModelGeometry;\r\n\t}());\r\n\texports.xModelGeometry = xModelGeometry;\r\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t/**\r\n\t    * Enumeration for object states.\r\n\t    * @readonly\r\n\t    * @enum {number}\r\n\t    */\r\n\texports.xState = {\r\n\t    UNDEFINED: 255,\r\n\t    HIDDEN: 254,\r\n\t    HIGHLIGHTED: 253,\r\n\t    XRAYVISIBLE: 252,\r\n\t    UNSTYLED: 225\r\n\t};\r\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t/**\r\n\t* Enumeration of product types.\r\n\t* @readonly\r\n\t* @enum {number}\r\n\t*/\r\n\texports.xProductType = {\r\n\t    IFCDISTRIBUTIONELEMENT: 44,\r\n\t    IFCDISTRIBUTIONFLOWELEMENT: 45,\r\n\t    IFCDISTRIBUTIONCHAMBERELEMENT: 180,\r\n\t    IFCENERGYCONVERSIONDEVICE: 175,\r\n\t    IFCAIRTOAIRHEATRECOVERY: 1097,\r\n\t    IFCBOILER: 1105,\r\n\t    IFCBURNER: 1109,\r\n\t    IFCCHILLER: 1119,\r\n\t    IFCCOIL: 1124,\r\n\t    IFCCONDENSER: 1132,\r\n\t    IFCCOOLEDBEAM: 1141,\r\n\t    IFCCOOLINGTOWER: 1142,\r\n\t    IFCENGINE: 1164,\r\n\t    IFCEVAPORATIVECOOLER: 1166,\r\n\t    IFCEVAPORATOR: 1167,\r\n\t    IFCHEATEXCHANGER: 1187,\r\n\t    IFCHUMIDIFIER: 1188,\r\n\t    IFCTUBEBUNDLE: 1305,\r\n\t    IFCUNITARYEQUIPMENT: 1310,\r\n\t    IFCELECTRICGENERATOR: 1160,\r\n\t    IFCELECTRICMOTOR: 1161,\r\n\t    IFCMOTORCONNECTION: 1216,\r\n\t    IFCSOLARDEVICE: 1270,\r\n\t    IFCTRANSFORMER: 1303,\r\n\t    IFCFLOWCONTROLLER: 121,\r\n\t    IFCELECTRICDISTRIBUTIONPOINT: 242,\r\n\t    IFCAIRTERMINALBOX: 1096,\r\n\t    IFCDAMPER: 1148,\r\n\t    IFCFLOWMETER: 1182,\r\n\t    IFCVALVE: 1311,\r\n\t    IFCELECTRICDISTRIBUTIONBOARD: 1157,\r\n\t    IFCELECTRICTIMECONTROL: 1162,\r\n\t    IFCPROTECTIVEDEVICE: 1235,\r\n\t    IFCSWITCHINGDEVICE: 1290,\r\n\t    IFCFLOWFITTING: 467,\r\n\t    IFCDUCTFITTING: 1153,\r\n\t    IFCPIPEFITTING: 1222,\r\n\t    IFCCABLECARRIERFITTING: 1111,\r\n\t    IFCCABLEFITTING: 1113,\r\n\t    IFCJUNCTIONBOX: 1195,\r\n\t    IFCFLOWMOVINGDEVICE: 502,\r\n\t    IFCCOMPRESSOR: 1131,\r\n\t    IFCFAN: 1177,\r\n\t    IFCPUMP: 1238,\r\n\t    IFCFLOWSEGMENT: 574,\r\n\t    IFCDUCTSEGMENT: 1154,\r\n\t    IFCPIPESEGMENT: 1223,\r\n\t    IFCCABLECARRIERSEGMENT: 1112,\r\n\t    IFCCABLESEGMENT: 1115,\r\n\t    IFCFLOWSTORAGEDEVICE: 371,\r\n\t    IFCTANK: 1293,\r\n\t    IFCELECTRICFLOWSTORAGEDEVICE: 1159,\r\n\t    IFCFLOWTERMINAL: 46,\r\n\t    IFCFIRESUPPRESSIONTERMINAL: 1179,\r\n\t    IFCSANITARYTERMINAL: 1262,\r\n\t    IFCSTACKTERMINAL: 1277,\r\n\t    IFCWASTETERMINAL: 1315,\r\n\t    IFCAIRTERMINAL: 1095,\r\n\t    IFCMEDICALDEVICE: 1212,\r\n\t    IFCSPACEHEATER: 1272,\r\n\t    IFCAUDIOVISUALAPPLIANCE: 1099,\r\n\t    IFCCOMMUNICATIONSAPPLIANCE: 1127,\r\n\t    IFCELECTRICAPPLIANCE: 1156,\r\n\t    IFCLAMP: 1198,\r\n\t    IFCLIGHTFIXTURE: 1199,\r\n\t    IFCOUTLET: 1219,\r\n\t    IFCFLOWTREATMENTDEVICE: 425,\r\n\t    IFCINTERCEPTOR: 1193,\r\n\t    IFCDUCTSILENCER: 1155,\r\n\t    IFCFILTER: 1178,\r\n\t    IFCDISTRIBUTIONCONTROLELEMENT: 468,\r\n\t    IFCPROTECTIVEDEVICETRIPPINGUNIT: 1236,\r\n\t    IFCACTUATOR: 1091,\r\n\t    IFCALARM: 1098,\r\n\t    IFCCONTROLLER: 1139,\r\n\t    IFCFLOWINSTRUMENT: 1181,\r\n\t    IFCSENSOR: 1264,\r\n\t    IFCUNITARYCONTROLELEMENT: 1308,\r\n\t    IFCDISCRETEACCESSORY: 423,\r\n\t    IFCFASTENER: 535,\r\n\t    IFCMECHANICALFASTENER: 536,\r\n\t    IFCREINFORCINGBAR: 571,\r\n\t    IFCREINFORCINGMESH: 531,\r\n\t    IFCTENDON: 261,\r\n\t    IFCTENDONANCHOR: 675,\r\n\t    IFCBUILDINGELEMENTPART: 220,\r\n\t    IFCVIBRATIONISOLATOR: 1312,\r\n\t    IFCCHAMFEREDGEFEATURE: 765,\r\n\t    IFCROUNDEDEDGEFEATURE: 766,\r\n\t    IFCOPENINGELEMENT: 498,\r\n\t    IFCOPENINGSTANDARDCASE: 1217,\r\n\t    IFCVOIDINGFEATURE: 1313,\r\n\t    IFCPROJECTIONELEMENT: 384,\r\n\t    IFCSURFACEFEATURE: 1287,\r\n\t    IFCFOOTING: 120,\r\n\t    IFCPILE: 572,\r\n\t    IFCBEAM: 171,\r\n\t    IFCBEAMSTANDARDCASE: 1104,\r\n\t    IFCCOLUMN: 383,\r\n\t    IFCCOLUMNSTANDARDCASE: 1126,\r\n\t    IFCCURTAINWALL: 456,\r\n\t    IFCDOOR: 213,\r\n\t    IFCDOORSTANDARDCASE: 1151,\r\n\t    IFCMEMBER: 310,\r\n\t    IFCMEMBERSTANDARDCASE: 1214,\r\n\t    IFCPLATE: 351,\r\n\t    IFCPLATESTANDARDCASE: 1224,\r\n\t    IFCRAILING: 350,\r\n\t    IFCRAMP: 414,\r\n\t    IFCRAMPFLIGHT: 348,\r\n\t    IFCROOF: 347,\r\n\t    IFCSLAB: 99,\r\n\t    IFCSLABELEMENTEDCASE: 1268,\r\n\t    IFCSLABSTANDARDCASE: 1269,\r\n\t    IFCSTAIR: 346,\r\n\t    IFCSTAIRFLIGHT: 25,\r\n\t    IFCWALL: 452,\r\n\t    IFCWALLSTANDARDCASE: 453,\r\n\t    IFCWALLELEMENTEDCASE: 1314,\r\n\t    IFCWINDOW: 667,\r\n\t    IFCWINDOWSTANDARDCASE: 1316,\r\n\t    IFCBUILDINGELEMENTPROXY: 560,\r\n\t    IFCCOVERING: 382,\r\n\t    IFCCHIMNEY: 1120,\r\n\t    IFCSHADINGDEVICE: 1265,\r\n\t    IFCELEMENTASSEMBLY: 18,\r\n\t    IFCFURNISHINGELEMENT: 253,\r\n\t    IFCFURNITURE: 1184,\r\n\t    IFCSYSTEMFURNITUREELEMENT: 1291,\r\n\t    IFCTRANSPORTELEMENT: 416,\r\n\t    IFCVIRTUALELEMENT: 168,\r\n\t    IFCELECTRICALELEMENT: 23,\r\n\t    IFCEQUIPMENTELEMENT: 212,\r\n\t    IFCCIVILELEMENT: 1122,\r\n\t    IFCGEOGRAPHICELEMENT: 1185,\r\n\t    IFCDISTRIBUTIONPORT: 178,\r\n\t    IFCPROXY: 447,\r\n\t    IFCSTRUCTURALLINEARACTION: 463,\r\n\t    IFCSTRUCTURALLINEARACTIONVARYING: 464,\r\n\t    IFCSTRUCTURALPLANARACTION: 39,\r\n\t    IFCSTRUCTURALPLANARACTIONVARYING: 357,\r\n\t    IFCSTRUCTURALPOINTACTION: 356,\r\n\t    IFCSTRUCTURALCURVEACTION: 1279,\r\n\t    IFCSTRUCTURALSURFACEACTION: 1284,\r\n\t    IFCSTRUCTURALPOINTREACTION: 354,\r\n\t    IFCSTRUCTURALCURVEREACTION: 1280,\r\n\t    IFCSTRUCTURALSURFACEREACTION: 1285,\r\n\t    IFCSTRUCTURALCURVECONNECTION: 534,\r\n\t    IFCSTRUCTURALPOINTCONNECTION: 533,\r\n\t    IFCSTRUCTURALSURFACECONNECTION: 264,\r\n\t    IFCSTRUCTURALCURVEMEMBER: 224,\r\n\t    IFCSTRUCTURALCURVEMEMBERVARYING: 227,\r\n\t    IFCSTRUCTURALSURFACEMEMBER: 420,\r\n\t    IFCSTRUCTURALSURFACEMEMBERVARYING: 421,\r\n\t    IFCANNOTATION: 634,\r\n\t    IFCBUILDING: 169,\r\n\t    IFCBUILDINGSTOREY: 459,\r\n\t    IFCSITE: 349,\r\n\t    IFCSPACE: 454,\r\n\t    IFCGRID: 564,\r\n\t    IFCEXTERNALSPATIALELEMENT: 1174,\r\n\t    IFCSPATIALZONE: 1275\r\n\t};\r\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_binary_reader_1 = __webpack_require__(2);\r\n\tvar xTriangulatedShape = (function () {\r\n\t    function xTriangulatedShape() {\r\n\t        //This would load only shape data from binary file\r\n\t        this.load = function (source) {\r\n\t            //binary reading\r\n\t            var br = new xbim_binary_reader_1.xBinaryReader();\r\n\t            var self = this;\r\n\t            br.onloaded = function () {\r\n\t                self.parse(br);\r\n\t                if (self.onloaded) {\r\n\t                    self.onloaded();\r\n\t                }\r\n\t            };\r\n\t            br.load(source);\r\n\t        };\r\n\t        this.vertices = [];\r\n\t    }\r\n\t    //this will get xBinaryReader on the current position and will parse it's content to fill itself with vertices, normals and vertex indices\r\n\t    xTriangulatedShape.prototype.parse = function (binReader) {\r\n\t        var self = this;\r\n\t        var version = binReader.readByte();\r\n\t        var numVertices = binReader.readInt32();\r\n\t        var numOfTriangles = binReader.readInt32();\r\n\t        self.vertices = binReader.readFloat32(numVertices * 3);\r\n\t        //allocate memory of defined size (to avoid reallocation of memory)\r\n\t        self.indices = new Uint32Array(numOfTriangles * 3);\r\n\t        self.normals = new Uint8Array(numOfTriangles * 6);\r\n\t        //indices for incremental adding of indices and normals\r\n\t        var iIndex = 0;\r\n\t        var readIndex;\r\n\t        if (numVertices <= 0xFF) {\r\n\t            readIndex = function (count) { return binReader.readByte(count); };\r\n\t        }\r\n\t        else if (numVertices <= 0xFFFF) {\r\n\t            readIndex = function (count) { return binReader.readUint16(count); };\r\n\t        }\r\n\t        else {\r\n\t            readIndex = function (count) { return binReader.readInt32(count); };\r\n\t        }\r\n\t        var numFaces = binReader.readInt32();\r\n\t        if (numVertices === 0 || numOfTriangles === 0)\r\n\t            return;\r\n\t        for (var i = 0; i < numFaces; i++) {\r\n\t            var numTrianglesInFace = binReader.readInt32();\r\n\t            if (numTrianglesInFace == 0)\r\n\t                continue;\r\n\t            var isPlanar = numTrianglesInFace > 0;\r\n\t            numTrianglesInFace = Math.abs(numTrianglesInFace);\r\n\t            if (isPlanar) {\r\n\t                var normal = binReader.readByte(2);\r\n\t                //read and set all indices\r\n\t                var planarIndices = readIndex(3 * numTrianglesInFace);\r\n\t                self.indices.set(planarIndices, iIndex);\r\n\t                for (var j = 0; j < numTrianglesInFace * 3; j++) {\r\n\t                    //add three identical normals because this is planar but needs to be expanded for WebGL\r\n\t                    self.normals[iIndex * 2] = normal[0];\r\n\t                    self.normals[iIndex * 2 + 1] = normal[1];\r\n\t                    iIndex++;\r\n\t                }\r\n\t            }\r\n\t            else {\r\n\t                for (var j = 0; j < numTrianglesInFace; j++) {\r\n\t                    self.indices[iIndex] = readIndex(); //a\r\n\t                    self.normals.set(binReader.readByte(2), iIndex * 2);\r\n\t                    iIndex++;\r\n\t                    self.indices[iIndex] = readIndex(); //b\r\n\t                    self.normals.set(binReader.readByte(2), iIndex * 2);\r\n\t                    iIndex++;\r\n\t                    self.indices[iIndex] = readIndex(); //c\r\n\t                    self.normals.set(binReader.readByte(2), iIndex * 2);\r\n\t                    iIndex++;\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    //this function will get called when loading is finished.\r\n\t    //This won't get called after parse which is supposed to happen in large operation.\r\n\t    xTriangulatedShape.prototype.onloaded = function () { };\r\n\t    return xTriangulatedShape;\r\n\t}());\r\n\texports.xTriangulatedShape = xTriangulatedShape;\r\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_state_1 = __webpack_require__(4);\r\n\t//this class holds pointers to textures, uniforms and data buffers which \r\n\t//make up a model in GPU\r\n\tvar xModelHandle = (function () {\r\n\t    function xModelHandle(gl, model, fpt) {\r\n\t        if (typeof (gl) == 'undefined' || typeof (model) == 'undefined' || typeof (fpt) == 'undefined') {\r\n\t            throw 'WebGL context and geometry model must be specified';\r\n\t        }\r\n\t        this._gl = gl;\r\n\t        this._model = model;\r\n\t        this._fpt = fpt;\r\n\t        /**\r\n\t         * unique ID which can be used to identify this handle\r\n\t         */\r\n\t        this.id = xModelHandle._instancesNum++;\r\n\t        /**\r\n\t         * indicates if this model should be used in a rendering loop or not.\r\n\t         */\r\n\t        this.stopped = false;\r\n\t        this.count = model.indices.length;\r\n\t        //data structure \r\n\t        this.vertexTexture = gl.createTexture();\r\n\t        this.matrixTexture = gl.createTexture();\r\n\t        this.styleTexture = gl.createTexture();\r\n\t        this.stateStyleTexture = gl.createTexture();\r\n\t        this.vertexTextureSize = 0;\r\n\t        this.matrixTextureSize = 0;\r\n\t        this.styleTextureSize = 0;\r\n\t        this.normalBuffer = gl.createBuffer();\r\n\t        this.indexBuffer = gl.createBuffer();\r\n\t        this.productBuffer = gl.createBuffer();\r\n\t        this.styleBuffer = gl.createBuffer();\r\n\t        this.stateBuffer = gl.createBuffer();\r\n\t        this.transformationBuffer = gl.createBuffer();\r\n\t        //small texture which can be used to overwrite appearance of the products\r\n\t        this.stateStyle = new Uint8Array(15 * 15 * 4);\r\n\t        this._feedCompleted = false;\r\n\t        this.region = model.regions[0];\r\n\t        //set the most populated region\r\n\t        model.regions.forEach(function (region) {\r\n\t            if (region.population > this.region.population) {\r\n\t                this.region = region;\r\n\t            }\r\n\t        }, this);\r\n\t        //set default region if no region is defined. This shouldn't ever happen if model contains any geometry.\r\n\t        if (typeof (this.region) == 'undefined') {\r\n\t            this.region = {\r\n\t                population: 1,\r\n\t                centre: [0.0, 0.0, 0.0],\r\n\t                bbox: [0.0, 0.0, 0.0, 10 * model.meter, 10 * model.meter, 10 * model.meter]\r\n\t            };\r\n\t        }\r\n\t    }\r\n\t    //this function sets this model as an active one\r\n\t    //it needs an argument 'pointers' which contains pointers to\r\n\t    //shader attributes and uniforms which are to be set.\r\n\t    //pointers = {\r\n\t    //\tnormalAttrPointer: null,\r\n\t    //\tindexlAttrPointer: null,\r\n\t    //\tproductAttrPointer: null,\r\n\t    //\tstateAttrPointer: null,\r\n\t    //\tstyleAttrPointer: null,\r\n\t    //\ttransformationAttrPointer: null,\r\n\t    //\r\n\t    //\tmatrixSamplerUniform: null,\r\n\t    //\tvertexSamplerUniform: null,\r\n\t    //\tstyleSamplerUniform: null,\r\n\t    //\tstateStyleSamplerUniform: null,\r\n\t    //\t\r\n\t    //\tvertexTextureSizeUniform: null,\r\n\t    //\tmatrixTextureSizeUniform: null,\r\n\t    //\tstyleTextureSizeUniform: null,\r\n\t    //};\r\n\t    xModelHandle.prototype.setActive = function (pointers) {\r\n\t        if (this.stopped)\r\n\t            return;\r\n\t        var gl = this._gl;\r\n\t        //set predefined textures\r\n\t        if (this.vertexTextureSize > 0) {\r\n\t            gl.activeTexture(gl.TEXTURE1);\r\n\t            gl.bindTexture(gl.TEXTURE_2D, this.vertexTexture);\r\n\t        }\r\n\t        if (this.matrixTextureSize > 0) {\r\n\t            gl.activeTexture(gl.TEXTURE2);\r\n\t            gl.bindTexture(gl.TEXTURE_2D, this.matrixTexture);\r\n\t        }\r\n\t        if (this.styleTextureSize > 0) {\r\n\t            gl.activeTexture(gl.TEXTURE3);\r\n\t            gl.bindTexture(gl.TEXTURE_2D, this.styleTexture);\r\n\t        }\r\n\t        //this texture has constant size\r\n\t        gl.activeTexture(gl.TEXTURE4);\r\n\t        gl.bindTexture(gl.TEXTURE_2D, this.stateStyleTexture);\r\n\t        //set attributes and uniforms\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this.normalBuffer);\r\n\t        gl.vertexAttribPointer(pointers.normalAttrPointer, 2, gl.UNSIGNED_BYTE, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this.indexBuffer);\r\n\t        gl.vertexAttribPointer(pointers.indexlAttrPointer, 1, gl.FLOAT, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this.productBuffer);\r\n\t        gl.vertexAttribPointer(pointers.productAttrPointer, 1, gl.FLOAT, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this.stateBuffer);\r\n\t        gl.vertexAttribPointer(pointers.stateAttrPointer, 2, gl.UNSIGNED_BYTE, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this.styleBuffer);\r\n\t        gl.vertexAttribPointer(pointers.styleAttrPointer, 1, gl.UNSIGNED_SHORT, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this.transformationBuffer);\r\n\t        gl.vertexAttribPointer(pointers.transformationAttrPointer, 1, gl.FLOAT, false, 0, 0);\r\n\t        gl.uniform1i(pointers.vertexSamplerUniform, 1);\r\n\t        gl.uniform1i(pointers.matrixSamplerUniform, 2);\r\n\t        gl.uniform1i(pointers.styleSamplerUniform, 3);\r\n\t        gl.uniform1i(pointers.stateStyleSamplerUniform, 4);\r\n\t        gl.uniform1i(pointers.vertexTextureSizeUniform, this.vertexTextureSize);\r\n\t        gl.uniform1i(pointers.matrixTextureSizeUniform, this.matrixTextureSize);\r\n\t        gl.uniform1i(pointers.styleTextureSizeUniform, this.styleTextureSize);\r\n\t    };\r\n\t    //this function must be called AFTER 'setActive()' function which sets up active buffers and uniforms\r\n\t    xModelHandle.prototype.draw = function (mode) {\r\n\t        if (this.stopped)\r\n\t            return;\r\n\t        var gl = this._gl;\r\n\t        if (typeof (mode) === 'undefined') {\r\n\t            //draw image frame\r\n\t            gl.drawArrays(gl.TRIANGLES, 0, this.count);\r\n\t            return;\r\n\t        }\r\n\t        if (mode === 'solid') {\r\n\t            gl.drawArrays(gl.TRIANGLES, 0, this._model.transparentIndex);\r\n\t            return;\r\n\t        }\r\n\t        if (mode === 'transparent') {\r\n\t            gl.drawArrays(gl.TRIANGLES, this._model.transparentIndex, this.count - this._model.transparentIndex);\r\n\t            return;\r\n\t        }\r\n\t    };\r\n\t    xModelHandle.prototype.drawProduct = function (ID) {\r\n\t        if (this.stopped)\r\n\t            return;\r\n\t        var gl = this._gl;\r\n\t        var map = this.getProductMap(ID);\r\n\t        //var i = 3; //3 is for a glass panel\r\n\t        //gl.drawArrays(gl.TRIANGLES, map.spans[i][0], map.spans[i][1] - map.spans[i][0]);\r\n\t        if (map != null) {\r\n\t            map.spans.forEach(function (span) {\r\n\t                gl.drawArrays(gl.TRIANGLES, span[0], span[1] - span[0]);\r\n\t            }, this);\r\n\t        }\r\n\t    };\r\n\t    xModelHandle.prototype.getProductMap = function (ID) {\r\n\t        var map = this._model.productMap[ID];\r\n\t        if (typeof (map) !== 'undefined')\r\n\t            return map;\r\n\t        return null;\r\n\t    };\r\n\t    xModelHandle.prototype.unload = function () {\r\n\t        var gl = this._gl;\r\n\t        gl.deleteTexture(this.vertexTexture);\r\n\t        gl.deleteTexture(this.matrixTexture);\r\n\t        gl.deleteTexture(this.styleTexture);\r\n\t        gl.deleteTexture(this.stateStyleTexture);\r\n\t        gl.deleteBuffer(this.normalBuffer);\r\n\t        gl.deleteBuffer(this.indexBuffer);\r\n\t        gl.deleteBuffer(this.productBuffer);\r\n\t        gl.deleteBuffer(this.styleBuffer);\r\n\t        gl.deleteBuffer(this.stateBuffer);\r\n\t        gl.deleteBuffer(this.transformationBuffer);\r\n\t    };\r\n\t    xModelHandle.prototype.feedGPU = function () {\r\n\t        if (this._feedCompleted) {\r\n\t            throw 'GPU can bee fed only once. It discards unnecessary data which cannot be restored again.';\r\n\t        }\r\n\t        var gl = this._gl;\r\n\t        var model = this._model;\r\n\t        //fill all buffers\r\n\t        this._bufferData(this.normalBuffer, model.normals);\r\n\t        this._bufferData(this.indexBuffer, model.indices);\r\n\t        this._bufferData(this.productBuffer, model.products);\r\n\t        this._bufferData(this.stateBuffer, model.states);\r\n\t        this._bufferData(this.transformationBuffer, model.transformations);\r\n\t        this._bufferData(this.styleBuffer, model.styleIndices);\r\n\t        //fill in all textures\r\n\t        this.vertexTextureSize = this._bufferTexture(this.vertexTexture, model.vertices, 3);\r\n\t        this.matrixTextureSize = this._bufferTexture(this.matrixTexture, model.matrices, 4);\r\n\t        this.styleTextureSize = this._bufferTexture(this.styleTexture, model.styles);\r\n\t        //this has a constant size 15 which is defined in vertex shader\r\n\t        this._bufferTexture(this.stateStyleTexture, this.stateStyle);\r\n\t        //Forget everything except for states and styles (this should save some RAM).\r\n\t        //data is already loaded to GPU by now\r\n\t        model.normals = null;\r\n\t        model.indices = null;\r\n\t        model.products = null;\r\n\t        model.transformations = null;\r\n\t        model.styleIndices = null;\r\n\t        model.vertices = null;\r\n\t        model.matrices = null;\r\n\t        this._feedCompleted = true;\r\n\t    };\r\n\t    xModelHandle.prototype.refreshStyles = function () {\r\n\t        this._bufferTexture(this.stateStyleTexture, this.stateStyle);\r\n\t    };\r\n\t    xModelHandle.prototype._bufferData = function (pointer, data) {\r\n\t        var gl = this._gl;\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, pointer);\r\n\t        gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\r\n\t    };\r\n\t    xModelHandle.prototype._bufferTexture = function (pointer, data, arity) {\r\n\t        var gl = this._gl;\r\n\t        if (data.length == 0)\r\n\t            return 0;\r\n\t        //detect floating point texture support and data type\r\n\t        var fp = this._fpt && data instanceof Float32Array;\r\n\t        //compute size of the image (length should be correct already)\r\n\t        var size = 0;\r\n\t        var maxSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n\t        if (fp) {\r\n\t            //recompute to smaller size, but make it +1 to make sure it is all right\r\n\t            size = Math.ceil(Math.sqrt(Math.ceil(data.length / arity))) + 1;\r\n\t        }\r\n\t        else {\r\n\t            var dim = Math.sqrt(data.byteLength / 4);\r\n\t            size = Math.ceil(dim);\r\n\t        }\r\n\t        if (size == 0)\r\n\t            return 0;\r\n\t        if (size > maxSize)\r\n\t            throw 'Too much data! It cannot fit into the texture.';\r\n\t        gl.bindTexture(gl.TEXTURE_2D, pointer);\r\n\t        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false); //this is our convention\r\n\t        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false); //this should preserve values of alpha\r\n\t        gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, 0); //this should preserve values of colours\r\n\t        if (fp) {\r\n\t            //create new data buffer and fill it in with data\r\n\t            var image = null;\r\n\t            if (size * size * arity != data.length) {\r\n\t                image = new Float32Array(size * size * arity);\r\n\t                image.set(data);\r\n\t            }\r\n\t            else {\r\n\t                image = data;\r\n\t            }\r\n\t            var type = null;\r\n\t            switch (arity) {\r\n\t                case 1:\r\n\t                    type = gl.ALPHA;\r\n\t                    break;\r\n\t                case 3:\r\n\t                    type = gl.RGB;\r\n\t                    break;\r\n\t                case 4:\r\n\t                    type = gl.RGBA;\r\n\t                    break;\r\n\t            }\r\n\t            gl.texImage2D(gl.TEXTURE_2D, 0, type, size, size, 0, type, gl.FLOAT, image);\r\n\t        }\r\n\t        else {\r\n\t            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, size, size, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array(data.buffer));\r\n\t        }\r\n\t        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n\t        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\t        gl.texParameteri(gl\r\n\t            .TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE); //Prevents s-coordinate wrapping (repeating).\r\n\t        gl.texParameteri(gl\r\n\t            .TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE); //Prevents t-coordinate wrapping (repeating).\r\n\t        return size;\r\n\t    };\r\n\t    xModelHandle.prototype.getState = function (id) {\r\n\t        if (typeof (id) === 'undefined')\r\n\t            throw 'id must be defined';\r\n\t        var map = this.getProductMap(id);\r\n\t        if (map === null)\r\n\t            return null;\r\n\t        var span = map.spans[0];\r\n\t        if (typeof (span) == 'undefined')\r\n\t            return null;\r\n\t        return this._model.states[span[0] * 2];\r\n\t    };\r\n\t    xModelHandle.prototype.getStyle = function (id) {\r\n\t        if (typeof (id) === 'undefined')\r\n\t            throw 'id must be defined';\r\n\t        var map = this.getProductMap(id);\r\n\t        if (map === null)\r\n\t            return null;\r\n\t        var span = map.spans[0];\r\n\t        if (typeof (span) == 'undefined')\r\n\t            return null;\r\n\t        return this._model.states[span[0] * 2 + 1];\r\n\t    };\r\n\t    xModelHandle.prototype.setState = function (state, args) {\r\n\t        if (typeof (state) != 'number' && state < 0 && state > 255)\r\n\t            throw 'You have to specify state as an ID of state or index in style pallete.';\r\n\t        if (typeof (args) == 'undefined')\r\n\t            throw 'You have to specify products as an array of product IDs or as a product type ID';\r\n\t        var maps = [];\r\n\t        //it is type\r\n\t        if (typeof (args) == 'number') {\r\n\t            for (var n in this._model.productMap) {\r\n\t                var map = this._model.productMap[n];\r\n\t                if (map.type == args)\r\n\t                    maps.push(map);\r\n\t            }\r\n\t        }\r\n\t        else {\r\n\t            for (var l = 0; l < args.length; l++) {\r\n\t                var id = args[l];\r\n\t                var map = this.getProductMap(id);\r\n\t                if (map != null)\r\n\t                    maps.push(map);\r\n\t            }\r\n\t        }\r\n\t        //shift +1 if it is an overlay colour style or 0 if it is a state.\r\n\t        var shift = state <= 225 ? 1 : 0;\r\n\t        maps.forEach(function (map) {\r\n\t            map.spans.forEach(function (span) {\r\n\t                //set state or style\r\n\t                for (var k = span[0]; k < span[1]; k++) {\r\n\t                    this._model.states[k * 2 + shift] = state;\r\n\t                }\r\n\t            }, this);\r\n\t        }, this);\r\n\t        //buffer data to GPU\r\n\t        this._bufferData(this.stateBuffer, this._model.states);\r\n\t    };\r\n\t    xModelHandle.prototype.resetStates = function () {\r\n\t        for (var i = 0; i < this._model.states.length; i += 2) {\r\n\t            this._model.states[i] = xbim_state_1.xState.UNDEFINED;\r\n\t        }\r\n\t        //buffer data to GPU\r\n\t        this._bufferData(this.stateBuffer, this._model.states);\r\n\t    };\r\n\t    xModelHandle.prototype.resetStyles = function () {\r\n\t        for (var i = 0; i < this._model.states.length; i += 2) {\r\n\t            this._model.states[i + 1] = xbim_state_1.xState.UNSTYLED;\r\n\t        }\r\n\t        //buffer data to GPU\r\n\t        this._bufferData(this.stateBuffer, this._model.states);\r\n\t    };\r\n\t    ;\r\n\t    xModelHandle.prototype.getModelState = function () {\r\n\t        var result = [];\r\n\t        var products = this._model.productMap;\r\n\t        for (var i in products) {\r\n\t            if (!products.hasOwnProperty(i)) {\r\n\t                continue;\r\n\t            }\r\n\t            var map = products[i];\r\n\t            var span = map.spans[0];\r\n\t            if (typeof (span) == 'undefined')\r\n\t                continue;\r\n\t            var state = this._model.states[span[0] * 2];\r\n\t            var style = this._model.states[span[0] * 2 + 1];\r\n\t            result.push([map.productID, state + (style << 8)]);\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xModelHandle.prototype.restoreModelState = function (state) {\r\n\t        state.forEach(function (s) {\r\n\t            var id = s[0];\r\n\t            var style = s[1] >> 8;\r\n\t            var state = s[1] - (style << 8);\r\n\t            var map = this.getProductMap(id);\r\n\t            if (map != null) {\r\n\t                map.spans.forEach(function (span) {\r\n\t                    //set state or style\r\n\t                    for (var k = span[0]; k < span[1]; k++) {\r\n\t                        this._model.states[k * 2] = state;\r\n\t                        this._model.states[k * 2 + 1] = style;\r\n\t                    }\r\n\t                }, this);\r\n\t            }\r\n\t        }, this);\r\n\t        //buffer data to GPU\r\n\t        this._bufferData(this.stateBuffer, this._model.states);\r\n\t    };\r\n\t    return xModelHandle;\r\n\t}());\r\n\t/**\r\n\t * Static counter to keep unique ID of the model handles\r\n\t */\r\n\txModelHandle._instancesNum = 0;\r\n\texports.xModelHandle = xModelHandle;\r\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.xProductInheritance = {\r\n\t    name: \"IfcProduct\",\r\n\t    id: 20,\r\n\t    abs: true,\r\n\t    children: [\r\n\t        {\r\n\t            name: \"IfcElement\",\r\n\t            id: 19,\r\n\t            abs: true,\r\n\t            children: [\r\n\t                {\r\n\t                    name: \"IfcDistributionElement\",\r\n\t                    id: 44,\r\n\t                    abs: false,\r\n\t                    children: [\r\n\t                        {\r\n\t                            name: \"IfcDistributionFlowElement\",\r\n\t                            id: 45,\r\n\t                            abs: false,\r\n\t                            children: [\r\n\t                                { name: \"IfcDistributionChamberElement\", id: 180, abs: false },\r\n\t                                {\r\n\t                                    name: \"IfcEnergyConversionDevice\",\r\n\t                                    id: 175,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcAirToAirHeatRecovery\", id: 1097, abs: false },\r\n\t                                        { name: \"IfcBoiler\", id: 1105, abs: false },\r\n\t                                        { name: \"IfcBurner\", id: 1109, abs: false },\r\n\t                                        { name: \"IfcChiller\", id: 1119, abs: false },\r\n\t                                        { name: \"IfcCoil\", id: 1124, abs: false },\r\n\t                                        { name: \"IfcCondenser\", id: 1132, abs: false },\r\n\t                                        { name: \"IfcCooledBeam\", id: 1141, abs: false },\r\n\t                                        { name: \"IfcCoolingTower\", id: 1142, abs: false },\r\n\t                                        { name: \"IfcEngine\", id: 1164, abs: false },\r\n\t                                        { name: \"IfcEvaporativeCooler\", id: 1166, abs: false },\r\n\t                                        { name: \"IfcEvaporator\", id: 1167, abs: false },\r\n\t                                        { name: \"IfcHeatExchanger\", id: 1187, abs: false },\r\n\t                                        { name: \"IfcHumidifier\", id: 1188, abs: false },\r\n\t                                        { name: \"IfcTubeBundle\", id: 1305, abs: false },\r\n\t                                        { name: \"IfcUnitaryEquipment\", id: 1310, abs: false },\r\n\t                                        { name: \"IfcElectricGenerator\", id: 1160, abs: false },\r\n\t                                        { name: \"IfcElectricMotor\", id: 1161, abs: false },\r\n\t                                        { name: \"IfcMotorConnection\", id: 1216, abs: false },\r\n\t                                        { name: \"IfcSolarDevice\", id: 1270, abs: false },\r\n\t                                        { name: \"IfcTransformer\", id: 1303, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowController\",\r\n\t                                    id: 121,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcElectricDistributionPoint\", id: 242, abs: false },\r\n\t                                        { name: \"IfcAirTerminalBox\", id: 1096, abs: false },\r\n\t                                        { name: \"IfcDamper\", id: 1148, abs: false },\r\n\t                                        { name: \"IfcFlowMeter\", id: 1182, abs: false },\r\n\t                                        { name: \"IfcValve\", id: 1311, abs: false },\r\n\t                                        { name: \"IfcElectricDistributionBoard\", id: 1157, abs: false },\r\n\t                                        { name: \"IfcElectricTimeControl\", id: 1162, abs: false },\r\n\t                                        { name: \"IfcProtectiveDevice\", id: 1235, abs: false },\r\n\t                                        { name: \"IfcSwitchingDevice\", id: 1290, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowFitting\",\r\n\t                                    id: 467,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcDuctFitting\", id: 1153, abs: false },\r\n\t                                        { name: \"IfcPipeFitting\", id: 1222, abs: false },\r\n\t                                        { name: \"IfcCableCarrierFitting\", id: 1111, abs: false },\r\n\t                                        { name: \"IfcCableFitting\", id: 1113, abs: false },\r\n\t                                        { name: \"IfcJunctionBox\", id: 1195, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowMovingDevice\",\r\n\t                                    id: 502,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcCompressor\", id: 1131, abs: false },\r\n\t                                        { name: \"IfcFan\", id: 1177, abs: false },\r\n\t                                        { name: \"IfcPump\", id: 1238, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowSegment\",\r\n\t                                    id: 574,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcDuctSegment\", id: 1154, abs: false },\r\n\t                                        { name: \"IfcPipeSegment\", id: 1223, abs: false },\r\n\t                                        { name: \"IfcCableCarrierSegment\", id: 1112, abs: false },\r\n\t                                        { name: \"IfcCableSegment\", id: 1115, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowStorageDevice\",\r\n\t                                    id: 371,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcTank\", id: 1293, abs: false },\r\n\t                                        { name: \"IfcElectricFlowStorageDevice\", id: 1159, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowTerminal\",\r\n\t                                    id: 46,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcFireSuppressionTerminal\", id: 1179, abs: false },\r\n\t                                        { name: \"IfcSanitaryTerminal\", id: 1262, abs: false },\r\n\t                                        { name: \"IfcStackTerminal\", id: 1277, abs: false },\r\n\t                                        { name: \"IfcWasteTerminal\", id: 1315, abs: false },\r\n\t                                        { name: \"IfcAirTerminal\", id: 1095, abs: false },\r\n\t                                        { name: \"IfcMedicalDevice\", id: 1212, abs: false },\r\n\t                                        { name: \"IfcSpaceHeater\", id: 1272, abs: false },\r\n\t                                        { name: \"IfcAudioVisualAppliance\", id: 1099, abs: false },\r\n\t                                        { name: \"IfcCommunicationsAppliance\", id: 1127, abs: false },\r\n\t                                        { name: \"IfcElectricAppliance\", id: 1156, abs: false },\r\n\t                                        { name: \"IfcLamp\", id: 1198, abs: false },\r\n\t                                        { name: \"IfcLightFixture\", id: 1199, abs: false },\r\n\t                                        { name: \"IfcOutlet\", id: 1219, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcFlowTreatmentDevice\",\r\n\t                                    id: 425,\r\n\t                                    abs: false,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcInterceptor\", id: 1193, abs: false },\r\n\t                                        { name: \"IfcDuctSilencer\", id: 1155, abs: false },\r\n\t                                        { name: \"IfcFilter\", id: 1178, abs: false }\r\n\t                                    ]\r\n\t                                }\r\n\t                            ]\r\n\t                        }, {\r\n\t                            name: \"IfcDistributionControlElement\",\r\n\t                            id: 468,\r\n\t                            abs: false,\r\n\t                            children: [\r\n\t                                { name: \"IfcProtectiveDeviceTrippingUnit\", id: 1236, abs: false },\r\n\t                                { name: \"IfcActuator\", id: 1091, abs: false },\r\n\t                                { name: \"IfcAlarm\", id: 1098, abs: false },\r\n\t                                { name: \"IfcController\", id: 1139, abs: false },\r\n\t                                { name: \"IfcFlowInstrument\", id: 1181, abs: false },\r\n\t                                { name: \"IfcSensor\", id: 1264, abs: false },\r\n\t                                { name: \"IfcUnitaryControlElement\", id: 1308, abs: false }\r\n\t                            ]\r\n\t                        }\r\n\t                    ]\r\n\t                }, {\r\n\t                    name: \"IfcElementComponent\",\r\n\t                    id: 424,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        { name: \"IfcDiscreteAccessory\", id: 423, abs: false },\r\n\t                        {\r\n\t                            name: \"IfcFastener\",\r\n\t                            id: 535,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcMechanicalFastener\", id: 536, abs: false }]\r\n\t                        }, {\r\n\t                            name: \"IfcReinforcingElement\",\r\n\t                            id: 262,\r\n\t                            abs: true,\r\n\t                            children: [\r\n\t                                { name: \"IfcReinforcingBar\", id: 571, abs: false },\r\n\t                                { name: \"IfcReinforcingMesh\", id: 531, abs: false },\r\n\t                                { name: \"IfcTendon\", id: 261, abs: false },\r\n\t                                { name: \"IfcTendonAnchor\", id: 675, abs: false }\r\n\t                            ]\r\n\t                        }, { name: \"IfcBuildingElementPart\", id: 220, abs: false },\r\n\t                        { name: \"IfcMechanicalFastener\", id: 536, abs: false },\r\n\t                        { name: \"IfcVibrationIsolator\", id: 1312, abs: false }\r\n\t                    ]\r\n\t                }, {\r\n\t                    name: \"IfcFeatureElement\",\r\n\t                    id: 386,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        {\r\n\t                            name: \"IfcFeatureElementSubtraction\",\r\n\t                            id: 499,\r\n\t                            abs: true,\r\n\t                            children: [\r\n\t                                {\r\n\t                                    name: \"IfcEdgeFeature\",\r\n\t                                    id: 764,\r\n\t                                    abs: true,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcChamferEdgeFeature\", id: 765, abs: false },\r\n\t                                        { name: \"IfcRoundedEdgeFeature\", id: 766, abs: false }\r\n\t                                    ]\r\n\t                                }, {\r\n\t                                    name: \"IfcOpeningElement\",\r\n\t                                    id: 498,\r\n\t                                    abs: false,\r\n\t                                    children: [{ name: \"IfcOpeningStandardCase\", id: 1217, abs: false }]\r\n\t                                }, { name: \"IfcVoidingFeature\", id: 1313, abs: false }\r\n\t                            ]\r\n\t                        }, {\r\n\t                            name: \"IfcFeatureElementAddition\",\r\n\t                            id: 385,\r\n\t                            abs: true,\r\n\t                            children: [{ name: \"IfcProjectionElement\", id: 384, abs: false }]\r\n\t                        }, { name: \"IfcSurfaceFeature\", id: 1287, abs: false }\r\n\t                    ]\r\n\t                }, {\r\n\t                    name: \"IfcBuildingElement\",\r\n\t                    id: 26,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        {\r\n\t                            name: \"IfcBuildingElementComponent\",\r\n\t                            id: 221,\r\n\t                            abs: true,\r\n\t                            children: [\r\n\t                                { name: \"IfcBuildingElementPart\", id: 220, abs: false },\r\n\t                                {\r\n\t                                    name: \"IfcReinforcingElement\",\r\n\t                                    id: 262,\r\n\t                                    abs: true,\r\n\t                                    children: [\r\n\t                                        { name: \"IfcReinforcingBar\", id: 571, abs: false },\r\n\t                                        { name: \"IfcReinforcingMesh\", id: 531, abs: false },\r\n\t                                        { name: \"IfcTendon\", id: 261, abs: false },\r\n\t                                        { name: \"IfcTendonAnchor\", id: 675, abs: false }\r\n\t                                    ]\r\n\t                                }\r\n\t                            ]\r\n\t                        }, { name: \"IfcFooting\", id: 120, abs: false }, { name: \"IfcPile\", id: 572, abs: false },\r\n\t                        {\r\n\t                            name: \"IfcBeam\",\r\n\t                            id: 171,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcBeamStandardCase\", id: 1104, abs: false }]\r\n\t                        },\r\n\t                        {\r\n\t                            name: \"IfcColumn\",\r\n\t                            id: 383,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcColumnStandardCase\", id: 1126, abs: false }]\r\n\t                        }, { name: \"IfcCurtainWall\", id: 456, abs: false },\r\n\t                        {\r\n\t                            name: \"IfcDoor\",\r\n\t                            id: 213,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcDoorStandardCase\", id: 1151, abs: false }]\r\n\t                        },\r\n\t                        {\r\n\t                            name: \"IfcMember\",\r\n\t                            id: 310,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcMemberStandardCase\", id: 1214, abs: false }]\r\n\t                        }, {\r\n\t                            name: \"IfcPlate\",\r\n\t                            id: 351,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcPlateStandardCase\", id: 1224, abs: false }]\r\n\t                        }, { name: \"IfcRailing\", id: 350, abs: false }, { name: \"IfcRamp\", id: 414, abs: false },\r\n\t                        { name: \"IfcRampFlight\", id: 348, abs: false }, { name: \"IfcRoof\", id: 347, abs: false },\r\n\t                        {\r\n\t                            name: \"IfcSlab\",\r\n\t                            id: 99,\r\n\t                            abs: false,\r\n\t                            children: [\r\n\t                                { name: \"IfcSlabElementedCase\", id: 1268, abs: false },\r\n\t                                { name: \"IfcSlabStandardCase\", id: 1269, abs: false }\r\n\t                            ]\r\n\t                        }, { name: \"IfcStair\", id: 346, abs: false }, { name: \"IfcStairFlight\", id: 25, abs: false },\r\n\t                        {\r\n\t                            name: \"IfcWall\",\r\n\t                            id: 452,\r\n\t                            abs: false,\r\n\t                            children: [\r\n\t                                { name: \"IfcWallStandardCase\", id: 453, abs: false },\r\n\t                                { name: \"IfcWallElementedCase\", id: 1314, abs: false }\r\n\t                            ]\r\n\t                        }, {\r\n\t                            name: \"IfcWindow\",\r\n\t                            id: 667,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcWindowStandardCase\", id: 1316, abs: false }]\r\n\t                        }, { name: \"IfcBuildingElementProxy\", id: 560, abs: false },\r\n\t                        { name: \"IfcCovering\", id: 382, abs: false },\r\n\t                        { name: \"IfcChimney\", id: 1120, abs: false }, { name: \"IfcShadingDevice\", id: 1265, abs: false }\r\n\t                    ]\r\n\t                }, { name: \"IfcElementAssembly\", id: 18, abs: false },\r\n\t                {\r\n\t                    name: \"IfcFurnishingElement\",\r\n\t                    id: 253,\r\n\t                    abs: false,\r\n\t                    children: [\r\n\t                        { name: \"IfcFurniture\", id: 1184, abs: false },\r\n\t                        { name: \"IfcSystemFurnitureElement\", id: 1291, abs: false }\r\n\t                    ]\r\n\t                }, { name: \"IfcTransportElement\", id: 416, abs: false },\r\n\t                { name: \"IfcVirtualElement\", id: 168, abs: false },\r\n\t                { name: \"IfcElectricalElement\", id: 23, abs: false },\r\n\t                { name: \"IfcEquipmentElement\", id: 212, abs: false },\r\n\t                { name: \"IfcCivilElement\", id: 1122, abs: false },\r\n\t                { name: \"IfcGeographicElement\", id: 1185, abs: false }\r\n\t            ]\r\n\t        }, { name: \"IfcPort\", id: 179, abs: true, children: [{ name: \"IfcDistributionPort\", id: 178, abs: false }] },\r\n\t        { name: \"IfcProxy\", id: 447, abs: false }, {\r\n\t            name: \"IfcStructuralActivity\",\r\n\t            id: 41,\r\n\t            abs: true,\r\n\t            children: [\r\n\t                {\r\n\t                    name: \"IfcStructuralAction\",\r\n\t                    id: 40,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        {\r\n\t                            name: \"IfcStructuralLinearAction\",\r\n\t                            id: 463,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcStructuralLinearActionVarying\", id: 464, abs: false }]\r\n\t                        }, {\r\n\t                            name: \"IfcStructuralPlanarAction\",\r\n\t                            id: 39,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcStructuralPlanarActionVarying\", id: 357, abs: false }]\r\n\t                        }, { name: \"IfcStructuralPointAction\", id: 356, abs: false },\r\n\t                        {\r\n\t                            name: \"IfcStructuralCurveAction\",\r\n\t                            id: 1279,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcStructuralLinearAction\", id: 463, abs: false }]\r\n\t                        }, {\r\n\t                            name: \"IfcStructuralSurfaceAction\",\r\n\t                            id: 1284,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcStructuralPlanarAction\", id: 39, abs: false }]\r\n\t                        }\r\n\t                    ]\r\n\t                }, {\r\n\t                    name: \"IfcStructuralReaction\",\r\n\t                    id: 355,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        { name: \"IfcStructuralPointReaction\", id: 354, abs: false },\r\n\t                        { name: \"IfcStructuralCurveReaction\", id: 1280, abs: false },\r\n\t                        { name: \"IfcStructuralSurfaceReaction\", id: 1285, abs: false }\r\n\t                    ]\r\n\t                }\r\n\t            ]\r\n\t        }, {\r\n\t            name: \"IfcStructuralItem\",\r\n\t            id: 226,\r\n\t            abs: true,\r\n\t            children: [\r\n\t                {\r\n\t                    name: \"IfcStructuralConnection\",\r\n\t                    id: 265,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        { name: \"IfcStructuralCurveConnection\", id: 534, abs: false },\r\n\t                        { name: \"IfcStructuralPointConnection\", id: 533, abs: false },\r\n\t                        { name: \"IfcStructuralSurfaceConnection\", id: 264, abs: false }\r\n\t                    ]\r\n\t                }, {\r\n\t                    name: \"IfcStructuralMember\",\r\n\t                    id: 225,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        {\r\n\t                            name: \"IfcStructuralCurveMember\",\r\n\t                            id: 224,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcStructuralCurveMemberVarying\", id: 227, abs: false }]\r\n\t                        }, {\r\n\t                            name: \"IfcStructuralSurfaceMember\",\r\n\t                            id: 420,\r\n\t                            abs: false,\r\n\t                            children: [{ name: \"IfcStructuralSurfaceMemberVarying\", id: 421, abs: false }]\r\n\t                        }\r\n\t                    ]\r\n\t                }\r\n\t            ]\r\n\t        }, { name: \"IfcAnnotation\", id: 634, abs: false }, {\r\n\t            name: \"IfcSpatialStructureElement\",\r\n\t            id: 170,\r\n\t            abs: true,\r\n\t            children: [\r\n\t                { name: \"IfcBuilding\", id: 169, abs: false }, { name: \"IfcBuildingStorey\", id: 459, abs: false },\r\n\t                { name: \"IfcSite\", id: 349, abs: false }, { name: \"IfcSpace\", id: 454, abs: false }\r\n\t            ]\r\n\t        }, { name: \"IfcGrid\", id: 564, abs: false }, {\r\n\t            name: \"IfcSpatialElement\",\r\n\t            id: 1273,\r\n\t            abs: true,\r\n\t            children: [\r\n\t                {\r\n\t                    name: \"IfcSpatialStructureElement\",\r\n\t                    id: 170,\r\n\t                    abs: true,\r\n\t                    children: [\r\n\t                        { name: \"IfcBuilding\", id: 169, abs: false },\r\n\t                        { name: \"IfcBuildingStorey\", id: 459, abs: false },\r\n\t                        { name: \"IfcSite\", id: 349, abs: false }, { name: \"IfcSpace\", id: 454, abs: false }\r\n\t                    ]\r\n\t                }, {\r\n\t                    name: \"IfcExternalSpatialStructureElement\",\r\n\t                    id: 1175,\r\n\t                    abs: true,\r\n\t                    children: [{ name: \"IfcExternalSpatialElement\", id: 1174, abs: false }]\r\n\t                }, { name: \"IfcSpatialZone\", id: 1275, abs: false }\r\n\t            ]\r\n\t        }\r\n\t    ]\r\n\t};\r\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t/*\r\n\t* This file has been generated by spacker.exe utility. Do not change this file manualy as your changes\r\n\t* will get lost when the file is regenerated. Original content is located in *.c files.\r\n\t*/\r\n\texports.xShaders = {\r\n\t    fragment_shader: ' precision mediump float; uniform vec4 uClippingPlane; varying vec4 vFrontColor; varying vec4 vBackColor; varying vec3 vPosition; varying float vDiscard; void main(void) { if ( vDiscard > 0.001) discard; if (length(uClippingPlane) > 0.001) { vec4 p = uClippingPlane; vec3 x = vPosition; float distance = (dot(p.xyz, x) + p.w) / length(p.xyz); if (distance < 0.0){ discard; } } gl_FragColor = gl_FrontFacing ? vFrontColor : vBackColor; }',\r\n\t    vertex_shader: ' attribute highp float aVertexIndex; attribute highp float aTransformationIndex; attribute highp float aStyleIndex; attribute highp float aProduct; attribute highp vec2 aState; attribute highp vec2 aNormal; uniform mat4 uMVMatrix; uniform mat4 uPMatrix; uniform vec4 ulightA; uniform vec4 ulightB; uniform vec4 uHighlightColour; uniform float uMeter; uniform bool uColorCoding; uniform int uRenderingMode; uniform highp sampler2D uVertexSampler; uniform int uVertexTextureSize; uniform highp sampler2D uMatrixSampler; uniform int uMatrixTextureSize; uniform highp sampler2D uStyleSampler; uniform int uStyleTextureSize; uniform highp sampler2D uStateStyleSampler; varying vec4 vFrontColor; varying vec4 vBackColor; varying vec3 vPosition; varying float vDiscard; vec3 getNormal(){ float U = aNormal[0]; float V = aNormal[1]; float PI = 3.1415926535897932384626433832795; float lon = U / 252.0 * 2.0 * PI; float lat = V / 252.0 * PI; float x = sin(lon) * sin(lat); float z = cos(lon) * sin(lat); float y = cos(lat); return normalize(vec3(x, y, z)); } vec4 getIdColor(){ float product = floor(aProduct + 0.5); float B = floor (product/(256.0*256.0)); float G = floor((product  - B * 256.0*256.0)/256.0); float R = mod(product, 256.0); return vec4(R/255.0, G/255.0, B/255.0, 1.0); } vec2 getTextureCoordinates(int index, int size) { float x = float(index - (index / size) * size); float y = float(index / size); float pixelSize = 1.0 / float(size); return vec2((x + 0.5) * pixelSize, (y + 0.5) * pixelSize); } vec4 getColor(){ int restyle = int(floor(aState[1] + 0.5)); if (restyle > 224){ int index = int (floor(aStyleIndex + 0.5)); vec2 coords = getTextureCoordinates(index, uStyleTextureSize); return texture2D(uStyleSampler, coords); } vec2 coords = getTextureCoordinates(restyle, 15); return texture2D(uStateStyleSampler, coords); } vec3 getVertexPosition(){ int index = int (floor(aVertexIndex +0.5)); vec2 coords = getTextureCoordinates(index, uVertexTextureSize); vec3 point = vec3(texture2D(uVertexSampler, coords)); int tIndex = int(floor(aTransformationIndex + 0.5)); if (tIndex != 65535) { tIndex *=4; mat4 transform = mat4( texture2D(uMatrixSampler, getTextureCoordinates(tIndex, uMatrixTextureSize)), texture2D(uMatrixSampler, getTextureCoordinates(tIndex+1, uMatrixTextureSize)), texture2D(uMatrixSampler, getTextureCoordinates(tIndex+2, uMatrixTextureSize)), texture2D(uMatrixSampler, getTextureCoordinates(tIndex+3, uMatrixTextureSize)) ); return vec3(transform * vec4(point, 1.0)); } return point; } void main(void) { int state = int(floor(aState[0] + 0.5)); vDiscard = 0.0; if (state == 254) { vDiscard = 1.0; vFrontColor = vec4(0.0, 0.0, 0.0, 0.0); vBackColor = vec4(0.0, 0.0, 0.0, 0.0); vPosition = vec3(0.0, 0.0, 0.0); gl_Position = vec4(0.0, 0.0, 0.0, 1.0); return; } vec3 vertex = getVertexPosition(); vec3 normal = getNormal(); vec3 backNormal = normal * -1.0; if (uColorCoding){ vec4 idColor = getIdColor(); vFrontColor = idColor; vBackColor = idColor; } else{ float lightAIntensity = ulightA[3]; vec3 lightADirection = normalize(ulightA.xyz - vertex); float lightBIntensity = ulightB[3]; vec3 lightBDirection = normalize(ulightB.xyz - vertex); float lightWeightA = max(dot(normal, lightADirection ) * lightAIntensity, 0.0); float lightWeightB = max(dot(normal, lightBDirection ) * lightBIntensity, 0.0); float backLightWeightA = max(dot(backNormal, lightADirection) * lightAIntensity, 0.0); float backLightWeightB = max(dot(backNormal, lightBDirection) * lightBIntensity, 0.0); float lightWeighting = lightWeightA + lightWeightB + 0.4; float backLightWeighting = backLightWeightA + backLightWeightB + 0.4; vec4 baseColor = vec4(1.0, 1.0, 1.0, 1.0); if (uRenderingMode == 2){ if (state == 252){ baseColor = getColor(); } else{ baseColor = vec4(0.0, 0.0, 0.3, 0.5); } } if (state == 253) { baseColor = uHighlightColour; } if (uRenderingMode != 2 && state != 253){ baseColor = getColor(); } if (baseColor.a < 0.98 && uRenderingMode == 0) { vec3 trans = -0.002 * uMeter * normalize(normal); vertex = vertex + trans; } vFrontColor = vec4(baseColor.rgb * lightWeighting, baseColor.a); vBackColor = vec4(baseColor.rgb * backLightWeighting, baseColor.a); } vPosition = vertex; gl_Position = uPMatrix * uMVMatrix * vec4(vertex, 1.0); }',\r\n\t    vertex_shader_noFPT: ' attribute highp float aVertexIndex; attribute highp float aTransformationIndex; attribute highp float aStyleIndex; attribute highp float aProduct; attribute highp float aState; attribute highp vec2 aNormal; uniform mat4 uMVMatrix; uniform mat4 uPMatrix; uniform vec4 ulightA; uniform vec4 ulightB; uniform bool uColorCoding; uniform bool uFloatingPoint; uniform highp sampler2D uVertexSampler; uniform int uVertexTextureSize; uniform highp sampler2D uMatrixSampler; uniform int uMatrixTextureSize; uniform highp sampler2D uStyleSampler; uniform int uStyleTextureSize; uniform highp sampler2D uStateStyleSampler; int stateStyleTextureSize = 15; varying vec4 vColor; varying vec3 vPosition; vec3 getNormal(){ float U = aNormal[0]; float V = aNormal[1]; float PI = 3.1415926535897932384626433832795; float u = ((U / 252.0) * (2.0 * PI)) - PI; float v = ((V / 252.0) * (2.0 * PI)) - PI; float x = sin(v) * cos(u); float y = sin(v) * sin(u); float z = cos(v); return normalize(vec3(x, y, z)); } vec4 getIdColor(){ float R = mod(aProduct, 256.0) / 255.0; float G = floor(aProduct/256.0) / 255.0; float B = floor (aProduct/(256.0*256.0)) / 255.0; return vec4(R, G, B, 1.0); } vec2 getVertexTextureCoordinates(int index, int size) { float x = float(index - (index / size) * size); float y = float(index / size); float pixelSize = 1.0 / float(size); return vec2((x + 0.5) * pixelSize, (y + 0.5) * pixelSize); } int getByteFromScale(float base) { float result = base * 255.0; int correction = fract(result) >= 0.5 ? 1 : 0; return int(result) + correction; } ivec4 getPixel(int index, sampler2D sampler, int size) { vec2 coords = getVertexTextureCoordinates(index, size); vec4 pixel = texture2D(sampler, coords); return ivec4( getByteFromScale(pixel.r), getByteFromScale(pixel.g), getByteFromScale(pixel.b), getByteFromScale(pixel.a) ); } void getBits(ivec4 pixel, out int result[32]) { for (int i = 0; i < 4; i++) { int actualByte = pixel[i]; for (int j = 0; j < 8; j++) { result[31 - (j + i * 8)] =  actualByte - (actualByte / 2) * 2; actualByte /= 2; } } } float getFloatFromPixel(ivec4 pixel) { int bits[32]; getBits(pixel, bits); float sign =  bits[0] == 0 ? 1.0 : -1.0; highp float fraction = 1.0; highp float exponent = 0.0; for (int i = 1; i < 9; i++) { exponent += float(bits[9 - i]) * exp2(float (i - 1)); } exponent -= 127.0; for (int i = 9; i < 32; i++) { fraction += float(bits[i]) * exp2(float((-1)*(i-8))); } return sign * fraction * exp2(exponent); } float getFloatFromPixel(int index, sampler2D sampler, int size) { ivec4 pixel = getPixel(index, sampler, size); return getFloatFromPixel(pixel); } vec4 getColor(){ if (floor(aState + 0.5) == 0.0){ int index = int (floor(aStyleIndex + 0.5)); vec2 coords = getVertexTextureCoordinates(index, uStyleTextureSize); return texture2D(uStyleSampler, coords); } else{ return vec4(1.0,1.0,1.0,1.0); } } vec3 getVertexPosition(){ int index = int (floor(aVertexIndex +0.5))* 3; vec3 position = vec3( getFloatFromPixel(index, uVertexSampler, uVertexTextureSize), getFloatFromPixel(index + 1, uVertexSampler, uVertexTextureSize), getFloatFromPixel(index + 2, uVertexSampler, uVertexTextureSize) ); int tIndex = int(floor(aTransformationIndex + 0.5)); if (tIndex != 65535) { tIndex *= 16; mat4 transform = mat4( getFloatFromPixel(tIndex + 0, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 1, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 2, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 3, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 4, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 5, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 6, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 7, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 8, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 9, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 10, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 11, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 12, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 13, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 14, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 15, uMatrixSampler, uMatrixTextureSize) ); vec4 transformedPosition = transform * vec4(position, 1.0); return vec3(transformedPosition); } return position; } void main(void) { vec3 vertex = getVertexPosition(); vPosition = vertex; gl_Position = uPMatrix * uMVMatrix * vec4(vertex, 1.0); if (uColorCoding){ vColor = getIdColor(); } else{ vec3 normal = getNormal(); float lightAIntensity = ulightA[3]; vec3 lightADirection = normalize(ulightA.xyz - vPosition); float lightBIntensity = ulightB[3]; vec3 lightBDirection = normalize(ulightB.xyz - vPosition); float lightWeightA = max(dot(normal, lightADirection ) * lightAIntensity, 0.0); float lightWeightB = max(dot(normal, lightBDirection ) * lightBIntensity, 0.0); float lightWeighting = lightWeightA + lightWeightB + 0.4; vec4 baseColor = getColor(); vColor = vec4(baseColor.rgb * lightWeighting, baseColor.a); } }'\r\n\t};\r\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_state_1 = __webpack_require__(4);\r\n\tvar xbim_product_type_1 = __webpack_require__(5);\r\n\tvar xbim_model_geometry_1 = __webpack_require__(3);\r\n\tvar xbim_model_handle_1 = __webpack_require__(7);\r\n\tvar xbim_shaders_1 = __webpack_require__(9);\r\n\tvar glMatrix = __webpack_require__(11);\r\n\t__webpack_require__(12);\r\n\tvar xViewer = (function () {\r\n\t    /**\r\n\t    * This is constructor of the xBIM Viewer. It gets HTMLCanvasElement or string ID as an argument. Viewer will than be initialized\r\n\t    * in the context of specified canvas. Any other argument will throw exception.\r\n\t    * @name xViewer\r\n\t    * @constructor\r\n\t    * @classdesc This is the main and the only class you need to load and render IFC models in wexBIM format. This viewer is part of\r\n\t    * xBIM toolkit which can be used to create wexBIM files from IFC, ifcZIP and ifcXML. WexBIM files are highly optimized for\r\n\t    * transmition over internet and rendering performance. Viewer uses WebGL technology for hardware accelerated 3D rendering and SVG for\r\n\t    * certain kinds of user interaction. This means that it won't work with obsolete and non-standard-compliant browsers like IE10 and less.\r\n\t    *\r\n\t    * @param {string | HTMLCanvasElement} canvas - string ID of the canvas or HTML canvas element.\r\n\t    */\r\n\t    function xViewer(canvas) {\r\n\t        if (typeof (canvas) == 'undefined') {\r\n\t            throw 'Canvas has to be defined';\r\n\t        }\r\n\t        if (typeof (canvas['nodeName']) != 'undefined' && canvas['nodeName'] === 'CANVAS') {\r\n\t            this._canvas = canvas;\r\n\t        }\r\n\t        if (typeof (canvas) == 'string') {\r\n\t            this._canvas = document.getElementById(canvas);\r\n\t        }\r\n\t        if (this._canvas == null) {\r\n\t            throw 'You have to specify canvas either as an ID of HTML element or the element itself';\r\n\t        }\r\n\t        /**\r\n\t        * This is a structure that holds settings of perspective camera.\r\n\t        * @member {PerspectiveCamera} xViewer#perspectiveCamera\r\n\t        */\r\n\t        /**\r\n\t        * This is only a structure. Don't call the constructor.\r\n\t        * @classdesc This is a structure that holds settings of perspective camera. If you want\r\n\t        * to switch viewer to use perspective camera set {@link xViewer#camera camera} to 'perspective'.\r\n\t        * You can modify this but it is not necessary because sensible values are\r\n\t        * defined when geometry model is loaded with {@link xViewer#load load()} method. If you want to\r\n\t        * change these values you have to do it after geometry is loaded.\r\n\t        * @class\r\n\t        * @name PerspectiveCamera\r\n\t        */\r\n\t        this.perspectiveCamera = {\r\n\t            /** @member {Number} PerspectiveCamera#fov - Field of view*/\r\n\t            fov: 45,\r\n\t            /** @member {Number} PerspectiveCamera#near - Near cutting plane*/\r\n\t            near: 0,\r\n\t            /** @member {Number} PerspectiveCamera#far - Far cutting plane*/\r\n\t            far: 0\r\n\t        };\r\n\t        /**\r\n\t        * This is a structure that holds settings of orthogonal camera. You can modify this but it is not necessary because sensible values are\r\n\t        * defined when geometry model is loaded with {@link xViewer#load load()} method. If you want to change these values you have to do it after geometry is loaded.\r\n\t        * @member {OrthogonalCamera} xViewer#orthogonalCamera\r\n\t        */\r\n\t        /**\r\n\t        * This is only a structure. Don't call the constructor.\r\n\t        * @classdesc This is a structure that holds settings of orthogonal camera. If you want to switch viewer to use orthogonal camera set {@link xViewer#camera camera} to 'orthogonal'.\r\n\t        * @class\r\n\t        * @name OrthogonalCamera\r\n\t        */\r\n\t        this.orthogonalCamera = {\r\n\t            /** @member {Number} OrthogonalCamera#left*/\r\n\t            left: 0,\r\n\t            /** @member {Number} OrthogonalCamera#right*/\r\n\t            right: 0,\r\n\t            /** @member {Number} OrthogonalCamera#top*/\r\n\t            top: 0,\r\n\t            /** @member {Number} OrthogonalCamera#bottom*/\r\n\t            bottom: 0,\r\n\t            /** @member {Number} OrthogonalCamera#near*/\r\n\t            near: 0,\r\n\t            /** @member {Number} OrthogonalCamera#far*/\r\n\t            far: 0\r\n\t        };\r\n\t        /**\r\n\t        * Type of camera to be used. Available values are <strong>'perspective'</strong> and <strong>'orthogonal'</strong> You can change this value at any time with instant effect.\r\n\t        * @member {string} xViewer#camera\r\n\t        */\r\n\t        this.camera = 'perspective';\r\n\t        /**\r\n\t        * Array of four integers between 0 and 255 representing RGBA colour components. This defines background colour of the viewer. You can change this value at any time with instant effect.\r\n\t        * @member {Number[]} xViewer#background\r\n\t        */\r\n\t        this.background = [230, 230, 230, 255];\r\n\t        /**\r\n\t        * Array of four integers between 0 and 255 representing RGBA colour components. This defines colour for highlighted elements. You can change this value at any time with instant effect.\r\n\t        * @member {Number[]} xViewer#highlightingColour\r\n\t        */\r\n\t        this.highlightingColour = [255, 173, 33, 255];\r\n\t        /**\r\n\t        * Array of four floats. It represents Light A's position <strong>XYZ</strong> and intensity <strong>I</strong> as [X, Y, Z, I]. Intensity should be in range 0.0 - 1.0.\r\n\t        * @member {Number[]} xViewer#lightA\r\n\t        */\r\n\t        this.lightA = [0, 1000000, 200000, 0.8];\r\n\t        /**\r\n\t        * Array of four floats. It represents Light B's position <strong>XYZ</strong> and intensity <strong>I</strong> as [X, Y, Z, I]. Intensity should be in range 0.0 - 1.0.\r\n\t        * @member {Number[]} xViewer#lightB\r\n\t        */\r\n\t        this.lightB = [0, -500000, 50000, 0.2];\r\n\t        /**\r\n\t        * Switch between different navigation modes for left mouse button. Allowed values: <strong> 'pan', 'zoom', 'orbit' (or 'fixed-orbit') , 'free-orbit' and 'none'</strong>. Default value is <strong>'orbit'</strong>;\r\n\t        * @member {String} xViewer#navigationMode\r\n\t        */\r\n\t        this.navigationMode = 'orbit';\r\n\t        /**\r\n\t        * Switch between different rendering modes. Allowed values: <strong> 'normal', 'x-ray'</strong>. Default value is <strong>'normal'</strong>;\r\n\t        * Only products with state set to state.HIGHLIGHTED or xState.XRAYVISIBLE will be rendered highlighted or in a normal colours. All other products\r\n\t        * will be rendered semi-transparent and single sided.\r\n\t        * @member {String} xViewer#renderingMode\r\n\t        */\r\n\t        this.renderingMode = 'normal';\r\n\t        /**\r\n\t        * Clipping plane [a, b, c, d] defined as normal equation of the plane ax + by + cz + d = 0. [0,0,0,0] is for no clipping plane.\r\n\t        * @member {Number[]} xViewer#clippingPlane\r\n\t        */\r\n\t        this.clippingPlane = [0, 0, 0, 0];\r\n\t        this._lastClippingPoint = [0, 0, 0];\r\n\t        //*************************** Do all the set up of WebGL **************************\r\n\t        var gl = WebGLUtils.setupWebGL(this._canvas);\r\n\t        //do not even initialize this object if WebGL is not supported\r\n\t        if (!gl) {\r\n\t            return;\r\n\t        }\r\n\t        this._gl = gl;\r\n\t        //detect floating point texture support\r\n\t        this._fpt = (gl.getExtension('OES_texture_float') ||\r\n\t            gl.getExtension('MOZ_OES_texture_float') ||\r\n\t            gl.getExtension('WEBKIT_OES_texture_float'));\r\n\t        //set up DEPTH_TEST and BLEND so that transparent objects look right\r\n\t        //this is not 100% perfect as it would be necessary to sort all objects from back to\r\n\t        //front when rendering them. We have sacrificed this for the sake of performance.\r\n\t        //Objects with no transparency in their default style are drawn first and semi-transparent last.\r\n\t        //This gives 90% right when there is not too much of transparency. It may not look right if you\r\n\t        //have a look through two windows or if you have a look from inside of the building out.\r\n\t        //It is granted to be alright when looking from outside of the building inside through one\r\n\t        //semi-transparent object like curtain wall panel or window which is the case most of the time.\r\n\t        //This is known limitation but there is no plan to change this behaviour.\r\n\t        gl.enable(gl.DEPTH_TEST);\r\n\t        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n\t        gl.enable(gl.BLEND);\r\n\t        //cache canvas width and height and change it only when size change\r\n\t        // it is better to cache this value because it is used frequently and it takes a time to get a value from HTML\r\n\t        this._width = this._canvas.width = this._canvas.offsetWidth;\r\n\t        this._height = this._canvas.height = this._canvas.offsetHeight;\r\n\t        this._geometryLoaded = false;\r\n\t        //number of active models is used to indicate that state has changed\r\n\t        this._numberOfActiveModels = 0;\r\n\t        //this object is used to identify if anything changed before two frames (hence if it is necessary to redraw)\r\n\t        this._lastStates = {};\r\n\t        this._visualStateAttributes = [\r\n\t            'perspectiveCamera', 'orthogonalCamera', 'camera', 'background', 'lightA', 'lightB',\r\n\t            'renderingMode', 'clippingPlane', '_mvMatrix', '_pMatrix', '_distance', '_origin', 'highlightingColour',\r\n\t            '_numberOfActiveModels'\r\n\t        ];\r\n\t        this._stylingChanged = true;\r\n\t        //this is to indicate that user has done some interaction\r\n\t        this._userAction = true;\r\n\t        //dictionary of named events which can be registered and unregistered by using '.on('eventname', callback)'\r\n\t        // and '.off('eventname', callback)'. Registered call-backs are triggered by the viewer when important events occur.\r\n\t        this._events = {};\r\n\t        //array of plugins which can implement certain methods which get called at certain points like before draw, after draw and others.\r\n\t        this._plugins = [];\r\n\t        //pointers to uniforms in shaders\r\n\t        this._mvMatrixUniformPointer = null;\r\n\t        this._pMatrixUniformPointer = null;\r\n\t        this._lightAUniformPointer = null;\r\n\t        this._lightBUniformPointer = null;\r\n\t        this._colorCodingUniformPointer = null;\r\n\t        this._clippingPlaneUniformPointer = null;\r\n\t        this._meterUniformPointer = null;\r\n\t        this._renderingModeUniformPointer = null;\r\n\t        this._highlightingColourUniformPointer = null;\r\n\t        //transformation matrices\r\n\t        this._mvMatrix = glMatrix.mat4.create(); //world matrix\r\n\t        this._pMatrix = glMatrix.mat4.create(); //camera matrix (this can be either perspective or orthogonal camera)\r\n\t        //Navigation settings - coordinates in the WCS of the origin used for orbiting and panning\r\n\t        this._origin = [0, 0, 0];\r\n\t        //Default distance for default views (top, bottom, left, right, front, back)\r\n\t        this._distance = 0;\r\n\t        //shader program used for rendering\r\n\t        this._shaderProgram = null;\r\n\t        //Array of handles which can eventually contain handles to one or more models.\r\n\t        //Models are loaded using 'load()' function.\r\n\t        this._handles = [];\r\n\t        //This array keeps data for overlay styles.\r\n\t        this._stateStyles = new Uint8Array(15 * 15 * 4);\r\n\t        //This is a switch which can stop animation.\r\n\t        this._isRunning = true;\r\n\t        //********************** Run all the initialize functions *****************************\r\n\t        //compile shaders for use\r\n\t        this._initShaders();\r\n\t        //initialize vertex attribute and uniform pointers\r\n\t        this._initAttributesAndUniforms();\r\n\t        //initialize mouse events to capture user interaction\r\n\t        this._initMouseEvents();\r\n\t    }\r\n\t    /**\r\n\t    * This is a static function which should always be called before xViewer is instantiated.\r\n\t    * It will check all prerequisites of the viewer and will report all issues. If Prerequisities.errors contain\r\n\t    * any messages viewer won't work. If Prerequisities.warnings contain any messages it will work but some\r\n\t    * functions may be restricted or may not work or it may have poor performance.\r\n\t    * @function xViewer.check\r\n\t    * @return {Prerequisites}\r\n\t    */\r\n\t    xViewer.check = function () {\r\n\t        /**\r\n\t        * This is a structure reporting errors and warnings about prerequisites of {@link xViewer xViewer}. It is result of {@link xViewer.checkPrerequisities checkPrerequisities()} static method.\r\n\t        *\r\n\t        * @name Prerequisites\r\n\t        * @class\r\n\t        */\r\n\t        var result = {\r\n\t            /**\r\n\t            * If this array contains any warnings xViewer will work but it might be slow or may not support full functionality.\r\n\t            * @member {string[]}  Prerequisites#warnings\r\n\t            */\r\n\t            warnings: [],\r\n\t            /**\r\n\t            * If this array contains any errors xViewer won't work at all or won't work as expected.\r\n\t            * You can use messages in this array to report problems to user. However, user won't probably\r\n\t            * be able to do to much with it except trying to use different browser. IE10- are not supported for example.\r\n\t            * The latest version of IE should be all right.\r\n\t            * @member {string[]}  Prerequisites#errors\r\n\t            */\r\n\t            errors: [],\r\n\t            /**\r\n\t            * If false xViewer won't work at all or won't work as expected.\r\n\t            * You can use messages in {@link Prerequisites#errors errors array} to report problems to user. However, user won't probably\r\n\t            * be able to do to much with it except trying to use different browser. IE10- are not supported for example.\r\n\t            * The latest version of IE should be all right.\r\n\t            * @member {string[]}  Prerequisites#noErrors\r\n\t            */\r\n\t            noErrors: false,\r\n\t            /**\r\n\t            * If false xViewer will work but it might be slow or may not support full functionality. Use {@link Prerequisites#warnings warnings array} to report problems.\r\n\t            * @member {string[]}  Prerequisites#noWarnings\r\n\t            */\r\n\t            noWarnings: false\r\n\t        };\r\n\t        //check WebGL support\r\n\t        var canvas = document.createElement('canvas');\r\n\t        if (!canvas)\r\n\t            result.errors.push(\"Browser doesn't have support for HTMLCanvasElement. This is critical.\");\r\n\t        else {\r\n\t            var gl = WebGLUtils.setupWebGL(canvas);\r\n\t            if (gl == null)\r\n\t                result.errors.push(\"Browser doesn't support WebGL. This is critical.\");\r\n\t            else {\r\n\t                //check floating point extension availability\r\n\t                var fpt = (gl.getExtension('OES_texture_float') ||\r\n\t                    gl.getExtension('MOZ_OES_texture_float') ||\r\n\t                    gl.getExtension('WEBKIT_OES_texture_float'));\r\n\t                if (!fpt)\r\n\t                    result.warnings\r\n\t                        .push('Floating point texture extension is not supported. Performance of the viewer will be very bad. But it should work.');\r\n\t                //check number of supported vertex shader textures. Minimum is 5 but standard requires 0.\r\n\t                var vertTextUnits = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n\t                if (vertTextUnits < 4)\r\n\t                    result.errors.push('Browser supports only ' +\r\n\t                        vertTextUnits +\r\n\t                        ' vertex texture image units but minimal requirement for the viewer is 4.');\r\n\t            }\r\n\t        }\r\n\t        //check FileReader and Blob support\r\n\t        if (!window\r\n\t            .File ||\r\n\t            !window.FileReader ||\r\n\t            !window.Blob)\r\n\t            result.errors.push(\"Browser doesn't support 'File', 'FileReader' or 'Blob' objects.\");\r\n\t        //check for typed arrays\r\n\t        if (!window.Int32Array || !window.Float32Array)\r\n\t            result.errors\r\n\t                .push(\"Browser doesn't support TypedArrays. These are crucial for binary parsing and for comunication with GPU.\");\r\n\t        //check SVG support\r\n\t        if (!document.implementation\r\n\t            .hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1'))\r\n\t            result.warnings\r\n\t                .push(\"Browser doesn't support SVG. This is used for user interaction like interactive clipping. Functions using SVG shouldn't crash but they won't work as expected.\");\r\n\t        //set boolean members for convenience\r\n\t        if (result.errors.length == 0)\r\n\t            result.noErrors = true;\r\n\t        if (result.warnings.length == 0)\r\n\t            result.noWarnings = true;\r\n\t        return result;\r\n\t    };\r\n\t    /**\r\n\t    * Adds plugin to the viewer. Plugins can implement certain methods which get called in certain moments in time like\r\n\t    * before draw, after draw etc. This makes it possible to implement functionality tightly integrated into xViewer like navigation cube or others.\r\n\t    * @function xViewer#addPlugin\r\n\t    * @param {object} plugin - plug-in object\r\n\t    */\r\n\t    xViewer.prototype.addPlugin = function (plugin) {\r\n\t        this._plugins.push(plugin);\r\n\t        if (!plugin.init)\r\n\t            return;\r\n\t        plugin.init(this);\r\n\t    };\r\n\t    /**\r\n\t    * Removes plugin from the viewer. Plugins can implement certain methods which get called in certain moments in time like\r\n\t    * before draw, after draw etc. This makes it possible to implement functionality tightly integrated into xViewer like navigation cube or others.\r\n\t    * @function xViewer#removePlugin\r\n\t    * @param {object} plugin - plug-in object\r\n\t    */\r\n\t    xViewer.prototype.removePlugin = function (plugin) {\r\n\t        var index = this._plugins.indexOf(plugin, 0);\r\n\t        if (index < 0)\r\n\t            return;\r\n\t        this._plugins.splice(index, 1);\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to define up to 224 optional styles which you can use to change appearance of products and types if you pass the index specified in this function to {@link xViewer#setState setState()} function.\r\n\t    * @function xViewer#defineStyle\r\n\t    * @param {Number} index - Index of the style to be defined. This has to be in range 0 - 224. Index can than be passed to change appearance of the products in model\r\n\t    * @param {Number[]} colour - Array of four numbers in range 0 - 255 representing RGBA colour. If there are less or more numbers exception is thrown.\r\n\t    */\r\n\t    xViewer.prototype.defineStyle = function (index, colour) {\r\n\t        if (typeof (index) == 'undefined' || (index < 0 && index > 224))\r\n\t            throw 'Style index has to be defined as a number 0-224';\r\n\t        if (typeof (colour) == 'undefined' || !colour.length || colour.length != 4)\r\n\t            throw 'Colour must be defined as an array of 4 bytes';\r\n\t        this._stylingChanged = true;\r\n\t        //set style to style texture via model handle\r\n\t        var colData = new Uint8Array(colour);\r\n\t        this._stateStyles.set(colData, index * 4);\r\n\t        //if there are some handles already set this style in there\r\n\t        this._handles.forEach(function (handle) {\r\n\t            handle.stateStyle = this._stateStyles;\r\n\t            handle.refreshStyles();\r\n\t        }, this);\r\n\t    };\r\n\t    /**\r\n\t    * You can use this function to change state of products in the model. State has to have one of values from {@link xState xState} enumeration.\r\n\t    * Target is either enumeration from {@link xProductType xProductType} or array of product IDs. If you specify type it will effect all elements of the type.\r\n\t    *\r\n\t    * @function xViewer#setState\r\n\t    * @param {Number} state - One of {@link xState xState} enumeration values.\r\n\t    * @param {Number[] | Number} target - Target of the change. It can either be array of product IDs or product type from {@link xProductType xProductType}.\r\n\t    */\r\n\t    xViewer.prototype.setState = function (state, target) {\r\n\t        if (typeof (state) == 'undefined' || !(state >= 225 && state <= 255))\r\n\t            throw 'State has to be defined as 225 - 255. Use xState enum.';\r\n\t        this._handles.forEach(function (handle) {\r\n\t            handle.setState(state, target);\r\n\t        }, this);\r\n\t        this._stylingChanged = true;\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to get state of the products in the model. You can compare result of this function\r\n\t    * with one of values from {@link xState xState} enumeration. 0xFF is the default value.\r\n\t    *\r\n\t    * @function xViewer#getState\r\n\t    * @param {Number} id - Id of the product. You would typically get the id from {@link xViewer#event:pick pick event} or similar event.\r\n\t    */\r\n\t    xViewer.prototype.getState = function (id) {\r\n\t        var state = null;\r\n\t        this._handles.forEach(function (handle) {\r\n\t            state = handle.getState(id);\r\n\t            if (state !== null) {\r\n\t                return;\r\n\t            }\r\n\t        }, this);\r\n\t        return state;\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to reset state of all products to 'UNDEFINED' which means visible and not highlighted.\r\n\t    * You can use optional hideSpaces parameter if you also want to show spaces. They will be hidden by default.\r\n\t    *\r\n\t    * @function xViewer#resetStates\r\n\t    * @param {Bool} [hideSpaces = true] - Default state is UNDEFINED which would also show spaces. That is often not\r\n\t    * desired so it can be excluded with this parameter.\r\n\t    */\r\n\t    xViewer.prototype.resetStates = function (hideSpaces) {\r\n\t        this._handles.forEach(function (handle) {\r\n\t            handle.resetStates();\r\n\t        }, this);\r\n\t        //hide spaces\r\n\t        hideSpaces = typeof (hideSpaces) != 'undefined' ? hideSpaces : true;\r\n\t        if (hideSpaces) {\r\n\t            this._handles.forEach(function (handle) {\r\n\t                handle.setState(xbim_state_1.xState.HIDDEN, xbim_product_type_1.xProductType.IFCSPACE);\r\n\t            }, this);\r\n\t        }\r\n\t        this._stylingChanged = true;\r\n\t    };\r\n\t    /**\r\n\t     * Gets complete model state and style. Resulting object can be used to restore the state later on.\r\n\t     *\r\n\t     * @param {Number} id - Model ID which you can get from {@link xViewer#event:loaded loaded} event.\r\n\t     * @returns {Array} - Array representing model state in compact form suitable for serialization\r\n\t     */\r\n\t    xViewer.prototype.getModelState = function (id) {\r\n\t        var handle = this._handles[id];\r\n\t        if (typeof (handle) === 'undefined') {\r\n\t            throw \"Model doesn't exist\";\r\n\t        }\r\n\t        return handle.getModelState();\r\n\t    };\r\n\t    /**\r\n\t     * Restores model state from the data previously captured with {@link xViewer#getModelState getModelState()} function\r\n\t     * @param {Number} id - ID of the model\r\n\t     * @param {Array} state - State of the model as obtained from {@link xViewer#getModelState getModelState()} function\r\n\t     */\r\n\t    xViewer.prototype.restoreModelState = function (id, state) {\r\n\t        var handle = this._handles[id];\r\n\t        if (typeof (handle) === 'undefined') {\r\n\t            throw \"Model doesn't exist\";\r\n\t        }\r\n\t        handle.restoreModelState(state);\r\n\t        this._stylingChanged = true;\r\n\t    };\r\n\t    /**\r\n\t    * Use this method for restyling of the model. This doesn't change the default appearance of the products so you can think about it as an overlay. You can\r\n\t    * remove the overlay if you set the style to {@link xState#UNSTYLED xState.UNSTYLED} value. You can combine restyling and hiding in this way.\r\n\t    * Use {@link xViewer#defineStyle defineStyle()} to define styling first.\r\n\t    *\r\n\t    * @function xViewer#setStyle\r\n\t    * @param style - style defined in {@link xViewer#defineStyle defineStyle()} method\r\n\t    * @param {Number[] | Number} target - Target of the change. It can either be array of product IDs or product type from {@link xProductType xProductType}.\r\n\t    */\r\n\t    xViewer.prototype.setStyle = function (style, target) {\r\n\t        if (typeof (style) == 'undefined' || !(style >= 0 && style <= 225))\r\n\t            throw 'Style has to be defined as 0 - 225 where 225 is for default style.';\r\n\t        var c = [\r\n\t            this._stateStyles[style * 4],\r\n\t            this._stateStyles[style * 4 + 1],\r\n\t            this._stateStyles[style * 4 + 2],\r\n\t            this._stateStyles[style * 4 + 3]\r\n\t        ];\r\n\t        if (c[0] == 0 && c[1] == 0 && c[2] == 0 && c[3] == 0 && console && console.warn)\r\n\t            console\r\n\t                .warn('You have used undefined colour for restyling. Elements with this style will have transparent black colour and hence will be invisible.');\r\n\t        this._handles.forEach(function (handle) {\r\n\t            handle.setState(style, target);\r\n\t        }, this);\r\n\t        this._stylingChanged = true;\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to get overriding colour style of the products in the model. The number you get is the index of\r\n\t    * your custom colour which you have defined in {@link xViewer#defineStyle defineStyle()} function. 0xFF is the default value.\r\n\t    *\r\n\t    * @function xViewer#getStyle\r\n\t    * @param {Number} id - Id of the product. You would typically get the id from {@link xViewer#event:pick pick event} or similar event.\r\n\t    */\r\n\t    xViewer.prototype.getStyle = function (id) {\r\n\t        this._handles.forEach(function (handle) {\r\n\t            var style = handle.getStyle(id);\r\n\t            if (style !== null) {\r\n\t                return style;\r\n\t            }\r\n\t        }, this);\r\n\t        return null;\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to reset appearance of all products to their default styles.\r\n\t    *\r\n\t    * @function xViewer#resetStyles\r\n\t    */\r\n\t    xViewer.prototype.resetStyles = function () {\r\n\t        this._handles.forEach(function (handle) {\r\n\t            handle.resetStyles();\r\n\t        }, this);\r\n\t        this._stylingChanged = true;\r\n\t    };\r\n\t    /**\r\n\t    *\r\n\t    * @function xViewer#getProductType\r\n\t    * @return {Number} Product type ID. This is either null if no type is identified or one of {@link xProductType type ids}.\r\n\t    * @param {Number} prodID - Product ID. You can get this value either from semantic structure of the model or by listening to {@link xViewer#event:pick pick} event.\r\n\t    */\r\n\t    xViewer.prototype.getProductType = function (prodId) {\r\n\t        var pType = null;\r\n\t        this._handles.forEach(function (handle) {\r\n\t            var map = handle.getProductMap(prodId);\r\n\t            if (map)\r\n\t                pType = map.type;\r\n\t        }, this);\r\n\t        return pType;\r\n\t    };\r\n\t    /**\r\n\t    * Use this method to set position of camera. Use it after {@link xViewer#setCameraTarget setCameraTarget()} to get desired result.\r\n\t    *\r\n\t    * @function xViewer#setCameraPosition\r\n\t    * @param {Number[]} coordinates - 3D coordinates of the camera in WCS\r\n\t    */\r\n\t    xViewer.prototype.setCameraPosition = function (coordinates) {\r\n\t        if (typeof (coordinates) == 'undefined')\r\n\t            throw 'Parameter coordinates must be defined';\r\n\t        glMatrix.mat4.lookAt(this._mvMatrix, coordinates, this._origin, [0, 0, 1]);\r\n\t    };\r\n\t    /**\r\n\t    * This method sets navigation origin to the centroid of specified product's bounding box or to the centre of model if no product ID is specified.\r\n\t    * This method doesn't affect the view itself but it has an impact on navigation. Navigation origin is used as a centre for orbiting and it is used\r\n\t    * if you call functions like {@link xViewer.show show()} or {@link xViewer#zoomTo zoomTo()}.\r\n\t    * @function xViewer#setCameraTarget\r\n\t    * @param {Number} prodId [optional] Product ID. You can get ID either from semantic structure of the model or from {@link xViewer#event:pick pick event}.\r\n\t    * @return {Bool} True if the target exists and is set, False otherwise\r\n\t    */\r\n\t    xViewer.prototype.setCameraTarget = function (prodId) {\r\n\t        var viewer = this;\r\n\t        //helper function for setting of the distance based on camera field of view and size of the product's bounding box\r\n\t        var setDistance = function (bBox) {\r\n\t            var size = Math.max(bBox[3], bBox[4], bBox[5]);\r\n\t            var ratio = Math.max(viewer._width, viewer._height) / Math.min(viewer._width, viewer._height);\r\n\t            viewer._distance = size / Math.tan(viewer.perspectiveCamera.fov * Math.PI / 180.0) * ratio * 1.0;\r\n\t        };\r\n\t        //set navigation origin and default distance to the product BBox\r\n\t        if (typeof (prodId) != 'undefined' && prodId != null) {\r\n\t            //get product BBox and set it's centre as a navigation origin\r\n\t            var bbox = null;\r\n\t            this._handles.every(function (handle) {\r\n\t                var map = handle.getProductMap(prodId);\r\n\t                if (map) {\r\n\t                    bbox = map.bBox;\r\n\t                    return false;\r\n\t                }\r\n\t                return true;\r\n\t            });\r\n\t            if (bbox) {\r\n\t                this._origin = [bbox[0] + bbox[3] / 2.0, bbox[1] + bbox[4] / 2.0, bbox[2] + bbox[5] / 2.0];\r\n\t                setDistance(bbox);\r\n\t                return true;\r\n\t            }\r\n\t            else\r\n\t                return false;\r\n\t        }\r\n\t        else {\r\n\t            //get region extent and set it's centre as a navigation origin\r\n\t            var handle = this._handles[0];\r\n\t            if (handle) {\r\n\t                var region = handle.region;\r\n\t                if (region) {\r\n\t                    this._origin = [region.centre[0], region.centre[1], region.centre[2]];\r\n\t                    setDistance(region.bbox);\r\n\t                }\r\n\t            }\r\n\t            return true;\r\n\t        }\r\n\t    };\r\n\t    /**\r\n\t    * This method can be used for batch setting of viewer members. It doesn't check validity of the input.\r\n\t    * @function xViewer#set\r\n\t    * @param {Object} settings - Object containing key - value pairs\r\n\t    */\r\n\t    xViewer.prototype.set = function (settings) {\r\n\t        for (var key in settings) {\r\n\t            this[key] = settings[key];\r\n\t        }\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This method is used to load model data into viewer. Model has to be either URL to wexBIM file or Blob or File representing wexBIM file binary data. Any other type of argument will throw an exception.\r\n\t    * Region extend is determined based on the region of the model\r\n\t    * Default view if 'front'. If you want to define different view you have to set it up in handler of {@link xViewer#event:loaded loaded} event. <br>\r\n\t    * You can load more than one model if they occupy the same space, use the same scale and have unique product IDs. Duplicated IDs won't affect\r\n\t    * visualization itself but would cause unexpected user interaction (picking, zooming, ...)\r\n\t    * @function xViewer#load\r\n\t    * @param {String | Blob | File} model - Model has to be either URL to wexBIM file or Blob or File representing wexBIM file binary data.\r\n\t    * @param {Any} tag [optional] - Tag to be used to identify the model in {@link xViewer#event:loaded loaded} event.\r\n\t    * @fires xViewer#loaded\r\n\t    */\r\n\t    xViewer.prototype.load = function (model, tag) {\r\n\t        if (typeof (model) == 'undefined')\r\n\t            throw 'You have to specify model to load.';\r\n\t        if (typeof (model) != 'string' && !(model instanceof Blob))\r\n\t            throw 'Model has to be specified either as a URL to wexBIM file or Blob object representing the wexBIM file.';\r\n\t        var viewer = this;\r\n\t        var geometry = new xbim_model_geometry_1.xModelGeometry();\r\n\t        geometry.onloaded = function () {\r\n\t            viewer._addHandle(geometry, tag);\r\n\t        };\r\n\t        geometry.onerror = function (msg) {\r\n\t            viewer._error(msg);\r\n\t        };\r\n\t        geometry.load(model);\r\n\t    };\r\n\t    //this is a private function used to add loaded geometry as a new handle and to set up camera and \r\n\t    //default view if this is the first geometry loaded\r\n\t    xViewer.prototype._addHandle = function (geometry, tag) {\r\n\t        var viewer = this;\r\n\t        var gl = this._gl;\r\n\t        var handle = new xbim_model_handle_1.xModelHandle(viewer._gl, geometry, viewer._fpt != null);\r\n\t        viewer._handles.push(handle);\r\n\t        handle.stateStyle = viewer._stateStyles;\r\n\t        handle.feedGPU();\r\n\t        //get one meter size from model and set it to shader\r\n\t        var meter = handle._model.meter;\r\n\t        gl.uniform1f(viewer._meterUniformPointer, meter);\r\n\t        //only set camera parameters and the view if this is the first model\r\n\t        if (viewer._handles.length === 1) {\r\n\t            //set centre and default distance based on the most populated region in the model\r\n\t            viewer.setCameraTarget();\r\n\t            //set perspective camera near and far based on 1 meter dimension and size of the model\r\n\t            var region = handle.region;\r\n\t            var maxSize = Math.max(region.bbox[3], region.bbox[4], region.bbox[5]);\r\n\t            viewer.perspectiveCamera.far = maxSize * 50;\r\n\t            viewer.perspectiveCamera.near = meter / 10.0;\r\n\t            //set orthogonalCamera boundaries so that it makes a sense\r\n\t            viewer.orthogonalCamera.far = viewer.perspectiveCamera.far;\r\n\t            viewer.orthogonalCamera.near = viewer.perspectiveCamera.near;\r\n\t            var ratio = 1.8;\r\n\t            viewer.orthogonalCamera.top = maxSize / ratio;\r\n\t            viewer.orthogonalCamera.bottom = maxSize / ratio * -1;\r\n\t            viewer.orthogonalCamera.left = maxSize / ratio * -1 * viewer._width / viewer._height;\r\n\t            viewer.orthogonalCamera.right = maxSize / ratio * viewer._width / viewer._height;\r\n\t            //set default view\r\n\t            viewer.setCameraTarget();\r\n\t            var dist = Math.sqrt(viewer._distance * viewer._distance / 3.0);\r\n\t            viewer.setCameraPosition([\r\n\t                region.centre[0] + dist * -1.0, region.centre[1] + dist * -1.0, region.centre[2] + dist\r\n\t            ]);\r\n\t        }\r\n\t        /**\r\n\t         * Occurs when geometry model is loaded into the viewer. This event returns object containing ID of the model.\r\n\t         * This ID can later be used to unload or temporarily stop the model.\r\n\t         *\r\n\t         * @event xViewer#loaded\r\n\t         * @type {object}\r\n\t         * @param {Number} id - model ID\r\n\t         * @param {Any} tag - tag which was passed to 'xViewer.load()' function\r\n\t         *\r\n\t        */\r\n\t        viewer._fire('loaded', { id: handle.id, tag: tag });\r\n\t        viewer._geometryLoaded = true;\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t     * Unloads model from the GPU. This action is not reversible.\r\n\t     *\r\n\t     * @param {Number} modelId - ID of the model which you can get from {@link xViewer#event:loaded loaded} event.\r\n\t     */\r\n\t    xViewer.prototype.unload = function (modelId) {\r\n\t        var handle = this._handles.filter(function (h) { return h.id === modelId; }).pop();\r\n\t        if (typeof (handle) === 'undefined')\r\n\t            throw 'Model with id: ' + modelId + \" doesn't exist or was unloaded already.\";\r\n\t        //stop for start so it doesn't interfere with the rendering loop\r\n\t        handle.stopped = true;\r\n\t        //remove from the array\r\n\t        var index = this._handles.indexOf(handle);\r\n\t        this._handles.splice(index, 1);\r\n\t        this._numberOfActiveModels = this._handles.length;\r\n\t        //unload and delete\r\n\t        handle.unload();\r\n\t        //delete handle; // TODO\r\n\t    };\r\n\t    //this function should be only called once during initialization\r\n\t    //or when shader set-up changes\r\n\t    xViewer.prototype._initShaders = function () {\r\n\t        var gl = this._gl;\r\n\t        var viewer = this;\r\n\t        var compile = function (shader, code) {\r\n\t            gl.shaderSource(shader, code);\r\n\t            gl.compileShader(shader);\r\n\t            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n\t                viewer._error(gl.getShaderInfoLog(shader));\r\n\t                return null;\r\n\t            }\r\n\t        };\r\n\t        //fragment shader\r\n\t        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n\t        compile(fragmentShader, xbim_shaders_1.xShaders.fragment_shader);\r\n\t        //vertex shader (the more complicated one)\r\n\t        var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n\t        if (this._fpt != null)\r\n\t            compile(vertexShader, xbim_shaders_1.xShaders.vertex_shader);\r\n\t        else\r\n\t            compile(vertexShader, xbim_shaders_1.xShaders.vertex_shader_noFPT);\r\n\t        //link program\r\n\t        this._shaderProgram = gl.createProgram();\r\n\t        gl.attachShader(this._shaderProgram, vertexShader);\r\n\t        gl.attachShader(this._shaderProgram, fragmentShader);\r\n\t        gl.linkProgram(this._shaderProgram);\r\n\t        if (!gl.getProgramParameter(this._shaderProgram, gl.LINK_STATUS)) {\r\n\t            this._error('Could not initialise shaders ');\r\n\t        }\r\n\t        gl.useProgram(this._shaderProgram);\r\n\t    };\r\n\t    xViewer.prototype._initAttributesAndUniforms = function () {\r\n\t        var gl = this._gl;\r\n\t        //create pointers to uniform variables for transformations\r\n\t        this._pMatrixUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uPMatrix');\r\n\t        this._mvMatrixUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uMVMatrix');\r\n\t        this._lightAUniformPointer = gl.getUniformLocation(this._shaderProgram, 'ulightA');\r\n\t        this._lightBUniformPointer = gl.getUniformLocation(this._shaderProgram, 'ulightB');\r\n\t        this._colorCodingUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uColorCoding');\r\n\t        this._clippingPlaneUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uClippingPlane');\r\n\t        this._meterUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uMeter');\r\n\t        this._renderingModeUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uRenderingMode');\r\n\t        this._highlightingColourUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uHighlightColour');\r\n\t        this._pointers = {\r\n\t            normalAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aNormal'),\r\n\t            indexlAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aVertexIndex'),\r\n\t            productAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aProduct'),\r\n\t            stateAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aState'),\r\n\t            styleAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aStyleIndex'),\r\n\t            transformationAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aTransformationIndex'),\r\n\t            vertexSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uVertexSampler'),\r\n\t            matrixSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uMatrixSampler'),\r\n\t            styleSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uStyleSampler'),\r\n\t            stateStyleSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uStateStyleSampler'),\r\n\t            vertexTextureSizeUniform: gl.getUniformLocation(this._shaderProgram, 'uVertexTextureSize'),\r\n\t            matrixTextureSizeUniform: gl.getUniformLocation(this._shaderProgram, 'uMatrixTextureSize'),\r\n\t            styleTextureSizeUniform: gl.getUniformLocation(this._shaderProgram, 'uStyleTextureSize')\r\n\t        };\r\n\t        //enable vertex attributes arrays\r\n\t        gl.enableVertexAttribArray(this._pointers.normalAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._pointers.indexlAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._pointers.productAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._pointers.stateAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._pointers.styleAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._pointers.transformationAttrPointer);\r\n\t    };\r\n\t    xViewer.prototype._initMouseEvents = function () {\r\n\t        var viewer = this;\r\n\t        var mouseDown = false;\r\n\t        var lastMouseX = null;\r\n\t        var lastMouseY = null;\r\n\t        var startX = null;\r\n\t        var startY = null;\r\n\t        var button = 'L';\r\n\t        var id = -1;\r\n\t        //set initial conditions so that different gestures can be identified\r\n\t        function handleMouseDown(event) {\r\n\t            mouseDown = true;\r\n\t            lastMouseX = event.clientX;\r\n\t            lastMouseY = event.clientY;\r\n\t            startX = event.clientX;\r\n\t            startY = event.clientY;\r\n\t            //get coordinates within canvas (with the right orientation)\r\n\t            var r = viewer._canvas.getBoundingClientRect();\r\n\t            var viewX = startX - r.left;\r\n\t            var viewY = viewer._height - (startY - r.top);\r\n\t            //this is for picking\r\n\t            id = viewer._getID(viewX, viewY);\r\n\t            /**\r\n\t            * Occurs when mousedown event happens on underlying canvas.\r\n\t            *\r\n\t            * @event xViewer#mouseDown\r\n\t            * @type {object}\r\n\t            * @param {Number} id - product ID of the element or null if there wasn't any product under mouse\r\n\t            */\r\n\t            viewer._fire('mouseDown', { id: id });\r\n\t            //keep information about the mouse button\r\n\t            switch (event.button) {\r\n\t                case 0:\r\n\t                    button = 'left';\r\n\t                    break;\r\n\t                case 1:\r\n\t                    button = 'middle';\r\n\t                    break;\r\n\t                case 2:\r\n\t                    button = 'right';\r\n\t                    break;\r\n\t                default:\r\n\t                    button = 'left';\r\n\t                    break;\r\n\t            }\r\n\t            viewer._disableTextSelection();\r\n\t        }\r\n\t        function handleMouseUp(event) {\r\n\t            mouseDown = false;\r\n\t            var endX = event.clientX;\r\n\t            var endY = event.clientY;\r\n\t            var deltaX = Math.abs(endX - startX);\r\n\t            var deltaY = Math.abs(endY - startY);\r\n\t            //if it was a longer movement do not perform picking\r\n\t            if (deltaX < 3 && deltaY < 3 && button == 'left') {\r\n\t                var handled = false;\r\n\t                viewer._plugins.forEach(function (plugin) {\r\n\t                    if (!plugin.onBeforePick) {\r\n\t                        return;\r\n\t                    }\r\n\t                    handled = handled || plugin.onBeforePick(id);\r\n\t                }, this);\r\n\t                /**\r\n\t                * Occurs when user click on model.\r\n\t                *\r\n\t                * @event xViewer#pick\r\n\t                * @type {object}\r\n\t                * @param {Number} id - product ID of the element or null if there wasn't any product under mouse\r\n\t                */\r\n\t                if (!handled)\r\n\t                    viewer._fire('pick', { id: id });\r\n\t            }\r\n\t            viewer._enableTextSelection();\r\n\t        }\r\n\t        function handleMouseMove(event) {\r\n\t            if (!mouseDown) {\r\n\t                return;\r\n\t            }\r\n\t            if (viewer.navigationMode == 'none') {\r\n\t                return;\r\n\t            }\r\n\t            var newX = event.clientX;\r\n\t            var newY = event.clientY;\r\n\t            var deltaX = newX - lastMouseX;\r\n\t            var deltaY = newY - lastMouseY;\r\n\t            lastMouseX = newX;\r\n\t            lastMouseY = newY;\r\n\t            if (button == 'left') {\r\n\t                switch (viewer.navigationMode) {\r\n\t                    case 'free-orbit':\r\n\t                        navigate('free-orbit', deltaX, deltaY);\r\n\t                        break;\r\n\t                    case 'fixed-orbit':\r\n\t                    case 'orbit':\r\n\t                        navigate('orbit', deltaX, deltaY);\r\n\t                        break;\r\n\t                    case 'pan':\r\n\t                        navigate('pan', deltaX, deltaY);\r\n\t                        break;\r\n\t                    case 'zoom':\r\n\t                        navigate('zoom', deltaX, deltaY);\r\n\t                        break;\r\n\t                    default:\r\n\t                        break;\r\n\t                }\r\n\t            }\r\n\t            if (button == 'middle') {\r\n\t                navigate('pan', deltaX, deltaY);\r\n\t            }\r\n\t        }\r\n\t        function handleMouseScroll(event) {\r\n\t            if (viewer.navigationMode == 'none') {\r\n\t                return;\r\n\t            }\r\n\t            if (event.stopPropagation) {\r\n\t                event.stopPropagation();\r\n\t            }\r\n\t            if (event.preventDefault) {\r\n\t                event.preventDefault();\r\n\t            }\r\n\t            function sign(x) {\r\n\t                x = +x; // convert to a number\r\n\t                if (x === 0 || isNaN(x))\r\n\t                    return x;\r\n\t                return x > 0 ? 1 : -1;\r\n\t            }\r\n\t            //deltaX and deltaY have very different values in different web browsers so fixed value is used for constant functionality.\r\n\t            navigate('zoom', sign(event.deltaX) * -1.0, sign(event.deltaY) * -1.0);\r\n\t        }\r\n\t        function navigate(type, deltaX, deltaY) {\r\n\t            if (!viewer._handles || !viewer._handles[0])\r\n\t                return;\r\n\t            //translation in WCS is position from [0, 0, 0]\r\n\t            var origin = viewer._origin;\r\n\t            var camera = viewer.getCameraPosition();\r\n\t            //get origin coordinates in view space\r\n\t            var mvOrigin = glMatrix.vec3.transformMat4(glMatrix.vec3.create(), origin, viewer._mvMatrix);\r\n\t            //movement factor needs to be dependant on the distance but one meter is a minimum so that movement wouldn't stop when camera is in 0 distance from navigation origin\r\n\t            var distanceVec = glMatrix.vec3.subtract(glMatrix.vec3.create(), origin, camera);\r\n\t            var distance = Math.max(glMatrix.vec3.length(distanceVec), viewer._handles[0]._model.meter);\r\n\t            //move to the navigation origin in view space\r\n\t            var transform = glMatrix.mat4.translate(glMatrix.mat4.create(), glMatrix.mat4.create(), mvOrigin);\r\n\t            //function for conversion from degrees to radians\r\n\t            function degToRad(deg) {\r\n\t                return deg * Math.PI / 180.0;\r\n\t            }\r\n\t            switch (type) {\r\n\t                case 'free-orbit':\r\n\t                    transform = glMatrix.mat4.rotate(glMatrix.mat4.create(), transform, degToRad(deltaY / 4), [1, 0, 0]);\r\n\t                    transform = glMatrix.mat4.rotate(glMatrix.mat4.create(), transform, degToRad(deltaX / 4), [0, 1, 0]);\r\n\t                    break;\r\n\t                case 'fixed-orbit':\r\n\t                case 'orbit':\r\n\t                    glMatrix.mat4.rotate(transform, transform, degToRad(deltaY / 4), [1, 0, 0]);\r\n\t                    //z rotation around model z axis\r\n\t                    var mvZ = glMatrix.vec3.transformMat3(glMatrix.vec3.create(), [0, 0, 1], glMatrix.mat3.fromMat4(glMatrix.mat3.create(), viewer._mvMatrix));\r\n\t                    mvZ = glMatrix.vec3.normalize(glMatrix.vec3.create(), mvZ);\r\n\t                    transform = glMatrix.mat4.rotate(glMatrix.mat4.create(), transform, degToRad(deltaX / 4), mvZ);\r\n\t                    break;\r\n\t                case 'pan':\r\n\t                    glMatrix.mat4.translate(transform, transform, [deltaX * distance / 150, 0, 0]);\r\n\t                    glMatrix.mat4.translate(transform, transform, [0, (-1.0 * deltaY) * distance / 150, 0]);\r\n\t                    break;\r\n\t                case 'zoom':\r\n\t                    glMatrix.mat4.translate(transform, transform, [0, 0, deltaX * distance / 20]);\r\n\t                    glMatrix.mat4.translate(transform, transform, [0, 0, deltaY * distance / 20]);\r\n\t                    break;\r\n\t                default:\r\n\t                    break;\r\n\t            }\r\n\t            //reverse the translation in view space and leave only navigation changes\r\n\t            var translation = glMatrix.vec3.negate(glMatrix.vec3.create(), mvOrigin);\r\n\t            transform = glMatrix.mat4.translate(glMatrix.mat4.create(), transform, translation);\r\n\t            //apply transformation in right order\r\n\t            viewer._mvMatrix = glMatrix.mat4.multiply(glMatrix.mat4.create(), transform, viewer._mvMatrix);\r\n\t        }\r\n\t        //watch resizing of canvas every 500ms\r\n\t        var elementHeight = viewer.height;\r\n\t        var elementWidth = viewer.width;\r\n\t        setInterval(function () {\r\n\t            if (viewer._canvas.offsetHeight !== elementHeight || viewer._canvas.offsetWidth !== elementWidth) {\r\n\t                elementHeight = viewer._height = viewer._canvas.height = viewer._canvas.offsetHeight;\r\n\t                elementWidth = viewer._width = viewer._canvas.width = viewer._canvas.offsetWidth;\r\n\t            }\r\n\t        }, 500);\r\n\t        //attach callbacks\r\n\t        this._canvas.addEventListener('mousedown', handleMouseDown, true);\r\n\t        this._canvas.addEventListener('wheel', handleMouseScroll, true);\r\n\t        window.addEventListener('mouseup', handleMouseUp, true);\r\n\t        window.addEventListener('mousemove', handleMouseMove, true);\r\n\t        this._canvas.addEventListener('mousemove', function () {\r\n\t            viewer._userAction = true;\r\n\t        }, true);\r\n\t        /**\r\n\t        * Occurs when user double clicks on model.\r\n\t        *\r\n\t        * @event xViewer#dblclick\r\n\t        * @type {object}\r\n\t        * @param {Number} id - product ID of the element or null if there wasn't any product under mouse\r\n\t        */\r\n\t        this._canvas.addEventListener('dblclick', function () { viewer._fire('dblclick', { id: id }); }, true);\r\n\t    };\r\n\t    /**\r\n\t    * This is a static draw method. You can use it if you just want to render model once with no navigation and interaction.\r\n\t    * If you want interactive model call {@link xViewer#start start()} method. {@link xViewer#frame Frame event} is fired when draw call is finished.\r\n\t    * @function xViewer#draw\r\n\t    * @fires xViewer#frame\r\n\t    */\r\n\t    xViewer.prototype.draw = function () {\r\n\t        if (!this._geometryLoaded || this._handles.length == 0 || !(this._stylingChanged || this._isChanged())) {\r\n\t            if (!this._userAction)\r\n\t                return;\r\n\t        }\r\n\t        this._userAction = false;\r\n\t        //call all before-draw plugins\r\n\t        this._plugins.forEach(function (plugin) {\r\n\t            if (!plugin.onBeforeDraw) {\r\n\t                return;\r\n\t            }\r\n\t            plugin.onBeforeDraw();\r\n\t        }, this);\r\n\t        //styles are up to date when new frame is drawn\r\n\t        this._stylingChanged = false;\r\n\t        var gl = this._gl;\r\n\t        var width = this._width;\r\n\t        var height = this._height;\r\n\t        gl.useProgram(this._shaderProgram);\r\n\t        gl.viewport(0, 0, width, height);\r\n\t        gl.clearColor(this.background[0] / 255, this.background[1] / 255, this.background[2] / 255, this.background[3] / 255);\r\n\t        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\t        //set up camera\r\n\t        switch (this.camera) {\r\n\t            case 'perspective':\r\n\t                glMatrix.mat4.perspective(this._pMatrix, this.perspectiveCamera.fov * Math.PI / 180.0, this._width / this._height, this.perspectiveCamera.near, this.perspectiveCamera.far);\r\n\t                break;\r\n\t            case 'orthogonal':\r\n\t                glMatrix.mat4.ortho(this._pMatrix, this.orthogonalCamera.left, this.orthogonalCamera.right, this.orthogonalCamera.bottom, this.orthogonalCamera.top, this.orthogonalCamera.near, this.orthogonalCamera.far);\r\n\t                break;\r\n\t            default:\r\n\t                glMatrix.mat4.perspective(this._pMatrix, this.perspectiveCamera.fov * Math.PI / 180.0, this._width / this._height, this.perspectiveCamera.near, this.perspectiveCamera.far);\r\n\t                break;\r\n\t        }\r\n\t        //set uniforms (these may quickly change between calls to draw)\r\n\t        gl.uniformMatrix4fv(this._pMatrixUniformPointer, false, this._pMatrix);\r\n\t        gl.uniformMatrix4fv(this._mvMatrixUniformPointer, false, this._mvMatrix);\r\n\t        gl.uniform4fv(this._lightAUniformPointer, new Float32Array(this.lightA));\r\n\t        gl.uniform4fv(this._lightBUniformPointer, new Float32Array(this.lightB));\r\n\t        gl.uniform4fv(this._clippingPlaneUniformPointer, new Float32Array(this.clippingPlane));\r\n\t        //use normal colour representation (1 would cause shader to use colour coding of IDs)\r\n\t        gl.uniform1i(this._colorCodingUniformPointer, 0);\r\n\t        //update highlighting colour\r\n\t        gl.uniform4fv(this._highlightingColourUniformPointer, new Float32Array([\r\n\t            this.highlightingColour[0] / 255.0,\r\n\t            this.highlightingColour[1] / 255.0,\r\n\t            this.highlightingColour[2] / 255.0,\r\n\t            this.highlightingColour[3] / 255.0\r\n\t        ]));\r\n\t        //check for x-ray mode\r\n\t        if (this.renderingMode == 'x-ray') {\r\n\t            //two passes - first one for non-transparent objects, second one for all the others\r\n\t            gl.uniform1i(this._renderingModeUniformPointer, 2);\r\n\t            gl.disable(gl.CULL_FACE);\r\n\t            this._handles.forEach(function (handle) {\r\n\t                if (!handle.stopped) {\r\n\t                    handle.setActive(this._pointers);\r\n\t                    handle.draw('solid');\r\n\t                }\r\n\t            }, this);\r\n\t            //transparent objects should have only one side so that they are even more transparent.\r\n\t            gl.uniform1i(this._renderingModeUniformPointer, 2);\r\n\t            gl.enable(gl.CULL_FACE);\r\n\t            this._handles.forEach(function (handle) {\r\n\t                if (!handle.stopped) {\r\n\t                    handle.setActive(this._pointers);\r\n\t                    handle.draw('transparent');\r\n\t                }\r\n\t            }, this);\r\n\t            gl.uniform1i(this._renderingModeUniformPointer, 0);\r\n\t        }\r\n\t        else {\r\n\t            gl.uniform1i(this._renderingModeUniformPointer, 0);\r\n\t            gl.disable(gl.CULL_FACE);\r\n\t            //two runs, first for solids from all models, second for transparent objects from all models\r\n\t            //this makes sure that transparent objects are always rendered at the end.\r\n\t            this._handles.forEach(function (handle) {\r\n\t                if (!handle.stopped) {\r\n\t                    handle.setActive(this._pointers);\r\n\t                    handle.draw('solid');\r\n\t                }\r\n\t            }, this);\r\n\t            this._handles.forEach(function (handle) {\r\n\t                if (!handle.stopped) {\r\n\t                    handle.setActive(this._pointers);\r\n\t                    handle.draw('transparent');\r\n\t                }\r\n\t            }, this);\r\n\t        }\r\n\t        //call all after-draw plugins\r\n\t        this._plugins.forEach(function (plugin) {\r\n\t            if (!plugin.onAfterDraw) {\r\n\t                return;\r\n\t            }\r\n\t            plugin.onAfterDraw();\r\n\t        }, this);\r\n\t        /**\r\n\t         * Occurs after every frame in animation. Don't do anything heavy weighted in here as it will happen about 60 times in a second all the time.\r\n\t         *\r\n\t         * @event xViewer#frame\r\n\t         * @type {object}\r\n\t         */\r\n\t        this._fire('frame', {});\r\n\t    };\r\n\t    ;\r\n\t    xViewer.prototype._isChanged = function () {\r\n\t        var theSame = true;\r\n\t        this._visualStateAttributes.forEach(function (visualStateAttribute) {\r\n\t            var state = JSON.stringify(this[visualStateAttribute]);\r\n\t            var lastState = this._lastStates[visualStateAttribute];\r\n\t            this._lastStates[visualStateAttribute] = state;\r\n\t            theSame = theSame && (state === lastState);\r\n\t        }, this);\r\n\t        return !theSame;\r\n\t    };\r\n\t    /**\r\n\t    * Use this method get actual camera position.\r\n\t    * @function xViewer#getCameraPosition\r\n\t    */\r\n\t    xViewer.prototype.getCameraPosition = function () {\r\n\t        var transform = glMatrix.mat4.create();\r\n\t        glMatrix.mat4.multiply(transform, this._pMatrix, this._mvMatrix);\r\n\t        var inv = glMatrix.mat4.create();\r\n\t        glMatrix.mat4.invert(inv, transform);\r\n\t        var eye = glMatrix.vec3.create();\r\n\t        glMatrix.vec3.transformMat4(eye, glMatrix.vec3.create(), inv);\r\n\t        return eye;\r\n\t    };\r\n\t    /**\r\n\t    * Use this method to zoom to specified element. If you don't specify a product ID it will zoom to full extent.\r\n\t    * @function xViewer#zoomTo\r\n\t    * @param {Number} [id] Product ID\r\n\t    * @return {Bool} True if target exists and zoom was successful, False otherwise\r\n\t    */\r\n\t    xViewer.prototype.zoomTo = function (id) {\r\n\t        var found = this.setCameraTarget(id);\r\n\t        if (!found)\r\n\t            return false;\r\n\t        var eye = this.getCameraPosition();\r\n\t        var dir = glMatrix.vec3.create();\r\n\t        glMatrix.vec3.subtract(dir, eye, this._origin);\r\n\t        dir = glMatrix.vec3.normalize(glMatrix.vec3.create(), dir);\r\n\t        var translation = glMatrix.vec3.create();\r\n\t        glMatrix.vec3.scale(translation, dir, this._distance);\r\n\t        glMatrix.vec3.add(eye, translation, this._origin);\r\n\t        glMatrix.mat4.lookAt(this._mvMatrix, eye, this._origin, [0, 0, 1]);\r\n\t        return true;\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to show default views.\r\n\t    *\r\n\t    * @function xViewer#show\r\n\t    * @param {String} type - Type of view. Allowed values are <strong>'top', 'bottom', 'front', 'back', 'left', 'right'</strong>.\r\n\t    * Directions of this views are defined by the coordinate system. Target and distance are defined by {@link xViewer#setCameraTarget setCameraTarget()} method to certain product ID\r\n\t    * or to the model extent if {@link xViewer#setCameraTarget setCameraTarget()} is called with no arguments.\r\n\t    */\r\n\t    xViewer.prototype.show = function (type) {\r\n\t        var origin = this._origin;\r\n\t        var distance = this._distance;\r\n\t        var camera = [0, 0, 0];\r\n\t        var heading = [0, 0, 1];\r\n\t        switch (type) {\r\n\t            //top and bottom are different because these are singular points for look-at function if heading is [0,0,1]\r\n\t            case 'top':\r\n\t                //only move to origin and up (negative values because we move camera against model)\r\n\t                glMatrix.mat4.translate(this._mvMatrix, glMatrix.mat4.create(), [origin[0] * -1.0, origin[1] * -1.0, (distance + origin[2]) * -1.0]);\r\n\t                return;\r\n\t            case 'bottom':\r\n\t                //only move to origin and up and rotate 180 degrees around Y axis\r\n\t                var toOrigin = glMatrix.mat4.translate(glMatrix.mat4.create(), glMatrix.mat4.create(), [origin[0] * -1.0, origin[1] * +1.0, (origin[2] + distance) * -1]);\r\n\t                var rotationY = glMatrix.mat4.rotateY(glMatrix.mat4.create(), toOrigin, Math.PI);\r\n\t                var rotationZ = glMatrix.mat4.rotateZ(glMatrix.mat4.create(), rotationY, Math.PI);\r\n\t                this\r\n\t                    ._mvMatrix = rotationZ;\r\n\t                // glMatrix.mat4.translate(glMatrix.mat4.create(), rotationZ, [0, 0, -1.0 * distance]);\r\n\t                return;\r\n\t            case 'front':\r\n\t                camera = [origin[0], origin[1] - distance, origin[2]];\r\n\t                break;\r\n\t            case 'back':\r\n\t                camera = [origin[0], origin[1] + distance, origin[2]];\r\n\t                break;\r\n\t            case 'left':\r\n\t                camera = [origin[0] - distance, origin[1], origin[2]];\r\n\t                break;\r\n\t            case 'right':\r\n\t                camera = [origin[0] + distance, origin[1], origin[2]];\r\n\t                break;\r\n\t            default:\r\n\t                break;\r\n\t        }\r\n\t        //use look-at function to set up camera and target\r\n\t        glMatrix.mat4.lookAt(this._mvMatrix, camera, origin, heading);\r\n\t    };\r\n\t    xViewer.prototype._error = function (msg) {\r\n\t        /**\r\n\t        * Occurs when viewer encounters error. You should listen to this because it might also report asynchronous errors which you would miss otherwise.\r\n\t        *\r\n\t        * @event xViewer#error\r\n\t        * @type {object}\r\n\t        * @param {string} message - Error message\r\n\t        */\r\n\t        this._fire('error', { message: msg });\r\n\t    };\r\n\t    //this renders the colour coded model into the memory buffer\r\n\t    //not to the canvas and use it to identify ID of the object from that\r\n\t    xViewer.prototype._getID = function (x, y) {\r\n\t        //call all before-drawId plugins\r\n\t        this._plugins.forEach(function (plugin) {\r\n\t            if (!plugin.onBeforeDrawId) {\r\n\t                return;\r\n\t            }\r\n\t            plugin.onBeforeDrawId();\r\n\t        }, this);\r\n\t        //it is not necessary to render the image in full resolution so this factor is used for less resolution. \r\n\t        var factor = 2;\r\n\t        var gl = this._gl;\r\n\t        var width = this._width / factor;\r\n\t        var height = this._height / factor;\r\n\t        x = x / factor;\r\n\t        y = y / factor;\r\n\t        //create framebuffer\r\n\t        var frameBuffer = gl.createFramebuffer();\r\n\t        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\r\n\t        // create renderbuffer\r\n\t        var renderBuffer = gl.createRenderbuffer();\r\n\t        gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\r\n\t        // allocate renderbuffer\r\n\t        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\r\n\t        var texture = gl.createTexture();\r\n\t        gl.activeTexture(gl.TEXTURE0);\r\n\t        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n\t        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n\t        // Set the parameters so we can render any image size.        \r\n\t        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\t        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n\t        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n\t        // attach renderbuffer and texture\r\n\t        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderBuffer);\r\n\t        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\r\n\t        if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) != gl.FRAMEBUFFER_COMPLETE) {\r\n\t            this._error('this combination of attachments does not work');\r\n\t            return null;\r\n\t        }\r\n\t        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\r\n\t        gl.viewport(0, 0, width, height);\r\n\t        gl.enable(gl.DEPTH_TEST); //we don't use any kind of blending or transparency\r\n\t        gl.disable(gl.BLEND);\r\n\t        gl.clearColor(0, 0, 0, 0); //zero colour for no-values\r\n\t        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\t        //set uniform for colour coding\r\n\t        gl.uniform1i(this._colorCodingUniformPointer, 1);\r\n\t        //render colour coded image using latest buffered data\r\n\t        this._handles.forEach(function (handle) {\r\n\t            if (!handle.stopped) {\r\n\t                handle.setActive(this._pointers);\r\n\t                handle.draw();\r\n\t            }\r\n\t        }, this);\r\n\t        //call all after-drawId plugins\r\n\t        this._plugins.forEach(function (plugin) {\r\n\t            if (!plugin.onAfterDrawId) {\r\n\t                return;\r\n\t            }\r\n\t            plugin.onAfterDrawId();\r\n\t        }, this);\r\n\t        //get colour in of the pixel\r\n\t        var result = new Uint8Array(4);\r\n\t        gl.readPixels(x, y, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, result);\r\n\t        //reset framebuffer to render into canvas again\r\n\t        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n\t        //free GPU memory\r\n\t        gl.deleteTexture(texture);\r\n\t        gl.deleteRenderbuffer(renderBuffer);\r\n\t        gl.deleteFramebuffer(frameBuffer);\r\n\t        //set back blending\r\n\t        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n\t        gl.enable(gl.BLEND);\r\n\t        //decode ID (bit shifting by multiplication)\r\n\t        var hasValue = result[3] != 0; //0 transparency is only for no-values\r\n\t        if (hasValue) {\r\n\t            var id = result[0] + result[1] * 256 + result[2] * 256 * 256;\r\n\t            var handled = false;\r\n\t            this._plugins.forEach(function (plugin) {\r\n\t                if (!plugin.onBeforeGetId) {\r\n\t                    return;\r\n\t                }\r\n\t                handled = handled || plugin.onBeforeGetId(id);\r\n\t            }, this);\r\n\t            if (!handled)\r\n\t                return id;\r\n\t            else\r\n\t                return null;\r\n\t        }\r\n\t        else {\r\n\t            return null;\r\n\t        }\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to start animation of the model. If you start animation before geometry is loaded it will wait for content to render it.\r\n\t    * This function is bound to browser framerate of the screen so it will stop consuming any resources if you switch to another tab.\r\n\t    *\r\n\t    * @function xViewer#start\r\n\t    * @param {Number} id [optional] - Optional ID of the model to be stopped. You can get this ID from {@link xViewer#event:loaded loaded} event.\r\n\t    */\r\n\t    xViewer.prototype.start = function (id) {\r\n\t        if (typeof (id) !== 'undefined') {\r\n\t            var model = this._handles.filter(function (h) { return h.id === id; }).pop();\r\n\t            if (typeof (model) === 'undefined')\r\n\t                throw \"Model doesn't exist.\";\r\n\t            model.stopped = false;\r\n\t            this._numberOfActiveModels++;\r\n\t            return;\r\n\t        }\r\n\t        this._isRunning = true;\r\n\t        var viewer = this;\r\n\t        var lastTime = new Date();\r\n\t        var counter = 0;\r\n\t        function tick() {\r\n\t            counter++;\r\n\t            if (counter == 30) {\r\n\t                counter = 0;\r\n\t                var newTime = new Date();\r\n\t                var span = newTime.getTime() - lastTime.getTime();\r\n\t                lastTime = newTime;\r\n\t                var fps = 1000 / span * 30;\r\n\t                /**\r\n\t                * Occurs after every 30th frame in animation. Use this event if you want to report FPS to the user. It might also be interesting performance measure.\r\n\t                *\r\n\t                * @event xViewer#fps\r\n\t                * @type {Number}\r\n\t                */\r\n\t                viewer._fire('fps', Math.floor(fps));\r\n\t            }\r\n\t            if (viewer._isRunning) {\r\n\t                window.requestAnimFrame(tick);\r\n\t                viewer.draw();\r\n\t            }\r\n\t        }\r\n\t        tick();\r\n\t    };\r\n\t    /**\r\n\t    * Use this function to stop animation of the model. User will still be able to see the latest state of the model. You can\r\n\t    * switch animation of the model on again by calling {@link xViewer#start start()}.\r\n\t    *\r\n\t    * @function xViewer#stop\r\n\t    * @param {Number} id [optional] - Optional ID of the model to be stopped. You can get this ID from {@link xViewer#event:loaded loaded} event.\r\n\t    */\r\n\t    xViewer.prototype.stop = function (id) {\r\n\t        if (typeof (id) == 'undefined') {\r\n\t            this._isRunning = false;\r\n\t            return;\r\n\t        }\r\n\t        var model = this._handles.filter(function (h) { return h.id === id; }).pop();\r\n\t        if (typeof (model) === 'undefined')\r\n\t            throw \"Model doesn't exist.\";\r\n\t        model.stopped = true;\r\n\t        this._numberOfActiveModels--;\r\n\t    };\r\n\t    /**\r\n\t     * Use this method to register to events of the viewer like {@link xViewer#event:pick pick}, {@link xViewer#event:mouseDown mouseDown},\r\n\t     * {@link xViewer#event:loaded loaded} and others. You can define arbitrary number\r\n\t     * of event handlers for any event. You can remove handler by calling {@link xViewer#off off()} method.\r\n\t     *\r\n\t     * @function xViewer#on\r\n\t     * @param {String} eventName - Name of the event you would like to listen to.\r\n\t     * @param {Object} callback - Callback handler of the event which will consume arguments and perform any custom action.\r\n\t    */\r\n\t    xViewer.prototype.on = function (eventName, callback) {\r\n\t        var events = this._events;\r\n\t        if (!events[eventName]) {\r\n\t            events[eventName] = [];\r\n\t        }\r\n\t        events[eventName].push(callback);\r\n\t    };\r\n\t    /**\r\n\t    * Use this method to unregister handlers from events. You can add event handlers by calling the {@link xViewer#on on()} method.\r\n\t    *\r\n\t    * @function xViewer#off\r\n\t    * @param {String} eventName - Name of the event\r\n\t    * @param {Object} callback - Handler to be removed\r\n\t    */\r\n\t    xViewer.prototype.off = function (eventName, callback) {\r\n\t        var events = this._events;\r\n\t        var callbacks = events[eventName];\r\n\t        if (!callbacks) {\r\n\t            return;\r\n\t        }\r\n\t        var index = callbacks.indexOf(callback);\r\n\t        if (index >= 0) {\r\n\t            callbacks.splice(index, 1);\r\n\t        }\r\n\t    };\r\n\t    //executes all handlers bound to event name\r\n\t    xViewer.prototype._fire = function (eventName, args) {\r\n\t        var handlers = this._events[eventName];\r\n\t        if (!handlers) {\r\n\t            return;\r\n\t        }\r\n\t        //cal the callbacks\r\n\t        handlers.forEach(function (handler) {\r\n\t            handler(args);\r\n\t        }, this);\r\n\t    };\r\n\t    xViewer.prototype._disableTextSelection = function () {\r\n\t        //disable text selection\r\n\t        document.documentElement.style['-webkit-touch-callout'] = 'none';\r\n\t        document.documentElement.style['-webkit-user-select'] = 'none';\r\n\t        document.documentElement.style['-khtml-user-select'] = 'none';\r\n\t        document.documentElement.style['-moz-user-select'] = 'none';\r\n\t        document.documentElement.style['-ms-user-select'] = 'none';\r\n\t        document.documentElement.style['user-select'] = 'none';\r\n\t    };\r\n\t    xViewer.prototype._enableTextSelection = function () {\r\n\t        //enable text selection again\r\n\t        document.documentElement.style['-webkit-touch-callout'] = 'text';\r\n\t        document.documentElement.style['-webkit-user-select'] = 'text';\r\n\t        document.documentElement.style['-khtml-user-select'] = 'text';\r\n\t        document.documentElement.style['-moz-user-select'] = 'text';\r\n\t        document.documentElement.style['-ms-user-select'] = 'text';\r\n\t        document.documentElement.style['user-select'] = 'text';\r\n\t    };\r\n\t    xViewer.prototype._getSVGOverlay = function () {\r\n\t        //check support for SVG\r\n\t        if (!document.implementation\r\n\t            .hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1'))\r\n\t            return false;\r\n\t        var ns = 'http://www.w3.org/2000/svg';\r\n\t        function getOffsetRect(elem) {\r\n\t            var box = elem.getBoundingClientRect();\r\n\t            var body = document.body;\r\n\t            var docElem = document.documentElement;\r\n\t            var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n\t            var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\t            var clientTop = docElem.clientTop || body.clientTop || 0;\r\n\t            var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\t            var clientBottom = docElem['clientBottom'] || body['clientBottom'] || 0;\r\n\t            var clientRight = docElem['clientRight'] || body['clientRight'] || 0;\r\n\t            var top = Math.round(box.top + scrollTop - clientTop);\r\n\t            var left = Math.round(box.left + scrollLeft - clientLeft);\r\n\t            var bottom = Math.round(box.top + scrollTop - clientBottom);\r\n\t            var right = Math.round(box.left + scrollLeft - clientRight);\r\n\t            return { top: top, left: left, width: right - left, height: bottom - top };\r\n\t        }\r\n\t        //create SVG overlay\r\n\t        var svg = document.createElementNS(ns, 'svg');\r\n\t        //document.body.appendChild(svg);\r\n\t        var cRect = getOffsetRect(this._canvas);\r\n\t        svg['style'].position = 'absolute';\r\n\t        svg['style'].top = cRect.top + 'px';\r\n\t        svg['style'].left = cRect.left + 'px';\r\n\t        svg['style']['z-index'] = 100;\r\n\t        svg.setAttribute('width', this._width.toString());\r\n\t        svg.setAttribute('height', this._height.toString());\r\n\t        return svg;\r\n\t    };\r\n\t    /**\r\n\t    * This method can be used to get parameter of the current clipping plane. If no clipping plane is active\r\n\t    * this returns [[0,0,0],[0,0,0]];\r\n\t    *\r\n\t    * @function xViewer#getClip\r\n\t    * @return  {Number[][]} Point and normal defining current clipping plane\r\n\t    */\r\n\t    xViewer.prototype.getClip = function () {\r\n\t        var cp = this.clippingPlane;\r\n\t        if (cp.every(function (e) { return e === 0; })) {\r\n\t            return [[0, 0, 0], [0, 0, 0]];\r\n\t        }\r\n\t        var normal = glMatrix.vec3.normalize([0.0, 0.0, 0.0], [cp[0], cp[1], cp[2]]);\r\n\t        //test if the last clipping point fits in the condition\r\n\t        var lp = this._lastClippingPoint;\r\n\t        var test = lp[0] * cp[0] + lp[1] * cp[1] + lp[2] * cp[2] + cp[3];\r\n\t        if (Math.abs(test) < 1e-5) {\r\n\t            return [lp, normal];\r\n\t        }\r\n\t        //find the point on the plane\r\n\t        var x = cp[0] !== 0 ? -1.0 * cp[3] / cp[0] : 0.0;\r\n\t        var y = cp[1] !== 0 ? -1.0 * cp[3] / cp[1] : 0.0;\r\n\t        var z = cp[2] !== 0 ? -1.0 * cp[3] / cp[2] : 0.0;\r\n\t        return [[x, y, z], normal];\r\n\t    };\r\n\t    /**\r\n\t    * Use this method to clip the model. If you call the function with no arguments interactive clipping will start. This is based on SVG overlay\r\n\t    * so SVG support is necessary for it. But as WebGL is more advanced technology than SVG it is sound assumption that it is present in the browser.\r\n\t    * Use {@link xViewer.check xViewer.check()} to make sure it is supported at the very beginning of using of xViewer. Use {@link xViewer#unclip unclip()} method to\r\n\t    * unset clipping plane.\r\n\t    *\r\n\t    * @function xViewer#clip\r\n\t    * @param {Number[]} [point] - point in clipping plane\r\n\t    * @param {Number[]} [normal] - normal pointing to the half space which will be hidden\r\n\t    * @fires xViewer#clipped\r\n\t    */\r\n\t    xViewer.prototype.clip = function (point, normal) {\r\n\t        //non interactive clipping, all information is there\r\n\t        if (typeof (point) != 'undefined' && typeof (normal) != 'undefined') {\r\n\t            this._lastClippingPoint = point;\r\n\t            //compute normal equation of the plane\r\n\t            var d = 0.0 - normal[0] * point[0] - normal[1] * point[1] - normal[2] * point[2];\r\n\t            //set clipping plane\r\n\t            this.clippingPlane = [normal[0], normal[1], normal[2], d];\r\n\t            /**\r\n\t            * Occurs when model is clipped. This event has empty object.\r\n\t            *\r\n\t            * @event xViewer#clipped\r\n\t            * @type {object}\r\n\t            */\r\n\t            this._fire('clipped', {});\r\n\t            return;\r\n\t        }\r\n\t        //********************************************** Interactive clipping ********************************************//\r\n\t        var ns = 'http://www.w3.org/2000/svg';\r\n\t        var svg = this._getSVGOverlay();\r\n\t        var viewer = this;\r\n\t        var position = {};\r\n\t        var down = false;\r\n\t        var g = {};\r\n\t        var handleMouseDown = function (event) {\r\n\t            if (down)\r\n\t                return;\r\n\t            down = true;\r\n\t            viewer._disableTextSelection();\r\n\t            var r = svg.getBoundingClientRect();\r\n\t            position.x = event.clientX - r.left;\r\n\t            position.y = event.clientY - r.top;\r\n\t            position.angle = 0.0;\r\n\t            //create very long vertical line going through the point\r\n\t            g = document.createElementNS(ns, 'g');\r\n\t            g['setAttribute']('id', 'section');\r\n\t            svg.appendChild(g);\r\n\t            var line = document.createElementNS(ns, 'line');\r\n\t            g['appendChild'](line);\r\n\t            line.setAttribute('style', 'stroke:rgb(255,0,0);stroke-width:2');\r\n\t            line.setAttribute('x1', position.x.toString());\r\n\t            line.setAttribute('y1', '99999');\r\n\t            line.setAttribute('x2', position.x.toString());\r\n\t            line.setAttribute('y2', '-99999');\r\n\t        };\r\n\t        var handleMouseUp = function (event) {\r\n\t            if (!down)\r\n\t                return;\r\n\t            //check if the points are not identical. \r\n\t            var r = svg.getBoundingClientRect();\r\n\t            if (position.x == event.clientX - r.left && position.y == event.clientY - r.top) {\r\n\t                return;\r\n\t            }\r\n\t            down = false;\r\n\t            viewer._enableTextSelection();\r\n\t            //get inverse transformation\r\n\t            var transform = glMatrix.mat4.create();\r\n\t            glMatrix.mat4.multiply(transform, viewer._pMatrix, viewer._mvMatrix);\r\n\t            var inverse = glMatrix.mat4.create();\r\n\t            glMatrix.mat4.invert(inverse, transform);\r\n\t            //get normalized coordinates the point in WebGL CS\r\n\t            var x1 = position.x / (viewer._width / 2.0) - 1.0;\r\n\t            var y1 = 1.0 - position.y / (viewer._height / 2.0);\r\n\t            //First point in WCS\r\n\t            var A = glMatrix.vec3.create();\r\n\t            glMatrix.vec3.transformMat4(A, [x1, y1, -1], inverse); //near clipping plane\r\n\t            //Second point in WCS\r\n\t            var B = glMatrix.vec3.create();\r\n\t            glMatrix.vec3.transformMat4(B, [x1, y1, 1], inverse); //far clipping plane\r\n\t            //Compute third point on plane\r\n\t            var angle = position.angle * Math.PI / 180.0;\r\n\t            var x2 = x1 + Math.cos(angle);\r\n\t            var y2 = y1 + Math.sin(angle);\r\n\t            //Third point in WCS\r\n\t            var C = glMatrix.vec3.create();\r\n\t            glMatrix.vec3.transformMat4(C, [x2, y2, 1], inverse); // far clipping plane\r\n\t            //Compute normal in WCS\r\n\t            var BA = glMatrix.vec3.subtract(glMatrix.vec3.create(), A, B);\r\n\t            var BC = glMatrix.vec3.subtract(glMatrix.vec3.create(), C, B);\r\n\t            var N = glMatrix.vec3.cross(glMatrix.vec3.create(), BA, BC);\r\n\t            viewer.clip(B, N);\r\n\t            //clean\r\n\t            svg.parentNode.removeChild(svg);\r\n\t            svg.removeEventListener('mousedown', handleMouseDown, true);\r\n\t            window.removeEventListener('mouseup', handleMouseUp, true);\r\n\t            window.removeEventListener('mousemove', handleMouseMove, true);\r\n\t        };\r\n\t        var handleMouseMove = function (event) {\r\n\t            if (!down)\r\n\t                return;\r\n\t            var r = svg.getBoundingClientRect();\r\n\t            var x = event.clientX - r.left;\r\n\t            var y = event.clientY - r.top;\r\n\t            //rotate\r\n\t            var dX = x - position.x;\r\n\t            var dY = y - position.y;\r\n\t            var angle = Math.atan2(dX, dY) * -180.0 / Math.PI + 90.0;\r\n\t            //round to 5 DEG\r\n\t            angle = Math.round(angle / 5.0) * 5.0;\r\n\t            position.angle = 360.0 - angle + 90;\r\n\t            g['setAttribute']('transform', 'rotate(' + angle + ' ' + position.x + ' ' + position.y + ')');\r\n\t        };\r\n\t        //this._canvas.parentNode.appendChild(svg);\r\n\t        document.documentElement.appendChild(svg);\r\n\t        svg.addEventListener('mousedown', handleMouseDown, true);\r\n\t        window.addEventListener('mouseup', handleMouseUp, true);\r\n\t        window.addEventListener('mousemove', handleMouseMove, true);\r\n\t        this.stopClipping = function () {\r\n\t            svg.parentNode.removeChild(svg);\r\n\t            svg.removeEventListener('mousedown', handleMouseDown, true);\r\n\t            window.removeEventListener('mouseup', handleMouseUp, true);\r\n\t            window.removeEventListener('mousemove', handleMouseMove, true);\r\n\t            //clear also itself\r\n\t            viewer.stopClipping = function () { };\r\n\t        };\r\n\t    };\r\n\t    /**\r\n\t    * This method is only active when interactive clipping is active. It stops interactive clipping operation.\r\n\t    *\r\n\t    * @function xViewer#stopClipping\r\n\t    */\r\n\t    //this is only a placeholder. It is actually created only when interactive clipping is active.\r\n\t    xViewer.prototype.stopClipping = function () { };\r\n\t    /**\r\n\t    * This method will cancel any clipping plane if it is defined. Use {@link xViewer#clip clip()}\r\n\t    * method to define clipping by point and normal of the plane or interactively if you call it with no arguments.\r\n\t    * @function xViewer#unclip\r\n\t    * @fires xViewer#unclipped\r\n\t    */\r\n\t    xViewer.prototype.unclip = function () {\r\n\t        this.clippingPlane = [0, 0, 0, 0];\r\n\t        /**\r\n\t          * Occurs when clipping of the model is dismissed. This event has empty object.\r\n\t          *\r\n\t          * @event xViewer#unclipped\r\n\t          * @type {object}\r\n\t          */\r\n\t        this._fire('unclipped', {});\r\n\t    };\r\n\t    return xViewer;\r\n\t}());\r\n\texports.xViewer = xViewer;\r\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\r\n\t * @fileoverview gl-matrix - High performance matrix and vector operations\r\n\t * @author Brandon Jones\r\n\t * @author Colin MacKenzie IV\r\n\t * @version 2.2.2\r\n\t */\r\n\t\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation\r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t\r\n\t(function(_global) {\r\n\t  \"use strict\";\r\n\t\r\n\t  var shim = {};\r\n\t  if (false) {\r\n\t    if(typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\r\n\t      shim.exports = {};\r\n\t      define(function() {\r\n\t        return shim.exports;\r\n\t      });\r\n\t    } else {\r\n\t      // gl-matrix lives in a browser, define its namespaces in global\r\n\t      shim.exports = typeof(window) !== 'undefined' ? window : _global;\r\n\t    }\r\n\t  }\r\n\t  else {\r\n\t    // gl-matrix lives in commonjs, define its namespaces in exports\r\n\t    shim.exports = exports;\r\n\t  }\r\n\t\r\n\t  (function(exports) {\r\n\t    /* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t\r\n\tif(!GLMAT_EPSILON) {\r\n\t    var GLMAT_EPSILON = 0.000001;\r\n\t}\r\n\t\r\n\tif(!GLMAT_ARRAY_TYPE) {\r\n\t    var GLMAT_ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\r\n\t}\r\n\t\r\n\tif(!GLMAT_RANDOM) {\r\n\t    var GLMAT_RANDOM = Math.random;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @class Common utilities\r\n\t * @name glMatrix\r\n\t */\r\n\tvar glMatrix = {};\r\n\t\r\n\t/**\r\n\t * Sets the type of array used when creating new vectors and matrices\r\n\t *\r\n\t * @param {Type} type Array type, such as Float32Array or Array\r\n\t */\r\n\tglMatrix.setMatrixArrayType = function(type) {\r\n\t    GLMAT_ARRAY_TYPE = type;\r\n\t}\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.glMatrix = glMatrix;\r\n\t}\r\n\t\r\n\tvar degree = Math.PI / 180;\r\n\t\r\n\t/**\r\n\t* Convert Degree To Radian\r\n\t*\r\n\t* @param {Number} Angle in Degrees\r\n\t*/\r\n\tglMatrix.toRadian = function(a){\r\n\t     return a * degree;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 2 Dimensional Vector\r\n\t * @name vec2\r\n\t */\r\n\t\r\n\tvar vec2 = {};\r\n\t\r\n\t/**\r\n\t * Creates a new, empty vec2\r\n\t *\r\n\t * @returns {vec2} a new 2D vector\r\n\t */\r\n\tvec2.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(2);\r\n\t    out[0] = 0;\r\n\t    out[1] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new vec2 initialized with values from an existing vector\r\n\t *\r\n\t * @param {vec2} a vector to clone\r\n\t * @returns {vec2} a new 2D vector\r\n\t */\r\n\tvec2.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(2);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new vec2 initialized with the given values\r\n\t *\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @returns {vec2} a new 2D vector\r\n\t */\r\n\tvec2.fromValues = function(x, y) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(2);\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one vec2 to another\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the source vector\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set the components of a vec2 to the given values\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.set = function(out, x, y) {\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two vec2's\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.add = function(out, a, b) {\r\n\t    out[0] = a[0] + b[0];\r\n\t    out[1] = a[1] + b[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Subtracts vector b from vector a\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.subtract = function(out, a, b) {\r\n\t    out[0] = a[0] - b[0];\r\n\t    out[1] = a[1] - b[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.subtract}\r\n\t * @function\r\n\t */\r\n\tvec2.sub = vec2.subtract;\r\n\t\r\n\t/**\r\n\t * Multiplies two vec2's\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.multiply = function(out, a, b) {\r\n\t    out[0] = a[0] * b[0];\r\n\t    out[1] = a[1] * b[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.multiply}\r\n\t * @function\r\n\t */\r\n\tvec2.mul = vec2.multiply;\r\n\t\r\n\t/**\r\n\t * Divides two vec2's\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.divide = function(out, a, b) {\r\n\t    out[0] = a[0] / b[0];\r\n\t    out[1] = a[1] / b[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.divide}\r\n\t * @function\r\n\t */\r\n\tvec2.div = vec2.divide;\r\n\t\r\n\t/**\r\n\t * Returns the minimum of two vec2's\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.min = function(out, a, b) {\r\n\t    out[0] = Math.min(a[0], b[0]);\r\n\t    out[1] = Math.min(a[1], b[1]);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the maximum of two vec2's\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.max = function(out, a, b) {\r\n\t    out[0] = Math.max(a[0], b[0]);\r\n\t    out[1] = Math.max(a[1], b[1]);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales a vec2 by a scalar number\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the vector to scale\r\n\t * @param {Number} b amount to scale the vector by\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.scale = function(out, a, b) {\r\n\t    out[0] = a[0] * b;\r\n\t    out[1] = a[1] * b;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two vec2's after scaling the second operand by a scalar value\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @param {Number} scale the amount to scale b by before adding\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.scaleAndAdd = function(out, a, b, scale) {\r\n\t    out[0] = a[0] + (b[0] * scale);\r\n\t    out[1] = a[1] + (b[1] * scale);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the euclidian distance between two vec2's\r\n\t *\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {Number} distance between a and b\r\n\t */\r\n\tvec2.distance = function(a, b) {\r\n\t    var x = b[0] - a[0],\r\n\t        y = b[1] - a[1];\r\n\t    return Math.sqrt(x*x + y*y);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.distance}\r\n\t * @function\r\n\t */\r\n\tvec2.dist = vec2.distance;\r\n\t\r\n\t/**\r\n\t * Calculates the squared euclidian distance between two vec2's\r\n\t *\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {Number} squared distance between a and b\r\n\t */\r\n\tvec2.squaredDistance = function(a, b) {\r\n\t    var x = b[0] - a[0],\r\n\t        y = b[1] - a[1];\r\n\t    return x*x + y*y;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.squaredDistance}\r\n\t * @function\r\n\t */\r\n\tvec2.sqrDist = vec2.squaredDistance;\r\n\t\r\n\t/**\r\n\t * Calculates the length of a vec2\r\n\t *\r\n\t * @param {vec2} a vector to calculate length of\r\n\t * @returns {Number} length of a\r\n\t */\r\n\tvec2.length = function (a) {\r\n\t    var x = a[0],\r\n\t        y = a[1];\r\n\t    return Math.sqrt(x*x + y*y);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.length}\r\n\t * @function\r\n\t */\r\n\tvec2.len = vec2.length;\r\n\t\r\n\t/**\r\n\t * Calculates the squared length of a vec2\r\n\t *\r\n\t * @param {vec2} a vector to calculate squared length of\r\n\t * @returns {Number} squared length of a\r\n\t */\r\n\tvec2.squaredLength = function (a) {\r\n\t    var x = a[0],\r\n\t        y = a[1];\r\n\t    return x*x + y*y;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec2.squaredLength}\r\n\t * @function\r\n\t */\r\n\tvec2.sqrLen = vec2.squaredLength;\r\n\t\r\n\t/**\r\n\t * Negates the components of a vec2\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a vector to negate\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.negate = function(out, a) {\r\n\t    out[0] = -a[0];\r\n\t    out[1] = -a[1];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the inverse of the components of a vec2\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a vector to invert\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.inverse = function(out, a) {\r\n\t  out[0] = 1.0 / a[0];\r\n\t  out[1] = 1.0 / a[1];\r\n\t  return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Normalize a vec2\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a vector to normalize\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.normalize = function(out, a) {\r\n\t    var x = a[0],\r\n\t        y = a[1];\r\n\t    var len = x*x + y*y;\r\n\t    if (len > 0) {\r\n\t        //TODO: evaluate use of glm_invsqrt here?\r\n\t        len = 1 / Math.sqrt(len);\r\n\t        out[0] = a[0] * len;\r\n\t        out[1] = a[1] * len;\r\n\t    }\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the dot product of two vec2's\r\n\t *\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {Number} dot product of a and b\r\n\t */\r\n\tvec2.dot = function (a, b) {\r\n\t    return a[0] * b[0] + a[1] * b[1];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Computes the cross product of two vec2's\r\n\t * Note that the cross product must by definition produce a 3D vector\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec2.cross = function(out, a, b) {\r\n\t    var z = a[0] * b[1] - a[1] * b[0];\r\n\t    out[0] = out[1] = 0;\r\n\t    out[2] = z;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Performs a linear interpolation between two vec2's\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the first operand\r\n\t * @param {vec2} b the second operand\r\n\t * @param {Number} t interpolation amount between the two inputs\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.lerp = function (out, a, b, t) {\r\n\t    var ax = a[0],\r\n\t        ay = a[1];\r\n\t    out[0] = ax + t * (b[0] - ax);\r\n\t    out[1] = ay + t * (b[1] - ay);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a random vector with the given scale\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.random = function (out, scale) {\r\n\t    scale = scale || 1.0;\r\n\t    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\r\n\t    out[0] = Math.cos(r) * scale;\r\n\t    out[1] = Math.sin(r) * scale;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec2 with a mat2\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the vector to transform\r\n\t * @param {mat2} m matrix to transform with\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.transformMat2 = function(out, a, m) {\r\n\t    var x = a[0],\r\n\t        y = a[1];\r\n\t    out[0] = m[0] * x + m[2] * y;\r\n\t    out[1] = m[1] * x + m[3] * y;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec2 with a mat2d\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the vector to transform\r\n\t * @param {mat2d} m matrix to transform with\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.transformMat2d = function(out, a, m) {\r\n\t    var x = a[0],\r\n\t        y = a[1];\r\n\t    out[0] = m[0] * x + m[2] * y + m[4];\r\n\t    out[1] = m[1] * x + m[3] * y + m[5];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec2 with a mat3\r\n\t * 3rd vector component is implicitly '1'\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the vector to transform\r\n\t * @param {mat3} m matrix to transform with\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.transformMat3 = function(out, a, m) {\r\n\t    var x = a[0],\r\n\t        y = a[1];\r\n\t    out[0] = m[0] * x + m[3] * y + m[6];\r\n\t    out[1] = m[1] * x + m[4] * y + m[7];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec2 with a mat4\r\n\t * 3rd vector component is implicitly '0'\r\n\t * 4th vector component is implicitly '1'\r\n\t *\r\n\t * @param {vec2} out the receiving vector\r\n\t * @param {vec2} a the vector to transform\r\n\t * @param {mat4} m matrix to transform with\r\n\t * @returns {vec2} out\r\n\t */\r\n\tvec2.transformMat4 = function(out, a, m) {\r\n\t    var x = a[0], \r\n\t        y = a[1];\r\n\t    out[0] = m[0] * x + m[4] * y + m[12];\r\n\t    out[1] = m[1] * x + m[5] * y + m[13];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Perform some operation over an array of vec2s.\r\n\t *\r\n\t * @param {Array} a the array of vectors to iterate over\r\n\t * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n\t * @param {Number} offset Number of elements to skip at the beginning of the array\r\n\t * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n\t * @param {Function} fn Function to call for each vector in the array\r\n\t * @param {Object} [arg] additional argument to pass to fn\r\n\t * @returns {Array} a\r\n\t * @function\r\n\t */\r\n\tvec2.forEach = (function() {\r\n\t    var vec = vec2.create();\r\n\t\r\n\t    return function(a, stride, offset, count, fn, arg) {\r\n\t        var i, l;\r\n\t        if(!stride) {\r\n\t            stride = 2;\r\n\t        }\r\n\t\r\n\t        if(!offset) {\r\n\t            offset = 0;\r\n\t        }\r\n\t        \r\n\t        if(count) {\r\n\t            l = Math.min((count * stride) + offset, a.length);\r\n\t        } else {\r\n\t            l = a.length;\r\n\t        }\r\n\t\r\n\t        for(i = offset; i < l; i += stride) {\r\n\t            vec[0] = a[i]; vec[1] = a[i+1];\r\n\t            fn(vec, vec, arg);\r\n\t            a[i] = vec[0]; a[i+1] = vec[1];\r\n\t        }\r\n\t        \r\n\t        return a;\r\n\t    };\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a vector\r\n\t *\r\n\t * @param {vec2} vec vector to represent as a string\r\n\t * @returns {String} string representation of the vector\r\n\t */\r\n\tvec2.str = function (a) {\r\n\t    return 'vec2(' + a[0] + ', ' + a[1] + ')';\r\n\t};\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.vec2 = vec2;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 3 Dimensional Vector\r\n\t * @name vec3\r\n\t */\r\n\t\r\n\tvar vec3 = {};\r\n\t\r\n\t/**\r\n\t * Creates a new, empty vec3\r\n\t *\r\n\t * @returns {vec3} a new 3D vector\r\n\t */\r\n\tvec3.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(3);\r\n\t    out[0] = 0;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new vec3 initialized with values from an existing vector\r\n\t *\r\n\t * @param {vec3} a vector to clone\r\n\t * @returns {vec3} a new 3D vector\r\n\t */\r\n\tvec3.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(3);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new vec3 initialized with the given values\r\n\t *\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @param {Number} z Z component\r\n\t * @returns {vec3} a new 3D vector\r\n\t */\r\n\tvec3.fromValues = function(x, y, z) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(3);\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    out[2] = z;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one vec3 to another\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the source vector\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set the components of a vec3 to the given values\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @param {Number} z Z component\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.set = function(out, x, y, z) {\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    out[2] = z;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.add = function(out, a, b) {\r\n\t    out[0] = a[0] + b[0];\r\n\t    out[1] = a[1] + b[1];\r\n\t    out[2] = a[2] + b[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Subtracts vector b from vector a\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.subtract = function(out, a, b) {\r\n\t    out[0] = a[0] - b[0];\r\n\t    out[1] = a[1] - b[1];\r\n\t    out[2] = a[2] - b[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.subtract}\r\n\t * @function\r\n\t */\r\n\tvec3.sub = vec3.subtract;\r\n\t\r\n\t/**\r\n\t * Multiplies two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.multiply = function(out, a, b) {\r\n\t    out[0] = a[0] * b[0];\r\n\t    out[1] = a[1] * b[1];\r\n\t    out[2] = a[2] * b[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.multiply}\r\n\t * @function\r\n\t */\r\n\tvec3.mul = vec3.multiply;\r\n\t\r\n\t/**\r\n\t * Divides two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.divide = function(out, a, b) {\r\n\t    out[0] = a[0] / b[0];\r\n\t    out[1] = a[1] / b[1];\r\n\t    out[2] = a[2] / b[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.divide}\r\n\t * @function\r\n\t */\r\n\tvec3.div = vec3.divide;\r\n\t\r\n\t/**\r\n\t * Returns the minimum of two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.min = function(out, a, b) {\r\n\t    out[0] = Math.min(a[0], b[0]);\r\n\t    out[1] = Math.min(a[1], b[1]);\r\n\t    out[2] = Math.min(a[2], b[2]);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the maximum of two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.max = function(out, a, b) {\r\n\t    out[0] = Math.max(a[0], b[0]);\r\n\t    out[1] = Math.max(a[1], b[1]);\r\n\t    out[2] = Math.max(a[2], b[2]);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales a vec3 by a scalar number\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the vector to scale\r\n\t * @param {Number} b amount to scale the vector by\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.scale = function(out, a, b) {\r\n\t    out[0] = a[0] * b;\r\n\t    out[1] = a[1] * b;\r\n\t    out[2] = a[2] * b;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two vec3's after scaling the second operand by a scalar value\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @param {Number} scale the amount to scale b by before adding\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.scaleAndAdd = function(out, a, b, scale) {\r\n\t    out[0] = a[0] + (b[0] * scale);\r\n\t    out[1] = a[1] + (b[1] * scale);\r\n\t    out[2] = a[2] + (b[2] * scale);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the euclidian distance between two vec3's\r\n\t *\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {Number} distance between a and b\r\n\t */\r\n\tvec3.distance = function(a, b) {\r\n\t    var x = b[0] - a[0],\r\n\t        y = b[1] - a[1],\r\n\t        z = b[2] - a[2];\r\n\t    return Math.sqrt(x*x + y*y + z*z);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.distance}\r\n\t * @function\r\n\t */\r\n\tvec3.dist = vec3.distance;\r\n\t\r\n\t/**\r\n\t * Calculates the squared euclidian distance between two vec3's\r\n\t *\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {Number} squared distance between a and b\r\n\t */\r\n\tvec3.squaredDistance = function(a, b) {\r\n\t    var x = b[0] - a[0],\r\n\t        y = b[1] - a[1],\r\n\t        z = b[2] - a[2];\r\n\t    return x*x + y*y + z*z;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.squaredDistance}\r\n\t * @function\r\n\t */\r\n\tvec3.sqrDist = vec3.squaredDistance;\r\n\t\r\n\t/**\r\n\t * Calculates the length of a vec3\r\n\t *\r\n\t * @param {vec3} a vector to calculate length of\r\n\t * @returns {Number} length of a\r\n\t */\r\n\tvec3.length = function (a) {\r\n\t    var x = a[0],\r\n\t        y = a[1],\r\n\t        z = a[2];\r\n\t    return Math.sqrt(x*x + y*y + z*z);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.length}\r\n\t * @function\r\n\t */\r\n\tvec3.len = vec3.length;\r\n\t\r\n\t/**\r\n\t * Calculates the squared length of a vec3\r\n\t *\r\n\t * @param {vec3} a vector to calculate squared length of\r\n\t * @returns {Number} squared length of a\r\n\t */\r\n\tvec3.squaredLength = function (a) {\r\n\t    var x = a[0],\r\n\t        y = a[1],\r\n\t        z = a[2];\r\n\t    return x*x + y*y + z*z;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec3.squaredLength}\r\n\t * @function\r\n\t */\r\n\tvec3.sqrLen = vec3.squaredLength;\r\n\t\r\n\t/**\r\n\t * Negates the components of a vec3\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a vector to negate\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.negate = function(out, a) {\r\n\t    out[0] = -a[0];\r\n\t    out[1] = -a[1];\r\n\t    out[2] = -a[2];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the inverse of the components of a vec3\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a vector to invert\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.inverse = function(out, a) {\r\n\t  out[0] = 1.0 / a[0];\r\n\t  out[1] = 1.0 / a[1];\r\n\t  out[2] = 1.0 / a[2];\r\n\t  return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Normalize a vec3\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a vector to normalize\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.normalize = function(out, a) {\r\n\t    var x = a[0],\r\n\t        y = a[1],\r\n\t        z = a[2];\r\n\t    var len = x*x + y*y + z*z;\r\n\t    if (len > 0) {\r\n\t        //TODO: evaluate use of glm_invsqrt here?\r\n\t        len = 1 / Math.sqrt(len);\r\n\t        out[0] = a[0] * len;\r\n\t        out[1] = a[1] * len;\r\n\t        out[2] = a[2] * len;\r\n\t    }\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the dot product of two vec3's\r\n\t *\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {Number} dot product of a and b\r\n\t */\r\n\tvec3.dot = function (a, b) {\r\n\t    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Computes the cross product of two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.cross = function(out, a, b) {\r\n\t    var ax = a[0], ay = a[1], az = a[2],\r\n\t        bx = b[0], by = b[1], bz = b[2];\r\n\t\r\n\t    out[0] = ay * bz - az * by;\r\n\t    out[1] = az * bx - ax * bz;\r\n\t    out[2] = ax * by - ay * bx;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Performs a linear interpolation between two vec3's\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the first operand\r\n\t * @param {vec3} b the second operand\r\n\t * @param {Number} t interpolation amount between the two inputs\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.lerp = function (out, a, b, t) {\r\n\t    var ax = a[0],\r\n\t        ay = a[1],\r\n\t        az = a[2];\r\n\t    out[0] = ax + t * (b[0] - ax);\r\n\t    out[1] = ay + t * (b[1] - ay);\r\n\t    out[2] = az + t * (b[2] - az);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a random vector with the given scale\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.random = function (out, scale) {\r\n\t    scale = scale || 1.0;\r\n\t\r\n\t    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\r\n\t    var z = (GLMAT_RANDOM() * 2.0) - 1.0;\r\n\t    var zScale = Math.sqrt(1.0-z*z) * scale;\r\n\t\r\n\t    out[0] = Math.cos(r) * zScale;\r\n\t    out[1] = Math.sin(r) * zScale;\r\n\t    out[2] = z * scale;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec3 with a mat4.\r\n\t * 4th vector component is implicitly '1'\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the vector to transform\r\n\t * @param {mat4} m matrix to transform with\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.transformMat4 = function(out, a, m) {\r\n\t    var x = a[0], y = a[1], z = a[2],\r\n\t        w = m[3] * x + m[7] * y + m[11] * z + m[15];\r\n\t    w = w || 1.0;\r\n\t    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\r\n\t    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\r\n\t    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec3 with a mat3.\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the vector to transform\r\n\t * @param {mat4} m the 3x3 matrix to transform with\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.transformMat3 = function(out, a, m) {\r\n\t    var x = a[0], y = a[1], z = a[2];\r\n\t    out[0] = x * m[0] + y * m[3] + z * m[6];\r\n\t    out[1] = x * m[1] + y * m[4] + z * m[7];\r\n\t    out[2] = x * m[2] + y * m[5] + z * m[8];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec3 with a quat\r\n\t *\r\n\t * @param {vec3} out the receiving vector\r\n\t * @param {vec3} a the vector to transform\r\n\t * @param {quat} q quaternion to transform with\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.transformQuat = function(out, a, q) {\r\n\t    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\r\n\t\r\n\t    var x = a[0], y = a[1], z = a[2],\r\n\t        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\r\n\t\r\n\t        // calculate quat * vec\r\n\t        ix = qw * x + qy * z - qz * y,\r\n\t        iy = qw * y + qz * x - qx * z,\r\n\t        iz = qw * z + qx * y - qy * x,\r\n\t        iw = -qx * x - qy * y - qz * z;\r\n\t\r\n\t    // calculate result * inverse quat\r\n\t    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n\t    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n\t    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotate a 3D vector around the x-axis\r\n\t * @param {vec3} out The receiving vec3\r\n\t * @param {vec3} a The vec3 point to rotate\r\n\t * @param {vec3} b The origin of the rotation\r\n\t * @param {Number} c The angle of rotation\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.rotateX = function(out, a, b, c){\r\n\t   var p = [], r=[];\r\n\t\t  //Translate point to the origin\r\n\t\t  p[0] = a[0] - b[0];\r\n\t\t  p[1] = a[1] - b[1];\r\n\t  \tp[2] = a[2] - b[2];\r\n\t\r\n\t\t  //perform rotation\r\n\t\t  r[0] = p[0];\r\n\t\t  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\r\n\t\t  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\r\n\t\r\n\t\t  //translate to correct position\r\n\t\t  out[0] = r[0] + b[0];\r\n\t\t  out[1] = r[1] + b[1];\r\n\t\t  out[2] = r[2] + b[2];\r\n\t\r\n\t  \treturn out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotate a 3D vector around the y-axis\r\n\t * @param {vec3} out The receiving vec3\r\n\t * @param {vec3} a The vec3 point to rotate\r\n\t * @param {vec3} b The origin of the rotation\r\n\t * @param {Number} c The angle of rotation\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.rotateY = function(out, a, b, c){\r\n\t  \tvar p = [], r=[];\r\n\t  \t//Translate point to the origin\r\n\t  \tp[0] = a[0] - b[0];\r\n\t  \tp[1] = a[1] - b[1];\r\n\t  \tp[2] = a[2] - b[2];\r\n\t  \r\n\t  \t//perform rotation\r\n\t  \tr[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\r\n\t  \tr[1] = p[1];\r\n\t  \tr[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\r\n\t  \r\n\t  \t//translate to correct position\r\n\t  \tout[0] = r[0] + b[0];\r\n\t  \tout[1] = r[1] + b[1];\r\n\t  \tout[2] = r[2] + b[2];\r\n\t  \r\n\t  \treturn out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotate a 3D vector around the z-axis\r\n\t * @param {vec3} out The receiving vec3\r\n\t * @param {vec3} a The vec3 point to rotate\r\n\t * @param {vec3} b The origin of the rotation\r\n\t * @param {Number} c The angle of rotation\r\n\t * @returns {vec3} out\r\n\t */\r\n\tvec3.rotateZ = function(out, a, b, c){\r\n\t  \tvar p = [], r=[];\r\n\t  \t//Translate point to the origin\r\n\t  \tp[0] = a[0] - b[0];\r\n\t  \tp[1] = a[1] - b[1];\r\n\t  \tp[2] = a[2] - b[2];\r\n\t  \r\n\t  \t//perform rotation\r\n\t  \tr[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\r\n\t  \tr[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\r\n\t  \tr[2] = p[2];\r\n\t  \r\n\t  \t//translate to correct position\r\n\t  \tout[0] = r[0] + b[0];\r\n\t  \tout[1] = r[1] + b[1];\r\n\t  \tout[2] = r[2] + b[2];\r\n\t  \r\n\t  \treturn out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Perform some operation over an array of vec3s.\r\n\t *\r\n\t * @param {Array} a the array of vectors to iterate over\r\n\t * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n\t * @param {Number} offset Number of elements to skip at the beginning of the array\r\n\t * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n\t * @param {Function} fn Function to call for each vector in the array\r\n\t * @param {Object} [arg] additional argument to pass to fn\r\n\t * @returns {Array} a\r\n\t * @function\r\n\t */\r\n\tvec3.forEach = (function() {\r\n\t    var vec = vec3.create();\r\n\t\r\n\t    return function(a, stride, offset, count, fn, arg) {\r\n\t        var i, l;\r\n\t        if(!stride) {\r\n\t            stride = 3;\r\n\t        }\r\n\t\r\n\t        if(!offset) {\r\n\t            offset = 0;\r\n\t        }\r\n\t        \r\n\t        if(count) {\r\n\t            l = Math.min((count * stride) + offset, a.length);\r\n\t        } else {\r\n\t            l = a.length;\r\n\t        }\r\n\t\r\n\t        for(i = offset; i < l; i += stride) {\r\n\t            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\r\n\t            fn(vec, vec, arg);\r\n\t            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\r\n\t        }\r\n\t        \r\n\t        return a;\r\n\t    };\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a vector\r\n\t *\r\n\t * @param {vec3} vec vector to represent as a string\r\n\t * @returns {String} string representation of the vector\r\n\t */\r\n\tvec3.str = function (a) {\r\n\t    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\r\n\t};\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.vec3 = vec3;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 4 Dimensional Vector\r\n\t * @name vec4\r\n\t */\r\n\t\r\n\tvar vec4 = {};\r\n\t\r\n\t/**\r\n\t * Creates a new, empty vec4\r\n\t *\r\n\t * @returns {vec4} a new 4D vector\r\n\t */\r\n\tvec4.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(4);\r\n\t    out[0] = 0;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new vec4 initialized with values from an existing vector\r\n\t *\r\n\t * @param {vec4} a vector to clone\r\n\t * @returns {vec4} a new 4D vector\r\n\t */\r\n\tvec4.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(4);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new vec4 initialized with the given values\r\n\t *\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @param {Number} z Z component\r\n\t * @param {Number} w W component\r\n\t * @returns {vec4} a new 4D vector\r\n\t */\r\n\tvec4.fromValues = function(x, y, z, w) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(4);\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    out[2] = z;\r\n\t    out[3] = w;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one vec4 to another\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the source vector\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set the components of a vec4 to the given values\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @param {Number} z Z component\r\n\t * @param {Number} w W component\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.set = function(out, x, y, z, w) {\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    out[2] = z;\r\n\t    out[3] = w;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two vec4's\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.add = function(out, a, b) {\r\n\t    out[0] = a[0] + b[0];\r\n\t    out[1] = a[1] + b[1];\r\n\t    out[2] = a[2] + b[2];\r\n\t    out[3] = a[3] + b[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Subtracts vector b from vector a\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.subtract = function(out, a, b) {\r\n\t    out[0] = a[0] - b[0];\r\n\t    out[1] = a[1] - b[1];\r\n\t    out[2] = a[2] - b[2];\r\n\t    out[3] = a[3] - b[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.subtract}\r\n\t * @function\r\n\t */\r\n\tvec4.sub = vec4.subtract;\r\n\t\r\n\t/**\r\n\t * Multiplies two vec4's\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.multiply = function(out, a, b) {\r\n\t    out[0] = a[0] * b[0];\r\n\t    out[1] = a[1] * b[1];\r\n\t    out[2] = a[2] * b[2];\r\n\t    out[3] = a[3] * b[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.multiply}\r\n\t * @function\r\n\t */\r\n\tvec4.mul = vec4.multiply;\r\n\t\r\n\t/**\r\n\t * Divides two vec4's\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.divide = function(out, a, b) {\r\n\t    out[0] = a[0] / b[0];\r\n\t    out[1] = a[1] / b[1];\r\n\t    out[2] = a[2] / b[2];\r\n\t    out[3] = a[3] / b[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.divide}\r\n\t * @function\r\n\t */\r\n\tvec4.div = vec4.divide;\r\n\t\r\n\t/**\r\n\t * Returns the minimum of two vec4's\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.min = function(out, a, b) {\r\n\t    out[0] = Math.min(a[0], b[0]);\r\n\t    out[1] = Math.min(a[1], b[1]);\r\n\t    out[2] = Math.min(a[2], b[2]);\r\n\t    out[3] = Math.min(a[3], b[3]);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the maximum of two vec4's\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.max = function(out, a, b) {\r\n\t    out[0] = Math.max(a[0], b[0]);\r\n\t    out[1] = Math.max(a[1], b[1]);\r\n\t    out[2] = Math.max(a[2], b[2]);\r\n\t    out[3] = Math.max(a[3], b[3]);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales a vec4 by a scalar number\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the vector to scale\r\n\t * @param {Number} b amount to scale the vector by\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.scale = function(out, a, b) {\r\n\t    out[0] = a[0] * b;\r\n\t    out[1] = a[1] * b;\r\n\t    out[2] = a[2] * b;\r\n\t    out[3] = a[3] * b;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two vec4's after scaling the second operand by a scalar value\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @param {Number} scale the amount to scale b by before adding\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.scaleAndAdd = function(out, a, b, scale) {\r\n\t    out[0] = a[0] + (b[0] * scale);\r\n\t    out[1] = a[1] + (b[1] * scale);\r\n\t    out[2] = a[2] + (b[2] * scale);\r\n\t    out[3] = a[3] + (b[3] * scale);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the euclidian distance between two vec4's\r\n\t *\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {Number} distance between a and b\r\n\t */\r\n\tvec4.distance = function(a, b) {\r\n\t    var x = b[0] - a[0],\r\n\t        y = b[1] - a[1],\r\n\t        z = b[2] - a[2],\r\n\t        w = b[3] - a[3];\r\n\t    return Math.sqrt(x*x + y*y + z*z + w*w);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.distance}\r\n\t * @function\r\n\t */\r\n\tvec4.dist = vec4.distance;\r\n\t\r\n\t/**\r\n\t * Calculates the squared euclidian distance between two vec4's\r\n\t *\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {Number} squared distance between a and b\r\n\t */\r\n\tvec4.squaredDistance = function(a, b) {\r\n\t    var x = b[0] - a[0],\r\n\t        y = b[1] - a[1],\r\n\t        z = b[2] - a[2],\r\n\t        w = b[3] - a[3];\r\n\t    return x*x + y*y + z*z + w*w;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.squaredDistance}\r\n\t * @function\r\n\t */\r\n\tvec4.sqrDist = vec4.squaredDistance;\r\n\t\r\n\t/**\r\n\t * Calculates the length of a vec4\r\n\t *\r\n\t * @param {vec4} a vector to calculate length of\r\n\t * @returns {Number} length of a\r\n\t */\r\n\tvec4.length = function (a) {\r\n\t    var x = a[0],\r\n\t        y = a[1],\r\n\t        z = a[2],\r\n\t        w = a[3];\r\n\t    return Math.sqrt(x*x + y*y + z*z + w*w);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.length}\r\n\t * @function\r\n\t */\r\n\tvec4.len = vec4.length;\r\n\t\r\n\t/**\r\n\t * Calculates the squared length of a vec4\r\n\t *\r\n\t * @param {vec4} a vector to calculate squared length of\r\n\t * @returns {Number} squared length of a\r\n\t */\r\n\tvec4.squaredLength = function (a) {\r\n\t    var x = a[0],\r\n\t        y = a[1],\r\n\t        z = a[2],\r\n\t        w = a[3];\r\n\t    return x*x + y*y + z*z + w*w;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link vec4.squaredLength}\r\n\t * @function\r\n\t */\r\n\tvec4.sqrLen = vec4.squaredLength;\r\n\t\r\n\t/**\r\n\t * Negates the components of a vec4\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a vector to negate\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.negate = function(out, a) {\r\n\t    out[0] = -a[0];\r\n\t    out[1] = -a[1];\r\n\t    out[2] = -a[2];\r\n\t    out[3] = -a[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns the inverse of the components of a vec4\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a vector to invert\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.inverse = function(out, a) {\r\n\t  out[0] = 1.0 / a[0];\r\n\t  out[1] = 1.0 / a[1];\r\n\t  out[2] = 1.0 / a[2];\r\n\t  out[3] = 1.0 / a[3];\r\n\t  return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Normalize a vec4\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a vector to normalize\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.normalize = function(out, a) {\r\n\t    var x = a[0],\r\n\t        y = a[1],\r\n\t        z = a[2],\r\n\t        w = a[3];\r\n\t    var len = x*x + y*y + z*z + w*w;\r\n\t    if (len > 0) {\r\n\t        len = 1 / Math.sqrt(len);\r\n\t        out[0] = a[0] * len;\r\n\t        out[1] = a[1] * len;\r\n\t        out[2] = a[2] * len;\r\n\t        out[3] = a[3] * len;\r\n\t    }\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the dot product of two vec4's\r\n\t *\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @returns {Number} dot product of a and b\r\n\t */\r\n\tvec4.dot = function (a, b) {\r\n\t    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Performs a linear interpolation between two vec4's\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the first operand\r\n\t * @param {vec4} b the second operand\r\n\t * @param {Number} t interpolation amount between the two inputs\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.lerp = function (out, a, b, t) {\r\n\t    var ax = a[0],\r\n\t        ay = a[1],\r\n\t        az = a[2],\r\n\t        aw = a[3];\r\n\t    out[0] = ax + t * (b[0] - ax);\r\n\t    out[1] = ay + t * (b[1] - ay);\r\n\t    out[2] = az + t * (b[2] - az);\r\n\t    out[3] = aw + t * (b[3] - aw);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a random vector with the given scale\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.random = function (out, scale) {\r\n\t    scale = scale || 1.0;\r\n\t\r\n\t    //TODO: This is a pretty awful way of doing this. Find something better.\r\n\t    out[0] = GLMAT_RANDOM();\r\n\t    out[1] = GLMAT_RANDOM();\r\n\t    out[2] = GLMAT_RANDOM();\r\n\t    out[3] = GLMAT_RANDOM();\r\n\t    vec4.normalize(out, out);\r\n\t    vec4.scale(out, out, scale);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec4 with a mat4.\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the vector to transform\r\n\t * @param {mat4} m matrix to transform with\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.transformMat4 = function(out, a, m) {\r\n\t    var x = a[0], y = a[1], z = a[2], w = a[3];\r\n\t    out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\r\n\t    out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\r\n\t    out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\r\n\t    out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transforms the vec4 with a quat\r\n\t *\r\n\t * @param {vec4} out the receiving vector\r\n\t * @param {vec4} a the vector to transform\r\n\t * @param {quat} q quaternion to transform with\r\n\t * @returns {vec4} out\r\n\t */\r\n\tvec4.transformQuat = function(out, a, q) {\r\n\t    var x = a[0], y = a[1], z = a[2],\r\n\t        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\r\n\t\r\n\t        // calculate quat * vec\r\n\t        ix = qw * x + qy * z - qz * y,\r\n\t        iy = qw * y + qz * x - qx * z,\r\n\t        iz = qw * z + qx * y - qy * x,\r\n\t        iw = -qx * x - qy * y - qz * z;\r\n\t\r\n\t    // calculate result * inverse quat\r\n\t    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n\t    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n\t    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Perform some operation over an array of vec4s.\r\n\t *\r\n\t * @param {Array} a the array of vectors to iterate over\r\n\t * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n\t * @param {Number} offset Number of elements to skip at the beginning of the array\r\n\t * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n\t * @param {Function} fn Function to call for each vector in the array\r\n\t * @param {Object} [arg] additional argument to pass to fn\r\n\t * @returns {Array} a\r\n\t * @function\r\n\t */\r\n\tvec4.forEach = (function() {\r\n\t    var vec = vec4.create();\r\n\t\r\n\t    return function(a, stride, offset, count, fn, arg) {\r\n\t        var i, l;\r\n\t        if(!stride) {\r\n\t            stride = 4;\r\n\t        }\r\n\t\r\n\t        if(!offset) {\r\n\t            offset = 0;\r\n\t        }\r\n\t        \r\n\t        if(count) {\r\n\t            l = Math.min((count * stride) + offset, a.length);\r\n\t        } else {\r\n\t            l = a.length;\r\n\t        }\r\n\t\r\n\t        for(i = offset; i < l; i += stride) {\r\n\t            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2]; vec[3] = a[i+3];\r\n\t            fn(vec, vec, arg);\r\n\t            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2]; a[i+3] = vec[3];\r\n\t        }\r\n\t        \r\n\t        return a;\r\n\t    };\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a vector\r\n\t *\r\n\t * @param {vec4} vec vector to represent as a string\r\n\t * @returns {String} string representation of the vector\r\n\t */\r\n\tvec4.str = function (a) {\r\n\t    return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n\t};\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.vec4 = vec4;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 2x2 Matrix\r\n\t * @name mat2\r\n\t */\r\n\t\r\n\tvar mat2 = {};\r\n\t\r\n\t/**\r\n\t * Creates a new identity mat2\r\n\t *\r\n\t * @returns {mat2} a new 2x2 matrix\r\n\t */\r\n\tmat2.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(4);\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new mat2 initialized with values from an existing matrix\r\n\t *\r\n\t * @param {mat2} a matrix to clone\r\n\t * @returns {mat2} a new 2x2 matrix\r\n\t */\r\n\tmat2.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(4);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one mat2 to another\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the source matrix\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set a mat2 to the identity matrix\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.identity = function(out) {\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transpose the values of a mat2\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the source matrix\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.transpose = function(out, a) {\r\n\t    // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n\t    if (out === a) {\r\n\t        var a1 = a[1];\r\n\t        out[1] = a[2];\r\n\t        out[2] = a1;\r\n\t    } else {\r\n\t        out[0] = a[0];\r\n\t        out[1] = a[2];\r\n\t        out[2] = a[1];\r\n\t        out[3] = a[3];\r\n\t    }\r\n\t    \r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Inverts a mat2\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the source matrix\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.invert = function(out, a) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n\t\r\n\t        // Calculate the determinant\r\n\t        det = a0 * a3 - a2 * a1;\r\n\t\r\n\t    if (!det) {\r\n\t        return null;\r\n\t    }\r\n\t    det = 1.0 / det;\r\n\t    \r\n\t    out[0] =  a3 * det;\r\n\t    out[1] = -a1 * det;\r\n\t    out[2] = -a2 * det;\r\n\t    out[3] =  a0 * det;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the adjugate of a mat2\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the source matrix\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.adjoint = function(out, a) {\r\n\t    // Caching this value is nessecary if out == a\r\n\t    var a0 = a[0];\r\n\t    out[0] =  a[3];\r\n\t    out[1] = -a[1];\r\n\t    out[2] = -a[2];\r\n\t    out[3] =  a0;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the determinant of a mat2\r\n\t *\r\n\t * @param {mat2} a the source matrix\r\n\t * @returns {Number} determinant of a\r\n\t */\r\n\tmat2.determinant = function (a) {\r\n\t    return a[0] * a[3] - a[2] * a[1];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Multiplies two mat2's\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the first operand\r\n\t * @param {mat2} b the second operand\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.multiply = function (out, a, b) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n\t    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\r\n\t    out[0] = a0 * b0 + a2 * b1;\r\n\t    out[1] = a1 * b0 + a3 * b1;\r\n\t    out[2] = a0 * b2 + a2 * b3;\r\n\t    out[3] = a1 * b2 + a3 * b3;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link mat2.multiply}\r\n\t * @function\r\n\t */\r\n\tmat2.mul = mat2.multiply;\r\n\t\r\n\t/**\r\n\t * Rotates a mat2 by the given angle\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @returns {mat2} out\r\n\t */\r\n\tmat2.rotate = function (out, a, rad) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n\t        s = Math.sin(rad),\r\n\t        c = Math.cos(rad);\r\n\t    out[0] = a0 *  c + a2 * s;\r\n\t    out[1] = a1 *  c + a3 * s;\r\n\t    out[2] = a0 * -s + a2 * c;\r\n\t    out[3] = a1 * -s + a3 * c;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales the mat2 by the dimensions in the given vec2\r\n\t *\r\n\t * @param {mat2} out the receiving matrix\r\n\t * @param {mat2} a the matrix to rotate\r\n\t * @param {vec2} v the vec2 to scale the matrix by\r\n\t * @returns {mat2} out\r\n\t **/\r\n\tmat2.scale = function(out, a, v) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n\t        v0 = v[0], v1 = v[1];\r\n\t    out[0] = a0 * v0;\r\n\t    out[1] = a1 * v0;\r\n\t    out[2] = a2 * v1;\r\n\t    out[3] = a3 * v1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a mat2\r\n\t *\r\n\t * @param {mat2} mat matrix to represent as a string\r\n\t * @returns {String} string representation of the matrix\r\n\t */\r\n\tmat2.str = function (a) {\r\n\t    return 'mat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns Frobenius norm of a mat2\r\n\t *\r\n\t * @param {mat2} a the matrix to calculate Frobenius norm of\r\n\t * @returns {Number} Frobenius norm\r\n\t */\r\n\tmat2.frob = function (a) {\r\n\t    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2)))\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n\t * @param {mat2} L the lower triangular matrix \r\n\t * @param {mat2} D the diagonal matrix \r\n\t * @param {mat2} U the upper triangular matrix \r\n\t * @param {mat2} a the input matrix to factorize\r\n\t */\r\n\t\r\n\tmat2.LDU = function (L, D, U, a) { \r\n\t    L[2] = a[2]/a[0]; \r\n\t    U[0] = a[0]; \r\n\t    U[1] = a[1]; \r\n\t    U[3] = a[3] - L[2] * U[1]; \r\n\t    return [L, D, U];       \r\n\t}; \r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.mat2 = mat2;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 2x3 Matrix\r\n\t * @name mat2d\r\n\t * \r\n\t * @description \r\n\t * A mat2d contains six elements defined as:\r\n\t * <pre>\r\n\t * [a, c, tx,\r\n\t *  b, d, ty]\r\n\t * </pre>\r\n\t * This is a short form for the 3x3 matrix:\r\n\t * <pre>\r\n\t * [a, c, tx,\r\n\t *  b, d, ty,\r\n\t *  0, 0, 1]\r\n\t * </pre>\r\n\t * The last row is ignored so the array is shorter and operations are faster.\r\n\t */\r\n\t\r\n\tvar mat2d = {};\r\n\t\r\n\t/**\r\n\t * Creates a new identity mat2d\r\n\t *\r\n\t * @returns {mat2d} a new 2x3 matrix\r\n\t */\r\n\tmat2d.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(6);\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 1;\r\n\t    out[4] = 0;\r\n\t    out[5] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new mat2d initialized with values from an existing matrix\r\n\t *\r\n\t * @param {mat2d} a matrix to clone\r\n\t * @returns {mat2d} a new 2x3 matrix\r\n\t */\r\n\tmat2d.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(6);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    out[4] = a[4];\r\n\t    out[5] = a[5];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one mat2d to another\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @param {mat2d} a the source matrix\r\n\t * @returns {mat2d} out\r\n\t */\r\n\tmat2d.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    out[4] = a[4];\r\n\t    out[5] = a[5];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set a mat2d to the identity matrix\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @returns {mat2d} out\r\n\t */\r\n\tmat2d.identity = function(out) {\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 1;\r\n\t    out[4] = 0;\r\n\t    out[5] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Inverts a mat2d\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @param {mat2d} a the source matrix\r\n\t * @returns {mat2d} out\r\n\t */\r\n\tmat2d.invert = function(out, a) {\r\n\t    var aa = a[0], ab = a[1], ac = a[2], ad = a[3],\r\n\t        atx = a[4], aty = a[5];\r\n\t\r\n\t    var det = aa * ad - ab * ac;\r\n\t    if(!det){\r\n\t        return null;\r\n\t    }\r\n\t    det = 1.0 / det;\r\n\t\r\n\t    out[0] = ad * det;\r\n\t    out[1] = -ab * det;\r\n\t    out[2] = -ac * det;\r\n\t    out[3] = aa * det;\r\n\t    out[4] = (ac * aty - ad * atx) * det;\r\n\t    out[5] = (ab * atx - aa * aty) * det;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the determinant of a mat2d\r\n\t *\r\n\t * @param {mat2d} a the source matrix\r\n\t * @returns {Number} determinant of a\r\n\t */\r\n\tmat2d.determinant = function (a) {\r\n\t    return a[0] * a[3] - a[1] * a[2];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Multiplies two mat2d's\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @param {mat2d} a the first operand\r\n\t * @param {mat2d} b the second operand\r\n\t * @returns {mat2d} out\r\n\t */\r\n\tmat2d.multiply = function (out, a, b) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n\t        b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5];\r\n\t    out[0] = a0 * b0 + a2 * b1;\r\n\t    out[1] = a1 * b0 + a3 * b1;\r\n\t    out[2] = a0 * b2 + a2 * b3;\r\n\t    out[3] = a1 * b2 + a3 * b3;\r\n\t    out[4] = a0 * b4 + a2 * b5 + a4;\r\n\t    out[5] = a1 * b4 + a3 * b5 + a5;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link mat2d.multiply}\r\n\t * @function\r\n\t */\r\n\tmat2d.mul = mat2d.multiply;\r\n\t\r\n\t\r\n\t/**\r\n\t * Rotates a mat2d by the given angle\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @param {mat2d} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @returns {mat2d} out\r\n\t */\r\n\tmat2d.rotate = function (out, a, rad) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n\t        s = Math.sin(rad),\r\n\t        c = Math.cos(rad);\r\n\t    out[0] = a0 *  c + a2 * s;\r\n\t    out[1] = a1 *  c + a3 * s;\r\n\t    out[2] = a0 * -s + a2 * c;\r\n\t    out[3] = a1 * -s + a3 * c;\r\n\t    out[4] = a4;\r\n\t    out[5] = a5;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales the mat2d by the dimensions in the given vec2\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @param {mat2d} a the matrix to translate\r\n\t * @param {vec2} v the vec2 to scale the matrix by\r\n\t * @returns {mat2d} out\r\n\t **/\r\n\tmat2d.scale = function(out, a, v) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n\t        v0 = v[0], v1 = v[1];\r\n\t    out[0] = a0 * v0;\r\n\t    out[1] = a1 * v0;\r\n\t    out[2] = a2 * v1;\r\n\t    out[3] = a3 * v1;\r\n\t    out[4] = a4;\r\n\t    out[5] = a5;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Translates the mat2d by the dimensions in the given vec2\r\n\t *\r\n\t * @param {mat2d} out the receiving matrix\r\n\t * @param {mat2d} a the matrix to translate\r\n\t * @param {vec2} v the vec2 to translate the matrix by\r\n\t * @returns {mat2d} out\r\n\t **/\r\n\tmat2d.translate = function(out, a, v) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n\t        v0 = v[0], v1 = v[1];\r\n\t    out[0] = a0;\r\n\t    out[1] = a1;\r\n\t    out[2] = a2;\r\n\t    out[3] = a3;\r\n\t    out[4] = a0 * v0 + a2 * v1 + a4;\r\n\t    out[5] = a1 * v0 + a3 * v1 + a5;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a mat2d\r\n\t *\r\n\t * @param {mat2d} a matrix to represent as a string\r\n\t * @returns {String} string representation of the matrix\r\n\t */\r\n\tmat2d.str = function (a) {\r\n\t    return 'mat2d(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + \r\n\t                    a[3] + ', ' + a[4] + ', ' + a[5] + ')';\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns Frobenius norm of a mat2d\r\n\t *\r\n\t * @param {mat2d} a the matrix to calculate Frobenius norm of\r\n\t * @returns {Number} Frobenius norm\r\n\t */\r\n\tmat2d.frob = function (a) { \r\n\t    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + 1))\r\n\t}; \r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.mat2d = mat2d;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 3x3 Matrix\r\n\t * @name mat3\r\n\t */\r\n\t\r\n\tvar mat3 = {};\r\n\t\r\n\t/**\r\n\t * Creates a new identity mat3\r\n\t *\r\n\t * @returns {mat3} a new 3x3 matrix\r\n\t */\r\n\tmat3.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(9);\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 1;\r\n\t    out[5] = 0;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copies the upper-left 3x3 values into the given mat3.\r\n\t *\r\n\t * @param {mat3} out the receiving 3x3 matrix\r\n\t * @param {mat4} a   the source 4x4 matrix\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.fromMat4 = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[4];\r\n\t    out[4] = a[5];\r\n\t    out[5] = a[6];\r\n\t    out[6] = a[8];\r\n\t    out[7] = a[9];\r\n\t    out[8] = a[10];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new mat3 initialized with values from an existing matrix\r\n\t *\r\n\t * @param {mat3} a matrix to clone\r\n\t * @returns {mat3} a new 3x3 matrix\r\n\t */\r\n\tmat3.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(9);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    out[4] = a[4];\r\n\t    out[5] = a[5];\r\n\t    out[6] = a[6];\r\n\t    out[7] = a[7];\r\n\t    out[8] = a[8];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one mat3 to another\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the source matrix\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    out[4] = a[4];\r\n\t    out[5] = a[5];\r\n\t    out[6] = a[6];\r\n\t    out[7] = a[7];\r\n\t    out[8] = a[8];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set a mat3 to the identity matrix\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.identity = function(out) {\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 1;\r\n\t    out[5] = 0;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transpose the values of a mat3\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the source matrix\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.transpose = function(out, a) {\r\n\t    // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n\t    if (out === a) {\r\n\t        var a01 = a[1], a02 = a[2], a12 = a[5];\r\n\t        out[1] = a[3];\r\n\t        out[2] = a[6];\r\n\t        out[3] = a01;\r\n\t        out[5] = a[7];\r\n\t        out[6] = a02;\r\n\t        out[7] = a12;\r\n\t    } else {\r\n\t        out[0] = a[0];\r\n\t        out[1] = a[3];\r\n\t        out[2] = a[6];\r\n\t        out[3] = a[1];\r\n\t        out[4] = a[4];\r\n\t        out[5] = a[7];\r\n\t        out[6] = a[2];\r\n\t        out[7] = a[5];\r\n\t        out[8] = a[8];\r\n\t    }\r\n\t    \r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Inverts a mat3\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the source matrix\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.invert = function(out, a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n\t        a10 = a[3], a11 = a[4], a12 = a[5],\r\n\t        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\t\r\n\t        b01 = a22 * a11 - a12 * a21,\r\n\t        b11 = -a22 * a10 + a12 * a20,\r\n\t        b21 = a21 * a10 - a11 * a20,\r\n\t\r\n\t        // Calculate the determinant\r\n\t        det = a00 * b01 + a01 * b11 + a02 * b21;\r\n\t\r\n\t    if (!det) { \r\n\t        return null; \r\n\t    }\r\n\t    det = 1.0 / det;\r\n\t\r\n\t    out[0] = b01 * det;\r\n\t    out[1] = (-a22 * a01 + a02 * a21) * det;\r\n\t    out[2] = (a12 * a01 - a02 * a11) * det;\r\n\t    out[3] = b11 * det;\r\n\t    out[4] = (a22 * a00 - a02 * a20) * det;\r\n\t    out[5] = (-a12 * a00 + a02 * a10) * det;\r\n\t    out[6] = b21 * det;\r\n\t    out[7] = (-a21 * a00 + a01 * a20) * det;\r\n\t    out[8] = (a11 * a00 - a01 * a10) * det;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the adjugate of a mat3\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the source matrix\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.adjoint = function(out, a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n\t        a10 = a[3], a11 = a[4], a12 = a[5],\r\n\t        a20 = a[6], a21 = a[7], a22 = a[8];\r\n\t\r\n\t    out[0] = (a11 * a22 - a12 * a21);\r\n\t    out[1] = (a02 * a21 - a01 * a22);\r\n\t    out[2] = (a01 * a12 - a02 * a11);\r\n\t    out[3] = (a12 * a20 - a10 * a22);\r\n\t    out[4] = (a00 * a22 - a02 * a20);\r\n\t    out[5] = (a02 * a10 - a00 * a12);\r\n\t    out[6] = (a10 * a21 - a11 * a20);\r\n\t    out[7] = (a01 * a20 - a00 * a21);\r\n\t    out[8] = (a00 * a11 - a01 * a10);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the determinant of a mat3\r\n\t *\r\n\t * @param {mat3} a the source matrix\r\n\t * @returns {Number} determinant of a\r\n\t */\r\n\tmat3.determinant = function (a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n\t        a10 = a[3], a11 = a[4], a12 = a[5],\r\n\t        a20 = a[6], a21 = a[7], a22 = a[8];\r\n\t\r\n\t    return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Multiplies two mat3's\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the first operand\r\n\t * @param {mat3} b the second operand\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.multiply = function (out, a, b) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n\t        a10 = a[3], a11 = a[4], a12 = a[5],\r\n\t        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\t\r\n\t        b00 = b[0], b01 = b[1], b02 = b[2],\r\n\t        b10 = b[3], b11 = b[4], b12 = b[5],\r\n\t        b20 = b[6], b21 = b[7], b22 = b[8];\r\n\t\r\n\t    out[0] = b00 * a00 + b01 * a10 + b02 * a20;\r\n\t    out[1] = b00 * a01 + b01 * a11 + b02 * a21;\r\n\t    out[2] = b00 * a02 + b01 * a12 + b02 * a22;\r\n\t\r\n\t    out[3] = b10 * a00 + b11 * a10 + b12 * a20;\r\n\t    out[4] = b10 * a01 + b11 * a11 + b12 * a21;\r\n\t    out[5] = b10 * a02 + b11 * a12 + b12 * a22;\r\n\t\r\n\t    out[6] = b20 * a00 + b21 * a10 + b22 * a20;\r\n\t    out[7] = b20 * a01 + b21 * a11 + b22 * a21;\r\n\t    out[8] = b20 * a02 + b21 * a12 + b22 * a22;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link mat3.multiply}\r\n\t * @function\r\n\t */\r\n\tmat3.mul = mat3.multiply;\r\n\t\r\n\t/**\r\n\t * Translate a mat3 by the given vector\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the matrix to translate\r\n\t * @param {vec2} v vector to translate by\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.translate = function(out, a, v) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n\t        a10 = a[3], a11 = a[4], a12 = a[5],\r\n\t        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\t        x = v[0], y = v[1];\r\n\t\r\n\t    out[0] = a00;\r\n\t    out[1] = a01;\r\n\t    out[2] = a02;\r\n\t\r\n\t    out[3] = a10;\r\n\t    out[4] = a11;\r\n\t    out[5] = a12;\r\n\t\r\n\t    out[6] = x * a00 + y * a10 + a20;\r\n\t    out[7] = x * a01 + y * a11 + a21;\r\n\t    out[8] = x * a02 + y * a12 + a22;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a mat3 by the given angle\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @returns {mat3} out\r\n\t */\r\n\tmat3.rotate = function (out, a, rad) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n\t        a10 = a[3], a11 = a[4], a12 = a[5],\r\n\t        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\t\r\n\t        s = Math.sin(rad),\r\n\t        c = Math.cos(rad);\r\n\t\r\n\t    out[0] = c * a00 + s * a10;\r\n\t    out[1] = c * a01 + s * a11;\r\n\t    out[2] = c * a02 + s * a12;\r\n\t\r\n\t    out[3] = c * a10 - s * a00;\r\n\t    out[4] = c * a11 - s * a01;\r\n\t    out[5] = c * a12 - s * a02;\r\n\t\r\n\t    out[6] = a20;\r\n\t    out[7] = a21;\r\n\t    out[8] = a22;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales the mat3 by the dimensions in the given vec2\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat3} a the matrix to rotate\r\n\t * @param {vec2} v the vec2 to scale the matrix by\r\n\t * @returns {mat3} out\r\n\t **/\r\n\tmat3.scale = function(out, a, v) {\r\n\t    var x = v[0], y = v[1];\r\n\t\r\n\t    out[0] = x * a[0];\r\n\t    out[1] = x * a[1];\r\n\t    out[2] = x * a[2];\r\n\t\r\n\t    out[3] = y * a[3];\r\n\t    out[4] = y * a[4];\r\n\t    out[5] = y * a[5];\r\n\t\r\n\t    out[6] = a[6];\r\n\t    out[7] = a[7];\r\n\t    out[8] = a[8];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copies the values from a mat2d into a mat3\r\n\t *\r\n\t * @param {mat3} out the receiving matrix\r\n\t * @param {mat2d} a the matrix to copy\r\n\t * @returns {mat3} out\r\n\t **/\r\n\tmat3.fromMat2d = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = 0;\r\n\t\r\n\t    out[3] = a[2];\r\n\t    out[4] = a[3];\r\n\t    out[5] = 0;\r\n\t\r\n\t    out[6] = a[4];\r\n\t    out[7] = a[5];\r\n\t    out[8] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t* Calculates a 3x3 matrix from the given quaternion\r\n\t*\r\n\t* @param {mat3} out mat3 receiving operation result\r\n\t* @param {quat} q Quaternion to create matrix from\r\n\t*\r\n\t* @returns {mat3} out\r\n\t*/\r\n\tmat3.fromQuat = function (out, q) {\r\n\t    var x = q[0], y = q[1], z = q[2], w = q[3],\r\n\t        x2 = x + x,\r\n\t        y2 = y + y,\r\n\t        z2 = z + z,\r\n\t\r\n\t        xx = x * x2,\r\n\t        yx = y * x2,\r\n\t        yy = y * y2,\r\n\t        zx = z * x2,\r\n\t        zy = z * y2,\r\n\t        zz = z * z2,\r\n\t        wx = w * x2,\r\n\t        wy = w * y2,\r\n\t        wz = w * z2;\r\n\t\r\n\t    out[0] = 1 - yy - zz;\r\n\t    out[3] = yx - wz;\r\n\t    out[6] = zx + wy;\r\n\t\r\n\t    out[1] = yx + wz;\r\n\t    out[4] = 1 - xx - zz;\r\n\t    out[7] = zy - wx;\r\n\t\r\n\t    out[2] = zx - wy;\r\n\t    out[5] = zy + wx;\r\n\t    out[8] = 1 - xx - yy;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n\t*\r\n\t* @param {mat3} out mat3 receiving operation result\r\n\t* @param {mat4} a Mat4 to derive the normal matrix from\r\n\t*\r\n\t* @returns {mat3} out\r\n\t*/\r\n\tmat3.normalFromMat4 = function (out, a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n\t        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n\t        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n\t        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\r\n\t\r\n\t        b00 = a00 * a11 - a01 * a10,\r\n\t        b01 = a00 * a12 - a02 * a10,\r\n\t        b02 = a00 * a13 - a03 * a10,\r\n\t        b03 = a01 * a12 - a02 * a11,\r\n\t        b04 = a01 * a13 - a03 * a11,\r\n\t        b05 = a02 * a13 - a03 * a12,\r\n\t        b06 = a20 * a31 - a21 * a30,\r\n\t        b07 = a20 * a32 - a22 * a30,\r\n\t        b08 = a20 * a33 - a23 * a30,\r\n\t        b09 = a21 * a32 - a22 * a31,\r\n\t        b10 = a21 * a33 - a23 * a31,\r\n\t        b11 = a22 * a33 - a23 * a32,\r\n\t\r\n\t        // Calculate the determinant\r\n\t        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\t\r\n\t    if (!det) { \r\n\t        return null; \r\n\t    }\r\n\t    det = 1.0 / det;\r\n\t\r\n\t    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n\t    out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n\t    out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\t\r\n\t    out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n\t    out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n\t    out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\t\r\n\t    out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n\t    out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n\t    out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a mat3\r\n\t *\r\n\t * @param {mat3} mat matrix to represent as a string\r\n\t * @returns {String} string representation of the matrix\r\n\t */\r\n\tmat3.str = function (a) {\r\n\t    return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + \r\n\t                    a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + \r\n\t                    a[6] + ', ' + a[7] + ', ' + a[8] + ')';\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns Frobenius norm of a mat3\r\n\t *\r\n\t * @param {mat3} a the matrix to calculate Frobenius norm of\r\n\t * @returns {Number} Frobenius norm\r\n\t */\r\n\tmat3.frob = function (a) {\r\n\t    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2)))\r\n\t};\r\n\t\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.mat3 = mat3;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class 4x4 Matrix\r\n\t * @name mat4\r\n\t */\r\n\t\r\n\tvar mat4 = {};\r\n\t\r\n\t/**\r\n\t * Creates a new identity mat4\r\n\t *\r\n\t * @returns {mat4} a new 4x4 matrix\r\n\t */\r\n\tmat4.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(16);\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 0;\r\n\t    out[5] = 1;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = 0;\r\n\t    out[9] = 0;\r\n\t    out[10] = 1;\r\n\t    out[11] = 0;\r\n\t    out[12] = 0;\r\n\t    out[13] = 0;\r\n\t    out[14] = 0;\r\n\t    out[15] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a new mat4 initialized with values from an existing matrix\r\n\t *\r\n\t * @param {mat4} a matrix to clone\r\n\t * @returns {mat4} a new 4x4 matrix\r\n\t */\r\n\tmat4.clone = function(a) {\r\n\t    var out = new GLMAT_ARRAY_TYPE(16);\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    out[4] = a[4];\r\n\t    out[5] = a[5];\r\n\t    out[6] = a[6];\r\n\t    out[7] = a[7];\r\n\t    out[8] = a[8];\r\n\t    out[9] = a[9];\r\n\t    out[10] = a[10];\r\n\t    out[11] = a[11];\r\n\t    out[12] = a[12];\r\n\t    out[13] = a[13];\r\n\t    out[14] = a[14];\r\n\t    out[15] = a[15];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Copy the values from one mat4 to another\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the source matrix\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.copy = function(out, a) {\r\n\t    out[0] = a[0];\r\n\t    out[1] = a[1];\r\n\t    out[2] = a[2];\r\n\t    out[3] = a[3];\r\n\t    out[4] = a[4];\r\n\t    out[5] = a[5];\r\n\t    out[6] = a[6];\r\n\t    out[7] = a[7];\r\n\t    out[8] = a[8];\r\n\t    out[9] = a[9];\r\n\t    out[10] = a[10];\r\n\t    out[11] = a[11];\r\n\t    out[12] = a[12];\r\n\t    out[13] = a[13];\r\n\t    out[14] = a[14];\r\n\t    out[15] = a[15];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Set a mat4 to the identity matrix\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.identity = function(out) {\r\n\t    out[0] = 1;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 0;\r\n\t    out[5] = 1;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = 0;\r\n\t    out[9] = 0;\r\n\t    out[10] = 1;\r\n\t    out[11] = 0;\r\n\t    out[12] = 0;\r\n\t    out[13] = 0;\r\n\t    out[14] = 0;\r\n\t    out[15] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Transpose the values of a mat4\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the source matrix\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.transpose = function(out, a) {\r\n\t    // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n\t    if (out === a) {\r\n\t        var a01 = a[1], a02 = a[2], a03 = a[3],\r\n\t            a12 = a[6], a13 = a[7],\r\n\t            a23 = a[11];\r\n\t\r\n\t        out[1] = a[4];\r\n\t        out[2] = a[8];\r\n\t        out[3] = a[12];\r\n\t        out[4] = a01;\r\n\t        out[6] = a[9];\r\n\t        out[7] = a[13];\r\n\t        out[8] = a02;\r\n\t        out[9] = a12;\r\n\t        out[11] = a[14];\r\n\t        out[12] = a03;\r\n\t        out[13] = a13;\r\n\t        out[14] = a23;\r\n\t    } else {\r\n\t        out[0] = a[0];\r\n\t        out[1] = a[4];\r\n\t        out[2] = a[8];\r\n\t        out[3] = a[12];\r\n\t        out[4] = a[1];\r\n\t        out[5] = a[5];\r\n\t        out[6] = a[9];\r\n\t        out[7] = a[13];\r\n\t        out[8] = a[2];\r\n\t        out[9] = a[6];\r\n\t        out[10] = a[10];\r\n\t        out[11] = a[14];\r\n\t        out[12] = a[3];\r\n\t        out[13] = a[7];\r\n\t        out[14] = a[11];\r\n\t        out[15] = a[15];\r\n\t    }\r\n\t    \r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Inverts a mat4\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the source matrix\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.invert = function(out, a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n\t        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n\t        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n\t        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\r\n\t\r\n\t        b00 = a00 * a11 - a01 * a10,\r\n\t        b01 = a00 * a12 - a02 * a10,\r\n\t        b02 = a00 * a13 - a03 * a10,\r\n\t        b03 = a01 * a12 - a02 * a11,\r\n\t        b04 = a01 * a13 - a03 * a11,\r\n\t        b05 = a02 * a13 - a03 * a12,\r\n\t        b06 = a20 * a31 - a21 * a30,\r\n\t        b07 = a20 * a32 - a22 * a30,\r\n\t        b08 = a20 * a33 - a23 * a30,\r\n\t        b09 = a21 * a32 - a22 * a31,\r\n\t        b10 = a21 * a33 - a23 * a31,\r\n\t        b11 = a22 * a33 - a23 * a32,\r\n\t\r\n\t        // Calculate the determinant\r\n\t        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\t\r\n\t    if (!det) { \r\n\t        return null; \r\n\t    }\r\n\t    det = 1.0 / det;\r\n\t\r\n\t    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n\t    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n\t    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n\t    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\r\n\t    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n\t    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n\t    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n\t    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\r\n\t    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\t    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\t    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\t    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\r\n\t    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\r\n\t    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\r\n\t    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\r\n\t    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the adjugate of a mat4\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the source matrix\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.adjoint = function(out, a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n\t        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n\t        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n\t        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\t\r\n\t    out[0]  =  (a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22));\r\n\t    out[1]  = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\r\n\t    out[2]  =  (a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12));\r\n\t    out[3]  = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\r\n\t    out[4]  = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\r\n\t    out[5]  =  (a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22));\r\n\t    out[6]  = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\r\n\t    out[7]  =  (a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12));\r\n\t    out[8]  =  (a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21));\r\n\t    out[9]  = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\r\n\t    out[10] =  (a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11));\r\n\t    out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\r\n\t    out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\r\n\t    out[13] =  (a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21));\r\n\t    out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\r\n\t    out[15] =  (a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11));\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the determinant of a mat4\r\n\t *\r\n\t * @param {mat4} a the source matrix\r\n\t * @returns {Number} determinant of a\r\n\t */\r\n\tmat4.determinant = function (a) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n\t        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n\t        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n\t        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\r\n\t\r\n\t        b00 = a00 * a11 - a01 * a10,\r\n\t        b01 = a00 * a12 - a02 * a10,\r\n\t        b02 = a00 * a13 - a03 * a10,\r\n\t        b03 = a01 * a12 - a02 * a11,\r\n\t        b04 = a01 * a13 - a03 * a11,\r\n\t        b05 = a02 * a13 - a03 * a12,\r\n\t        b06 = a20 * a31 - a21 * a30,\r\n\t        b07 = a20 * a32 - a22 * a30,\r\n\t        b08 = a20 * a33 - a23 * a30,\r\n\t        b09 = a21 * a32 - a22 * a31,\r\n\t        b10 = a21 * a33 - a23 * a31,\r\n\t        b11 = a22 * a33 - a23 * a32;\r\n\t\r\n\t    // Calculate the determinant\r\n\t    return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Multiplies two mat4's\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the first operand\r\n\t * @param {mat4} b the second operand\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.multiply = function (out, a, b) {\r\n\t    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n\t        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n\t        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n\t        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\t\r\n\t    // Cache only the current line of the second matrix\r\n\t    var b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];  \r\n\t    out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n\t    out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n\t    out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n\t    out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\t\r\n\t    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\r\n\t    out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n\t    out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n\t    out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n\t    out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\t\r\n\t    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\r\n\t    out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n\t    out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n\t    out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n\t    out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\t\r\n\t    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\r\n\t    out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n\t    out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n\t    out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n\t    out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link mat4.multiply}\r\n\t * @function\r\n\t */\r\n\tmat4.mul = mat4.multiply;\r\n\t\r\n\t/**\r\n\t * Translate a mat4 by the given vector\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to translate\r\n\t * @param {vec3} v vector to translate by\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.translate = function (out, a, v) {\r\n\t    var x = v[0], y = v[1], z = v[2],\r\n\t        a00, a01, a02, a03,\r\n\t        a10, a11, a12, a13,\r\n\t        a20, a21, a22, a23;\r\n\t\r\n\t    if (a === out) {\r\n\t        out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\r\n\t        out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\r\n\t        out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\r\n\t        out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\r\n\t    } else {\r\n\t        a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\r\n\t        a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\r\n\t        a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\r\n\t\r\n\t        out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\r\n\t        out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\r\n\t        out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\r\n\t\r\n\t        out[12] = a00 * x + a10 * y + a20 * z + a[12];\r\n\t        out[13] = a01 * x + a11 * y + a21 * z + a[13];\r\n\t        out[14] = a02 * x + a12 * y + a22 * z + a[14];\r\n\t        out[15] = a03 * x + a13 * y + a23 * z + a[15];\r\n\t    }\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Scales the mat4 by the dimensions in the given vec3\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to scale\r\n\t * @param {vec3} v the vec3 to scale the matrix by\r\n\t * @returns {mat4} out\r\n\t **/\r\n\tmat4.scale = function(out, a, v) {\r\n\t    var x = v[0], y = v[1], z = v[2];\r\n\t\r\n\t    out[0] = a[0] * x;\r\n\t    out[1] = a[1] * x;\r\n\t    out[2] = a[2] * x;\r\n\t    out[3] = a[3] * x;\r\n\t    out[4] = a[4] * y;\r\n\t    out[5] = a[5] * y;\r\n\t    out[6] = a[6] * y;\r\n\t    out[7] = a[7] * y;\r\n\t    out[8] = a[8] * z;\r\n\t    out[9] = a[9] * z;\r\n\t    out[10] = a[10] * z;\r\n\t    out[11] = a[11] * z;\r\n\t    out[12] = a[12];\r\n\t    out[13] = a[13];\r\n\t    out[14] = a[14];\r\n\t    out[15] = a[15];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a mat4 by the given angle\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @param {vec3} axis the axis to rotate around\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.rotate = function (out, a, rad, axis) {\r\n\t    var x = axis[0], y = axis[1], z = axis[2],\r\n\t        len = Math.sqrt(x * x + y * y + z * z),\r\n\t        s, c, t,\r\n\t        a00, a01, a02, a03,\r\n\t        a10, a11, a12, a13,\r\n\t        a20, a21, a22, a23,\r\n\t        b00, b01, b02,\r\n\t        b10, b11, b12,\r\n\t        b20, b21, b22;\r\n\t\r\n\t    if (Math.abs(len) < GLMAT_EPSILON) { return null; }\r\n\t    \r\n\t    len = 1 / len;\r\n\t    x *= len;\r\n\t    y *= len;\r\n\t    z *= len;\r\n\t\r\n\t    s = Math.sin(rad);\r\n\t    c = Math.cos(rad);\r\n\t    t = 1 - c;\r\n\t\r\n\t    a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\r\n\t    a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\r\n\t    a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\r\n\t\r\n\t    // Construct the elements of the rotation matrix\r\n\t    b00 = x * x * t + c; b01 = y * x * t + z * s; b02 = z * x * t - y * s;\r\n\t    b10 = x * y * t - z * s; b11 = y * y * t + c; b12 = z * y * t + x * s;\r\n\t    b20 = x * z * t + y * s; b21 = y * z * t - x * s; b22 = z * z * t + c;\r\n\t\r\n\t    // Perform rotation-specific matrix multiplication\r\n\t    out[0] = a00 * b00 + a10 * b01 + a20 * b02;\r\n\t    out[1] = a01 * b00 + a11 * b01 + a21 * b02;\r\n\t    out[2] = a02 * b00 + a12 * b01 + a22 * b02;\r\n\t    out[3] = a03 * b00 + a13 * b01 + a23 * b02;\r\n\t    out[4] = a00 * b10 + a10 * b11 + a20 * b12;\r\n\t    out[5] = a01 * b10 + a11 * b11 + a21 * b12;\r\n\t    out[6] = a02 * b10 + a12 * b11 + a22 * b12;\r\n\t    out[7] = a03 * b10 + a13 * b11 + a23 * b12;\r\n\t    out[8] = a00 * b20 + a10 * b21 + a20 * b22;\r\n\t    out[9] = a01 * b20 + a11 * b21 + a21 * b22;\r\n\t    out[10] = a02 * b20 + a12 * b21 + a22 * b22;\r\n\t    out[11] = a03 * b20 + a13 * b21 + a23 * b22;\r\n\t\r\n\t    if (a !== out) { // If the source and destination differ, copy the unchanged last row\r\n\t        out[12] = a[12];\r\n\t        out[13] = a[13];\r\n\t        out[14] = a[14];\r\n\t        out[15] = a[15];\r\n\t    }\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a matrix by the given angle around the X axis\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.rotateX = function (out, a, rad) {\r\n\t    var s = Math.sin(rad),\r\n\t        c = Math.cos(rad),\r\n\t        a10 = a[4],\r\n\t        a11 = a[5],\r\n\t        a12 = a[6],\r\n\t        a13 = a[7],\r\n\t        a20 = a[8],\r\n\t        a21 = a[9],\r\n\t        a22 = a[10],\r\n\t        a23 = a[11];\r\n\t\r\n\t    if (a !== out) { // If the source and destination differ, copy the unchanged rows\r\n\t        out[0]  = a[0];\r\n\t        out[1]  = a[1];\r\n\t        out[2]  = a[2];\r\n\t        out[3]  = a[3];\r\n\t        out[12] = a[12];\r\n\t        out[13] = a[13];\r\n\t        out[14] = a[14];\r\n\t        out[15] = a[15];\r\n\t    }\r\n\t\r\n\t    // Perform axis-specific matrix multiplication\r\n\t    out[4] = a10 * c + a20 * s;\r\n\t    out[5] = a11 * c + a21 * s;\r\n\t    out[6] = a12 * c + a22 * s;\r\n\t    out[7] = a13 * c + a23 * s;\r\n\t    out[8] = a20 * c - a10 * s;\r\n\t    out[9] = a21 * c - a11 * s;\r\n\t    out[10] = a22 * c - a12 * s;\r\n\t    out[11] = a23 * c - a13 * s;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a matrix by the given angle around the Y axis\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.rotateY = function (out, a, rad) {\r\n\t    var s = Math.sin(rad),\r\n\t        c = Math.cos(rad),\r\n\t        a00 = a[0],\r\n\t        a01 = a[1],\r\n\t        a02 = a[2],\r\n\t        a03 = a[3],\r\n\t        a20 = a[8],\r\n\t        a21 = a[9],\r\n\t        a22 = a[10],\r\n\t        a23 = a[11];\r\n\t\r\n\t    if (a !== out) { // If the source and destination differ, copy the unchanged rows\r\n\t        out[4]  = a[4];\r\n\t        out[5]  = a[5];\r\n\t        out[6]  = a[6];\r\n\t        out[7]  = a[7];\r\n\t        out[12] = a[12];\r\n\t        out[13] = a[13];\r\n\t        out[14] = a[14];\r\n\t        out[15] = a[15];\r\n\t    }\r\n\t\r\n\t    // Perform axis-specific matrix multiplication\r\n\t    out[0] = a00 * c - a20 * s;\r\n\t    out[1] = a01 * c - a21 * s;\r\n\t    out[2] = a02 * c - a22 * s;\r\n\t    out[3] = a03 * c - a23 * s;\r\n\t    out[8] = a00 * s + a20 * c;\r\n\t    out[9] = a01 * s + a21 * c;\r\n\t    out[10] = a02 * s + a22 * c;\r\n\t    out[11] = a03 * s + a23 * c;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a matrix by the given angle around the Z axis\r\n\t *\r\n\t * @param {mat4} out the receiving matrix\r\n\t * @param {mat4} a the matrix to rotate\r\n\t * @param {Number} rad the angle to rotate the matrix by\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.rotateZ = function (out, a, rad) {\r\n\t    var s = Math.sin(rad),\r\n\t        c = Math.cos(rad),\r\n\t        a00 = a[0],\r\n\t        a01 = a[1],\r\n\t        a02 = a[2],\r\n\t        a03 = a[3],\r\n\t        a10 = a[4],\r\n\t        a11 = a[5],\r\n\t        a12 = a[6],\r\n\t        a13 = a[7];\r\n\t\r\n\t    if (a !== out) { // If the source and destination differ, copy the unchanged last row\r\n\t        out[8]  = a[8];\r\n\t        out[9]  = a[9];\r\n\t        out[10] = a[10];\r\n\t        out[11] = a[11];\r\n\t        out[12] = a[12];\r\n\t        out[13] = a[13];\r\n\t        out[14] = a[14];\r\n\t        out[15] = a[15];\r\n\t    }\r\n\t\r\n\t    // Perform axis-specific matrix multiplication\r\n\t    out[0] = a00 * c + a10 * s;\r\n\t    out[1] = a01 * c + a11 * s;\r\n\t    out[2] = a02 * c + a12 * s;\r\n\t    out[3] = a03 * c + a13 * s;\r\n\t    out[4] = a10 * c - a00 * s;\r\n\t    out[5] = a11 * c - a01 * s;\r\n\t    out[6] = a12 * c - a02 * s;\r\n\t    out[7] = a13 * c - a03 * s;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a matrix from a quaternion rotation and vector translation\r\n\t * This is equivalent to (but much faster than):\r\n\t *\r\n\t *     mat4.identity(dest);\r\n\t *     mat4.translate(dest, vec);\r\n\t *     var quatMat = mat4.create();\r\n\t *     quat4.toMat4(quat, quatMat);\r\n\t *     mat4.multiply(dest, quatMat);\r\n\t *\r\n\t * @param {mat4} out mat4 receiving operation result\r\n\t * @param {quat4} q Rotation quaternion\r\n\t * @param {vec3} v Translation vector\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.fromRotationTranslation = function (out, q, v) {\r\n\t    // Quaternion math\r\n\t    var x = q[0], y = q[1], z = q[2], w = q[3],\r\n\t        x2 = x + x,\r\n\t        y2 = y + y,\r\n\t        z2 = z + z,\r\n\t\r\n\t        xx = x * x2,\r\n\t        xy = x * y2,\r\n\t        xz = x * z2,\r\n\t        yy = y * y2,\r\n\t        yz = y * z2,\r\n\t        zz = z * z2,\r\n\t        wx = w * x2,\r\n\t        wy = w * y2,\r\n\t        wz = w * z2;\r\n\t\r\n\t    out[0] = 1 - (yy + zz);\r\n\t    out[1] = xy + wz;\r\n\t    out[2] = xz - wy;\r\n\t    out[3] = 0;\r\n\t    out[4] = xy - wz;\r\n\t    out[5] = 1 - (xx + zz);\r\n\t    out[6] = yz + wx;\r\n\t    out[7] = 0;\r\n\t    out[8] = xz + wy;\r\n\t    out[9] = yz - wx;\r\n\t    out[10] = 1 - (xx + yy);\r\n\t    out[11] = 0;\r\n\t    out[12] = v[0];\r\n\t    out[13] = v[1];\r\n\t    out[14] = v[2];\r\n\t    out[15] = 1;\r\n\t    \r\n\t    return out;\r\n\t};\r\n\t\r\n\tmat4.fromQuat = function (out, q) {\r\n\t    var x = q[0], y = q[1], z = q[2], w = q[3],\r\n\t        x2 = x + x,\r\n\t        y2 = y + y,\r\n\t        z2 = z + z,\r\n\t\r\n\t        xx = x * x2,\r\n\t        yx = y * x2,\r\n\t        yy = y * y2,\r\n\t        zx = z * x2,\r\n\t        zy = z * y2,\r\n\t        zz = z * z2,\r\n\t        wx = w * x2,\r\n\t        wy = w * y2,\r\n\t        wz = w * z2;\r\n\t\r\n\t    out[0] = 1 - yy - zz;\r\n\t    out[1] = yx + wz;\r\n\t    out[2] = zx - wy;\r\n\t    out[3] = 0;\r\n\t\r\n\t    out[4] = yx - wz;\r\n\t    out[5] = 1 - xx - zz;\r\n\t    out[6] = zy + wx;\r\n\t    out[7] = 0;\r\n\t\r\n\t    out[8] = zx + wy;\r\n\t    out[9] = zy - wx;\r\n\t    out[10] = 1 - xx - yy;\r\n\t    out[11] = 0;\r\n\t\r\n\t    out[12] = 0;\r\n\t    out[13] = 0;\r\n\t    out[14] = 0;\r\n\t    out[15] = 1;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a frustum matrix with the given bounds\r\n\t *\r\n\t * @param {mat4} out mat4 frustum matrix will be written into\r\n\t * @param {Number} left Left bound of the frustum\r\n\t * @param {Number} right Right bound of the frustum\r\n\t * @param {Number} bottom Bottom bound of the frustum\r\n\t * @param {Number} top Top bound of the frustum\r\n\t * @param {Number} near Near bound of the frustum\r\n\t * @param {Number} far Far bound of the frustum\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.frustum = function (out, left, right, bottom, top, near, far) {\r\n\t    var rl = 1 / (right - left),\r\n\t        tb = 1 / (top - bottom),\r\n\t        nf = 1 / (near - far);\r\n\t    out[0] = (near * 2) * rl;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 0;\r\n\t    out[5] = (near * 2) * tb;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = (right + left) * rl;\r\n\t    out[9] = (top + bottom) * tb;\r\n\t    out[10] = (far + near) * nf;\r\n\t    out[11] = -1;\r\n\t    out[12] = 0;\r\n\t    out[13] = 0;\r\n\t    out[14] = (far * near * 2) * nf;\r\n\t    out[15] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a perspective projection matrix with the given bounds\r\n\t *\r\n\t * @param {mat4} out mat4 frustum matrix will be written into\r\n\t * @param {number} fovy Vertical field of view in radians\r\n\t * @param {number} aspect Aspect ratio. typically viewport width/height\r\n\t * @param {number} near Near bound of the frustum\r\n\t * @param {number} far Far bound of the frustum\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.perspective = function (out, fovy, aspect, near, far) {\r\n\t    var f = 1.0 / Math.tan(fovy / 2),\r\n\t        nf = 1 / (near - far);\r\n\t    out[0] = f / aspect;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 0;\r\n\t    out[5] = f;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = 0;\r\n\t    out[9] = 0;\r\n\t    out[10] = (far + near) * nf;\r\n\t    out[11] = -1;\r\n\t    out[12] = 0;\r\n\t    out[13] = 0;\r\n\t    out[14] = (2 * far * near) * nf;\r\n\t    out[15] = 0;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a orthogonal projection matrix with the given bounds\r\n\t *\r\n\t * @param {mat4} out mat4 frustum matrix will be written into\r\n\t * @param {number} left Left bound of the frustum\r\n\t * @param {number} right Right bound of the frustum\r\n\t * @param {number} bottom Bottom bound of the frustum\r\n\t * @param {number} top Top bound of the frustum\r\n\t * @param {number} near Near bound of the frustum\r\n\t * @param {number} far Far bound of the frustum\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.ortho = function (out, left, right, bottom, top, near, far) {\r\n\t    var lr = 1 / (left - right),\r\n\t        bt = 1 / (bottom - top),\r\n\t        nf = 1 / (near - far);\r\n\t    out[0] = -2 * lr;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 0;\r\n\t    out[4] = 0;\r\n\t    out[5] = -2 * bt;\r\n\t    out[6] = 0;\r\n\t    out[7] = 0;\r\n\t    out[8] = 0;\r\n\t    out[9] = 0;\r\n\t    out[10] = 2 * nf;\r\n\t    out[11] = 0;\r\n\t    out[12] = (left + right) * lr;\r\n\t    out[13] = (top + bottom) * bt;\r\n\t    out[14] = (far + near) * nf;\r\n\t    out[15] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Generates a look-at matrix with the given eye position, focal point, and up axis\r\n\t *\r\n\t * @param {mat4} out mat4 frustum matrix will be written into\r\n\t * @param {vec3} eye Position of the viewer\r\n\t * @param {vec3} center Point the viewer is looking at\r\n\t * @param {vec3} up vec3 pointing up\r\n\t * @returns {mat4} out\r\n\t */\r\n\tmat4.lookAt = function (out, eye, center, up) {\r\n\t    var x0, x1, x2, y0, y1, y2, z0, z1, z2, len,\r\n\t        eyex = eye[0],\r\n\t        eyey = eye[1],\r\n\t        eyez = eye[2],\r\n\t        upx = up[0],\r\n\t        upy = up[1],\r\n\t        upz = up[2],\r\n\t        centerx = center[0],\r\n\t        centery = center[1],\r\n\t        centerz = center[2];\r\n\t\r\n\t    if (Math.abs(eyex - centerx) < GLMAT_EPSILON &&\r\n\t        Math.abs(eyey - centery) < GLMAT_EPSILON &&\r\n\t        Math.abs(eyez - centerz) < GLMAT_EPSILON) {\r\n\t        return mat4.identity(out);\r\n\t    }\r\n\t\r\n\t    z0 = eyex - centerx;\r\n\t    z1 = eyey - centery;\r\n\t    z2 = eyez - centerz;\r\n\t\r\n\t    len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\r\n\t    z0 *= len;\r\n\t    z1 *= len;\r\n\t    z2 *= len;\r\n\t\r\n\t    x0 = upy * z2 - upz * z1;\r\n\t    x1 = upz * z0 - upx * z2;\r\n\t    x2 = upx * z1 - upy * z0;\r\n\t    len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\r\n\t    if (!len) {\r\n\t        x0 = 0;\r\n\t        x1 = 0;\r\n\t        x2 = 0;\r\n\t    } else {\r\n\t        len = 1 / len;\r\n\t        x0 *= len;\r\n\t        x1 *= len;\r\n\t        x2 *= len;\r\n\t    }\r\n\t\r\n\t    y0 = z1 * x2 - z2 * x1;\r\n\t    y1 = z2 * x0 - z0 * x2;\r\n\t    y2 = z0 * x1 - z1 * x0;\r\n\t\r\n\t    len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\r\n\t    if (!len) {\r\n\t        y0 = 0;\r\n\t        y1 = 0;\r\n\t        y2 = 0;\r\n\t    } else {\r\n\t        len = 1 / len;\r\n\t        y0 *= len;\r\n\t        y1 *= len;\r\n\t        y2 *= len;\r\n\t    }\r\n\t\r\n\t    out[0] = x0;\r\n\t    out[1] = y0;\r\n\t    out[2] = z0;\r\n\t    out[3] = 0;\r\n\t    out[4] = x1;\r\n\t    out[5] = y1;\r\n\t    out[6] = z1;\r\n\t    out[7] = 0;\r\n\t    out[8] = x2;\r\n\t    out[9] = y2;\r\n\t    out[10] = z2;\r\n\t    out[11] = 0;\r\n\t    out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\r\n\t    out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\r\n\t    out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\r\n\t    out[15] = 1;\r\n\t\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a mat4\r\n\t *\r\n\t * @param {mat4} mat matrix to represent as a string\r\n\t * @returns {String} string representation of the matrix\r\n\t */\r\n\tmat4.str = function (a) {\r\n\t    return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' +\r\n\t                    a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' +\r\n\t                    a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + \r\n\t                    a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns Frobenius norm of a mat4\r\n\t *\r\n\t * @param {mat4} a the matrix to calculate Frobenius norm of\r\n\t * @returns {Number} Frobenius norm\r\n\t */\r\n\tmat4.frob = function (a) {\r\n\t    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2) + Math.pow(a[9], 2) + Math.pow(a[10], 2) + Math.pow(a[11], 2) + Math.pow(a[12], 2) + Math.pow(a[13], 2) + Math.pow(a[14], 2) + Math.pow(a[15], 2) ))\r\n\t};\r\n\t\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.mat4 = mat4;\r\n\t}\r\n\t;\r\n\t/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\t\r\n\tRedistribution and use in source and binary forms, with or without modification,\r\n\tare permitted provided that the following conditions are met:\r\n\t\r\n\t  * Redistributions of source code must retain the above copyright notice, this\r\n\t    list of conditions and the following disclaimer.\r\n\t  * Redistributions in binary form must reproduce the above copyright notice,\r\n\t    this list of conditions and the following disclaimer in the documentation \r\n\t    and/or other materials provided with the distribution.\r\n\t\r\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n\tANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n\tWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\n\tDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n\t(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n\tLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\n\tANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n\tSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\t\r\n\t/**\r\n\t * @class Quaternion\r\n\t * @name quat\r\n\t */\r\n\t\r\n\tvar quat = {};\r\n\t\r\n\t/**\r\n\t * Creates a new identity quat\r\n\t *\r\n\t * @returns {quat} a new quaternion\r\n\t */\r\n\tquat.create = function() {\r\n\t    var out = new GLMAT_ARRAY_TYPE(4);\r\n\t    out[0] = 0;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Sets a quaternion to represent the shortest rotation from one\r\n\t * vector to another.\r\n\t *\r\n\t * Both vectors are assumed to be unit length.\r\n\t *\r\n\t * @param {quat} out the receiving quaternion.\r\n\t * @param {vec3} a the initial vector\r\n\t * @param {vec3} b the destination vector\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.rotationTo = (function() {\r\n\t    var tmpvec3 = vec3.create();\r\n\t    var xUnitVec3 = vec3.fromValues(1,0,0);\r\n\t    var yUnitVec3 = vec3.fromValues(0,1,0);\r\n\t\r\n\t    return function(out, a, b) {\r\n\t        var dot = vec3.dot(a, b);\r\n\t        if (dot < -0.999999) {\r\n\t            vec3.cross(tmpvec3, xUnitVec3, a);\r\n\t            if (vec3.length(tmpvec3) < 0.000001)\r\n\t                vec3.cross(tmpvec3, yUnitVec3, a);\r\n\t            vec3.normalize(tmpvec3, tmpvec3);\r\n\t            quat.setAxisAngle(out, tmpvec3, Math.PI);\r\n\t            return out;\r\n\t        } else if (dot > 0.999999) {\r\n\t            out[0] = 0;\r\n\t            out[1] = 0;\r\n\t            out[2] = 0;\r\n\t            out[3] = 1;\r\n\t            return out;\r\n\t        } else {\r\n\t            vec3.cross(tmpvec3, a, b);\r\n\t            out[0] = tmpvec3[0];\r\n\t            out[1] = tmpvec3[1];\r\n\t            out[2] = tmpvec3[2];\r\n\t            out[3] = 1 + dot;\r\n\t            return quat.normalize(out, out);\r\n\t        }\r\n\t    };\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Sets the specified quaternion with values corresponding to the given\r\n\t * axes. Each axis is a vec3 and is expected to be unit length and\r\n\t * perpendicular to all other specified axes.\r\n\t *\r\n\t * @param {vec3} view  the vector representing the viewing direction\r\n\t * @param {vec3} right the vector representing the local \"right\" direction\r\n\t * @param {vec3} up    the vector representing the local \"up\" direction\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.setAxes = (function() {\r\n\t    var matr = mat3.create();\r\n\t\r\n\t    return function(out, view, right, up) {\r\n\t        matr[0] = right[0];\r\n\t        matr[3] = right[1];\r\n\t        matr[6] = right[2];\r\n\t\r\n\t        matr[1] = up[0];\r\n\t        matr[4] = up[1];\r\n\t        matr[7] = up[2];\r\n\t\r\n\t        matr[2] = -view[0];\r\n\t        matr[5] = -view[1];\r\n\t        matr[8] = -view[2];\r\n\t\r\n\t        return quat.normalize(out, quat.fromMat3(out, matr));\r\n\t    };\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Creates a new quat initialized with values from an existing quaternion\r\n\t *\r\n\t * @param {quat} a quaternion to clone\r\n\t * @returns {quat} a new quaternion\r\n\t * @function\r\n\t */\r\n\tquat.clone = vec4.clone;\r\n\t\r\n\t/**\r\n\t * Creates a new quat initialized with the given values\r\n\t *\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @param {Number} z Z component\r\n\t * @param {Number} w W component\r\n\t * @returns {quat} a new quaternion\r\n\t * @function\r\n\t */\r\n\tquat.fromValues = vec4.fromValues;\r\n\t\r\n\t/**\r\n\t * Copy the values from one quat to another\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a the source quaternion\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.copy = vec4.copy;\r\n\t\r\n\t/**\r\n\t * Set the components of a quat to the given values\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {Number} x X component\r\n\t * @param {Number} y Y component\r\n\t * @param {Number} z Z component\r\n\t * @param {Number} w W component\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.set = vec4.set;\r\n\t\r\n\t/**\r\n\t * Set a quat to the identity quaternion\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.identity = function(out) {\r\n\t    out[0] = 0;\r\n\t    out[1] = 0;\r\n\t    out[2] = 0;\r\n\t    out[3] = 1;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Sets a quat from the given angle and rotation axis,\r\n\t * then returns it.\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {vec3} axis the axis around which to rotate\r\n\t * @param {Number} rad the angle in radians\r\n\t * @returns {quat} out\r\n\t **/\r\n\tquat.setAxisAngle = function(out, axis, rad) {\r\n\t    rad = rad * 0.5;\r\n\t    var s = Math.sin(rad);\r\n\t    out[0] = s * axis[0];\r\n\t    out[1] = s * axis[1];\r\n\t    out[2] = s * axis[2];\r\n\t    out[3] = Math.cos(rad);\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Adds two quat's\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a the first operand\r\n\t * @param {quat} b the second operand\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.add = vec4.add;\r\n\t\r\n\t/**\r\n\t * Multiplies two quat's\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a the first operand\r\n\t * @param {quat} b the second operand\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.multiply = function(out, a, b) {\r\n\t    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n\t        bx = b[0], by = b[1], bz = b[2], bw = b[3];\r\n\t\r\n\t    out[0] = ax * bw + aw * bx + ay * bz - az * by;\r\n\t    out[1] = ay * bw + aw * by + az * bx - ax * bz;\r\n\t    out[2] = az * bw + aw * bz + ax * by - ay * bx;\r\n\t    out[3] = aw * bw - ax * bx - ay * by - az * bz;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Alias for {@link quat.multiply}\r\n\t * @function\r\n\t */\r\n\tquat.mul = quat.multiply;\r\n\t\r\n\t/**\r\n\t * Scales a quat by a scalar number\r\n\t *\r\n\t * @param {quat} out the receiving vector\r\n\t * @param {quat} a the vector to scale\r\n\t * @param {Number} b amount to scale the vector by\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.scale = vec4.scale;\r\n\t\r\n\t/**\r\n\t * Rotates a quaternion by the given angle about the X axis\r\n\t *\r\n\t * @param {quat} out quat receiving operation result\r\n\t * @param {quat} a quat to rotate\r\n\t * @param {number} rad angle (in radians) to rotate\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.rotateX = function (out, a, rad) {\r\n\t    rad *= 0.5; \r\n\t\r\n\t    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n\t        bx = Math.sin(rad), bw = Math.cos(rad);\r\n\t\r\n\t    out[0] = ax * bw + aw * bx;\r\n\t    out[1] = ay * bw + az * bx;\r\n\t    out[2] = az * bw - ay * bx;\r\n\t    out[3] = aw * bw - ax * bx;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a quaternion by the given angle about the Y axis\r\n\t *\r\n\t * @param {quat} out quat receiving operation result\r\n\t * @param {quat} a quat to rotate\r\n\t * @param {number} rad angle (in radians) to rotate\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.rotateY = function (out, a, rad) {\r\n\t    rad *= 0.5; \r\n\t\r\n\t    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n\t        by = Math.sin(rad), bw = Math.cos(rad);\r\n\t\r\n\t    out[0] = ax * bw - az * by;\r\n\t    out[1] = ay * bw + aw * by;\r\n\t    out[2] = az * bw + ax * by;\r\n\t    out[3] = aw * bw - ay * by;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Rotates a quaternion by the given angle about the Z axis\r\n\t *\r\n\t * @param {quat} out quat receiving operation result\r\n\t * @param {quat} a quat to rotate\r\n\t * @param {number} rad angle (in radians) to rotate\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.rotateZ = function (out, a, rad) {\r\n\t    rad *= 0.5; \r\n\t\r\n\t    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n\t        bz = Math.sin(rad), bw = Math.cos(rad);\r\n\t\r\n\t    out[0] = ax * bw + ay * bz;\r\n\t    out[1] = ay * bw - ax * bz;\r\n\t    out[2] = az * bw + aw * bz;\r\n\t    out[3] = aw * bw - az * bz;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the W component of a quat from the X, Y, and Z components.\r\n\t * Assumes that quaternion is 1 unit in length.\r\n\t * Any existing W component will be ignored.\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a quat to calculate W component of\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.calculateW = function (out, a) {\r\n\t    var x = a[0], y = a[1], z = a[2];\r\n\t\r\n\t    out[0] = x;\r\n\t    out[1] = y;\r\n\t    out[2] = z;\r\n\t    out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the dot product of two quat's\r\n\t *\r\n\t * @param {quat} a the first operand\r\n\t * @param {quat} b the second operand\r\n\t * @returns {Number} dot product of a and b\r\n\t * @function\r\n\t */\r\n\tquat.dot = vec4.dot;\r\n\t\r\n\t/**\r\n\t * Performs a linear interpolation between two quat's\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a the first operand\r\n\t * @param {quat} b the second operand\r\n\t * @param {Number} t interpolation amount between the two inputs\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.lerp = vec4.lerp;\r\n\t\r\n\t/**\r\n\t * Performs a spherical linear interpolation between two quat\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a the first operand\r\n\t * @param {quat} b the second operand\r\n\t * @param {Number} t interpolation amount between the two inputs\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.slerp = function (out, a, b, t) {\r\n\t    // benchmarks:\r\n\t    //    http://jsperf.com/quaternion-slerp-implementations\r\n\t\r\n\t    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n\t        bx = b[0], by = b[1], bz = b[2], bw = b[3];\r\n\t\r\n\t    var        omega, cosom, sinom, scale0, scale1;\r\n\t\r\n\t    // calc cosine\r\n\t    cosom = ax * bx + ay * by + az * bz + aw * bw;\r\n\t    // adjust signs (if necessary)\r\n\t    if ( cosom < 0.0 ) {\r\n\t        cosom = -cosom;\r\n\t        bx = - bx;\r\n\t        by = - by;\r\n\t        bz = - bz;\r\n\t        bw = - bw;\r\n\t    }\r\n\t    // calculate coefficients\r\n\t    if ( (1.0 - cosom) > 0.000001 ) {\r\n\t        // standard case (slerp)\r\n\t        omega  = Math.acos(cosom);\r\n\t        sinom  = Math.sin(omega);\r\n\t        scale0 = Math.sin((1.0 - t) * omega) / sinom;\r\n\t        scale1 = Math.sin(t * omega) / sinom;\r\n\t    } else {        \r\n\t        // \"from\" and \"to\" quaternions are very close \r\n\t        //  ... so we can do a linear interpolation\r\n\t        scale0 = 1.0 - t;\r\n\t        scale1 = t;\r\n\t    }\r\n\t    // calculate final values\r\n\t    out[0] = scale0 * ax + scale1 * bx;\r\n\t    out[1] = scale0 * ay + scale1 * by;\r\n\t    out[2] = scale0 * az + scale1 * bz;\r\n\t    out[3] = scale0 * aw + scale1 * bw;\r\n\t    \r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the inverse of a quat\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a quat to calculate inverse of\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.invert = function(out, a) {\r\n\t    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n\t        dot = a0*a0 + a1*a1 + a2*a2 + a3*a3,\r\n\t        invDot = dot ? 1.0/dot : 0;\r\n\t    \r\n\t    // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\r\n\t\r\n\t    out[0] = -a0*invDot;\r\n\t    out[1] = -a1*invDot;\r\n\t    out[2] = -a2*invDot;\r\n\t    out[3] = a3*invDot;\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the conjugate of a quat\r\n\t * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a quat to calculate conjugate of\r\n\t * @returns {quat} out\r\n\t */\r\n\tquat.conjugate = function (out, a) {\r\n\t    out[0] = -a[0];\r\n\t    out[1] = -a[1];\r\n\t    out[2] = -a[2];\r\n\t    out[3] = a[3];\r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Calculates the length of a quat\r\n\t *\r\n\t * @param {quat} a vector to calculate length of\r\n\t * @returns {Number} length of a\r\n\t * @function\r\n\t */\r\n\tquat.length = vec4.length;\r\n\t\r\n\t/**\r\n\t * Alias for {@link quat.length}\r\n\t * @function\r\n\t */\r\n\tquat.len = quat.length;\r\n\t\r\n\t/**\r\n\t * Calculates the squared length of a quat\r\n\t *\r\n\t * @param {quat} a vector to calculate squared length of\r\n\t * @returns {Number} squared length of a\r\n\t * @function\r\n\t */\r\n\tquat.squaredLength = vec4.squaredLength;\r\n\t\r\n\t/**\r\n\t * Alias for {@link quat.squaredLength}\r\n\t * @function\r\n\t */\r\n\tquat.sqrLen = quat.squaredLength;\r\n\t\r\n\t/**\r\n\t * Normalize a quat\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {quat} a quaternion to normalize\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.normalize = vec4.normalize;\r\n\t\r\n\t/**\r\n\t * Creates a quaternion from the given 3x3 rotation matrix.\r\n\t *\r\n\t * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n\t * to renormalize the quaternion yourself where necessary.\r\n\t *\r\n\t * @param {quat} out the receiving quaternion\r\n\t * @param {mat3} m rotation matrix\r\n\t * @returns {quat} out\r\n\t * @function\r\n\t */\r\n\tquat.fromMat3 = function(out, m) {\r\n\t    // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\r\n\t    // article \"Quaternion Calculus and Fast Animation\".\r\n\t    var fTrace = m[0] + m[4] + m[8];\r\n\t    var fRoot;\r\n\t\r\n\t    if ( fTrace > 0.0 ) {\r\n\t        // |w| > 1/2, may as well choose w > 1/2\r\n\t        fRoot = Math.sqrt(fTrace + 1.0);  // 2w\r\n\t        out[3] = 0.5 * fRoot;\r\n\t        fRoot = 0.5/fRoot;  // 1/(4w)\r\n\t        out[0] = (m[5]-m[7])*fRoot;\r\n\t        out[1] = (m[6]-m[2])*fRoot;\r\n\t        out[2] = (m[1]-m[3])*fRoot;\r\n\t    } else {\r\n\t        // |w| <= 1/2\r\n\t        var i = 0;\r\n\t        if ( m[4] > m[0] )\r\n\t          i = 1;\r\n\t        if ( m[8] > m[i*3+i] )\r\n\t          i = 2;\r\n\t        var j = (i+1)%3;\r\n\t        var k = (i+2)%3;\r\n\t        \r\n\t        fRoot = Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k] + 1.0);\r\n\t        out[i] = 0.5 * fRoot;\r\n\t        fRoot = 0.5 / fRoot;\r\n\t        out[3] = (m[j*3+k] - m[k*3+j]) * fRoot;\r\n\t        out[j] = (m[j*3+i] + m[i*3+j]) * fRoot;\r\n\t        out[k] = (m[k*3+i] + m[i*3+k]) * fRoot;\r\n\t    }\r\n\t    \r\n\t    return out;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Returns a string representation of a quatenion\r\n\t *\r\n\t * @param {quat} vec vector to represent as a string\r\n\t * @returns {String} string representation of the vector\r\n\t */\r\n\tquat.str = function (a) {\r\n\t    return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n\t};\r\n\t\r\n\tif(typeof(exports) !== 'undefined') {\r\n\t    exports.quat = quat;\r\n\t}\r\n\t;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t  })(shim.exports);\r\n\t})(this);\r\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\t/*\r\n\t * Copyright 2010, Google Inc.\r\n\t * All rights reserved.\r\n\t *\r\n\t * Redistribution and use in source and binary forms, with or without\r\n\t * modification, are permitted provided that the following conditions are\r\n\t * met:\r\n\t *\r\n\t *     * Redistributions of source code must retain the above copyright\r\n\t * notice, this list of conditions and the following disclaimer.\r\n\t *     * Redistributions in binary form must reproduce the above\r\n\t * copyright notice, this list of conditions and the following disclaimer\r\n\t * in the documentation and/or other materials provided with the\r\n\t * distribution.\r\n\t *     * Neither the name of Google Inc. nor the names of its\r\n\t * contributors may be used to endorse or promote products derived from\r\n\t * this software without specific prior written permission.\r\n\t *\r\n\t * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n\t * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n\t * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n\t * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n\t * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n\t * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n\t * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n\t * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n\t * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n\t * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n\t * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n\t */\r\n\t\r\n\t\r\n\t/**\r\n\t * @fileoverview This file contains functions every webgl program will need\r\n\t * a version of one way or another.\r\n\t *\r\n\t * Instead of setting up a context manually it is recommended to\r\n\t * use. This will check for success or failure. On failure it\r\n\t * will attempt to present an approriate message to the user.\r\n\t *\r\n\t *       gl = WebGLUtils.setupWebGL(canvas);\r\n\t *\r\n\t * For animated WebGL apps use of setTimeout or setInterval are\r\n\t * discouraged. It is recommended you structure your rendering\r\n\t * loop like this.\r\n\t *\r\n\t *       function render() {\r\n\t *         window.requestAnimFrame(render, canvas);\r\n\t *\r\n\t *         // do rendering\r\n\t *         ...\r\n\t *       }\r\n\t *       render();\r\n\t *\r\n\t * This will call your rendering function up to the refresh rate\r\n\t * of your display but will stop rendering if your app is not\r\n\t * visible.\r\n\t */\r\n\t\r\n\tWebGLUtils = function() {\r\n\t\r\n\t/**\r\n\t * Creates the HTLM for a failure message\r\n\t * @param {string} canvasContainerId id of container of th\r\n\t *        canvas.\r\n\t * @return {string} The html.\r\n\t */\r\n\tvar makeFailHTML = function(msg) {\r\n\t  return '' +\r\n\t    '<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>' +\r\n\t    '<td align=\"center\">' +\r\n\t    '<div style=\"display: table-cell; vertical-align: middle;\">' +\r\n\t    '<div style=\"\">' + msg + '</div>' +\r\n\t    '</div>' +\r\n\t    '</td></tr></table>';\r\n\t};\r\n\t\r\n\t/**\r\n\t * Mesasge for getting a webgl browser\r\n\t * @type {string}\r\n\t */\r\n\tvar GET_A_WEBGL_BROWSER = '' +\r\n\t  'This page requires a browser that supports WebGL.<br/>' +\r\n\t  '<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>';\r\n\t\r\n\t/**\r\n\t * Mesasge for need better hardware\r\n\t * @type {string}\r\n\t */\r\n\tvar OTHER_PROBLEM = '' +\r\n\t  \"It doesn't appear your computer can support WebGL.<br/>\" +\r\n\t  '<a href=\"http://get.webgl.org/troubleshooting/\">Click here for more information.</a>';\r\n\t\r\n\t/**\r\n\t * Creates a webgl context. If creation fails it will\r\n\t * change the contents of the container of the <canvas>\r\n\t * tag to an error message with the correct links for WebGL.\r\n\t * @param {Element} canvas. The canvas element to create a\r\n\t *     context from.\r\n\t * @param {WebGLContextCreationAttirbutes} opt_attribs Any\r\n\t *     creation attributes you want to pass in.\r\n\t * @param {function:(msg)} opt_onError An function to call\r\n\t *     if there is an error during creation.\r\n\t * @return {WebGLRenderingContext} The created context.\r\n\t */\r\n\tvar setupWebGL = function(canvas, opt_attribs, opt_onError) {\r\n\t  function handleCreationError(msg) {\r\n\t    var container = canvas.parentNode;\r\n\t    if (container) {\r\n\t      var str = window.WebGLRenderingContext ?\r\n\t           OTHER_PROBLEM :\r\n\t           GET_A_WEBGL_BROWSER;\r\n\t      if (msg) {\r\n\t        str += \"<br/><br/>Status: \" + msg;\r\n\t      }\r\n\t      container.innerHTML = makeFailHTML(str);\r\n\t    }\r\n\t  };\r\n\t\r\n\t  opt_onError = opt_onError || handleCreationError;\r\n\t\r\n\t  if (canvas.addEventListener) {\r\n\t    canvas.addEventListener(\"webglcontextcreationerror\", function(event) {\r\n\t          opt_onError(event.statusMessage);\r\n\t        }, false);\r\n\t  }\r\n\t  var context = create3DContext(canvas, opt_attribs);\r\n\t  if (!context) {\r\n\t    if (!window.WebGLRenderingContext) {\r\n\t      opt_onError(\"\");\r\n\t    }\r\n\t  }\r\n\t  return context;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Creates a webgl context.\r\n\t * @param {!Canvas} canvas The canvas tag to get context\r\n\t *     from. If one is not passed in one will be created.\r\n\t * @return {!WebGLContext} The created context.\r\n\t */\r\n\tvar create3DContext = function(canvas, opt_attribs) {\r\n\t  var names = [\"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n\t  var context = null;\r\n\t  for (var ii = 0; ii < names.length; ++ii) {\r\n\t    try {\r\n\t      context = canvas.getContext(names[ii], opt_attribs);\r\n\t    } catch(e) {}\r\n\t    if (context) {\r\n\t      break;\r\n\t    }\r\n\t  }\r\n\t  return context;\r\n\t}\r\n\t\r\n\treturn {\r\n\t  create3DContext: create3DContext,\r\n\t  setupWebGL: setupWebGL\r\n\t};\r\n\t}();\r\n\t\r\n\t/**\r\n\t * Provides requestAnimationFrame in a cross browser way.\r\n\t */\r\n\twindow.requestAnimFrame = (function() {\r\n\t  return window.requestAnimationFrame ||\r\n\t         window.webkitRequestAnimationFrame ||\r\n\t         window.mozRequestAnimationFrame ||\r\n\t         window.oRequestAnimationFrame ||\r\n\t         window.msRequestAnimationFrame ||\r\n\t         function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {\r\n\t           window.setTimeout(callback, 1000/60);\r\n\t         };\r\n\t})();\r\n\t\r\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t/*\r\n\t* This file has been generated by spacker.exe utility. Do not change this file manualy as your changes\r\n\t* will get lost when the file is regenerated. Original content is located in *.c files.\r\n\t*/\r\n\texports.xCubeShaders = {\r\n\t    cube_fshader: ' precision mediump float; uniform float uAlpha; uniform sampler2D uTexture; uniform bool uColorCoding; uniform float uHighlighting; varying vec2 vTexCoord; varying vec4 vIdColor; void main(void) { if (uColorCoding) { gl_FragColor = vIdColor; } else { vec4 pixel = texture2D(uTexture, vTexCoord); if (vIdColor.x < 0.0) { gl_FragColor = vec4(pixel.rgb * uHighlighting, uAlpha); } else { gl_FragColor = vec4(pixel.rgb, uAlpha); } } }',\r\n\t    cube_vshader: ' attribute highp vec3 aVertex; attribute highp vec2 aTexCoord; attribute highp float aId; uniform mat3 uRotation; uniform mat4 uPMatrix; uniform bool uColorCoding; uniform float uSelection; varying vec2 vTexCoord; varying vec4 vIdColor; vec4 getIdColor(float id){ float product = floor(id + 0.5); float B = floor(product / (256.0*256.0)); float G = floor((product - B * 256.0*256.0) / 256.0); float R = mod(product, 256.0); return vec4(R / 255.0, G / 255.0, B / 255.0, 1.0); } void main(void) { vec4 point = vec4(uRotation * aVertex, 1.0); gl_Position = uPMatrix * point; vTexCoord = aTexCoord; if (uColorCoding) { vIdColor = getIdColor(aId); return; } bool isSelected = abs(uSelection - aId) < 0.1; if (isSelected){ vIdColor = vec4(-1.0, -1.0, -1.0, -1.0); } else{ vIdColor = vec4(1.0, 1.0, 1.0, 1.0); } }'\r\n\t};\r\n\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.xCubeTextures = {\r\n\t    en: 'data:image/png;base64,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',\r\n\t};\r\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_navigation_cube_textures_1 = __webpack_require__(14);\r\n\tvar xbim_navigation_cube_shaders_1 = __webpack_require__(13);\r\n\tvar glMatrix = __webpack_require__(11);\r\n\tvar xNavigationCube = (function () {\r\n\t    /**\r\n\t     * This is constructor of the Navigation Cube plugin for {@link xViewer xBIM Viewer}. It gets optional Image as an argument.\r\n\t     * The image will be used as a texture of the navigation cube. If you don't specify eny image default one will be used.\r\n\t     * Image has to be square and its size has to be power of 2.\r\n\t     * @name xNavigationCube\r\n\t     * @constructor\r\n\t     * @classdesc This is a plugin for xViewer which renders interactive navigation cube. It is customizable in terms of alpha\r\n\t     * behaviour and its position on the viewer canvas. Use of plugin:\r\n\t     *\r\n\t     *     var cube = new xNavigationCube();\r\n\t     *     viewer.addPlugin(cube);\r\n\t     *\r\n\t     * You can specify your own texture of the cube as an [Image](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/Image)\r\n\t     * object argumen in constructor. If you don't specify any image default texture will be used (you can also use this one and enhance it if you want):\r\n\t     *\r\n\t     * ![Cube texture](cube_texture.png)\r\n\t     *\r\n\t     * @param {Image} [image = null] - optional image to be used for a cube texture.\r\n\t    */\r\n\t    function xNavigationCube(image) {\r\n\t        this.TOP = 1600000;\r\n\t        this.BOTTOM = 1600001;\r\n\t        this.LEFT = 1600002;\r\n\t        this.RIGHT = 1600003;\r\n\t        this.FRONT = 1600004;\r\n\t        this.BACK = 1600005;\r\n\t        this.TOP_LEFT_FRONT = 1600006;\r\n\t        this.TOP_RIGHT_FRONT = 1600007;\r\n\t        this.TOP_LEFT_BACK = 1600008;\r\n\t        this.TOP_RIGHT_BACK = 1600009;\r\n\t        this.BOTTOM_LEFT_FRONT = 1600010;\r\n\t        this.BOTTOM_RIGHT_FRONT = 1600011;\r\n\t        this.BOTTOM_LEFT_BACK = 1600012;\r\n\t        this.BOTTOM_RIGHT_BACK = 1600013;\r\n\t        this.TOP_LEFT = 1600014;\r\n\t        this.TOP_RIGHT = 1600015;\r\n\t        this.TOP_FRONT = 1600016;\r\n\t        this.TOP_BACK = 1600017;\r\n\t        this.BOTTOM_LEFT = 1600018;\r\n\t        this.BOTTOM_RIGHT = 1600019;\r\n\t        this.BOTTOM_FRONT = 1600020;\r\n\t        this.BOTTOM_BACK = 1600021;\r\n\t        this.FRONT_RIGHT = 1600022;\r\n\t        this.FRONT_LEFT = 1600023;\r\n\t        this.BACK_RIGHT = 1600024;\r\n\t        this.BACK_LEFT = 1600025;\r\n\t        this._initialized = false;\r\n\t        /**\r\n\t        * Size of the cube relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.15.\r\n\t        * @member {Number} xNavigationCube#ratio\r\n\t        */\r\n\t        this.ratio = 0.15;\r\n\t        /**\r\n\t        * Active parts of the navigation cube are highlighted so that user can recognize which part is active.\r\n\t        * This should be a positive number between [0,2]. If the value is less than 1 active area is darker.\r\n\t        * If the value is greater than 1 active area is lighter. Default value is 1.2.\r\n\t        * @member {Number} xNavigationCube#highlighting\r\n\t        */\r\n\t        this.highlighting = 1.2;\r\n\t        /**\r\n\t        * Navigation cube has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n\t        * This is for the hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent\r\n\t        * when user hovers over. Default value is 1.0.\r\n\t        * @member {Number} xNavigationCube#activeAlpha\r\n\t        */\r\n\t        this.activeAlpha = 1.0;\r\n\t        /**\r\n\t        * Navigation cube has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n\t        * This is for the non-hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent\r\n\t        * when user is not hovering over. Default value is 0.3.\r\n\t        * @member {Number} xNavigationCube#passiveAlpha\r\n\t        */\r\n\t        this.passiveAlpha = 0.3;\r\n\t        /**\r\n\t        * It is possible to place navigation cube to any of the corners of the canvas using this property. Default value is cube.BOTTOM_RIGHT.\r\n\t        * Allowed values are cube.BOTTOM_RIGHT, cube.BOTTOM_LEFT, cube.TOP_RIGHT and cube.TOP_LEFT.\r\n\t        * @member {Enum} xNavigationCube#position\r\n\t        */\r\n\t        this.position = this.BOTTOM_RIGHT;\r\n\t        this.vertices = new Float32Array([\r\n\t            // Front face\r\n\t            -0.3, -0.5, -0.3,\r\n\t            0.3, -0.5, -0.3,\r\n\t            0.3, -0.5, 0.3,\r\n\t            -0.3, -0.5, 0.3,\r\n\t            // Back face\r\n\t            -0.3, 0.5, -0.3,\r\n\t            -0.3, 0.5, 0.3,\r\n\t            0.3, 0.5, 0.3,\r\n\t            0.3, 0.5, -0.3,\r\n\t            // Top face\r\n\t            -0.3, -0.3, 0.5,\r\n\t            0.3, -0.3, 0.5,\r\n\t            0.3, 0.3, 0.5,\r\n\t            -0.3, 0.3, 0.5,\r\n\t            // Bottom face\r\n\t            -0.3, -0.3, -0.5,\r\n\t            -0.3, 0.3, -0.5,\r\n\t            0.3, 0.3, -0.5,\r\n\t            0.3, -0.3, -0.5,\r\n\t            // Right face\r\n\t            0.5, -0.3, -0.3,\r\n\t            0.5, 0.3, -0.3,\r\n\t            0.5, 0.3, 0.3,\r\n\t            0.5, -0.3, 0.3,\r\n\t            // Left face\r\n\t            -0.5, -0.3, -0.3,\r\n\t            -0.5, -0.3, 0.3,\r\n\t            -0.5, 0.3, 0.3,\r\n\t            -0.5, 0.3, -0.3,\r\n\t            //top - left - front (--+)\r\n\t            -0.5, -0.5, 0.5,\r\n\t            -0.3, -0.5, 0.5,\r\n\t            -0.3, -0.3, 0.5,\r\n\t            -0.5, -0.3, 0.5,\r\n\t            -0.5, -0.5, 0.3,\r\n\t            -0.5, -0.5, 0.5,\r\n\t            -0.5, -0.3, 0.5,\r\n\t            -0.5, -0.3, 0.3,\r\n\t            -0.5, -0.5, 0.3,\r\n\t            -0.3, -0.5, 0.3,\r\n\t            -0.3, -0.5, 0.5,\r\n\t            -0.5, -0.5, 0.5,\r\n\t            //top-right-front (+-+)\r\n\t            0.3, -0.5, 0.5,\r\n\t            0.5, -0.5, 0.5,\r\n\t            0.5, -0.3, 0.5,\r\n\t            0.3, -0.3, 0.5,\r\n\t            0.5, -0.5, 0.3,\r\n\t            0.5, -0.3, 0.3,\r\n\t            0.5, -0.3, 0.5,\r\n\t            0.5, -0.5, 0.5,\r\n\t            0.3, -0.5, 0.3,\r\n\t            0.5, -0.5, 0.3,\r\n\t            0.5, -0.5, 0.5,\r\n\t            0.3, -0.5, 0.5,\r\n\t            //top-left-back (-++)\r\n\t            -0.5, 0.3, 0.5,\r\n\t            -0.3, 0.3, 0.5,\r\n\t            -0.3, 0.5, 0.5,\r\n\t            -0.5, 0.5, 0.5,\r\n\t            -0.5, 0.3, 0.3,\r\n\t            -0.5, 0.3, 0.5,\r\n\t            -0.5, 0.5, 0.5,\r\n\t            -0.5, 0.5, 0.3,\r\n\t            -0.5, 0.5, 0.3,\r\n\t            -0.5, 0.5, 0.5,\r\n\t            -0.3, 0.5, 0.5,\r\n\t            -0.3, 0.5, 0.3,\r\n\t            //top-right-back (+++)\r\n\t            0.3, 0.3, 0.5,\r\n\t            0.5, 0.3, 0.5,\r\n\t            0.5, 0.5, 0.5,\r\n\t            0.3, 0.5, 0.5,\r\n\t            0.5, 0.3, 0.3,\r\n\t            0.5, 0.5, 0.3,\r\n\t            0.5, 0.5, 0.5,\r\n\t            0.5, 0.3, 0.5,\r\n\t            0.3, 0.5, 0.3,\r\n\t            0.3, 0.5, 0.5,\r\n\t            0.5, 0.5, 0.5,\r\n\t            0.5, 0.5, 0.3,\r\n\t            //bottom - left - front (---)\r\n\t            -0.5, -0.5, -0.5,\r\n\t            -0.3, -0.5, -0.5,\r\n\t            -0.3, -0.3, -0.5,\r\n\t            -0.5, -0.3, -0.5,\r\n\t            -0.5, -0.5, -0.5,\r\n\t            -0.5, -0.5, -0.3,\r\n\t            -0.5, -0.3, -0.3,\r\n\t            -0.5, -0.3, -0.5,\r\n\t            -0.5, -0.5, -0.5,\r\n\t            -0.3, -0.5, -0.5,\r\n\t            -0.3, -0.5, -0.3,\r\n\t            -0.5, -0.5, -0.3,\r\n\t            //bottom-right-front (+--)\r\n\t            0.3, -0.5, -0.5,\r\n\t            0.5, -0.5, -0.5,\r\n\t            0.5, -0.3, -0.5,\r\n\t            0.3, -0.3, -0.5,\r\n\t            0.5, -0.5, -0.5,\r\n\t            0.5, -0.3, -0.5,\r\n\t            0.5, -0.3, -0.3,\r\n\t            0.5, -0.5, -0.3,\r\n\t            0.3, -0.5, -0.5,\r\n\t            0.5, -0.5, -0.5,\r\n\t            0.5, -0.5, -0.3,\r\n\t            0.3, -0.5, -0.3,\r\n\t            //bottom-left-back (-+-)\r\n\t            -0.5, 0.3, -0.5,\r\n\t            -0.3, 0.3, -0.5,\r\n\t            -0.3, 0.5, -0.5,\r\n\t            -0.5, 0.5, -0.5,\r\n\t            -0.5, 0.3, -0.5,\r\n\t            -0.5, 0.3, -0.3,\r\n\t            -0.5, 0.5, -0.3,\r\n\t            -0.5, 0.5, -0.5,\r\n\t            -0.5, 0.5, -0.5,\r\n\t            -0.5, 0.5, -0.3,\r\n\t            -0.3, 0.5, -0.3,\r\n\t            -0.3, 0.5, -0.5,\r\n\t            //bottom-right-back (++-)\r\n\t            0.3, 0.3, -0.5,\r\n\t            0.5, 0.3, -0.5,\r\n\t            0.5, 0.5, -0.5,\r\n\t            0.3, 0.5, -0.5,\r\n\t            0.5, 0.3, -0.5,\r\n\t            0.5, 0.5, -0.5,\r\n\t            0.5, 0.5, -0.3,\r\n\t            0.5, 0.3, -0.3,\r\n\t            0.3, 0.5, -0.5,\r\n\t            0.3, 0.5, -0.3,\r\n\t            0.5, 0.5, -0.3,\r\n\t            0.5, 0.5, -0.5,\r\n\t            //top-right (+0+)\r\n\t            0.3, -0.3, 0.5,\r\n\t            0.5, -0.3, 0.5,\r\n\t            0.5, 0.3, 0.5,\r\n\t            0.3, 0.3, 0.5,\r\n\t            0.5, -0.3, 0.3,\r\n\t            0.5, 0.3, 0.3,\r\n\t            0.5, 0.3, 0.5,\r\n\t            0.5, -0.3, 0.5,\r\n\t            //top-left (-0+)\r\n\t            -0.5, -0.3, 0.5,\r\n\t            -0.3, -0.3, 0.5,\r\n\t            -0.3, 0.3, 0.5,\r\n\t            -0.5, 0.3, 0.5,\r\n\t            -0.5, -0.3, 0.3,\r\n\t            -0.5, -0.3, 0.5,\r\n\t            -0.5, 0.3, 0.5,\r\n\t            -0.5, 0.3, 0.3,\r\n\t            //top-front (0-+)\r\n\t            -0.3, -0.5, 0.5,\r\n\t            0.3, -0.5, 0.5,\r\n\t            0.3, -0.3, 0.5,\r\n\t            -0.3, -0.3, 0.5,\r\n\t            -0.3, -0.5, 0.3,\r\n\t            0.3, -0.5, 0.3,\r\n\t            0.3, -0.5, 0.5,\r\n\t            -0.3, -0.5, 0.5,\r\n\t            //top-back (0++)\r\n\t            -0.3, 0.3, 0.5,\r\n\t            0.3, 0.3, 0.5,\r\n\t            0.3, 0.5, 0.5,\r\n\t            -0.3, 0.5, 0.5,\r\n\t            -0.3, 0.5, 0.3,\r\n\t            -0.3, 0.5, 0.5,\r\n\t            0.3, 0.5, 0.5,\r\n\t            0.3, 0.5, 0.3,\r\n\t            //bottom-right (+0-)\r\n\t            0.3, -0.3, -0.5,\r\n\t            0.5, -0.3, -0.5,\r\n\t            0.5, 0.3, -0.5,\r\n\t            0.3, 0.3, -0.5,\r\n\t            0.5, -0.3, -0.5,\r\n\t            0.5, 0.3, -0.5,\r\n\t            0.5, 0.3, -0.3,\r\n\t            0.5, -0.3, -0.3,\r\n\t            //bottom-left (-0-)\r\n\t            -0.5, -0.3, -0.5,\r\n\t            -0.5, 0.3, -0.5,\r\n\t            -0.3, 0.3, -0.5,\r\n\t            -0.3, -0.3, -0.5,\r\n\t            -0.5, -0.3, -0.5,\r\n\t            -0.5, -0.3, -0.3,\r\n\t            -0.5, 0.3, -0.3,\r\n\t            -0.5, 0.3, -0.5,\r\n\t            //bottom-front (0--)\r\n\t            -0.3, -0.5, -0.5,\r\n\t            0.3, -0.5, -0.5,\r\n\t            0.3, -0.3, -0.5,\r\n\t            -0.3, -0.3, -0.5,\r\n\t            -0.3, -0.5, -0.5,\r\n\t            0.3, -0.5, -0.5,\r\n\t            0.3, -0.5, -0.3,\r\n\t            -0.3, -0.5, -0.3,\r\n\t            //bottom-back (0+-)\r\n\t            -0.3, 0.3, -0.5,\r\n\t            0.3, 0.3, -0.5,\r\n\t            0.3, 0.5, -0.5,\r\n\t            -0.3, 0.5, -0.5,\r\n\t            -0.3, 0.5, -0.5,\r\n\t            -0.3, 0.5, -0.3,\r\n\t            0.3, 0.5, -0.3,\r\n\t            0.3, 0.5, -0.5,\r\n\t            //front-right (+-0)\r\n\t            0.3, -0.5, -0.3,\r\n\t            0.5, -0.5, -0.3,\r\n\t            0.5, -0.5, 0.3,\r\n\t            0.3, -0.5, 0.3,\r\n\t            0.5, -0.5, -0.3,\r\n\t            0.5, -0.3, -0.3,\r\n\t            0.5, -0.3, 0.3,\r\n\t            0.5, -0.5, 0.3,\r\n\t            //front-left (--0)\r\n\t            -0.5, -0.5, -0.3,\r\n\t            -0.3, -0.5, -0.3,\r\n\t            -0.3, -0.5, 0.3,\r\n\t            -0.5, -0.5, 0.3,\r\n\t            -0.5, -0.5, -0.3,\r\n\t            -0.5, -0.5, 0.3,\r\n\t            -0.5, -0.3, 0.3,\r\n\t            -0.5, -0.3, -0.3,\r\n\t            //back-right (++0)\r\n\t            0.3, 0.5, -0.3,\r\n\t            0.3, 0.5, 0.3,\r\n\t            0.5, 0.5, 0.3,\r\n\t            0.5, 0.5, -0.3,\r\n\t            0.5, 0.3, -0.3,\r\n\t            0.5, 0.5, -0.3,\r\n\t            0.5, 0.5, 0.3,\r\n\t            0.5, 0.3, 0.3,\r\n\t            //back-left (-+0)\r\n\t            -0.5, 0.5, -0.3,\r\n\t            -0.5, 0.5, 0.3,\r\n\t            -0.3, 0.5, 0.3,\r\n\t            -0.3, 0.5, -0.3,\r\n\t            -0.5, 0.3, -0.3,\r\n\t            -0.5, 0.3, 0.3,\r\n\t            -0.5, 0.5, 0.3,\r\n\t            -0.5, 0.5, -0.3,\r\n\t        ]);\r\n\t        //// Front face\r\n\t        //-0.5, -0.5, -0.5,\r\n\t        // 0.5, -0.5, -0.5,\r\n\t        // 0.5, -0.5, 0.5,\r\n\t        //-0.5, -0.5, 0.5,\r\n\t        //\r\n\t        //// Back face\r\n\t        //-0.5, 0.5, -0.5,\r\n\t        //-0.5, 0.5, 0.5,\r\n\t        // 0.5, 0.5, 0.5,\r\n\t        // 0.5, 0.5, -0.5,\r\n\t        //\r\n\t        //// Top face\r\n\t        //-0.5, -0.5, 0.5,\r\n\t        // 0.5, -0.5, 0.5,\r\n\t        // 0.5, 0.5, 0.5,\r\n\t        //-0.5, 0.5, 0.5,\r\n\t        //\r\n\t        //// Bottom face\r\n\t        //-0.5, -0.5, -0.5,\r\n\t        //-0.5, 0.5, -0.5,\r\n\t        // 0.5, 0.5, -0.5,\r\n\t        // 0.5, -0.5, -0.5,\r\n\t        //\r\n\t        //// Right face\r\n\t        // 0.5, -0.5, -0.5,\r\n\t        // 0.5, 0.5, -0.5,\r\n\t        // 0.5, 0.5, 0.5,\r\n\t        // 0.5, -0.5, 0.5,\r\n\t        //\r\n\t        //// Left face\r\n\t        //-0.5, -0.5, -0.5,\r\n\t        //-0.5, -0.5, 0.5,\r\n\t        //-0.5, 0.5, 0.5,\r\n\t        //-0.5, 0.5, -0.5,\r\n\t        this.indices = new Uint16Array([\r\n\t            0, 1, 2, 0, 2, 3,\r\n\t            4, 5, 6, 4, 6, 7,\r\n\t            8, 9, 10, 8, 10, 11,\r\n\t            12, 13, 14, 12, 14, 15,\r\n\t            16, 17, 18, 16, 18, 19,\r\n\t            20, 21, 22, 20, 22, 23,\r\n\t            //top - left - front \r\n\t            0 + 24, 1 + 24, 2 + 24, 0 + 24, 2 + 24, 3 + 24,\r\n\t            4 + 24, 5 + 24, 6 + 24, 4 + 24, 6 + 24, 7 + 24,\r\n\t            8 + 24, 9 + 24, 10 + 24, 8 + 24, 10 + 24, 11 + 24,\r\n\t            //top-right-front \r\n\t            0 + 36, 1 + 36, 2 + 36, 0 + 36, 2 + 36, 3 + 36,\r\n\t            4 + 36, 5 + 36, 6 + 36, 4 + 36, 6 + 36, 7 + 36,\r\n\t            8 + 36, 9 + 36, 10 + 36, 8 + 36, 10 + 36, 11 + 36,\r\n\t            //top-left-back \r\n\t            0 + 48, 1 + 48, 2 + 48, 0 + 48, 2 + 48, 3 + 48,\r\n\t            4 + 48, 5 + 48, 6 + 48, 4 + 48, 6 + 48, 7 + 48,\r\n\t            8 + 48, 9 + 48, 10 + 48, 8 + 48, 10 + 48, 11 + 48,\r\n\t            //top-right-back\r\n\t            0 + 60, 1 + 60, 2 + 60, 0 + 60, 2 + 60, 3 + 60,\r\n\t            4 + 60, 5 + 60, 6 + 60, 4 + 60, 6 + 60, 7 + 60,\r\n\t            8 + 60, 9 + 60, 10 + 60, 8 + 60, 10 + 60, 11 + 60,\r\n\t            //bottom - left - front\r\n\t            0 + 72, 2 + 72, 1 + 72, 0 + 72, 3 + 72, 2 + 72,\r\n\t            4 + 72, 5 + 72, 6 + 72, 4 + 72, 6 + 72, 7 + 72,\r\n\t            8 + 72, 9 + 72, 10 + 72, 8 + 72, 10 + 72, 11 + 72,\r\n\t            //bottom-right-front \r\n\t            0 + 84, 2 + 84, 1 + 84, 0 + 84, 3 + 84, 2 + 84,\r\n\t            4 + 84, 5 + 84, 6 + 84, 4 + 84, 6 + 84, 7 + 84,\r\n\t            8 + 84, 9 + 84, 10 + 84, 8 + 84, 10 + 84, 11 + 84,\r\n\t            //bottom-left-back \r\n\t            0 + 96, 2 + 96, 1 + 96, 0 + 96, 3 + 96, 2 + 96,\r\n\t            4 + 96, 5 + 96, 6 + 96, 4 + 96, 6 + 96, 7 + 96,\r\n\t            8 + 96, 9 + 96, 10 + 96, 8 + 96, 10 + 96, 11 + 96,\r\n\t            //bottom-right-back\r\n\t            0 + 108, 2 + 108, 1 + 108, 0 + 108, 3 + 108, 2 + 108,\r\n\t            4 + 108, 5 + 108, 6 + 108, 4 + 108, 6 + 108, 7 + 108,\r\n\t            8 + 108, 9 + 108, 10 + 108, 8 + 108, 10 + 108, 11 + 108,\r\n\t            //top-right\r\n\t            0 + 120, 1 + 120, 2 + 120, 0 + 120, 2 + 120, 3 + 120,\r\n\t            4 + 120, 5 + 120, 6 + 120, 4 + 120, 6 + 120, 7 + 120,\r\n\t            //top-left\r\n\t            0 + 128, 1 + 128, 2 + 128, 0 + 128, 2 + 128, 3 + 128,\r\n\t            4 + 128, 5 + 128, 6 + 128, 4 + 128, 6 + 128, 7 + 128,\r\n\t            //top-front\r\n\t            0 + 136, 1 + 136, 2 + 136, 0 + 136, 2 + 136, 3 + 136,\r\n\t            4 + 136, 5 + 136, 6 + 136, 4 + 136, 6 + 136, 7 + 136,\r\n\t            //top-back\r\n\t            0 + 144, 1 + 144, 2 + 144, 0 + 144, 2 + 144, 3 + 144,\r\n\t            4 + 144, 5 + 144, 6 + 144, 4 + 144, 6 + 144, 7 + 144,\r\n\t            //bottom-right\r\n\t            0 + 152, 2 + 152, 1 + 152, 0 + 152, 3 + 152, 2 + 152,\r\n\t            4 + 152, 5 + 152, 6 + 152, 4 + 152, 6 + 152, 7 + 152,\r\n\t            //bottom-left\r\n\t            0 + 160, 1 + 160, 2 + 160, 0 + 160, 2 + 160, 3 + 160,\r\n\t            4 + 160, 5 + 160, 6 + 160, 4 + 160, 6 + 160, 7 + 160,\r\n\t            //bottom-front\r\n\t            0 + 168, 2 + 168, 1 + 168, 0 + 168, 3 + 168, 2 + 168,\r\n\t            4 + 168, 5 + 168, 6 + 168, 4 + 168, 6 + 168, 7 + 168,\r\n\t            //bottom-back\r\n\t            0 + 176, 2 + 176, 1 + 176, 0 + 176, 3 + 176, 2 + 176,\r\n\t            4 + 176, 5 + 176, 6 + 176, 4 + 176, 6 + 176, 7 + 176,\r\n\t            //front-right\r\n\t            0 + 184, 1 + 184, 2 + 184, 0 + 184, 2 + 184, 3 + 184,\r\n\t            4 + 184, 5 + 184, 6 + 184, 4 + 184, 6 + 184, 7 + 184,\r\n\t            //front-left\r\n\t            0 + 192, 1 + 192, 2 + 192, 0 + 192, 2 + 192, 3 + 192,\r\n\t            4 + 192, 5 + 192, 6 + 192, 4 + 192, 6 + 192, 7 + 192,\r\n\t            //back-right\r\n\t            0 + 200, 1 + 200, 2 + 200, 0 + 200, 2 + 200, 3 + 200,\r\n\t            4 + 200, 5 + 200, 6 + 200, 4 + 200, 6 + 200, 7 + 200,\r\n\t            //back-left\r\n\t            0 + 208, 1 + 208, 2 + 208, 0 + 208, 2 + 208, 3 + 208,\r\n\t            4 + 208, 5 + 208, 6 + 208, 4 + 208, 6 + 208, 7 + 208,\r\n\t        ]);\r\n\t        //// Front face\r\n\t        //1.0 / 3.0, 0.0 / 3.0,\r\n\t        //2.0 / 3.0, 0.0 / 3.0,\r\n\t        //2.0 / 3.0, 1.0 / 3.0,\r\n\t        //1.0 / 3.0, 1.0 / 3.0,\r\n\t        //\r\n\t        //// Back face\r\n\t        //1.0, 0.0 / 3.0,\r\n\t        //1.0, 1.0 / 3.0,\r\n\t        //2.0 / 3.0, 1.0 / 3.0,\r\n\t        //2.0 / 3.0, 0.0 / 3.0,\r\n\t        //\r\n\t        //\r\n\t        //// Top face\r\n\t        //2.0 / 3.0, 1.0 / 3.0,\r\n\t        //1.0, 1.0 / 3.0,\r\n\t        //1.0, 2.0 / 3.0,\r\n\t        //2.0 / 3.0, 2.0 / 3.0,\r\n\t        //\r\n\t        //// Bottom face\r\n\t        //0.0, 1.0 / 3.0,\r\n\t        //0.0, 0.0 / 3.0,\r\n\t        //1.0 / 3.0, 0.0 / 3.0,\r\n\t        //1.0 / 3.0, 1.0 / 3.0,\r\n\t        //\r\n\t        //// Right face\r\n\t        //0.0, 1.0 / 3.0,\r\n\t        //1.0 / 3.0, 1.0 / 3.0,\r\n\t        //1.0 / 3.0, 2.0 / 3.0,\r\n\t        //0.0, 2.0 / 3.0,\r\n\t        //\r\n\t        //// Left face\r\n\t        //2.0 / 3.0, 1.0 / 3.0,\r\n\t        //2.0 / 3.0, 2.0 / 3.0,\r\n\t        //1.0 / 3.0, 2.0 / 3.0,\r\n\t        //1.0 / 3.0, 1.0 / 3.0\r\n\t        this.txtCoords = new Float32Array([\r\n\t            // Front face\r\n\t            1.0 / 3.0 + 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\t            2.0 / 3.0 - 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\t            2.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\t            1.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\t            // Back face\r\n\t            1.0 - 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 - 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\t            2.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\t            2.0 / 3.0 + 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\t            // Top face\r\n\t            2.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 - 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 - 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\t            2.0 / 3.0 + 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\t            // Bottom face\r\n\t            0.0 + 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\t            0.0 + 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 / 3.0 - 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\t            // Right face\r\n\t            0.0 + 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\t            1.0 / 3.0 - 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\t            0.0 + 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\t            // Left face\r\n\t            2.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\t            2.0 / 3.0 - 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\t            1.0 / 3.0 + 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\t            1.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\t            //top - left - front \r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //top-right-front \r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //top-left-back \r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //top-right-back \r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //bottom - left - front \r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //bottom-right-front \r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //bottom-left-back \r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //bottom-right-back \r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\t            //top-right\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //top-left\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //top-front\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            //top-back\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            //bottom-right\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //bottom-left\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //bottom-front\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            //bottom-back\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            //front-right\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //front-left\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //back-right\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            //back-left\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t            1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\t        ]);\r\n\t        this._image = image;\r\n\t    }\r\n\t    xNavigationCube.prototype.init = function (xviewer) {\r\n\t        var self = this;\r\n\t        this.viewer = xviewer;\r\n\t        var gl = this.viewer._gl;\r\n\t        //create own shader \r\n\t        this._shader = null;\r\n\t        this._initShader();\r\n\t        this._alpha = this.passiveAlpha;\r\n\t        this._selection = 0.0;\r\n\t        //set own shader for init\r\n\t        gl.useProgram(this._shader);\r\n\t        //create uniform and attribute pointers\r\n\t        this._pMatrixUniformPointer = gl.getUniformLocation(this._shader, \"uPMatrix\");\r\n\t        this._rotationUniformPointer = gl.getUniformLocation(this._shader, \"uRotation\");\r\n\t        this._colourCodingUniformPointer = gl.getUniformLocation(this._shader, \"uColorCoding\");\r\n\t        this._alphaUniformPointer = gl.getUniformLocation(this._shader, \"uAlpha\");\r\n\t        this._selectionUniformPointer = gl.getUniformLocation(this._shader, \"uSelection\");\r\n\t        this._textureUniformPointer = gl.getUniformLocation(this._shader, \"uTexture\");\r\n\t        this._highlightingUniformPointer = gl.getUniformLocation(this._shader, \"uHighlighting\");\r\n\t        this._vertexAttrPointer = gl.getAttribLocation(this._shader, \"aVertex\"),\r\n\t            this._texCoordAttrPointer = gl.getAttribLocation(this._shader, \"aTexCoord\"),\r\n\t            this._idAttrPointer = gl.getAttribLocation(this._shader, \"aId\"),\r\n\t            gl.enableVertexAttribArray(this._vertexAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._texCoordAttrPointer);\r\n\t        gl.enableVertexAttribArray(this._idAttrPointer);\r\n\t        //feed data into the GPU and keep pointers\r\n\t        this._indexBuffer = gl.createBuffer();\r\n\t        this._vertexBuffer = gl.createBuffer();\r\n\t        this._texCoordBuffer = gl.createBuffer();\r\n\t        this._idBuffer = gl.createBuffer();\r\n\t        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);\r\n\t        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indices, gl.STATIC_DRAW);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n\t        gl.bufferData(gl.ARRAY_BUFFER, this.vertices, gl.STATIC_DRAW);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this._texCoordBuffer);\r\n\t        gl.bufferData(gl.ARRAY_BUFFER, this.txtCoords, gl.STATIC_DRAW);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this._idBuffer);\r\n\t        gl.bufferData(gl.ARRAY_BUFFER, this.ids(), gl.STATIC_DRAW);\r\n\t        //create texture\r\n\t        var self = this;\r\n\t        this._texture = gl.createTexture();\r\n\t        if (typeof (this._image) === \"undefined\") {\r\n\t            //add HTML UI to viewer port\r\n\t            var data = xbim_navigation_cube_textures_1.xCubeTextures.en;\r\n\t            var image = new Image();\r\n\t            self._image = image;\r\n\t            image.addEventListener(\"load\", function () {\r\n\t                //load image texture into GPU\r\n\t                gl.bindTexture(gl.TEXTURE_2D, self._texture);\r\n\t                gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n\t                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, self._image);\r\n\t                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n\t                gl.generateMipmap(gl.TEXTURE_2D);\r\n\t            });\r\n\t            image.src = data;\r\n\t        }\r\n\t        else {\r\n\t            //load image texture into GPU\r\n\t            gl.bindTexture(gl.TEXTURE_2D, self._texture);\r\n\t            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n\t            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, self._image);\r\n\t            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n\t            gl.generateMipmap(gl.TEXTURE_2D);\r\n\t        }\r\n\t        //reset original shader program \r\n\t        gl.useProgram(this.viewer._shaderProgram);\r\n\t        xviewer._canvas.addEventListener('mousemove', function (event) {\r\n\t            var startX = event.clientX;\r\n\t            var startY = event.clientY;\r\n\t            //get coordinates within canvas (with the right orientation)\r\n\t            var r = xviewer._canvas.getBoundingClientRect();\r\n\t            var viewX = startX - r.left;\r\n\t            var viewY = xviewer._height - (startY - r.top);\r\n\t            //this is for picking\r\n\t            var id = xviewer._getID(viewX, viewY);\r\n\t            if (id >= self.TOP && id <= self.BACK_LEFT) {\r\n\t                self._alpha = self.activeAlpha;\r\n\t                self._selection = id;\r\n\t            }\r\n\t            else {\r\n\t                self._alpha = self.passiveAlpha;\r\n\t                self._selection = 0;\r\n\t            }\r\n\t        }, true);\r\n\t        self._drag = false;\r\n\t        xviewer._canvas.addEventListener('mousedown', function (event) {\r\n\t            var startX = event.clientX;\r\n\t            var startY = event.clientY;\r\n\t            //get coordinates within canvas (with the right orientation)\r\n\t            var r = xviewer._canvas.getBoundingClientRect();\r\n\t            var viewX = startX - r.left;\r\n\t            var viewY = xviewer._height - (startY - r.top);\r\n\t            //this is for picking\r\n\t            var id = xviewer._getID(viewX, viewY);\r\n\t            if (id >= self.TOP && id <= self.BACK_LEFT) {\r\n\t                //change viewer navigation mode to be 'orbit'\r\n\t                self._drag = true;\r\n\t                self._originalNavigation = xviewer.navigationMode;\r\n\t                xviewer.navigationMode = \"orbit\";\r\n\t            }\r\n\t        }, true);\r\n\t        window.addEventListener('mouseup', function (event) {\r\n\t            if (self._drag === true) {\r\n\t                xviewer.navigationMode = self._originalNavigation;\r\n\t            }\r\n\t            self._drag = false;\r\n\t        }, true);\r\n\t        this._initialized = true;\r\n\t    };\r\n\t    xNavigationCube.prototype.onBeforeDraw = function () { };\r\n\t    xNavigationCube.prototype.onBeforePick = function (id) {\r\n\t        if (id >= this.TOP && id <= this.BACK_LEFT) {\r\n\t            var dir = glMatrix.vec3.create();\r\n\t            var distance = this.viewer._distance;\r\n\t            var diagonalRatio = 1.3;\r\n\t            switch (id) {\r\n\t                case this.TOP:\r\n\t                    this.viewer.show('top');\r\n\t                    return true;\r\n\t                case this.BOTTOM:\r\n\t                    this.viewer.show('bottom');\r\n\t                    return true;\r\n\t                case this.LEFT:\r\n\t                    this.viewer.show('left');\r\n\t                    return true;\r\n\t                case this.RIGHT:\r\n\t                    this.viewer.show('right');\r\n\t                    return true;\r\n\t                case this.FRONT:\r\n\t                    this.viewer.show('front');\r\n\t                    return true;\r\n\t                case this.BACK:\r\n\t                    this.viewer.show('back');\r\n\t                    return true;\r\n\t                case this.TOP_LEFT_FRONT:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, -1, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_RIGHT_FRONT:\r\n\t                    dir = glMatrix.vec3.fromValues(1, -1, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_LEFT_BACK:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, 1, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_RIGHT_BACK:\r\n\t                    dir = glMatrix.vec3.fromValues(1, 1, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_LEFT_FRONT:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, -1, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_RIGHT_FRONT:\r\n\t                    dir = glMatrix.vec3.fromValues(1, -1, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_LEFT_BACK:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, 1, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_RIGHT_BACK:\r\n\t                    dir = glMatrix.vec3.fromValues(1, 1, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_LEFT:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, 0, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_RIGHT:\r\n\t                    dir = glMatrix.vec3.fromValues(1, 0, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_FRONT:\r\n\t                    dir = glMatrix.vec3.fromValues(0, -1, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.TOP_BACK:\r\n\t                    dir = glMatrix.vec3.fromValues(0, 1, 1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_LEFT:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, 0, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_RIGHT:\r\n\t                    dir = glMatrix.vec3.fromValues(1, 0, -1);\r\n\t                    break;\r\n\t                case this.BOTTOM_FRONT:\r\n\t                    dir = glMatrix.vec3.fromValues(0, -1, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BOTTOM_BACK:\r\n\t                    dir = glMatrix.vec3.fromValues(0, 1, -1);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.FRONT_RIGHT:\r\n\t                    dir = glMatrix.vec3.fromValues(1, -1, 0);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.FRONT_LEFT:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, -1, 0);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BACK_RIGHT:\r\n\t                    dir = glMatrix.vec3.fromValues(1, 1, 0);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                case this.BACK_LEFT:\r\n\t                    dir = glMatrix.vec3.fromValues(-1, 1, 0);\r\n\t                    distance *= diagonalRatio;\r\n\t                    break;\r\n\t                default:\r\n\t                    break;\r\n\t            }\r\n\t            var o = this.viewer._origin;\r\n\t            var heading = glMatrix.vec3.fromValues(0, 0, 1);\r\n\t            var origin = glMatrix.vec3.fromValues(o[0], o[1], o[2]);\r\n\t            dir = glMatrix.vec3.normalize(glMatrix.vec3.create(), dir);\r\n\t            var shift = glMatrix.vec3.scale(glMatrix.vec3.create(), dir, distance);\r\n\t            var camera = glMatrix.vec3.add(glMatrix.vec3.create(), origin, shift);\r\n\t            //use look-at function to set up camera and target\r\n\t            glMatrix.mat4.lookAt(this.viewer._mvMatrix, camera, origin, heading);\r\n\t            return true;\r\n\t        }\r\n\t        return false;\r\n\t    };\r\n\t    xNavigationCube.prototype.onAfterDraw = function () {\r\n\t        var gl = this.setActive();\r\n\t        //set uniform for colour coding to false\r\n\t        gl.uniform1i(this._colourCodingUniformPointer, 0);\r\n\t        this.draw();\r\n\t        this.setInactive();\r\n\t    };\r\n\t    xNavigationCube.prototype.onBeforeDrawId = function () { };\r\n\t    xNavigationCube.prototype.onAfterDrawId = function () {\r\n\t        var gl = this.setActive();\r\n\t        //set uniform for colour coding to false\r\n\t        gl.uniform1i(this._colourCodingUniformPointer, 1);\r\n\t        this.draw();\r\n\t        this.setInactive();\r\n\t    };\r\n\t    xNavigationCube.prototype.onBeforeGetId = function (id) { };\r\n\t    xNavigationCube.prototype.setActive = function () {\r\n\t        var gl = this.viewer._gl;\r\n\t        //set own shader\r\n\t        gl.useProgram(this._shader);\r\n\t        return gl;\r\n\t    };\r\n\t    xNavigationCube.prototype.setInactive = function () {\r\n\t        var gl = this.viewer._gl;\r\n\t        //set viewer shader\r\n\t        gl.useProgram(this.viewer._shaderProgram);\r\n\t    };\r\n\t    xNavigationCube.prototype.draw = function () {\r\n\t        if (!this._initialized)\r\n\t            return;\r\n\t        var gl = this.viewer._gl;\r\n\t        //set navigation data from xViewer to this shader\r\n\t        var pMatrix = glMatrix.mat4.create();\r\n\t        var height = 1.0 / this.ratio;\r\n\t        var width = height / this.viewer._height * this.viewer._width;\r\n\t        //create orthogonal projection matrix\r\n\t        switch (this.position) {\r\n\t            case this.BOTTOM_RIGHT:\r\n\t                glMatrix.mat4.ortho(pMatrix, (this.ratio - 1.0) * width, //left\r\n\t                this.ratio * width, //right\r\n\t                this.ratio * -1.0 * height, //bottom\r\n\t                (1.0 - this.ratio) * height, //top\r\n\t                -1, //near\r\n\t                1); //far\r\n\t                break;\r\n\t            case this.BOTTOM_LEFT:\r\n\t                glMatrix.mat4.ortho(pMatrix, -1.0 * this.ratio * width, //left\r\n\t                (1.0 - this.ratio) * width, //right\r\n\t                this.ratio * -1.0 * height, //bottom\r\n\t                (1.0 - this.ratio) * height, //top\r\n\t                -1, //near\r\n\t                1); //far\r\n\t                break;\r\n\t            case this.TOP_LEFT:\r\n\t                glMatrix.mat4.ortho(pMatrix, -1.0 * this.ratio * width, //left\r\n\t                (1.0 - this.ratio) * width, //right\r\n\t                (this.ratio - 1.0) * height, //bottom\r\n\t                this.ratio * height, //top\r\n\t                -1, //near\r\n\t                1); //far\r\n\t                break;\r\n\t            case this.TOP_RIGHT:\r\n\t                glMatrix.mat4.ortho(pMatrix, (this.ratio - 1.0) * width, //left\r\n\t                this.ratio * width, //right\r\n\t                (this.ratio - 1.0) * height, //bottom\r\n\t                this.ratio * height, //top\r\n\t                -1, //near\r\n\t                1); //far\r\n\t                break;\r\n\t            default:\r\n\t        }\r\n\t        //extract just a rotation from model-view matrix\r\n\t        var rotation = glMatrix.mat3.fromMat4(glMatrix.mat3\r\n\t            .create(), this.viewer._mvMatrix); // TODO Check -> fromMat4(mat3) -> Is this correct?\r\n\t        gl.uniformMatrix4fv(this._pMatrixUniformPointer, false, pMatrix);\r\n\t        gl.uniformMatrix3fv(this._rotationUniformPointer, false, rotation);\r\n\t        gl.uniform1f(this._alphaUniformPointer, this._alpha);\r\n\t        gl.uniform1f(this._highlightingUniformPointer, this.highlighting);\r\n\t        gl.uniform1f(this._selectionUniformPointer, this._selection);\r\n\t        //bind data buffers\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n\t        gl.vertexAttribPointer(this._vertexAttrPointer, 3, gl.FLOAT, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this._idBuffer);\r\n\t        gl.vertexAttribPointer(this._idAttrPointer, 1, gl.FLOAT, false, 0, 0);\r\n\t        gl.bindBuffer(gl.ARRAY_BUFFER, this._texCoordBuffer);\r\n\t        gl.vertexAttribPointer(this._texCoordAttrPointer, 2, gl.FLOAT, false, 0, 0);\r\n\t        //bind texture\r\n\t        gl.activeTexture(gl.TEXTURE1);\r\n\t        gl.bindTexture(gl.TEXTURE_2D, this._texture);\r\n\t        gl.uniform1i(this._textureUniformPointer, 1);\r\n\t        var cfEnabled = gl.getParameter(gl.CULL_FACE);\r\n\t        if (!cfEnabled)\r\n\t            gl.enable(gl.CULL_FACE);\r\n\t        //draw the cube as an element array\r\n\t        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);\r\n\t        gl.drawElements(gl.TRIANGLES, this.indices.length, gl.UNSIGNED_SHORT, 0);\r\n\t        if (!cfEnabled)\r\n\t            gl.disable(gl.CULL_FACE);\r\n\t    };\r\n\t    xNavigationCube.prototype._initShader = function () {\r\n\t        var gl = this.viewer._gl;\r\n\t        var viewer = this.viewer;\r\n\t        var compile = function (shader, code) {\r\n\t            gl.shaderSource(shader, code);\r\n\t            gl.compileShader(shader);\r\n\t            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n\t                viewer._error(gl.getShaderInfoLog(shader));\r\n\t                return null;\r\n\t            }\r\n\t        };\r\n\t        //fragment shader\r\n\t        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n\t        compile(fragmentShader, xbim_navigation_cube_shaders_1.xCubeShaders.cube_fshader);\r\n\t        //vertex shader (the more complicated one)\r\n\t        var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n\t        compile(vertexShader, xbim_navigation_cube_shaders_1.xCubeShaders.cube_vshader);\r\n\t        //link program\r\n\t        this._shader = gl.createProgram();\r\n\t        gl.attachShader(this._shader, vertexShader);\r\n\t        gl.attachShader(this._shader, fragmentShader);\r\n\t        gl.linkProgram(this._shader);\r\n\t        if (!gl.getProgramParameter(this._shader, gl.LINK_STATUS)) {\r\n\t            viewer._error('Could not initialise shaders for a navigation cube plugin');\r\n\t        }\r\n\t    };\r\n\t    xNavigationCube.prototype.ids = function () {\r\n\t        return new Float32Array([\r\n\t            this.FRONT,\r\n\t            this.FRONT,\r\n\t            this.FRONT,\r\n\t            this.FRONT,\r\n\t            this.BACK,\r\n\t            this.BACK,\r\n\t            this.BACK,\r\n\t            this.BACK,\r\n\t            this.TOP,\r\n\t            this.TOP,\r\n\t            this.TOP,\r\n\t            this.TOP,\r\n\t            this.BOTTOM,\r\n\t            this.BOTTOM,\r\n\t            this.BOTTOM,\r\n\t            this.BOTTOM,\r\n\t            this.RIGHT,\r\n\t            this.RIGHT,\r\n\t            this.RIGHT,\r\n\t            this.RIGHT,\r\n\t            this.LEFT,\r\n\t            this.LEFT,\r\n\t            this.LEFT,\r\n\t            this.LEFT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_LEFT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_RIGHT_FRONT,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_LEFT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.TOP_RIGHT_BACK,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_LEFT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_RIGHT_FRONT,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_LEFT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.BOTTOM_RIGHT_BACK,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_RIGHT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_LEFT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_FRONT,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.TOP_BACK,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_RIGHT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_LEFT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_FRONT,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.BOTTOM_BACK,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_RIGHT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.FRONT_LEFT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_RIGHT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t            this.BACK_LEFT,\r\n\t        ]);\r\n\t    };\r\n\t    ;\r\n\t    return xNavigationCube;\r\n\t}());\r\n\texports.xNavigationCube = xNavigationCube;\r\n\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.xHomeTextures = {\r\n\t    en: 'data:image/png;base64,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SsR29L9i99nLfjBJ0+QW4Niu1q8u94GWHaMS8Uz6W/d7LHeMpKn0Bfpb/59fzoMs6wJ2iTgcuBVDJM2zPYBbhx4s2ZJjVCJOAD4JbLucAZJmwrbAJ4cuLMmSYlQi3gZcCKxa6hNLmjmrgAuHPizaoq4ZlYgNgQ8CY/k5A0kz40zg9K7WRxf6BxYcoxKxOf2tvLH9BKakmfJ3wAldrd9ayAcvKEYlYifgSmCsZ1MkzZx/AY7qav3v9X3geq8ZlYj96Q+7GiJJi3Ug/SHb/df3geuMUYl4Pv1h151HNEzS/NmZ/pDtOt/P7EljVCJeR/9Psy1GPEzS/NkCuHLoylo94ZrRcNj194GJvweupLnwHuC3fviQ7eNiVCJWAn8NNPntAJLmxgXAq7taH/q///H9GJWIbYDLgOe02SZpzqwBjutq/ToMMSoRu9Mfdt2r6TRJ8+Yu+kO298S/wmHA5cD2jUdJmk9fAY7ZCHiM6XtDtOcBv916hJTUu4HrW49YpMc26mr9+9YrFqtE7Nh6g5TYnV2tN7QesVgT//XWkrQ2xkhSCsZIUgrGSFIKxkhSCsZIUgrGSFIKxkhSCsZIUgrGSFIKxkhSChu1HpDdhltuCRGtZ0xcffRRHnvggZE/7garVxMbbjjyx02vVh69//7WK1IzRuux1333EStXtp4xcQ/ecQd3Hzj6Xwiz25o1rDrggJE/bnb1oYe4c5W/gHld/GeapBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFDZqPSC7r51xBrFiResZE/fIvfeO5XHvP/98vn3DDWN57Mzqww+3npBe1Fpbb1i0EnEScEHrHVJSJ3e1Xth6xGL5zzRJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKfwvQct8OdSrePoAAAAASUVORK5CYII='\r\n\t};\r\n\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_navigation_home_textures_1 = __webpack_require__(16);\r\n\tvar glMatrix = __webpack_require__(11);\r\n\tvar xNavigationHome = (function () {\r\n\t    /**\r\n\t     * This is constructor of the Home plugin for {@link xViewer xBIM Viewer}. It gets optional Image object as an argument. If no image\r\n\t     * is specified there is a default one (which is not very prety).\r\n\t     * @name xNavigationHome\r\n\t     * @constructor\r\n\t     * @classdesc This is a plugin for xViewer which renders interactive home button. It is customizable in terms of alpha\r\n\t     * behaviour and its position on the viewer canvas as well as definition of the distance and view direction. Use of plugin:\r\n\t     *\r\n\t     *     var home = new xNavigationHome();\r\n\t     *     viewer.addPlugin(home);\r\n\t     *\r\n\t     *\r\n\t     * @param {Image} [image = null] - optional image to be used for a button.\r\n\t    */\r\n\t    function xNavigationHome(image) {\r\n\t        /**\r\n\t        * Size of the the home button relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.2.\r\n\t        * @member {Number} xNavigationHome#ratio\r\n\t        */\r\n\t        this.ratio = 0.2;\r\n\t        /**\r\n\t        * Position of the the home button relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.05.\r\n\t        * @member {Number} xNavigationHome#placementX\r\n\t        */\r\n\t        this.placementX = 0.05;\r\n\t        /**\r\n\t        * Position of the the home button relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.05.\r\n\t        * @member {Number} xNavigationHome#placementY\r\n\t        */\r\n\t        this.placementY = 0.05;\r\n\t        /**\r\n\t        * Navigation home button has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n\t        * This is for the hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent\r\n\t        * when user hovers over. Default value is 1.0.\r\n\t        * @member {Number} xNavigationHome#activeAlpha\r\n\t        */\r\n\t        this.activeAlpha = 1.0;\r\n\t        /**\r\n\t        * Navigation home button has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n\t        * This is for the non-hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent\r\n\t        * when user is not hovering over. Default value is 0.3.\r\n\t        * @member {Number} xNavigationHome#passiveAlpha\r\n\t        */\r\n\t        this.passiveAlpha = 0.3;\r\n\t        /**\r\n\t        * Distance to be used for a home view. If null, default viewer distance for a full extent mode is used. Default value: null\r\n\t        * @member {Number} xNavigationHome#distance\r\n\t        */\r\n\t        this.distance = null;\r\n\t        /**\r\n\t        * View direction to be used for a home view. Default value: [1, 1, -1]\r\n\t        * @member {Number} xNavigationHome#viewDirection\r\n\t        */\r\n\t        this.viewDirection = [1, 1, -1];\r\n\t        //private variables\r\n\t        this._image = image;\r\n\t    }\r\n\t    xNavigationHome.prototype.init = function (xviewer) {\r\n\t        this._viewer = xviewer;\r\n\t        var self = this;\r\n\t        if (typeof (this._image) === \"undefined\") {\r\n\t            //add HTML UI to viewer port\r\n\t            var data = xbim_navigation_home_textures_1.xHomeTextures[\"en\"];\r\n\t            var image = new Image();\r\n\t            self._image = image;\r\n\t            image.addEventListener(\"load\", function () {\r\n\t                self._adjust();\r\n\t            });\r\n\t            image.src = data;\r\n\t        }\r\n\t        else {\r\n\t            self._adjust();\r\n\t        }\r\n\t        //add image to document\r\n\t        document.documentElement.appendChild(this._image);\r\n\t        //add click event listener\r\n\t        self._image.addEventListener(\"click\", function () {\r\n\t            var viewer = self._viewer;\r\n\t            //set target to full extent\r\n\t            viewer.setCameraTarget();\r\n\t            var origin = viewer._origin;\r\n\t            var distance = self.distance != null ? self.distance : viewer._distance;\r\n\t            var normDirection = glMatrix.vec3.normalize(glMatrix.vec3.create(), self.viewDirection);\r\n\t            var position = glMatrix.vec3.scale(glMatrix.vec3.create(), normDirection, -1.0 * distance);\r\n\t            viewer.setCameraPosition(position);\r\n\t        });\r\n\t        //set active state styling\r\n\t        self._image.addEventListener(\"mouseover\", function () {\r\n\t            self._image.style.opacity = self.activeAlpha.toString(); //For real browsers;\r\n\t            self._image.style.filter = \"alpha(opacity=\" + Math.round(self.activeAlpha * 100.0) + \")\"; //For IE;\r\n\t        });\r\n\t        //set passive state styling\r\n\t        self._image.addEventListener(\"mouseleave\", function () {\r\n\t            self._image.style.opacity = self.passiveAlpha.toString(); //For real browsers;\r\n\t            self._image.style.filter = \"alpha(opacity=\" + Math.round(self.passiveAlpha * 100.0) + \")\"; //For IE;\r\n\t        });\r\n\t        //set initial styling\r\n\t        self._image.style.opacity = this.passiveAlpha.toString(); //For real browsers;\r\n\t        self._image.style.filter = \"alpha(opacity=\" + Math.round(this.passiveAlpha * 100.0) + \")\"; //For IE;\r\n\t    };\r\n\t    xNavigationHome.prototype._adjust = function () {\r\n\t        var canvas = this._viewer._canvas;\r\n\t        function getOffsetRect(elem) {\r\n\t            var box = elem.getBoundingClientRect();\r\n\t            var body = document.body;\r\n\t            var docElem = document.documentElement;\r\n\t            var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n\t            var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\t            var clientTop = docElem.clientTop || body.clientTop || 0;\r\n\t            var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\t            var top = Math.round(box.top + scrollTop - clientTop);\r\n\t            var left = Math.round(box.left + scrollLeft - clientLeft);\r\n\t            var width = Math.round(box.width);\r\n\t            var height = Math.round(box.height);\r\n\t            return { top: top, left: left, width: width, height: height };\r\n\t        }\r\n\t        //get position, width and height\r\n\t        var rect = getOffsetRect(canvas);\r\n\t        //set image size to what it should be (both relative to height so it is not destorted)\r\n\t        this._image.style.width = Math.round(rect.height * this.ratio) + \"px\";\r\n\t        this._image.style.height = Math.round(rect.height * this.ratio) + \"px\";\r\n\t        //place image to the desired position\r\n\t        this._image.style.position = \"absolute\";\r\n\t        this._image.style.left = Math.round(rect.left + rect.width * this.placementX) + \"px\";\r\n\t        this._image.style.top = Math.round(rect.top + rect.height * this.placementY) + \"px\";\r\n\t    };\r\n\t    xNavigationHome.prototype.onBeforeDraw = function () { };\r\n\t    xNavigationHome.prototype.onBeforePick = function (id) { };\r\n\t    xNavigationHome.prototype.onAfterDraw = function () { this._adjust(); };\r\n\t    xNavigationHome.prototype.onBeforeDrawId = function () { };\r\n\t    xNavigationHome.prototype.onAfterDrawId = function () { };\r\n\t    xNavigationHome.prototype.onBeforeGetId = function (id) { };\r\n\t    xNavigationHome.prototype.draw = function () { };\r\n\t    return xNavigationHome;\r\n\t}());\r\n\texports.xNavigationHome = xNavigationHome;\r\n\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar xAttributeDictionary = (function () {\r\n\t    function xAttributeDictionary(lang, culture) {\r\n\t        var dictionaries = [\r\n\t            {\r\n\t                lang: 'cs',\r\n\t                culture: 'cz',\r\n\t                terms: {\r\n\t                    AssetDescription: \"Popis\",\r\n\t                    AssetInstallationDate: \"Datum instalace\",\r\n\t                    AssetName: \"Nzev\",\r\n\t                    AssetSerialNumber: \"Sriov slo\",\r\n\t                    AssetTypeCategory: \"Kategorie\",\r\n\t                    AssetTypeColorCode: \"Kd barvy\",\r\n\t                    AssetTypeDescription: \"Popis\",\r\n\t                    AssetTypeFeaturesDescription: \"Popis vlastnost\",\r\n\t                    AssetTypeGradeDescription: \"Popis kvality\",\r\n\t                    AssetTypeMaterialDescription: \"Popis materilu\",\r\n\t                    AssetTypeName: \"Nzev\",\r\n\t                    AssetTypeShapeDescription: \"Popis tvaru\",\r\n\t                    AssetTypeSizeDescription: \"Popis velikosti\",\r\n\t                    AssetWarrantyStartDate: \"Zatek zruky\",\r\n\t                    AttributeCategory: \"Kategorie\",\r\n\t                    AttributeDescription: \"Popis\",\r\n\t                    AttributeName: \"Nzev\",\r\n\t                    FacilityCategory: \"Kategorie\",\r\n\t                    FacilityDefaultAreaUnit: \"Peddefinovan jednotka plochy\",\r\n\t                    FacilityDefaultLinearUnit: \"Peddefinovan jednotka dlky\",\r\n\t                    FacilityDefaultVolumeUnit: \"Peddefinovan jednotka objemu\",\r\n\t                    FacilityDeliverablePhaseName: \"Nzev fze vsledku\",\r\n\t                    FacilityDescription: \"Popis nemovitosti\",\r\n\t                    FacilityName: \"Nzev\",\r\n\t                    FloorCategory: \"Kategorie\",\r\n\t                    FloorDescription: \"Popis\",\r\n\t                    FloorName: \"Nzev\",\r\n\t                    ProjectDescription: \"Popis projektu\",\r\n\t                    ProjectName: \"Nzev projektu\",\r\n\t                    SiteDescription: \"Popis stavby\",\r\n\t                    SpaceCategory: \"Kategorie mstnosti\",\r\n\t                    SpaceDescription: \"Popis mstnosti\",\r\n\t                    SpaceName: \"Nzev mstnosti\",\r\n\t                    SpaceSignageName: \"Space Signage Name\",\r\n\t                    StringValue: \"String Value\",\r\n\t                    SystemCategory: \"System Category\",\r\n\t                    SystemDescription: \"System Description\",\r\n\t                    SystemName: \"System Name\",\r\n\t                    UnitName: \"Unit Name\",\r\n\t                    ZoneCategory: \"Zone Category\",\r\n\t                    ZoneDescription: \"Zone Description\",\r\n\t                    ZoneName: \"Zone Name\",\r\n\t                    externalID: \"External ID\",\r\n\t                    externalIDReference: \"External ID Reference\",\r\n\t                    propertySetName: \"Property Set\",\r\n\t                    True: \"Ano\",\r\n\t                    False: \"Ne\"\r\n\t                }\r\n\t            },\r\n\t            {\r\n\t                lang: 'en',\r\n\t                culture: 'uk',\r\n\t                terms: {\r\n\t                    AssetDescription: \"Asset Description\",\r\n\t                    AssetInstallationDate: \"Asset Installation Date\",\r\n\t                    AssetName: \"Asset Name\",\r\n\t                    AssetSerialNumber: \"Asset Serial Number\",\r\n\t                    AssetTypeCategory: \"Asset Type Category\",\r\n\t                    AssetTypeColorCode: \"Asset Type Color Code\",\r\n\t                    AssetTypeDescription: \"Asset Type Description\",\r\n\t                    AssetTypeFeaturesDescription: \"Asset Type Features Description\",\r\n\t                    AssetTypeGradeDescription: \"Asset Type Grade Description\",\r\n\t                    AssetTypeMaterialDescription: \"Asset Type Material Description\",\r\n\t                    AssetTypeName: \"Asset Type Name\",\r\n\t                    AssetTypeShapeDescription: \"Asset Type Shape Description\",\r\n\t                    AssetTypeSizeDescription: \"Asset Type Size Description\",\r\n\t                    AssetWarrantyStartDate: \"Asset Warranty Start Date\",\r\n\t                    AttributeCategory: \"Attribute Category\",\r\n\t                    AttributeDescription: \"Attribute Description\",\r\n\t                    AttributeName: \"Attribute Name\",\r\n\t                    FacilityCategory: \"Facility Category\",\r\n\t                    FacilityDefaultAreaUnit: \"Facility Default Area Unit\",\r\n\t                    FacilityDefaultLinearUnit: \"Facility Default Linear Unit\",\r\n\t                    FacilityDefaultVolumeUnit: \"Facility Default Volume Unit\",\r\n\t                    FacilityDeliverablePhaseName: \"Facility Deliverable Phase Name\",\r\n\t                    FacilityDescription: \"Facility Description\",\r\n\t                    FacilityName: \"Facility Name\",\r\n\t                    FloorCategory: \"Floor Category\",\r\n\t                    FloorDescription: \"Floor Description\",\r\n\t                    FloorName: \"Floor Name\",\r\n\t                    ProjectDescription: \"Project Description\",\r\n\t                    ProjectName: \"Project Name\",\r\n\t                    SiteDescription: \"Site Description\",\r\n\t                    SpaceCategory: \"Space Category\",\r\n\t                    SpaceDescription: \"Space Description\",\r\n\t                    SpaceName: \"Space Name\",\r\n\t                    SpaceSignageName: \"Space Signage Name\",\r\n\t                    StringValue: \"String Value\",\r\n\t                    SystemCategory: \"System Category\",\r\n\t                    SystemDescription: \"System Description\",\r\n\t                    SystemName: \"System Name\",\r\n\t                    UnitName: \"Unit Name\",\r\n\t                    ZoneCategory: \"Zone Category\",\r\n\t                    ZoneDescription: \"Zone Description\",\r\n\t                    ZoneName: \"Zone Name\",\r\n\t                    externalID: \"External ID\",\r\n\t                    externalIDReference: \"External ID Reference\",\r\n\t                    propertySetName: \"Property Set\",\r\n\t                    True: \"True\",\r\n\t                    False: \"False\"\r\n\t                }\r\n\t            }\r\n\t        ];\r\n\t        var def = dictionaries.filter(function (e) { return e.lang == 'en' && e.culture == 'uk'; })[0].terms;\r\n\t        if (typeof (lang) == 'undefined' && typeof (culture) == 'undefined')\r\n\t            return def;\r\n\t        //try to find the best fit\r\n\t        var candidates = dictionaries.filter(function (e) { return e.lang == lang; });\r\n\t        //return default dictionary\r\n\t        if (candidates.length == 0)\r\n\t            return def;\r\n\t        //return language match\r\n\t        if (candidates.length == 1 || typeof (culture) == 'undefined')\r\n\t            return candidates[0].terms;\r\n\t        var candidates2 = candidates.filter(function (e) { return e.culture == culture; });\r\n\t        //return culture match\r\n\t        if (candidates2.length == 1)\r\n\t            return candidates2[0].terms;\r\n\t        else\r\n\t            return candidates[0].terms;\r\n\t    }\r\n\t    return xAttributeDictionary;\r\n\t}());\r\n\texports.xAttributeDictionary = xAttributeDictionary;\r\n\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_visual_templates_1 = __webpack_require__(20);\r\n\tvar xbim_visual_model_1 = __webpack_require__(21);\r\n\tvar xbim_cobieuk_utils_1 = __webpack_require__(22);\r\n\tvar xbim_cobie_utils_1 = __webpack_require__(27);\r\n\tvar xBrowser = (function () {\r\n\t    /**\r\n\t    * This is the main class you need to use to render semantic structure of the building model\r\n\t    *\r\n\t    * @name xBrowser\r\n\t    * @constructor\r\n\t    * @classdesc This is a reader of COBie data encoded in JSON format in COBieLite data structure. You can easily combine this with 3D viewer xViewer to get full\r\n\t    * user experience. This class is loosely coupled with jQuery UI. It is not a mandatory dependency for the rendering itself. Tree views are basically\r\n\t    * nested unordered lists which is a natural representation for hierarchical data and lists are rendered as a table with one column. Classes are assigned\r\n\t    * to different parts in a way that you can use to style in any way you want.\r\n\t    *\r\n\t    * If you want to do all the rendering yourself you can still take advantage of preprocessing which happens after COBie data is loaded. COBie data model\r\n\t    * is converted to the simplified structure which is more homogenous and better suitable for templating and visual representation. For more detailed\r\n\t    * information have a look on {@link xVisualModel xVisualModel} and related classes. Visual model is passed as an argument to {@link xBrowser#event.loaded loaded} event.\r\n\t    *\r\n\t    * @param {string} [lang] - language code. This framework contains dictionary for parameters and attributes. It will be used for COBie processing and rendering. If your language or culture is not available default values are \"en\", \"uk\"\r\n\t    * @param {string} [culture] - culture code. Default combination of language and culture is \"en\", \"uk\".\r\n\t    */\r\n\t    function xBrowser(lang, culture) {\r\n\t        this._iconMap = {\r\n\t            def: 'ui-icon-document',\r\n\t            facility: 'ui-icon-home',\r\n\t            space: 'ui-icon-document-b',\r\n\t            floor: 'ui-icon-image',\r\n\t            assettype: 'ui-icon-copy',\r\n\t            asset: 'ui-icon-script',\r\n\t            document: 'ui-icon-document',\r\n\t            issue: 'ui-icon-clipboard',\r\n\t            contact: 'ui-icon-person',\r\n\t            system: 'ui-icon-wrench',\r\n\t            zone: 'ui-icon-newwin'\r\n\t        };\r\n\t        this._model = new xbim_visual_model_1.xVisualModel(null);\r\n\t        this._events = [];\r\n\t        this._templates = {};\r\n\t        this._lang = lang;\r\n\t        this._culture = culture;\r\n\t        this._templates = {};\r\n\t        //compile templates\r\n\t        var templateStrings = xbim_visual_templates_1.xVisualTemplates();\r\n\t        for (var t in templateStrings) {\r\n\t            var templateString = templateStrings[t];\r\n\t            this._templates[t] = this._compileTemplate(templateString);\r\n\t        }\r\n\t    }\r\n\t    xBrowser.prototype._compileTemplate = function (str) {\r\n\t        // Based on Simple JavaScript Templating\r\n\t        // John Resig - http://ejohn.org/ - MIT Licensed\r\n\t        // http://ejohn.org/blog/javascript-micro-templating/\r\n\t        return new Function(\"_data_\", \"var _p_=[],print=function(){_p_.push.apply(_p_,arguments);};\" +\r\n\t            // Introduce the data as local variables using with(){}\r\n\t            \"with(_data_){_p_.push('\" +\r\n\t            // Convert the template into pure JavaScript\r\n\t            str\r\n\t                .replace(/[\\r\\t\\n]/g, \" \")\r\n\t                .split(\"<%\").join(\"\\t\")\r\n\t                .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t                .replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t                .split(\"\\t\").join(\"');\")\r\n\t                .split(\"%>\").join(\"_p_.push('\")\r\n\t                .split(\"\\r\").join(\"\\\\'\")\r\n\t            + \"');}return _p_.join('');\");\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders spatial structure as a tree view (facility -> floors -> spaces -> assets). If you use jQuery UI it can be turned into collapsable tree control\r\n\t    * with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderSpatialStructure\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    * @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n\t    */\r\n\t    xBrowser.prototype.renderSpatialStructure = function (container, initTree) {\r\n\t        if (!this._model)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        this._renderTreeView(container, this._model.facility, initTree);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders asset types as a tree view (asset type -> asset). If you use jQuery UI it can be turned into collapsable tree control\r\n\t    * with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderAssetTypes\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    * @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n\t    */\r\n\t    xBrowser.prototype.renderAssetTypes = function (container, initTree) {\r\n\t        if (!this._model)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        this._renderTreeView(container, this._model.assetTypes, initTree);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders asset types as a list view (asset type -> asset). If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderContacts\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderContacts = function (container) {\r\n\t        if (!this._model)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        this._renderListView(container, this._model.contacts, this._templates.contact);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders systems as a tree view (systems -> assets). If you use jQuery UI it can be turned into collapsable tree control\r\n\t    * with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderSystems\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    * @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n\t    */\r\n\t    xBrowser.prototype.renderSystems = function (container, initTree) {\r\n\t        if (!this._model)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        this._renderTreeView(container, this._model.systems, initTree);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders zones as a tree view (zones -> spaces -> assets). If you use jQuery UI it can be turned into collapsable tree control\r\n\t    * with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderZones\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    * @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n\t    */\r\n\t    xBrowser.prototype.renderZones = function (container, initTree) {\r\n\t        if (!this._model)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        this._renderTreeView(container, this._model.zones, initTree);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders assignments as a list view. This represents different kinds of relations between this and other entities\r\n\t    * If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderAssignments\r\n\t    * @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n\t    * {@link xBrowser#event:entityClick entityClick},\r\n\t    * {@link xBrowser#event:entityDblclick entityDblclick},\r\n\t    * {@link xBrowser#event:entityMouseDown entityMouseDown},\r\n\t    * {@link xBrowser#event:entityMouseUp entityMouseUp},\r\n\t    * {@link xBrowser#event:entityMouseMove entityMouseMove},\r\n\t    * {@link xBrowser#event:entityTouch entityTouch},\r\n\t    * {@link xBrowser#event:entityActive entityActive}\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderAssignments = function (entity, container) {\r\n\t        if (!this._model)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        container = this._getContainer(container);\r\n\t        container.innerHTML = \"\";\r\n\t        var sets = entity.assignments;\r\n\t        if (sets.length == 0)\r\n\t            return;\r\n\t        for (var i = 0; i < sets.length; i++) {\r\n\t            var set = sets[i];\r\n\t            if (set.assignments.length == 0)\r\n\t                continue;\r\n\t            var div = document.createElement(\"div\");\r\n\t            div.classList.add('xbim-assignment');\r\n\t            div.classList.add('ui-widget');\r\n\t            div.classList.add('ui-corner-all');\r\n\t            div.classList.add('ui-widget-content');\r\n\t            var header = document.createElement('h3');\r\n\t            header.classList.add('xbim-assignment-header');\r\n\t            header.classList.add('ui-corner-all');\r\n\t            header.classList.add('ui-widget-header');\r\n\t            header.classList.add('ui-state-default');\r\n\t            header.innerHTML = set.name ? set.name : 'Undefined';\r\n\t            div.appendChild(header);\r\n\t            var data = document.createElement('div');\r\n\t            data.classList.add('xbim-assignment-content');\r\n\t            this._renderListView(data, set.assignments);\r\n\t            div.appendChild(data);\r\n\t            container.appendChild(div);\r\n\t        }\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders documents as a list view. If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderDocuments\r\n\t    * @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n\t    * {@link xBrowser#event:entityClick entityClick},\r\n\t    * {@link xBrowser#event:entityDblclick entityDblclick},\r\n\t    * {@link xBrowser#event:entityMouseDown entityMouseDown},\r\n\t    * {@link xBrowser#event:entityMouseUp entityMouseUp},\r\n\t    * {@link xBrowser#event:entityMouseMove entityMouseMove},\r\n\t    * {@link xBrowser#event:entityTouch entityTouch},\r\n\t    * {@link xBrowser#event:entityActive entityActive}\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderDocuments = function (entity, container) {\r\n\t        if (!entity)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        var docs = entity.documents;\r\n\t        if (docs) {\r\n\t            this._renderListView(container, docs, null);\r\n\t        }\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders issues assigned to the entity as a list view. If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n\t    * created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n\t    * heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n\t    * @function xBrowser#renderIssues\r\n\t    * @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n\t    * {@link xBrowser#event:entityClick entityClick},\r\n\t    * {@link xBrowser#event:entityDblclick entityDblclick},\r\n\t    * {@link xBrowser#event:entityMouseDown entityMouseDown},\r\n\t    * {@link xBrowser#event:entityMouseUp entityMouseUp},\r\n\t    * {@link xBrowser#event:entityMouseMove entityMouseMove},\r\n\t    * {@link xBrowser#event:entityTouch entityTouch},\r\n\t    * {@link xBrowser#event:entityActive entityActive}\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderIssues = function (entity, container) {\r\n\t        if (!entity)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        var issues = entity.issues;\r\n\t        if (issues) {\r\n\t            this._renderListView(container, issues, null);\r\n\t        }\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders attributes assigned to the entity as a list view. Attributes are COBie equivalent for Property Sets and can contain\r\n\t    * arbitrary data. If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want.\r\n\t    * @function xBrowser#renderAttributes\r\n\t    * @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n\t    * {@link xBrowser#event:entityClick entityClick},\r\n\t    * {@link xBrowser#event:entityDblclick entityDblclick},\r\n\t    * {@link xBrowser#event:entityMouseDown entityMouseDown},\r\n\t    * {@link xBrowser#event:entityMouseUp entityMouseUp},\r\n\t    * {@link xBrowser#event:entityMouseMove entityMouseMove},\r\n\t    * {@link xBrowser#event:entityTouch entityTouch},\r\n\t    * {@link xBrowser#event:entityActive entityActive}\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderAttributes = function (entity, container) {\r\n\t        if (!entity)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        var html = self._templates.attribute(entity);\r\n\t        container.innerHTML = html;\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders properties assigned to the entity as a list view. Properties are predefined in COBie data model. If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want.\r\n\t    * @function xBrowser#renderProperties\r\n\t    * @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n\t    * {@link xBrowser#event:entityClick entityClick},\r\n\t    * {@link xBrowser#event:entityDblclick entityDblclick},\r\n\t    * {@link xBrowser#event:entityMouseDown entityMouseDown},\r\n\t    * {@link xBrowser#event:entityMouseUp entityMouseUp},\r\n\t    * {@link xBrowser#event:entityMouseMove entityMouseMove},\r\n\t    * {@link xBrowser#event:entityTouch entityTouch},\r\n\t    * {@link xBrowser#event:entityActive entityActive}\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderProperties = function (entity, container) {\r\n\t        if (!entity)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        var html = self._templates.property(entity);\r\n\t        container.innerHTML = html;\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * This function renders properties and attributes assigned to the entity as a list view. This combines data which can be rendered separately\r\n\t    * by {@link xBrowser#renderProperties renderProperties()} or {@link xBrowser#renderAttributes renderAttributes()} but it is sometimes convenient\r\n\t    * to render both into one single layout.  If you use jQuery UI it will use UI icons.\r\n\t    * But it is not mandatory and you can style it any way you want.\r\n\t    *\r\n\t    * @function xBrowser#renderPropertiesAttributes\r\n\t    * @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n\t    * {@link xBrowser#event:entityClick entityClick},\r\n\t    * {@link xBrowser#event:entityDblclick entityDblclick},\r\n\t    * {@link xBrowser#event:entityMouseDown entityMouseDown},\r\n\t    * {@link xBrowser#event:entityMouseUp entityMouseUp},\r\n\t    * {@link xBrowser#event:entityMouseMove entityMouseMove},\r\n\t    * {@link xBrowser#event:entityTouch entityTouch},\r\n\t    * {@link xBrowser#event:entityActive entityActive}\r\n\t    * @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n\t    */\r\n\t    xBrowser.prototype.renderPropertiesAttributes = function (entity, container) {\r\n\t        if (!entity)\r\n\t            throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        var html = self._templates.propertyattribute(entity);\r\n\t        container.innerHTML = html;\r\n\t    };\r\n\t    ;\r\n\t    xBrowser.prototype._registerEntityCallBacks = function (element, entity) {\r\n\t        var self = this;\r\n\t        element.entity = entity;\r\n\t        //element.addEventListener('', function (e) { self._fire('', { entity: entity, event: e , element: element}); e.stopPropagation(); });\r\n\t        /**\r\n\t        * Occurs when user clicks on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n\t        * @event xBrowser#entityClick\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element\r\n\t        */\r\n\t        /**\r\n\t        * Occurs when user clicks on a HTML element representing {@link xVisualEntity xVisualEntity} or if {@link xBrowser#activateEntity activateEntity()} is called.\r\n\t        * @event xBrowser#entityActive\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element - This argument might be null if event is fired in code by call to {@link xBrowser#activateEntity activateEntity()}.\r\n\t        */\r\n\t        /**\r\n\t        * Occurs when user double clicks on a HTML element representing {@link xVisualEntity xVisualEntity}.\r\n\t        * @event xBrowser#entityDblclick\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element - This argument might be null if event is fired in code by call to {@link xBrowser#activateEntity activateEntity()}.\r\n\t        */\r\n\t        element.addEventListener('click', function (e) {\r\n\t            self._fire('entityClick', { entity: entity, event: e, element: element });\r\n\t            self._fire('entityActive', { entity: entity, event: e, element: element });\r\n\t            e.stopPropagation();\r\n\t        });\r\n\t        element.addEventListener('dblclick', function (e) {\r\n\t            self._fire('entityDblclick', { entity: entity, event: e, element: element });\r\n\t            self._fire('entityActive', { entity: entity, event: e, element: element });\r\n\t            e.stopPropagation();\r\n\t        });\r\n\t        /**\r\n\t        * Occurs when mouseDown event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n\t        * @event xBrowser#entityMouseDown\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element\r\n\t        */\r\n\t        element.addEventListener('mouseDown', function (e) { self._fire('entityMouseDown', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n\t        /**\r\n\t        * Occurs when mouseUp event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n\t        * @event xBrowser#entityMouseUp\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element\r\n\t        */\r\n\t        element.addEventListener('mouseUp', function (e) { self._fire('entityMouseUp', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n\t        /**\r\n\t        * Occurs when mouseMove event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n\t        * @event xBrowser#entityMouseMove\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element\r\n\t        */\r\n\t        element.addEventListener('mouseMove', function (e) { self._fire('entityMouseMove', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n\t        /**\r\n\t        * Occurs when touch event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n\t        * @event xBrowser#entityTouch\r\n\t        * @type {object}\r\n\t        * @param {xVisualEntity} entity\r\n\t        * @param {object} event\r\n\t        * @param {HTMLElement} element\r\n\t        */\r\n\t        element.addEventListener('touch', function (e) { self._fire('entityTouch', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n\t    };\r\n\t    ;\r\n\t    xBrowser.prototype._uiTree = function (container) {\r\n\t        if (!container)\r\n\t            return;\r\n\t        //this only works if jQuery UI is available\r\n\t        if (!jQuery || !jQuery.ui)\r\n\t            return;\r\n\t        var $container = typeof (container) == 'string' ? $(\"#\" + container) : $(container);\r\n\t        var elements = typeof (container) == 'string' ? $(\"#\" + container + \" li\") : $(container).find('li');\r\n\t        //return if tree has been initialized already\r\n\t        if ($container.hasClass('xbim-tree'))\r\n\t            return;\r\n\t        $container.addClass('xbim-tree');\r\n\t        var iconOpen = \"ui-icon-triangle-1-s\";\r\n\t        var iconClosed = \"ui-icon-triangle-1-e\";\r\n\t        var iconLeaf = \"ui-icon-document\";\r\n\t        elements\r\n\t            .prepend(function () {\r\n\t            if ($(this).children('ul').length > 0) {\r\n\t                $(this).addClass('xbim-tree-node');\r\n\t                return '<span class=\"ui-icon ' + iconClosed + '\" style=\"float: left;\"></span>';\r\n\t            }\r\n\t            else {\r\n\t                $(this).addClass('xbim-tree-leaf');\r\n\t                return '';\r\n\t            }\r\n\t        })\r\n\t            .css('list-style-type', 'none')\r\n\t            .css('cursor', 'default')\r\n\t            .children('ul').hide();\r\n\t        elements.find('span.' + iconClosed).on(\"click\", function (e) {\r\n\t            e.stopPropagation();\r\n\t            $(this).parent().children('ul').slideToggle();\r\n\t            if ($(this).hasClass(iconClosed))\r\n\t                $(this).removeClass(iconClosed).addClass(iconOpen);\r\n\t            else\r\n\t                $(this).removeClass(iconOpen).addClass(iconClosed);\r\n\t        });\r\n\t        //open first level if there is only one element\r\n\t        var firstLevel = $container.children('ul').children('li');\r\n\t        if (firstLevel.length == 1)\r\n\t            firstLevel.children('span.' + iconClosed).click();\r\n\t    };\r\n\t    ;\r\n\t    xBrowser.prototype._renderListView = function (container, entities, entityTemplate) {\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        entityTemplate = entityTemplate ? entityTemplate : self._templates.entity;\r\n\t        var table = document.createElement('table');\r\n\t        container.innerHTML = \"\";\r\n\t        container.appendChild(table);\r\n\t        for (var i = 0; i < entities.length; i++) {\r\n\t            var entity = entities[i];\r\n\t            var html = entityTemplate(entity);\r\n\t            var tr = document.createElement('tr');\r\n\t            table.appendChild(tr);\r\n\t            var td = document.createElement('td');\r\n\t            tr.appendChild(td);\r\n\t            td.innerHTML = html;\r\n\t            this._registerEntityCallBacks(td, entity);\r\n\t            if (jQuery && jQuery.ui) {\r\n\t                var icon = this._iconMap[entity.type] ? this._iconMap[entity.type] : this._iconMap['def'];\r\n\t                $(td).prepend('<span class=\"ui-icon ' + icon + '\" style=\"float: left;\"></span>');\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    ;\r\n\t    xBrowser.prototype._renderTreeView = function (container, roots, initSimpleTree, entityTemplate) {\r\n\t        var self = this;\r\n\t        container = this._getContainer(container);\r\n\t        entityTemplate = entityTemplate ? entityTemplate : self._templates.entity;\r\n\t        initSimpleTree = initSimpleTree ? initSimpleTree : true;\r\n\t        var renderEntities = function (entities, ul) {\r\n\t            for (var i = 0; i < entities.length; i++) {\r\n\t                var entity = entities[i];\r\n\t                var html = entityTemplate(entity);\r\n\t                var li = document.createElement('li');\r\n\t                li.innerHTML = html;\r\n\t                self._registerEntityCallBacks(li, entity);\r\n\t                if (!ul) {\r\n\t                    var ul = document.createElement('ul');\r\n\t                    container.appendChild(ul);\r\n\t                }\r\n\t                ul.appendChild(li);\r\n\t                //recursive call if this element has any children\r\n\t                if (entity.children && entity.children.length > 0) {\r\n\t                    var inUl = document.createElement('ul');\r\n\t                    li.appendChild(inUl);\r\n\t                    renderEntities(entity.children, inUl);\r\n\t                }\r\n\t                if (jQuery && jQuery.ui) {\r\n\t                    var icon = self._iconMap[entity.type] ? self._iconMap[entity.type] : self._iconMap['def'];\r\n\t                    $(li).prepend('<span class=\"ui-icon ' + icon + '\" style=\"float: left;\"></span>');\r\n\t                }\r\n\t            }\r\n\t        };\r\n\t        renderEntities(roots);\r\n\t        if (initSimpleTree)\r\n\t            this._uiTree(container);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * Use this function to activate entity from code. This will cause {@link xBrowser#event:entityActive entityActive} event to be fired.\r\n\t    * That might be usefull to update data relying on any kind of selection.\r\n\t    * @function xBrowser#activateEntity\r\n\t    * @param {Number} id - ID of the entity to be activated\r\n\t    */\r\n\t    xBrowser.prototype.activateEntity = function (id) {\r\n\t        if (!this._model)\r\n\t            return;\r\n\t        var entity = this._model.getEntity(id);\r\n\t        if (!entity)\r\n\t            return;\r\n\t        this._fire('entityActive', { entity: entity });\r\n\t    };\r\n\t    ;\r\n\t    xBrowser.prototype._getContainer = function (container) {\r\n\t        if (typeof (container) == 'object')\r\n\t            return container;\r\n\t        if (typeof (container) == 'string') {\r\n\t            container = document.getElementById(container);\r\n\t            if (container)\r\n\t                return container;\r\n\t        }\r\n\t        if (!container)\r\n\t            return document.documentElement;\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * Use this function to load data from JSON representation of COBieLite. Listen to {@link xBrowser#event:loaded loaded} event to start\r\n\t    * using the browser.\r\n\t    * @function xBrowser#load\r\n\t    * @param {string|File|Blob} source - path to JSON data or File or Blob object to be used to load the data from\r\n\t    * @fires xBrowser#loaded\r\n\t    */\r\n\t    xBrowser.prototype.load = function (source) {\r\n\t        if (typeof (source) == 'undefined')\r\n\t            throw 'You have to define a source to JSON data.';\r\n\t        var self = this;\r\n\t        //if it is a file, load its content\r\n\t        if (source instanceof Blob || source instanceof File) {\r\n\t            var fReader = new FileReader();\r\n\t            fReader.onloadend = function () {\r\n\t                if (fReader.result) {\r\n\t                    //set data buffer for next processing\r\n\t                    var data = JSON.parse(fReader.result);\r\n\t                    //set right utils according to the data type\r\n\t                    var uk = typeof (data.FacilityDefaultLinearUnit) === \"undefined\";\r\n\t                    var utils = uk ? new xbim_cobieuk_utils_1.xCobieUkUtils(self._lang, self._culture) : new xbim_cobie_utils_1.xCobieUtils(self._lang, self._culture);\r\n\t                    self._model = utils.getVisualModel(data);\r\n\t                    self._fire('loaded', { model: self._model });\r\n\t                }\r\n\t            };\r\n\t            fReader.readAsText(source);\r\n\t            return;\r\n\t        }\r\n\t        //it should be a string now. Throw an exception if it isn't\r\n\t        if (typeof (source) !== 'string')\r\n\t            throw \"Unexpected type of source. It should be File, Blob of string URL\";\r\n\t        //if it is a string than use ajax to load the data\r\n\t        var xhr = new XMLHttpRequest();\r\n\t        xhr.open('GET', source, true);\r\n\t        xhr.onreadystatechange = function () {\r\n\t            if (xhr.readyState == 4 && xhr.status == 200) {\r\n\t                var data = xhr.response;\r\n\t                //----- IE fix\r\n\t                if (typeof (data) == 'string')\r\n\t                    data = JSON.parse(data);\r\n\t                //------\r\n\t                //decide about the version if utils\r\n\t                var uk = typeof (data.FacilityDefaultLinearUnit) === \"undefined\";\r\n\t                var utils = uk ? new xbim_cobieuk_utils_1.xCobieUkUtils(self._lang, self._culture) : new xbim_cobie_utils_1.xCobieUtils(self._lang, self._culture);\r\n\t                self._model = utils.getVisualModel(data);\r\n\t                /**\r\n\t                * Occurs when JSON data model is loaded\r\n\t                * @event xBrowser#loaded\r\n\t                * @type {object}\r\n\t                * @param {xVisualModel} model - preprocessed {@link xVisualModel model} prepared for visual representation\r\n\t                * @param {object} model - original COBie data\r\n\t                */\r\n\t                self._fire('loaded', { model: self._model });\r\n\t            }\r\n\t            //throw exception as a warning\r\n\t            if (xhr.readyState == 4 && xhr.status != 200) {\r\n\t                var msg = 'Failed to fetch semantic JSON data from server. Server code: ' + xhr.status +\r\n\t                    '. This might be due to CORS policy of your browser if you run this as a local file.';\r\n\t                throw msg;\r\n\t            }\r\n\t        };\r\n\t        xhr.responseType = 'json';\r\n\t        xhr.send();\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * Use this method to register to events of the browser. You can define arbitrary number\r\n\t    * of event handlers for any event. You can remove handler by calling {@link xBrowser#onRemove onRemove()} method.\r\n\t    *\r\n\t    * @function xBrowser#on\r\n\t    * @param {String} eventName - Name of the event you would like to listen to.\r\n\t    * @param {Object} callback - Callback handler of the event which will consume arguments and perform any custom action.\r\n\t    */\r\n\t    xBrowser.prototype.on = function (eventName, callback) {\r\n\t        var events = this._events;\r\n\t        if (!events[eventName]) {\r\n\t            events[eventName] = [];\r\n\t        }\r\n\t        events[eventName].push(callback);\r\n\t    };\r\n\t    ;\r\n\t    /**\r\n\t    * Use this method to unregisted handlers from events. You can add event handlers by call to {@link xBrowser#on on()} method.\r\n\t    *\r\n\t    * @function xBrowser#onRemove\r\n\t    * @param {String} eventName - Name of the event\r\n\t    * @param {Object} callback - Handler to be removed\r\n\t    */\r\n\t    xBrowser.prototype.onRemove = function (eventName, callback) {\r\n\t        var events = this._events;\r\n\t        var callbacks = events[eventName];\r\n\t        if (!callbacks) {\r\n\t            return;\r\n\t        }\r\n\t        var index = callbacks.indexOf(callback);\r\n\t        if (index >= 0) {\r\n\t            callbacks.splice(index, 1);\r\n\t        }\r\n\t    };\r\n\t    ;\r\n\t    //executes all handlers bound to event name\r\n\t    xBrowser.prototype._fire = function (eventName, args) {\r\n\t        var handlers = this._events[eventName];\r\n\t        if (!handlers) {\r\n\t            return;\r\n\t        }\r\n\t        //call the callbacks\r\n\t        handlers.forEach(function (handler) {\r\n\t            handler(args);\r\n\t        }, this);\r\n\t    };\r\n\t    ;\r\n\t    return xBrowser;\r\n\t}());\r\n\texports.xBrowser = xBrowser;\r\n\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tfunction xVisualTemplates() {\r\n\t    return {\r\n\t        property: '<%if (properties && properties.length > 0) {%>\\\r\n\t<table> \\\r\n\t    <% for (var p in properties) { var prop = properties[p];%> \\\r\n\t    <tr> \\\r\n\t        <td><%=prop.name%></td>\\\r\n\t        <td><%=prop.value%></td>\\\r\n\t    </tr>\\\r\n\t    <%}%>\\\r\n\t</table> \\\r\n\t<%}%>',\r\n\t        attribute: '<% if (attributes && attributes.length > 0) {\\\r\n\t    var psets = [];\\\r\n\t    for(var i = 0; i < attributes.length; i++){\\\r\n\t        var attr = attributes[i]; var pset = attr.propertySet; if (pset) {if(psets.indexOf(pset) == -1){psets.push(pset);}}\\\r\n\t    }\\\r\n\t%>\\\r\n\t<table> \\\r\n\t    <% for (var p in psets) { var psetName = psets[p]; var pset = attributes.filter(function(e){ return e.propertySet == psetName;});\\\r\n\t%>\\\r\n\t<tr><th colspan=\"2\"><%=psetName%></th></tr>\\\r\n\t<%for (var a in pset) { var attr = pset[a];%> \\\r\n\t    <tr title=\"<%=attr.description%>\"> \\\r\n\t        <td><%=attr.name%></td>\\\r\n\t        <td><%=attr.value%></td>\\\r\n\t    </tr>\\\r\n\t    <%}}%>\\\r\n\t</table>\\\r\n\t<%}%>',\r\n\t        propertyattribute: '<%if (properties.length > 0 || attributes.length > 0) {%><table> \\\r\n\t    <% for (var p in properties) { var prop = properties[p];%> \\\r\n\t    <tr> \\\r\n\t        <td><%=prop.name%></td>\\\r\n\t        <td><%=prop.value%></td>\\\r\n\t    </tr>\\\r\n\t    <%}%>\\\r\n\t<%}\\\r\n\tif (attributes && attributes.length > 0) {\\\r\n\t    var psets = [];\\\r\n\t    for(var i = 0; i < attributes.length; i++){\\\r\n\t        var attr = attributes[i]; if (!attr.propertySet) attr.propertySet = \"General\";\\\r\n\t        var pset = attr.propertySet; if (pset) {if(psets.indexOf(pset) == -1){psets.push(pset);}}\\\r\n\t    }\\\r\n\t%>\\\r\n\t    <% for (var p in psets) { var psetName = psets[p]; var pset = attributes.filter(function(e){ return e.propertySet == psetName;});\\\r\n\t%>\\\r\n\t<tr><th colspan=\"2\"><%=psetName%></th></tr>\\\r\n\t<%for (var a in pset) { var attr = pset[a];%> \\\r\n\t    <tr title=\"<%=attr.description%>\"> \\\r\n\t        <td><%=attr.name%></td>\\\r\n\t        <td><%=attr.value%></td>\\\r\n\t    </tr>\\\r\n\t    <%}}%>\\\r\n\t</table>\\\r\n\t<%}%>',\r\n\t        entity: '<span class=\"xbim-entity\" title=\"<%=typeof(description) != \"undefined\" ? description : \"\"%>\"> <%= name? name: (function f() { return type.charAt(0).toUpperCase() + type.slice(1); })() %> </span>',\r\n\t        contact: '<% var nameA = properties.filter(function(e){return e.id == \"ContactGivenName\";})[0] || properties.filter(function(e){return e.id == \"GivenName\";})[0]; \\\r\n\tvar surnameA = properties.filter(function(e){return e.id == \"ContactFamilyName\";})[0] || properties.filter(function(e){return e.id == \"FamilyName\";})[0]; \\\r\n\tvar emailA = properties.filter(function(e){return e.id == \"ContactEmail\";})[0] || properties.filter(function(e){return e.id == \"Email\";})[0]; \\\r\n\tvar name = nameA ? nameA.value : \"\";\\\r\n\tvar surname = surnameA ? surnameA.value : \"\";\\\r\n\tvar email = emailA ? emailA.value : \"\"; %>\\\r\n\t<span class=\"xbim-entity\" title=\"<%=email%>\"> <%=name%> <%=surname%> <% if (!name && !surname) print(\"No name\"); %> </span>'\r\n\t    };\r\n\t}\r\n\texports.xVisualTemplates = xVisualTemplates;\r\n\t;\r\n\n\n/***/ },\n/* 21 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar xVisualModel = (function () {\r\n\t    /**\r\n\t    * Visual model containing preprocessed COBie data in more uniform form usable for templating and rendering\r\n\t    *\r\n\t    * @name xVisualModel\r\n\t    * @constructor\r\n\t    * @classdesc Visual model containing preprocessed COBie data in more uniform form usable for templating and rendering\r\n\t    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n\t    */\r\n\t    function xVisualModel(values) {\r\n\t        /** @member {xVisualEntity[]} xVisualModel#facility - An array of facilities. There is always one faclity but it is convenient to have all\r\n\t        * members of xVisualModel to be an array so they can be accessed in an uniform way.\r\n\t        */\r\n\t        this.facility = [];\r\n\t        /** @member {xVisualEntity[]} xVisualModel#zones - An array of zones defined in COBie model. They contain spaces as their children. */\r\n\t        this.zones = [];\r\n\t        /** @member {xVisualEntity[]} xVisualModel#systems - An array of systems */\r\n\t        this.systems = [];\r\n\t        /** @member {xVisualEntity[]} xVisualModel#contacts - An array of all contacts used in the COBie model*/\r\n\t        this.contacts = [];\r\n\t        /** @member {xVisualEntity[]} xVisualModel#assetTypes - An array of all asset types. These contain assets as their children */\r\n\t        this.assetTypes = [];\r\n\t        if (typeof (values) == 'object') {\r\n\t            for (var a in values) {\r\n\t                this[a] = values[a];\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t    xVisualModel.prototype.getEntity = function (id) {\r\n\t        if (typeof (id) == 'undefined' || id == null)\r\n\t            return null;\r\n\t        id = id.toString();\r\n\t        var get = function (collection, id) {\r\n\t            for (var i = 0; i < collection.length; i++) {\r\n\t                var entity = collection[i];\r\n\t                if (entity.id == id)\r\n\t                    return entity;\r\n\t                var result = get(entity.children, id);\r\n\t                if (result)\r\n\t                    return result;\r\n\t            }\r\n\t            return null;\r\n\t        };\r\n\t        for (var i in this) {\r\n\t            if (typeof (this[i]) == 'function')\r\n\t                continue;\r\n\t            var result = get(this[i], id);\r\n\t            if (result)\r\n\t                return result;\r\n\t        }\r\n\t        return null;\r\n\t    };\r\n\t    return xVisualModel;\r\n\t}());\r\n\texports.xVisualModel = xVisualModel;\r\n\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_visual_entity_1 = __webpack_require__(23);\r\n\tvar xbim_visual_model_1 = __webpack_require__(21);\r\n\tvar xbim_attribute_dictionary_1 = __webpack_require__(18);\r\n\tvar xbim_visual_assignment_set_1 = __webpack_require__(24);\r\n\tvar xbim_visual_attribute_1 = __webpack_require__(25);\r\n\tvar xbim_visual_property_1 = __webpack_require__(26);\r\n\tvar xCobieUkUtils = (function () {\r\n\t    function xCobieUkUtils(lang, culture) {\r\n\t        this._contacts = [];\r\n\t        this.settings = {\r\n\t            decimalPlaces: 4\r\n\t        };\r\n\t        this._dictionary = new xbim_attribute_dictionary_1.xAttributeDictionary(lang, culture);\r\n\t    }\r\n\t    xCobieUkUtils.prototype.getVisualEntity = function (entity, type) {\r\n\t        if (!entity || !type)\r\n\t            throw 'entity must be defined';\r\n\t        return new xbim_visual_entity_1.xVisualEntity({\r\n\t            id: entity.ExternalId,\r\n\t            type: type,\r\n\t            name: this\r\n\t                .getValidationStatus(entity) +\r\n\t                entity.Name,\r\n\t            description: entity.Description,\r\n\t            attributes: this.getAttributes(entity),\r\n\t            properties: this.getProperties(entity),\r\n\t            assignments: this.getAssignments(entity, type),\r\n\t            documents: this.getDocuments(entity, type),\r\n\t            issues: this.getIssues(entity)\r\n\t        });\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getValidationStatus = function (entity) {\r\n\t        if (entity.Categories == null)\r\n\t            return '';\r\n\t        for (var i = 0; i < entity.Categories.length; i++) {\r\n\t            var category = entity.Categories[i];\r\n\t            if (typeof (category.Code) !== 'undefined' && category.Code.toLowerCase() === 'failed')\r\n\t                return '[F] ';\r\n\t            if (typeof (category.Code) !== 'undefined' && category.Code.toLowerCase() === 'passed')\r\n\t                return '[T] ';\r\n\t        }\r\n\t        return '';\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getVisualModel = function (data) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        //contacts are used very often as a references in assignments\r\n\t        //so it is good to have them in the wide scope for processing\r\n\t        this._contacts = this.getContacts(data);\r\n\t        var types = this.getAssetTypes(data);\r\n\t        //this will also add assets to spaces where they should be\r\n\t        var facility = this.getSpatialStructure(data, types);\r\n\t        return new xbim_visual_model_1.xVisualModel({\r\n\t            facility: facility,\r\n\t            zones: this.getZones(data, facility),\r\n\t            systems: this.getSystems(data, types),\r\n\t            assetTypes: types,\r\n\t            contacts: this._contacts\r\n\t        });\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getContacts = function (data) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var contacts = data.Contacts;\r\n\t        if (!contacts)\r\n\t            return result;\r\n\t        for (var i = 0; i < contacts.length; i++) {\r\n\t            var vContact = this.getVisualEntity(contacts[i], 'contact');\r\n\t            result.push(vContact);\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getSpatialStructure = function (data, types) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        if (!types)\r\n\t            throw 'types must be defined';\r\n\t        var facility = this.getVisualEntity(data, 'facility');\r\n\t        var floors = data.Floors;\r\n\t        if (!floors || floors.length == 0)\r\n\t            return [facility];\r\n\t        for (var i in floors) {\r\n\t            var floor = floors[i];\r\n\t            var vFloor = this.getVisualEntity(floor, 'floor');\r\n\t            facility.children.push(vFloor);\r\n\t            var spaces = floor['Spaces'];\r\n\t            if (!spaces)\r\n\t                continue;\r\n\t            for (var s in spaces) {\r\n\t                var space = spaces[s];\r\n\t                var vSpace = this.getVisualEntity(space, 'space');\r\n\t                vFloor.children.push(vSpace);\r\n\t            }\r\n\t        }\r\n\t        //add asset types and assets to spaces \r\n\t        for (var t in types) {\r\n\t            var type = types[t];\r\n\t            for (var i in type.children) {\r\n\t                var instance = type.children[i];\r\n\t                //check assignments\r\n\t                var assignmentSet = instance.assignments.filter(function (e) { return e.id == 'Space'; })[0];\r\n\t                if (!assignmentSet)\r\n\t                    continue;\r\n\t                var key = assignmentSet.assignments[0];\r\n\t                if (!key)\r\n\t                    continue;\r\n\t                var spaceProp = key.properties.filter(function (e) { return e.id == 'Name'; })[0];\r\n\t                if (!spaceProp)\r\n\t                    continue;\r\n\t                var spaceName = spaceProp.value.split(',')[0];\r\n\t                for (var j = 0; j < facility.children.length; j++) {\r\n\t                    var floor = facility.children[j];\r\n\t                    var space = floor.children.filter(function (e) { return e.name == spaceName; })[0];\r\n\t                    if (!space)\r\n\t                        continue;\r\n\t                    space.children.push(instance);\r\n\t                    assignmentSet.assignments[0] = space;\r\n\t                    break;\r\n\t                    ;\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        //facility is a root element of the tree spatial structure\r\n\t        return [facility];\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getZones = function (data, facility) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        if (!facility)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var zones = data.Zones;\r\n\t        if (!zones)\r\n\t            return result;\r\n\t        for (var z in zones) {\r\n\t            var zone = zones[z];\r\n\t            var vZone = this.getVisualEntity(zone, 'zone');\r\n\t            result.push(vZone);\r\n\t            //add spaces as a children\r\n\t            var keys = zone.Spaces;\r\n\t            if (!keys || keys.length == 0)\r\n\t                continue;\r\n\t            for (var ki in keys) {\r\n\t                var key = keys[ki];\r\n\t                for (var i = 0; i < facility.length; i++) {\r\n\t                    var f = facility[i];\r\n\t                    for (var j = 0; j < f.children.length; j++) {\r\n\t                        var floor = f.children[j];\r\n\t                        for (var k = 0; k < floor.children.length; k++) {\r\n\t                            var space = floor.children[k];\r\n\t                            if (space.name != key.Name)\r\n\t                                continue;\r\n\t                            //add space as a children\r\n\t                            vZone.children.push(space);\r\n\t                            //add zone to space as an assignment\r\n\t                            var assignmentSet = space.assignments.filter(function (e) { return e.id == 'Zone'; })[0];\r\n\t                            if (!assignmentSet) {\r\n\t                                assignmentSet = new xbim_visual_assignment_set_1.xVisualAssignmentSet();\r\n\t                                assignmentSet.id = 'Zone';\r\n\t                                assignmentSet.name = 'Zones';\r\n\t                                space.assignments.push(assignmentSet);\r\n\t                            }\r\n\t                            assignmentSet.assignments.push(vZone);\r\n\t                        }\r\n\t                    }\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getSystems = function (data, types) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        if (!types)\r\n\t            throw 'types must be defined';\r\n\t        var result = [];\r\n\t        var systems = data.Systems;\r\n\t        if (!systems)\r\n\t            return result;\r\n\t        var instances = [];\r\n\t        for (var k = 0; k < types.length; k++) {\r\n\t            var type = types[k];\r\n\t            for (var c in type.children) {\r\n\t                instances.push(type.children[c]);\r\n\t            }\r\n\t        }\r\n\t        for (var s in systems) {\r\n\t            var system = systems[s];\r\n\t            var vSystem = this.getVisualEntity(system, 'system');\r\n\t            result.push(vSystem);\r\n\t            //add assets to systems \r\n\t            var componentKeys = system.Components;\r\n\t            for (var j = 0; j < componentKeys.length; j++) {\r\n\t                var key = componentKeys[j];\r\n\t                var candidates = instances.filter(function (e) { return e.name == key.Name; });\r\n\t                if (!candidates)\r\n\t                    continue;\r\n\t                var instance = candidates[0];\r\n\t                if (!instance)\r\n\t                    continue;\r\n\t                //add asset to system\r\n\t                vSystem.children.push(instance);\r\n\t                //add system to asset assignments\r\n\t                var assignmentSet = instance.assignments.filter(function (e) { return e.id == 'System'; })[0];\r\n\t                if (!assignmentSet) {\r\n\t                    assignmentSet = new xbim_visual_assignment_set_1.xVisualAssignmentSet();\r\n\t                    assignmentSet.id = 'System';\r\n\t                    assignmentSet.Name = 'Systems';\r\n\t                    instance.assignments.push(assignmentSet);\r\n\t                }\r\n\t                assignmentSet.assignments.push(vSystem);\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getAssetTypes = function (data) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var tr = this.getTranslator();\r\n\t        var types = data.AssetTypes;\r\n\t        if (!types)\r\n\t            return result;\r\n\t        for (var t in types) {\r\n\t            var type = types[t];\r\n\t            var vType = this.getVisualEntity(type, 'assettype');\r\n\t            result.push(vType);\r\n\t            //process instances of type\r\n\t            var instances = type.Assets;\r\n\t            if (!instances)\r\n\t                continue;\r\n\t            for (var i in instances) {\r\n\t                var instance = instances[i];\r\n\t                var vInstance = this.getVisualEntity(instance, 'asset');\r\n\t                vType.children.push(vInstance);\r\n\t                //add assignment to the type\r\n\t                var assignment = new xbim_visual_assignment_set_1.xVisualAssignmentSet();\r\n\t                assignment.id = 'AssetType';\r\n\t                assignment.name = tr(assignment.id);\r\n\t                assignment.assignments.push(vType);\r\n\t                vInstance.assignments.push(assignment);\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getProperties = function (entity) {\r\n\t        if (!entity)\r\n\t            throw 'entity must be defined';\r\n\t        var tr = this.getTranslator();\r\n\t        var result = [];\r\n\t        for (var a in entity) {\r\n\t            var attr = entity[a];\r\n\t            var valStr = this.getValueString(attr);\r\n\t            if (valStr) {\r\n\t                var nameStr = tr(a);\r\n\t                result.push(new xbim_visual_property_1.xVisualProperty({ name: nameStr, value: valStr, id: a }));\r\n\t            }\r\n\t        }\r\n\t        var catProperties = this.getCategoryProperties(entity);\r\n\t        for (var i = 0; i < catProperties.length; i++) {\r\n\t            result.push(catProperties[i]);\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getCategoryProperties = function (entity) {\r\n\t        var cats = entity.Categories;\r\n\t        if (!cats)\r\n\t            return [];\r\n\t        var result = [];\r\n\t        for (var i = 0; i < cats.length; i++) {\r\n\t            var cat = cats[i];\r\n\t            var valStr = cat.Code + cat.Description ? ': ' + cat.Description : '';\r\n\t            result.push(new xbim_visual_property_1.xVisualProperty({ name: cat.Classification || 'Free category', value: valStr, id: i }));\r\n\t        }\r\n\t        return [];\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getAttributes = function (entity) {\r\n\t        if (!entity)\r\n\t            throw 'entity must be defined';\r\n\t        var result = [];\r\n\t        var attributes = entity.Attributes;\r\n\t        if (!attributes)\r\n\t            return result;\r\n\t        for (var a in attributes) {\r\n\t            var attribute = attributes[a];\r\n\t            result.push(new xbim_visual_attribute_1.xVisualAttribute({\r\n\t                name: attribute.Name,\r\n\t                description: attribute.Description,\r\n\t                value: this.getValueString(attribute),\r\n\t                propertySet: attribute.ExternalEntity,\r\n\t                categories: this.getCategoryProperties(attribute),\r\n\t                issues: attribute.Issues ? this.getIssues({ Issues: attribute.Issues }) : []\r\n\t            }));\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getAssignments = function (entity, type) {\r\n\t        if (!entity || !type)\r\n\t            throw 'entity and type must be defined';\r\n\t        var tr = this.getTranslator();\r\n\t        var result = [];\r\n\t        //assignment can either be an array of keys or a single embeded object\r\n\t        for (var attrName in entity) {\r\n\t            if (!entity.hasOwnProperty(attrName))\r\n\t                continue;\r\n\t            var assignmentSet = new xbim_visual_assignment_set_1.xVisualAssignmentSet();\r\n\t            var attr = entity[attrName];\r\n\t            //set of assignments (keys)\r\n\t            if (attr instanceof Array && attr.length > 0 && typeof (attr[0].KeyType) !== 'undefined') {\r\n\t                assignmentSet.id = attr[0].KeyType;\r\n\t                assignmentSet.name = tr(attrName);\r\n\t                for (var i = 0; i < attr.length; i++) {\r\n\t                    //if it is a contact than add a contact if available\r\n\t                    if (attr[i].KeyType === 'Contact') {\r\n\t                        var contact = this.findContact(attr['Email']);\r\n\t                        if (contact) {\r\n\t                            assignmentSet.assignments.push(contact);\r\n\t                            continue;\r\n\t                        }\r\n\t                    }\r\n\t                    var vAssignment = this.getVisualEntity(attr[i], attr[i].KeyType.toLowerCase());\r\n\t                    vAssignment.isKey = true;\r\n\t                    assignmentSet.assignments.push(vAssignment);\r\n\t                }\r\n\t                result.push(assignmentSet);\r\n\t                continue;\r\n\t            }\r\n\t            //single key assignment\r\n\t            if (typeof (attr.KeyType) !== 'undefined') {\r\n\t                assignmentSet.id = attr.KeyType;\r\n\t                assignmentSet.name = tr(attrName);\r\n\t                //add a contact if it is defined\r\n\t                if (attr.KeyType === 'Contact' && this._contacts) {\r\n\t                    var contact = this.findContact(attr.Email);\r\n\t                    if (contact) {\r\n\t                        assignmentSet.assignments.push(contact);\r\n\t                        result.push(assignmentSet);\r\n\t                        continue;\r\n\t                    }\r\n\t                }\r\n\t                var vEntity = this.getVisualEntity(attr, attr.KeyType.toLowerCase());\r\n\t                assignmentSet.assignments.push(vEntity);\r\n\t                result.push(assignmentSet);\r\n\t                continue;\r\n\t            }\r\n\t            //cope with objects that encapsulate set of information (like a warranty, site, space and eventually others)\r\n\t            if (!(attr instanceof Array) && (attr instanceof Object)) {\r\n\t                assignmentSet.id = attr.KeyType;\r\n\t                assignmentSet.name = tr(attrName);\r\n\t                var vEntity = this.getVisualEntity(attr, 'inner');\r\n\t                assignmentSet.assignments.push(vEntity);\r\n\t                result.push(assignmentSet);\r\n\t                continue;\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.findContact = function (email) {\r\n\t        for (var i = 0; i < this._contacts.length; i++) {\r\n\t            var contact = this._contacts[i];\r\n\t            var emailProp = contact.properties.filter(function (e) { return e.name === 'Email'; })[0];\r\n\t            if (emailProp && emailProp.value === email)\r\n\t                return contact;\r\n\t        }\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getDocuments = function (entity, type) {\r\n\t        if (!entity || !type)\r\n\t            throw 'entity and type must be defined';\r\n\t        var result = [];\r\n\t        var documents = entity.Documents;\r\n\t        if (!documents)\r\n\t            return result;\r\n\t        for (var i = 0; i < documents.length; i++) {\r\n\t            var doc = documents[i];\r\n\t            var vDoc = this.getVisualEntity(doc, 'document');\r\n\t            result.push(vDoc);\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getIssues = function (entity) {\r\n\t        if (!entity)\r\n\t            throw 'entity and type must be defined';\r\n\t        var result = [];\r\n\t        var issues = entity.Issues;\r\n\t        if (!issues)\r\n\t            return result;\r\n\t        for (var i = 0; i < issues.length; i++) {\r\n\t            var issue = issues[i];\r\n\t            var vIssue = this.getVisualEntity(issue, 'issue');\r\n\t            result.push(vIssue);\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.setLanguage = function (lang, culture) {\r\n\t        this._dictionary = new xbim_attribute_dictionary_1.xAttributeDictionary(lang, culture);\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getValueString = function (value) {\r\n\t        if (typeof (value) == 'undefined' || value == null)\r\n\t            return '';\r\n\t        var units = value.Unit || '';\r\n\t        //this is for different kinds of attributes using latest serializer implementation\r\n\t        if (typeof (value.StringAttributeValue) !== 'undefined')\r\n\t            return value.StringAttributeValue.Value || '';\r\n\t        if (typeof (value.BooleanAttributeValue) !== 'undefined')\r\n\t            return value.BooleanAttributeValue.Value || '';\r\n\t        if (typeof (value.DateTimeAttributeValue) !== 'undefined')\r\n\t            return value.DateTimeAttributeValue.Value || '';\r\n\t        if (typeof (value.DecimalAttributeValue) !== 'undefined') {\r\n\t            var number = value.DecimalAttributeValue.Value;\r\n\t            if (number) {\r\n\t                number = number.toFixed(this.settings.decimalPlaces);\r\n\t                return number.toString() + ' ' + units;\r\n\t            }\r\n\t            return '';\r\n\t        }\r\n\t        if (typeof (value.IntegerAttributeValue) !== 'undefined') {\r\n\t            var number = value.IntegerAttributeValue.Value;\r\n\t            if (number) {\r\n\t                return number.toString() + ' ' + units;\r\n\t            }\r\n\t            return '';\r\n\t        }\r\n\t        //return null for arrays and objects (which are both 'object')\r\n\t        if (typeof (value) == 'object')\r\n\t            return null;\r\n\t        return value;\r\n\t    };\r\n\t    xCobieUkUtils.prototype.getTranslator = function () {\r\n\t        var self = this;\r\n\t        return function (term) {\r\n\t            return self._dictionary[term] ? self._dictionary[term] : term.replace(/([a-z0-9])([A-Z])/g, '$1 $2');\r\n\t        };\r\n\t    };\r\n\t    return xCobieUkUtils;\r\n\t}());\r\n\texports.xCobieUkUtils = xCobieUkUtils;\r\n\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar xVisualEntity = (function () {\r\n\t    /**\r\n\t    * Visual model containing entity data\r\n\t    *\r\n\t    * @name xVisualEntity\r\n\t    * @constructor\r\n\t    * @classdesc Visual model containing entity data\r\n\t    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n\t    */\r\n\t    function xVisualEntity(values) {\r\n\t        /** @member {string} xVisualEntity#id - ID extracted from object attributes*/\r\n\t        this.id = '';\r\n\t        /** @member {string} xVisualEntity#type - type of the object like asset, assettype, floor, facility, assembly and others. It is always one lower case word.*/\r\n\t        this.type = '';\r\n\t        /** @member {string} xVisualEntity#name - Name extracted from object attributes*/\r\n\t        this.name = '';\r\n\t        /** @member {string} xVisualEntity#description - Description extracted from attributes*/\r\n\t        this.description = '';\r\n\t        /** @member {xVisualAttribute[]} xVisualEntity#attributes */\r\n\t        this.attributes = [];\r\n\t        /** @member {xVisualProperty[]} xVisualEntity#properties */\r\n\t        this.properties = [];\r\n\t        /** @member {xVisualEntity[]} xVisualEntity#documents */\r\n\t        this.documents = [];\r\n\t        /** @member {xVisualEntity[]} xVisualEntity#issues */\r\n\t        this.issues = [];\r\n\t        /** @member {xVisualAssignmentSet[]} xVisualEntity#assignments - An array of {@link xVisualAsignmentSet visual assignment sets} */\r\n\t        this.assignments = [];\r\n\t        /** @member {xVisualEntity[]} xVisualEntity#children - this can be used to build hierarchical structures like facility -> floors -> spaces -> assets */\r\n\t        this.children = [];\r\n\t        /** @member {xVisualEntity[]} xVisualEntity#warranties - this is applicable for asset type only. */\r\n\t        this.warranties = [];\r\n\t        this.isKey = false; //indicates if this is only a key for the actual entity\r\n\t        if (typeof (values) == 'object') {\r\n\t            for (var a in values) {\r\n\t                this[a] = values[a];\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t    return xVisualEntity;\r\n\t}());\r\n\texports.xVisualEntity = xVisualEntity;\r\n\n\n/***/ },\n/* 24 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t/**\r\n\t* @name xVisualAssignmentSet\r\n\t* @constructor\r\n\t* @classdesc Visual model describing named sets of assignments\r\n\t*/\r\n\tvar xVisualAssignmentSet = (function () {\r\n\t    function xVisualAssignmentSet() {\r\n\t        /** @member {string} xVisualAssignmentSet#name */\r\n\t        this.name = '';\r\n\t        /** @member {string} xVisualAssignmentSet#id */\r\n\t        this.id = '';\r\n\t        /** @member {xVisualEntity[]} xVisualAssignmentSet#assignments */\r\n\t        this.assignments = [];\r\n\t    }\r\n\t    return xVisualAssignmentSet;\r\n\t}());\r\n\texports.xVisualAssignmentSet = xVisualAssignmentSet;\r\n\t;\r\n\n\n/***/ },\n/* 25 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar xVisualAttribute = (function () {\r\n\t    /**\r\n\t    * @name xVisualAttribute\r\n\t    * @constructor\r\n\t    * @classdesc Visual model describing attribute of the object\r\n\t    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n\t    */\r\n\t    function xVisualAttribute(values) {\r\n\t        /** @member {string} xVisualAttribute#name */\r\n\t        this.name = '';\r\n\t        /** @member {string} xVisualAttribute#description */\r\n\t        this.description = '';\r\n\t        /** @member {string} xVisualAttribute#value */\r\n\t        this.value = '';\r\n\t        /** @member {string} xVisualAttribute#propertySet - original property set name from IFC file */\r\n\t        this.propertySet = '';\r\n\t        /** @member {string} xVisualAttribute#category */\r\n\t        this.category = '';\r\n\t        /** @member {xVisualEntity[]} xVisualAttribute#issues */\r\n\t        this.issues = [];\r\n\t        if (typeof (values) == 'object') {\r\n\t            for (var a in values) {\r\n\t                this[a] = values[a];\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t    return xVisualAttribute;\r\n\t}());\r\n\texports.xVisualAttribute = xVisualAttribute;\r\n\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar xVisualProperty = (function () {\r\n\t    /**\r\n\t    * @name xVisualProperty\r\n\t    * @constructor\r\n\t    * @classdesc Visual model describing property of the object\r\n\t    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n\t    */\r\n\t    function xVisualProperty(values) {\r\n\t        /** @member {string} xVisualProperty#name - name might be translated if you specify a language and culture in {@link xBrowser xBrowser} constructor */\r\n\t        this.name = '';\r\n\t        /** @member {string} xVisualProperty#value - string containing eventually units*/\r\n\t        this.value = '';\r\n\t        /** @member {string} xVisualProperty#id - original name from COBie before any transformation*/\r\n\t        this.id = '';\r\n\t        if (typeof (values) == 'object') {\r\n\t            for (var a in values) {\r\n\t                this[a] = values[a];\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t    return xVisualProperty;\r\n\t}());\r\n\texports.xVisualProperty = xVisualProperty;\r\n\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar xbim_visual_entity_1 = __webpack_require__(23);\r\n\tvar xbim_visual_model_1 = __webpack_require__(21);\r\n\tvar xbim_attribute_dictionary_1 = __webpack_require__(18);\r\n\tvar xbim_visual_assignment_set_1 = __webpack_require__(24);\r\n\tvar xbim_visual_attribute_1 = __webpack_require__(25);\r\n\tvar xbim_visual_property_1 = __webpack_require__(26);\r\n\tvar xCobieUtils = (function () {\r\n\t    function xCobieUtils(lang, culture) {\r\n\t        this.settings = {\r\n\t            decimalPlaces: 4\r\n\t        };\r\n\t        this._dictionary = new xbim_attribute_dictionary_1.xAttributeDictionary(lang, culture);\r\n\t    }\r\n\t    xCobieUtils.prototype.getVisualEntity = function (entity, type) {\r\n\t        if (!entity || !type)\r\n\t            throw 'entity must be defined';\r\n\t        var id = entity.externalID || entity.externalIDReference;\r\n\t        var name = '';\r\n\t        var description = '';\r\n\t        for (var a in entity) {\r\n\t            if (!entity.hasOwnProperty(a)) {\r\n\t                continue;\r\n\t            }\r\n\t            if (a.toLowerCase() === (type + 'name').toLowerCase())\r\n\t                name = entity[a];\r\n\t            if (a.toLowerCase() === (type + 'description').toLowerCase())\r\n\t                description = entity[a];\r\n\t            if (name.length !== 0 && description.length !== 0)\r\n\t                break;\r\n\t        }\r\n\t        return new xbim_visual_entity_1.xVisualEntity({\r\n\t            id: id,\r\n\t            type: type,\r\n\t            name: name,\r\n\t            description: description,\r\n\t            attributes: this.getAttributes(entity),\r\n\t            properties: this.getProperties(entity),\r\n\t            assignments: this.getAssignments(entity, type),\r\n\t            documents: this.getDocuments(entity, type),\r\n\t            issues: this.getIssues(entity)\r\n\t        });\r\n\t    };\r\n\t    xCobieUtils.prototype.getVisualModel = function (data) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var types = this.getAssetTypes(data);\r\n\t        var facility = this.getSpatialStructure(data, types);\r\n\t        return new xbim_visual_model_1.xVisualModel({\r\n\t            facility: facility,\r\n\t            zones: this.getZones(data, facility),\r\n\t            systems: this.getSystems(data, types),\r\n\t            assetTypes: types,\r\n\t            contacts: this.getContacts(data)\r\n\t        });\r\n\t    };\r\n\t    xCobieUtils.prototype.getContacts = function (data) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var contacts = data.Contacts;\r\n\t        if (contacts)\r\n\t            contacts = contacts.Contact;\r\n\t        if (!contacts)\r\n\t            return result;\r\n\t        contacts.forEach(function (contact) {\r\n\t            var vContact = this.getVisualEntity(contact, 'contact');\r\n\t            result.push(vContact);\r\n\t        }, this);\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getSpatialStructure = function (data, types) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var facility = this.getVisualEntity(data, 'facility');\r\n\t        var floors = data.Floors;\r\n\t        if (!floors)\r\n\t            return [facility];\r\n\t        floors = floors.Floor;\r\n\t        if (!floors || floors.length == 0)\r\n\t            return [facility];\r\n\t        floors.forEach(function (floor) {\r\n\t            var vFloor = this.getVisualEntity(floor, 'floor');\r\n\t            facility.children.push(vFloor);\r\n\t            var spaces = floor.Spaces;\r\n\t            if (!spaces)\r\n\t                return;\r\n\t            spaces = spaces.Space;\r\n\t            if (!spaces)\r\n\t                return;\r\n\t            spaces.forEach(function (space) {\r\n\t                var vSpace = this.getVisualEntity(space, 'space');\r\n\t                vFloor.children.push(vSpace);\r\n\t            }, this);\r\n\t        }, this);\r\n\t        //add asset types and assets to spaces \r\n\t        types = types ? types : this.getAssetTypes(data);\r\n\t        types.forEach(function (type) {\r\n\t            type.children.forEach(function (instance) {\r\n\t                //check assignments\r\n\t                var assignmentSet = instance.assignments.filter(function (e) { return e.id === 'Space'; })[0];\r\n\t                if (!assignmentSet)\r\n\t                    return;\r\n\t                var key = assignmentSet.assignments[0];\r\n\t                if (!key)\r\n\t                    return;\r\n\t                var spaceProp = key.properties.filter(function (e) { return e.id === 'SpaceName'; })[0];\r\n\t                var floorProp = key.properties.filter(function (e) { return e.id === 'FloorName'; })[0];\r\n\t                if (!floorProp || !spaceProp)\r\n\t                    return;\r\n\t                var spaceName = spaceProp.value;\r\n\t                var floorName = floorProp.value;\r\n\t                var floor = facility.children.filter(function (e) { return e.name === floorName; })[0];\r\n\t                if (!floor)\r\n\t                    return;\r\n\t                var space = floor.children.filter(function (e) { return e.name === spaceName; })[0];\r\n\t                if (!space)\r\n\t                    return;\r\n\t                space.children.push(instance);\r\n\t                assignmentSet.assignments[0] = space;\r\n\t            }, this);\r\n\t        }, this);\r\n\t        //facility is a root element of the tree spatial structure\r\n\t        return [facility];\r\n\t    };\r\n\t    xCobieUtils.prototype.getZones = function (data, facility) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var zones = data.Zones;\r\n\t        if (!zones)\r\n\t            return result;\r\n\t        zones = zones.Zone;\r\n\t        if (!zones)\r\n\t            return result;\r\n\t        zones.forEach(function (zone) {\r\n\t            var vZone = this.getVisualEntity(zone, 'zone');\r\n\t            result.push(vZone);\r\n\t        }, this);\r\n\t        //add spaces as a children of zones\r\n\t        facility.forEach(function (f) {\r\n\t            f.children.forEach(function (floor) {\r\n\t                floor.children.forEach(function (space) {\r\n\t                    var assignmentSet = space.assignments\r\n\t                        .filter(function (e) { return e.id === 'Zone'; })[0];\r\n\t                    if (!assignmentSet)\r\n\t                        return;\r\n\t                    var key = assignmentSet.assignments[0];\r\n\t                    if (!key)\r\n\t                        return;\r\n\t                    if (!key.id)\r\n\t                        return;\r\n\t                    var zone = result.filter(function (e) { return e.id === key.id; })[0];\r\n\t                    if (zone) {\r\n\t                        //add space to visual children\r\n\t                        zone.children.push(space);\r\n\t                        //replace key with actual object\r\n\t                        assignmentSet.assignments[0] = zone;\r\n\t                    }\r\n\t                }, this);\r\n\t            }, this);\r\n\t        }, this);\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getSystems = function (data, types) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var systems = data.Systems;\r\n\t        if (!systems)\r\n\t            return result;\r\n\t        systems = systems.System;\r\n\t        if (!systems)\r\n\t            return result;\r\n\t        systems.forEach(function (system) {\r\n\t            var vSystem = this.getVisualEntity(system, 'system');\r\n\t            result.push(vSystem);\r\n\t        }, this);\r\n\t        //add asset types and assets to spaces \r\n\t        types = types ? types : this.getAssetTypes(data);\r\n\t        types.forEach(function (type) {\r\n\t            type.children.forEach(function (instance) {\r\n\t                //check assignments\r\n\t                var assignmentSet = instance.assignments.filter(function (e) { return e.id === 'System'; })[0];\r\n\t                if (!assignmentSet)\r\n\t                    return;\r\n\t                var key = assignmentSet.assignments[0];\r\n\t                if (!key)\r\n\t                    return;\r\n\t                if (!key.id)\r\n\t                    return;\r\n\t                var system = result.filter(function (e) { return e.id === key.id; })[0];\r\n\t                if (system) {\r\n\t                    //add instance to system's visual children\r\n\t                    system.children.push(instance);\r\n\t                    //replace key with actual object\r\n\t                    assignmentSet.assignments[0] = system;\r\n\t                }\r\n\t            }, this);\r\n\t        }, this);\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getAssetTypes = function (data) {\r\n\t        if (!data)\r\n\t            throw 'data must be defined';\r\n\t        var result = [];\r\n\t        var tr = this.getTranslator();\r\n\t        var types = data.AssetTypes;\r\n\t        if (!types)\r\n\t            return result;\r\n\t        types = types.AssetType;\r\n\t        if (!types)\r\n\t            return result;\r\n\t        types.forEach(function (type) {\r\n\t            var vType = this.getVisualEntity(type, 'assettype');\r\n\t            result.push(vType);\r\n\t            //process instances of type\r\n\t            var instances = type.Assets;\r\n\t            if (!instances)\r\n\t                return;\r\n\t            instances = instances.Asset;\r\n\t            if (!instances)\r\n\t                return;\r\n\t            instances.forEach(function (instance) {\r\n\t                var vInstance = this.getVisualEntity(instance, 'asset');\r\n\t                vType.children.push(vInstance);\r\n\t                //add assignment to the type\r\n\t                var assignment = new xbim_visual_assignment_set_1.xVisualAssignmentSet();\r\n\t                assignment.id = 'AssetType';\r\n\t                assignment.name = tr(assignment.id);\r\n\t                assignment.assignments.push(vType);\r\n\t                vInstance.assignments.push(assignment);\r\n\t            }, this);\r\n\t        }, this);\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getProperties = function (entity) {\r\n\t        if (!entity)\r\n\t            throw 'entity must be defined';\r\n\t        var tr = this.getTranslator();\r\n\t        var result = [];\r\n\t        for (var a in entity) {\r\n\t            if (!entity.hasOwnProperty(a)) {\r\n\t                continue;\r\n\t            }\r\n\t            var attr = entity[a];\r\n\t            var valStr = this.getValueString(attr);\r\n\t            //it is an object not an attribute\r\n\t            if (!valStr)\r\n\t                continue;\r\n\t            var nameStr = tr(a);\r\n\t            result.push(new xbim_visual_property_1.xVisualProperty({ name: nameStr, value: valStr, id: a }));\r\n\t        }\r\n\t        ;\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getAttributes = function (entity) {\r\n\t        if (!entity)\r\n\t            throw 'entity must be defined';\r\n\t        var result = [];\r\n\t        var attributes = null;\r\n\t        for (var a in entity) {\r\n\t            if (!entity.hasOwnProperty(a)) {\r\n\t                continue;\r\n\t            }\r\n\t            if (entity[a].Attribute) {\r\n\t                attributes = entity[a].Attribute;\r\n\t                break;\r\n\t            }\r\n\t        }\r\n\t        if (!attributes)\r\n\t            return result;\r\n\t        attributes.forEach(function (attribute) {\r\n\t            result.push(new xbim_visual_attribute_1.xVisualAttribute({\r\n\t                name: attribute.AttributeName,\r\n\t                description: attribute.AttributeDescription,\r\n\t                value: this.getValueString(attribute.AttributeValue),\r\n\t                propertySet: attribute.propertySetName,\r\n\t                category: attribute.AttributeCategory,\r\n\t                issues: attribute.AttributeIssues ? this.getAttributes(attribute.AttributeIssues) : []\r\n\t            }));\r\n\t        }, this);\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getAssignments = function (entity, type) {\r\n\t        if (!entity || !type)\r\n\t            throw 'entity and type must be defined';\r\n\t        var tr = this.getTranslator();\r\n\t        var result = [];\r\n\t        for (var attr in entity) {\r\n\t            if (!entity.hasOwnProperty(attr)) {\r\n\t                continue;\r\n\t            }\r\n\t            var collection = new xbim_visual_assignment_set_1.xVisualAssignmentSet();\r\n\t            //assignment collection\r\n\t            var r = new RegExp('^(' + type + ')(.*)(assignments)$', 'i');\r\n\t            if (r.test(attr)) {\r\n\t                collection.id = attr.replace(r, '$2');\r\n\t                collection.name = tr(collection.id + 's');\r\n\t                for (var a in entity[attr]) {\r\n\t                    if (!entity[attr].hasOwnProperty(a)) {\r\n\t                        continue;\r\n\t                    }\r\n\t                    var assignmentSet = entity[attr][a];\r\n\t                    var name = a.replace('Assignment', '').toLowerCase();\r\n\t                    for (var a in assignmentSet) {\r\n\t                        if (!assignmentSet.hasOwnProperty(a)) {\r\n\t                            continue;\r\n\t                        }\r\n\t                        var assignment = assignmentSet[a];\r\n\t                        var vAssignment = this.getVisualEntity(assignment, name);\r\n\t                        vAssignment.isKey = true;\r\n\t                        collection.assignments.push(vAssignment);\r\n\t                    }\r\n\t                }\r\n\t            }\r\n\t            //single assignment\r\n\t            r = new RegExp('(.*)(assignment)$', 'i');\r\n\t            if (r.test(attr)) {\r\n\t                collection.id = attr.replace(r, '$1');\r\n\t                collection.name = tr(collection.id);\r\n\t                var vEntity = this.getVisualEntity(entity[attr], collection.id.toLowerCase());\r\n\t                collection.assignments.push(vEntity);\r\n\t            }\r\n\t            if (collection.assignments.length !== 0) {\r\n\t                result.push(collection);\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getDocuments = function (entity, type) {\r\n\t        if (!entity || !type)\r\n\t            throw 'entity and type must be defined';\r\n\t        var result = [];\r\n\t        for (var attr in entity) {\r\n\t            if (!entity.hasOwnProperty(attr)) {\r\n\t                continue;\r\n\t            }\r\n\t            var r = new RegExp('^(' + type + ')(documents)$', 'i');\r\n\t            if (r.test(attr)) {\r\n\t                var documents = entity[attr].Document;\r\n\t                if (!documents)\r\n\t                    continue;\r\n\t                for (var i = 0; i < documents.length; i++) {\r\n\t                    var doc = documents[i];\r\n\t                    var vDoc = this.getVisualEntity(doc, 'document');\r\n\t                    result.push(vDoc);\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.getIssues = function (entity) {\r\n\t        if (!entity)\r\n\t            throw 'entity and type must be defined';\r\n\t        var result = [];\r\n\t        for (var attr in entity) {\r\n\t            if (!entity.hasOwnProperty(attr)) {\r\n\t                continue;\r\n\t            }\r\n\t            if (entity[attr].Issue) {\r\n\t                var issues = entity[attr].Issue;\r\n\t                for (var i = 0; i < issues.length; i++) {\r\n\t                    var issue = issues[i];\r\n\t                    var vIssue = this.getVisualEntity(issue, 'issue');\r\n\t                    result.push(vIssue);\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        return result;\r\n\t    };\r\n\t    xCobieUtils.prototype.setLanguage = function (lang, culture) {\r\n\t        this._dictionary = new xbim_attribute_dictionary_1.xAttributeDictionary(lang, culture);\r\n\t    };\r\n\t    xCobieUtils.prototype.getValueString = function (value) {\r\n\t        if (typeof (value) == 'undefined' || value == null)\r\n\t            return '';\r\n\t        var tr = this.getTranslator();\r\n\t        //this of for attributes prior to serialization enhancements\r\n\t        if (typeof (value.Item) !== 'undefined')\r\n\t            value = value.Item;\r\n\t        //this is for different kinds of attributes using latest serializer implementation\r\n\t        if (typeof (value.AttributeBooleanValue) !== 'undefined')\r\n\t            value = value.AttributeBooleanValue;\r\n\t        if (typeof (value.AttributeDateValue) !== 'undefined')\r\n\t            value = value.AttributeDateValue;\r\n\t        if (typeof (value.AttributeDateTimeValue) !== 'undefined')\r\n\t            value = value.AttributeDateTimeValue;\r\n\t        if (typeof (value.AttributeDecimalValue) !== 'undefined')\r\n\t            value = value.AttributeDecimalValue;\r\n\t        if (typeof (value.AttributeIntegerValue) !== 'undefined')\r\n\t            value = value.AttributeIntegerValue;\r\n\t        if (typeof (value.AttributeMonetaryValue) !== 'undefined')\r\n\t            value = value.AttributeMonetaryValue;\r\n\t        if (typeof (value.AttributeStringValue) !== 'undefined')\r\n\t            value = value.AttributeStringValue;\r\n\t        if (typeof (value.AttributeTimeValue) !== 'undefined')\r\n\t            value = value.AttributeTimeValue;\r\n\t        var baseVal = '';\r\n\t        if (typeof (value) == 'string')\r\n\t            baseVal = value;\r\n\t        if (typeof (value.BooleanValue) !== 'undefined')\r\n\t            baseVal = value.BooleanValue ? tr('True') : tr('False');\r\n\t        if (typeof (value.StringValue) !== 'undefined')\r\n\t            baseVal = value.StringValue;\r\n\t        if (typeof (value.DecimalValue) !== 'undefined')\r\n\t            baseVal = value.DecimalValue.toFixed(this.settings.decimalPlaces).toString();\r\n\t        if (typeof (value.IntegerValue) !== 'undefined')\r\n\t            baseVal = value.IntegerValue.toString();\r\n\t        if (value.UnitName)\r\n\t            baseVal += ' ' + value.UnitName;\r\n\t        return baseVal.length > 0 ? baseVal : '';\r\n\t    };\r\n\t    xCobieUtils.prototype.getTranslator = function () {\r\n\t        var self = this;\r\n\t        return function (term) {\r\n\t            return self._dictionary[term] ? self._dictionary[term] : term.replace(/([a-z0-9])([A-Z])/g, '$1 $2');\r\n\t        };\r\n\t    };\r\n\t    return xCobieUtils;\r\n\t}());\r\n\texports.xCobieUtils = xCobieUtils;\r\n\n\n/***/ },\n/* 28 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 29 */,\n/* 30 */\n28\n/******/ ])))\n});\n;\n\n\n// WEBPACK FOOTER //\n// xbim.bundle.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a0e985e8cc170c1a8190","// Viewer\r\nexport * from './Viewer/xbim-binary-reader';\r\nexport * from './Viewer/xbim-model-geometry';\r\nexport * from './Viewer/xbim-model-handle';\r\nexport * from './Viewer/xbim-product-inheritance';\r\nexport * from './Viewer/xbim-product-type';\r\nexport * from './Viewer/xbim-shaders';\r\nexport * from './Viewer/xbim-state';\r\nexport * from './Viewer/xbim-triangulated-shape';\r\nexport * from './Viewer/xbim-viewer';\r\n\r\n// Plugins\r\nexport * from './Plugins/NavigationCube/xbim-navigation-cube-shaders';\r\nexport * from './Plugins/NavigationCube/xbim-navigation-cube-textures';\r\nexport * from './Plugins/NavigationCube/xbim-navigation-cube';\r\nexport * from './Plugins/NavigationHome/xbim-navigation-home-textures';\r\nexport * from './Plugins/NavigationHome/xbim-navigation-home';\r\n\r\n// Browser\r\nexport * from './Browser/xbim-attribute-dictionary';\r\nexport * from './Browser/xbim-browser';\r\nexport * from './Browser/xbim-cobie-utils';\r\nexport * from './Browser/xbim-cobieuk-utils';\r\nexport * from './Browser/xbim-visual-assignment-set';\r\nexport * from './Browser/xbim-visual-attribute';\r\nexport * from './Browser/xbim-visual-entity';\r\nexport * from './Browser/xbim-visual-model';\r\nexport * from './Browser/xbim-visual-property';\r\nexport * from './Browser/xbim-visual-templates';\n\n\n// WEBPACK FOOTER //\n// ./index.ts","export class xBinaryReader {\n    private _buffer: any = null;\n    private _position: number = 0;\n\n    public onloaded() {}\n\n    public onerror(message?: string) {}\n\n    public load(source: string | Blob | File | ArrayBuffer) {\n        this._position = 0;\n        var self = this;\n\n        if (typeof (source) == 'undefined' || source == null) throw 'Source must be defined';\n        if (typeof (source) == 'string') {\n            var xhr;\n            xhr = new XMLHttpRequest();\n            xhr.open(\"GET\", source, true);\n            xhr.onreadystatechange = function() {\n                if (xhr.readyState == 4 && xhr.status == 200) {\n                    var fReader = new FileReader();\n                    fReader.onloadend = function() {\n                        if (fReader.result) {\n                            //set data buffer for next processing\n                            self._buffer = fReader.result;\n                            //do predefined processing of the data\n                            if (self.onloaded) {\n                                self.onloaded();\n                            }\n                        }\n                    };\n                    fReader.readAsArrayBuffer(xhr.response);\n                }\n                //throw exception as a warning\n                if (xhr.readyState == 4 && xhr.status != 200) {\n                    var msg = 'Failed to fetch binary data from server. Server code: ' +\n                        xhr.status +\n                        '. This might be due to CORS policy of your browser if you run this as a local file.';\n                    if (self.onerror) self.onerror(msg);\n                    throw msg;\n                }\n            };\n            xhr.responseType = 'blob';\n            xhr.send();\n        } else if (source instanceof Blob || source instanceof File) {\n            var fReader = new FileReader();\n            fReader.onloadend = function() {\n                if (fReader.result) {\n                    //set data buffer for next processing\n                    self._buffer = fReader.result;\n                    //do predefined processing of the data\n                    if (self.onloaded) {\n                        self.onloaded();\n                    }\n                }\n            };\n            fReader.readAsArrayBuffer(source);\n        } else if (source instanceof ArrayBuffer) {\n            this._buffer = source;\n        }\n    }\n\n    public getIsEOF(type, count) {\n        if (typeof (this._position) === \"undefined\")\n            throw \"Position is not defined\";\n        return this._position == this._buffer.byteLength;\n    }\n\n    public read(arity, count, ctor) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var length = arity * count;\n        var offset = this._position;\n        this._position += length;\n        var result;\n\n        return count === 1\n            ? new ctor(this._buffer.slice(offset, offset + length))[0]\n            : new ctor(this._buffer.slice(offset, offset + length));\n    }\n\n    public readByte(count) {\n        return this.read(1, count, Uint8Array);\n    }\n\n    public readUint8(count) {\n        return this.read(1, count, Uint8Array);\n    }\n\n    public readInt16(count) {\n        return this.read(2, count, Int16Array);\n    }\n\n    public readUint16(count) {\n        return this.read(2, count, Uint16Array);\n    }\n\n    public readInt32(count) {\n        return this.read(4, count, Int32Array);\n    }\n\n    public readUint32(count) {\n        return this.read(4, count, Uint32Array);\n    }\n\n    public readFloat32(count) {\n        return this.read(4, count, Float32Array);\n    }\n\n    public readFloat64(count) {\n        return this.read(8, count, Float64Array);\n    }\n\n    //functions for a higher objects like points, colours and matrices\n    public readChar(count) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var bytes = this.readByte(count);\n        var result = new Array(count);\n        for (var i in bytes) {\n            result[i] = String.fromCharCode(bytes[i]);\n        }\n        return count === 1 ? result[0] : result;\n    }\n\n    public readPoint(count) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var coords = this.readFloat32(count * 3);\n        var result = new Array(count);\n        for (var i = 0; i < count; i++) {\n            var offset = i * 3 * 4;\n            //only create new view on the buffer so that no new memory is allocated\n            var point = new Float32Array(coords.buffer, offset, 3);\n            result[i] = point;\n        }\n        return count === 1 ? result[0] : result;\n    }\n\n    public readRgba(count) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var values = this.readByte(count * 4);\n        var result = new Array(count);\n        for (var i = 0; i < count; i++) {\n            var offset = i * 4;\n            var colour = new Uint8Array(values.buffer, offset, 4);\n            result[i] = colour;\n        }\n        return count === 1 ? result[0] : result;\n    }\n\n    public readPackedNormal(count) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var values = this.readUint8(count * 2);\n        var result = new Array(count);\n        for (var i = 0; i < count; i++) {\n            var uv = new Uint8Array(values.buffer, i * 2, 2);\n            result[i] = uv;\n        }\n        return count === 1 ? result[0] : result;\n    }\n\n    public readMatrix4x4(count) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var values = this.readFloat32(count * 16);\n        var result = new Array(count);\n        for (var i = 0; i < count; i++) {\n            var offset = i * 16 * 4;\n            var matrix = new Float32Array(values.buffer, offset, 16);\n            result[i] = matrix;\n        }\n        return count === 1 ? result[0] : result;\n    }\n\n    public readMatrix4x4_64(count) {\n        if (typeof (count) === \"undefined\") count = 1;\n        var values = this.readFloat64(count * 16);\n        var result = new Array(count);\n        for (var i = 0; i < count; i++) {\n            var offset = i * 16 * 8;\n            var matrix = new Float64Array(values.buffer, offset, 16);\n            result[i] = matrix;\n        }\n        return count === 1 ? result[0] : result;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-binary-reader.ts","import { xState} from './xbim-state';\nimport { xProductType} from './xbim-product-type';\nimport { xTriangulatedShape } from './xbim-triangulated-shape';\nimport { xBinaryReader } from './xbim-binary-reader';\n\nexport class xModelGeometry {\n    //all this data is to be fed into GPU as attributes\n    normals: Uint8Array;\n    indices: Float32Array;\n    products: Float32Array;\n    transformations: Float32Array;\n    styleIndices: Uint16Array;\n    states: Uint8Array;\n//this is the only array we need to keep alive on client side to be able to change appearance of the model\n\n    //these will be sent to GPU as the textures\n    vertices: Float32Array;\n    matrices: Float32Array;\n    styles: Uint8Array;\n\n    meter = 1000;\n\n    //this will be used to change appearance of the objects\n    //map objects have a format: \n    //map = {\n    //\tproductID: int,\n    //\ttype: int,\n    //\tbBox: Float32Array(6),\n    //\tspans: [Int32Array([int, int]),Int32Array([int, int]), ...] //spanning indexes defining shapes of product and it's state\n    //};\n\n    productMap = {};\n    regions: any[];\n    transparentIndex: number;\n\n    public parse(binReader) {\n        var br = binReader;\n        var magicNumber = br.readInt32();\n        if (magicNumber != 94132117) throw 'Magic number mismatch.';\n        var version = br.readByte();\n        var numShapes = br.readInt32();\n        var numVertices = br.readInt32();\n        var numTriangles = br.readInt32();\n        var numMatrices = br.readInt32();;\n        var numProducts = br.readInt32();;\n        var numStyles = br.readInt32();;\n        this.meter = br.readFloat32();;\n        var numRegions = br.readInt16();\n\n\n        //set size of arrays to be square usable for texture data\n        //TODO: reflect support for floating point textures\n        var square = function(arity, count) {\n            if (typeof (arity) == 'undefined' || typeof (count) == 'undefined') {\n                throw 'Wrong arguments';\n            }\n            if (count == 0) return 0;\n            var byteLength = count * arity;\n            var imgSide = Math.ceil(Math.sqrt(byteLength / 4));\n            //clamp to parity\n            while ((imgSide * 4) % arity != 0) {\n                imgSide++\n            }\n            var result = imgSide * imgSide * 4 / arity;\n            return result;\n        };\n\n        //create target buffers of correct size (avoid reallocation of memory)\n        this.vertices = new Float32Array(square(4, numVertices * 3));\n        this.normals = new Uint8Array(numTriangles * 6);\n        this.indices = new Float32Array(numTriangles * 3);\n        this.styleIndices = new Uint16Array(numTriangles * 3);\n        this.styles = new Uint8Array(square(1, (numStyles + 1) * 4)); //+1 is for a default style\n        this.products = new Float32Array(numTriangles * 3);\n        this.states = new Uint8Array(numTriangles * 3 * 2); //place for state and restyling\n        this.transformations = new Float32Array(numTriangles * 3);\n        this.matrices = new Float32Array(square(4, numMatrices * 16));\n        this.productMap = {};\n        this.regions = new Array(numRegions);\n\n        var iVertex = 0;\n        var iIndexForward = 0;\n        var iIndexBackward = numTriangles * 3;\n        var iTransform = 0;\n        var iMatrix = 0;\n\n        var stateEnum = xState;\n        var typeEnum = xProductType;\n\n\n        for (var i = 0; i < numRegions; i++) {\n            this.regions[i] = {\n                population: br.readInt32(),\n                centre: br.readFloat32(3),\n                bbox: br.readFloat32(6)\n            }\n        }\n\n\n        var styleMap = [];\n        styleMap['getStyle'] = function(id) {\n            for (var i = 0; i < this.length; i++) {\n                var item = this[i];\n                if (item.id == id) return item;\n            }\n            return null;\n        };\n        var iStyle = 0;\n        for (iStyle; iStyle < numStyles; iStyle++) {\n            var styleId = br.readInt32();\n            var R = br.readFloat32() * 255;\n            var G = br.readFloat32() * 255;\n            var B = br.readFloat32() * 255;\n            var A = br.readFloat32() * 255;\n            this.styles.set([R, G, B, A], iStyle * 4);\n            styleMap.push({ id: styleId, index: iStyle, transparent: A < 254 });\n        }\n        this.styles.set([255, 255, 255, 255], iStyle * 4);\n        var defaultStyle = { id: -1, index: iStyle, transparent: A < 254 }\n        styleMap.push(defaultStyle);\n\n        for (var i = 0; i < numProducts; i++) {\n            var productLabel = br.readInt32();\n            var prodType = br.readInt16();\n            var bBox = br.readFloat32(6);\n\n            var map = {\n                productID: productLabel,\n                type: prodType,\n                bBox: bBox,\n                spans: []\n            };\n            this.productMap[productLabel] = map;\n        }\n\n        for (var iShape = 0; iShape < numShapes; iShape++) {\n\n            var repetition = br.readInt32();\n            var shapeList = [];\n            for (var iProduct = 0; iProduct < repetition; iProduct++) {\n                var prodLabel = br.readInt32();\n                var instanceTypeId = br.readInt16();\n                var instanceLabel = br.readInt32();\n                var styleId = br.readInt32();\n                var transformation = null;\n\n                if (repetition > 1) {\n                    transformation = version === 1 ? br.readFloat32(16) : br.readFloat64(16);\n                    this.matrices.set(transformation, iMatrix);\n                    iMatrix += 16;\n                }\n\n                var styleItem = styleMap['getStyle'](styleId);\n                if (styleItem === null)\n                    styleItem = defaultStyle;\n\n                shapeList.push({\n                    pLabel: prodLabel,\n                    iLabel: instanceLabel,\n                    style: styleItem.index,\n                    transparent: styleItem.transparent,\n                    transform: transformation != null ? iTransform++ : 0xFFFF\n                });\n            }\n\n            //read shape geometry\n            var shapeGeom = new xTriangulatedShape();\n            shapeGeom.parse(br);\n\n\n            //copy shape data into inner array and set to null so it can be garbage collected\n            shapeList.forEach(function(shape) {\n                    var iIndex = 0;\n                    //set iIndex according to transparency either from beginning or at the end\n                    if (shape.transparent) {\n                        iIndex = iIndexBackward - shapeGeom.indices.length;\n                    } else {\n                        iIndex = iIndexForward;\n                    }\n\n                    var begin = iIndex;\n                    var map = this.productMap[shape.pLabel];\n                    if (typeof (map) === \"undefined\") {\n                        //throw \"Product hasn't been defined before.\";\n                        map = {\n                            productID: 0,\n                            type: typeEnum.IFCOPENINGELEMENT,\n                            bBox: new Float32Array(6),\n                            spans: []\n                        };\n                        this.productMap[shape.pLabel] = map;\n                    }\n\n                    this.normals.set(shapeGeom.normals, iIndex * 2);\n\n                    //switch spaces and openings off by default \n                    var state = map.type == typeEnum.IFCSPACE || map.type == typeEnum.IFCOPENINGELEMENT\n                        ? stateEnum.HIDDEN\n                        : 0xFF; //0xFF is for the default state\n\n                    //fix indices to right absolute position. It is relative to the shape.\n                    for (var i = 0; i < shapeGeom.indices.length; i++) {\n                        this.indices[iIndex] = shapeGeom.indices[i] + iVertex / 3;\n                        this.products[iIndex] = shape.pLabel;\n                        this.styleIndices[iIndex] = shape.style;\n                        this.transformations[iIndex] = shape.transform;\n                        this.states[2 * iIndex] = state; //set state\n                        this.states[2 * iIndex + 1] = 0xFF; //default style\n\n                        iIndex++;\n                    }\n\n                    var end = iIndex;\n                    map.spans.push(new Int32Array([begin, end]));\n\n                    if (shape.transparent) iIndexBackward -= shapeGeom.indices.length;\n                    else iIndexForward += shapeGeom.indices.length;\n                },\n                this);\n\n            //copy geometry and keep track of amount so that we can fix indices to right position\n            //this must be the last step to have correct iVertex number above\n            this.vertices.set(shapeGeom.vertices, iVertex);\n            iVertex += shapeGeom.vertices.length;\n            shapeGeom = null;\n        }\n\n        //binary reader should be at the end by now\n        if (!br.getIsEOF()) {\n            //throw 'Binary reader is not at the end of the file.';\n        }\n\n        this.transparentIndex = iIndexForward;\n    }\n\n    //Source has to be either URL of wexBIM file or Blob representing wexBIM file\n    public load(source) {\n        //binary reading\n        var br = new xBinaryReader();\n        var self = this;\n        br.onloaded = function() {\n            self.parse(br);\n            if (self.onloaded) {\n                self.onloaded();\n            }\n        };\n        br.onerror = function(msg) {\n            if (self.onerror) self.onerror(msg);\n        };\n        br.load(source);\n    }\n\n    public onloaded() {}\n\n    public onerror(message?: string) {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-model-geometry.ts","/**\n    * Enumeration for object states.\n    * @readonly\n    * @enum {number}\n    */\nexport var xState = {\n    UNDEFINED: 255,\n    HIDDEN: 254,\n    HIGHLIGHTED: 253,\n    XRAYVISIBLE: 252,\n    UNSTYLED: 225\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-state.ts","/**\n* Enumeration of product types.\n* @readonly\n* @enum {number}\n*/\nexport var xProductType = {\n    IFCDISTRIBUTIONELEMENT: 44,\n    IFCDISTRIBUTIONFLOWELEMENT: 45,\n    IFCDISTRIBUTIONCHAMBERELEMENT: 180,\n    IFCENERGYCONVERSIONDEVICE: 175,\n    IFCAIRTOAIRHEATRECOVERY: 1097,\n    IFCBOILER: 1105,\n    IFCBURNER: 1109,\n    IFCCHILLER: 1119,\n    IFCCOIL: 1124,\n    IFCCONDENSER: 1132,\n    IFCCOOLEDBEAM: 1141,\n    IFCCOOLINGTOWER: 1142,\n    IFCENGINE: 1164,\n    IFCEVAPORATIVECOOLER: 1166,\n    IFCEVAPORATOR: 1167,\n    IFCHEATEXCHANGER: 1187,\n    IFCHUMIDIFIER: 1188,\n    IFCTUBEBUNDLE: 1305,\n    IFCUNITARYEQUIPMENT: 1310,\n    IFCELECTRICGENERATOR: 1160,\n    IFCELECTRICMOTOR: 1161,\n    IFCMOTORCONNECTION: 1216,\n    IFCSOLARDEVICE: 1270,\n    IFCTRANSFORMER: 1303,\n    IFCFLOWCONTROLLER: 121,\n    IFCELECTRICDISTRIBUTIONPOINT: 242,\n    IFCAIRTERMINALBOX: 1096,\n    IFCDAMPER: 1148,\n    IFCFLOWMETER: 1182,\n    IFCVALVE: 1311,\n    IFCELECTRICDISTRIBUTIONBOARD: 1157,\n    IFCELECTRICTIMECONTROL: 1162,\n    IFCPROTECTIVEDEVICE: 1235,\n    IFCSWITCHINGDEVICE: 1290,\n    IFCFLOWFITTING: 467,\n    IFCDUCTFITTING: 1153,\n    IFCPIPEFITTING: 1222,\n    IFCCABLECARRIERFITTING: 1111,\n    IFCCABLEFITTING: 1113,\n    IFCJUNCTIONBOX: 1195,\n    IFCFLOWMOVINGDEVICE: 502,\n    IFCCOMPRESSOR: 1131,\n    IFCFAN: 1177,\n    IFCPUMP: 1238,\n    IFCFLOWSEGMENT: 574,\n    IFCDUCTSEGMENT: 1154,\n    IFCPIPESEGMENT: 1223,\n    IFCCABLECARRIERSEGMENT: 1112,\n    IFCCABLESEGMENT: 1115,\n    IFCFLOWSTORAGEDEVICE: 371,\n    IFCTANK: 1293,\n    IFCELECTRICFLOWSTORAGEDEVICE: 1159,\n    IFCFLOWTERMINAL: 46,\n    IFCFIRESUPPRESSIONTERMINAL: 1179,\n    IFCSANITARYTERMINAL: 1262,\n    IFCSTACKTERMINAL: 1277,\n    IFCWASTETERMINAL: 1315,\n    IFCAIRTERMINAL: 1095,\n    IFCMEDICALDEVICE: 1212,\n    IFCSPACEHEATER: 1272,\n    IFCAUDIOVISUALAPPLIANCE: 1099,\n    IFCCOMMUNICATIONSAPPLIANCE: 1127,\n    IFCELECTRICAPPLIANCE: 1156,\n    IFCLAMP: 1198,\n    IFCLIGHTFIXTURE: 1199,\n    IFCOUTLET: 1219,\n    IFCFLOWTREATMENTDEVICE: 425,\n    IFCINTERCEPTOR: 1193,\n    IFCDUCTSILENCER: 1155,\n    IFCFILTER: 1178,\n    IFCDISTRIBUTIONCONTROLELEMENT: 468,\n    IFCPROTECTIVEDEVICETRIPPINGUNIT: 1236,\n    IFCACTUATOR: 1091,\n    IFCALARM: 1098,\n    IFCCONTROLLER: 1139,\n    IFCFLOWINSTRUMENT: 1181,\n    IFCSENSOR: 1264,\n    IFCUNITARYCONTROLELEMENT: 1308,\n    IFCDISCRETEACCESSORY: 423,\n    IFCFASTENER: 535,\n    IFCMECHANICALFASTENER: 536,\n    IFCREINFORCINGBAR: 571,\n    IFCREINFORCINGMESH: 531,\n    IFCTENDON: 261,\n    IFCTENDONANCHOR: 675,\n    IFCBUILDINGELEMENTPART: 220,\n    IFCVIBRATIONISOLATOR: 1312,\n    IFCCHAMFEREDGEFEATURE: 765,\n    IFCROUNDEDEDGEFEATURE: 766,\n    IFCOPENINGELEMENT: 498,\n    IFCOPENINGSTANDARDCASE: 1217,\n    IFCVOIDINGFEATURE: 1313,\n    IFCPROJECTIONELEMENT: 384,\n    IFCSURFACEFEATURE: 1287,\n    IFCFOOTING: 120,\n    IFCPILE: 572,\n    IFCBEAM: 171,\n    IFCBEAMSTANDARDCASE: 1104,\n    IFCCOLUMN: 383,\n    IFCCOLUMNSTANDARDCASE: 1126,\n    IFCCURTAINWALL: 456,\n    IFCDOOR: 213,\n    IFCDOORSTANDARDCASE: 1151,\n    IFCMEMBER: 310,\n    IFCMEMBERSTANDARDCASE: 1214,\n    IFCPLATE: 351,\n    IFCPLATESTANDARDCASE: 1224,\n    IFCRAILING: 350,\n    IFCRAMP: 414,\n    IFCRAMPFLIGHT: 348,\n    IFCROOF: 347,\n    IFCSLAB: 99,\n    IFCSLABELEMENTEDCASE: 1268,\n    IFCSLABSTANDARDCASE: 1269,\n    IFCSTAIR: 346,\n    IFCSTAIRFLIGHT: 25,\n    IFCWALL: 452,\n    IFCWALLSTANDARDCASE: 453,\n    IFCWALLELEMENTEDCASE: 1314,\n    IFCWINDOW: 667,\n    IFCWINDOWSTANDARDCASE: 1316,\n    IFCBUILDINGELEMENTPROXY: 560,\n    IFCCOVERING: 382,\n    IFCCHIMNEY: 1120,\n    IFCSHADINGDEVICE: 1265,\n    IFCELEMENTASSEMBLY: 18,\n    IFCFURNISHINGELEMENT: 253,\n    IFCFURNITURE: 1184,\n    IFCSYSTEMFURNITUREELEMENT: 1291,\n    IFCTRANSPORTELEMENT: 416,\n    IFCVIRTUALELEMENT: 168,\n    IFCELECTRICALELEMENT: 23,\n    IFCEQUIPMENTELEMENT: 212,\n    IFCCIVILELEMENT: 1122,\n    IFCGEOGRAPHICELEMENT: 1185,\n    IFCDISTRIBUTIONPORT: 178,\n    IFCPROXY: 447,\n    IFCSTRUCTURALLINEARACTION: 463,\n    IFCSTRUCTURALLINEARACTIONVARYING: 464,\n    IFCSTRUCTURALPLANARACTION: 39,\n    IFCSTRUCTURALPLANARACTIONVARYING: 357,\n    IFCSTRUCTURALPOINTACTION: 356,\n    IFCSTRUCTURALCURVEACTION: 1279,\n    IFCSTRUCTURALSURFACEACTION: 1284,\n    IFCSTRUCTURALPOINTREACTION: 354,\n    IFCSTRUCTURALCURVEREACTION: 1280,\n    IFCSTRUCTURALSURFACEREACTION: 1285,\n    IFCSTRUCTURALCURVECONNECTION: 534,\n    IFCSTRUCTURALPOINTCONNECTION: 533,\n    IFCSTRUCTURALSURFACECONNECTION: 264,\n    IFCSTRUCTURALCURVEMEMBER: 224,\n    IFCSTRUCTURALCURVEMEMBERVARYING: 227,\n    IFCSTRUCTURALSURFACEMEMBER: 420,\n    IFCSTRUCTURALSURFACEMEMBERVARYING: 421,\n    IFCANNOTATION: 634,\n    IFCBUILDING: 169,\n    IFCBUILDINGSTOREY: 459,\n    IFCSITE: 349,\n    IFCSPACE: 454,\n    IFCGRID: 564,\n    IFCEXTERNALSPATIALELEMENT: 1174,\n    IFCSPATIALZONE: 1275\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-product-type.ts","import { xBinaryReader } from './xbim-binary-reader';\n\nexport class xTriangulatedShape {\n\n    //this will get xBinaryReader on the current position and will parse it's content to fill itself with vertices, normals and vertex indices\n    public parse(binReader) {\n        var self = this;\n        var version = binReader.readByte();\n        var numVertices = binReader.readInt32();\n        var numOfTriangles = binReader.readInt32();\n        self.vertices = binReader.readFloat32(numVertices * 3);\n        //allocate memory of defined size (to avoid reallocation of memory)\n        self.indices = new Uint32Array(numOfTriangles * 3);\n        self.normals = new Uint8Array(numOfTriangles * 6);\n        //indices for incremental adding of indices and normals\n        var iIndex = 0;\n        var readIndex;\n        if (numVertices <= 0xFF) {\n            readIndex = function(count) { return binReader.readByte(count); };\n        } else if (numVertices <= 0xFFFF) {\n            readIndex = function(count) { return binReader.readUint16(count); };\n        } else {\n            readIndex = function(count) { return binReader.readInt32(count); };\n        }\n\n        var numFaces = binReader.readInt32();\n\n        if (numVertices === 0 || numOfTriangles === 0)\n            return;\n\n        for (var i = 0; i < numFaces; i++) {\n            var numTrianglesInFace = binReader.readInt32();\n            if (numTrianglesInFace == 0) continue;\n\n            var isPlanar = numTrianglesInFace > 0;\n            numTrianglesInFace = Math.abs(numTrianglesInFace);\n            if (isPlanar) {\n                var normal = binReader.readByte(2);\n                //read and set all indices\n                var planarIndices = readIndex(3 * numTrianglesInFace);\n                self.indices.set(planarIndices, iIndex);\n\n                for (var j = 0; j < numTrianglesInFace * 3; j++) {\n                    //add three identical normals because this is planar but needs to be expanded for WebGL\n                    self.normals[iIndex * 2] = normal[0];\n                    self.normals[iIndex * 2 + 1] = normal[1];\n                    iIndex++;\n                }\n            } else {\n                for (var j = 0; j < numTrianglesInFace; j++) {\n                    self.indices[iIndex] = readIndex(); //a\n                    self.normals.set(binReader.readByte(2), iIndex * 2);\n                    iIndex++;\n\n                    self.indices[iIndex] = readIndex(); //b\n                    self.normals.set(binReader.readByte(2), iIndex * 2);\n                    iIndex++;\n\n                    self.indices[iIndex] = readIndex(); //c\n                    self.normals.set(binReader.readByte(2), iIndex * 2);\n                    iIndex++;\n                }\n            }\n        }\n    }\n\n    //This would load only shape data from binary file\n    public load = function(source) {\n        //binary reading\n        var br = new xBinaryReader();\n        var self = this;\n        br.onloaded = function() {\n            self.parse(br);\n            if (self.onloaded) {\n                self.onloaded();\n            }\n        };\n        br.load(source);\n    }\n\n\n    vertices = [];\n    indices: Uint32Array;\n    normals: Uint8Array;\n\n    //this function will get called when loading is finished.\n    //This won't get called after parse which is supposed to happen in large operation.\n    public onloaded() {}\n}\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-triangulated-shape.ts","import { xState } from './xbim-state';\nimport { xModelGeometry } from './xbim-model-geometry';\n\n//this class holds pointers to textures, uniforms and data buffers which \n//make up a model in GPU\nexport class xModelHandle {\n\n    //gl: WebGL context\n    private _gl: any;\n    //model: xModelGeometry\n    public _model: xModelGeometry;\n    //fpt: bool (floating point texture support)\n    private _fpt: boolean;\n\n    public id: number;\n    public stopped: boolean;\n    public count: number;\n    public vertexTextureSize: number;\n    public matrixTextureSize: number;\n    public styleTextureSize: number;\n\n    public vertexTexture: any;\n    public matrixTexture: any;\n    public styleTexture: any;\n    public stateStyleTexture: any;\n\n    public normalBuffer: any;\n    public indexBuffer: any;\n    public productBuffer: any;\n    public styleBuffer: any;\n    public stateBuffer: any;\n    public transformationBuffer: any;\n\n    public stateStyle: Uint8Array;\n    private _feedCompleted: boolean;\n\n    region: any;\n\n    constructor(gl, model: xModelGeometry, fpt: boolean) {\n        if (typeof (gl) == 'undefined' || typeof (model) == 'undefined' || typeof (fpt) == 'undefined') {\n            throw 'WebGL context and geometry model must be specified';\n        }\n\n        this._gl = gl;\n        this._model = model;\n        this._fpt = fpt;\n\n        /**\n         * unique ID which can be used to identify this handle \n         */\n        this.id = xModelHandle._instancesNum++;\n\n        /**\n         * indicates if this model should be used in a rendering loop or not.\n         */\n        this.stopped = false;\n\n        this.count = model.indices.length;\n\n        //data structure \n        this.vertexTexture = gl.createTexture();\n        this.matrixTexture = gl.createTexture();\n        this.styleTexture = gl.createTexture();\n        this.stateStyleTexture = gl.createTexture();\n\n        this.vertexTextureSize = 0;\n        this.matrixTextureSize = 0;\n        this.styleTextureSize = 0;\n\n        this.normalBuffer = gl.createBuffer();\n        this.indexBuffer = gl.createBuffer();\n        this.productBuffer = gl.createBuffer();\n        this.styleBuffer = gl.createBuffer();\n        this.stateBuffer = gl.createBuffer();\n        this.transformationBuffer = gl.createBuffer();\n\n        //small texture which can be used to overwrite appearance of the products\n        this.stateStyle = new Uint8Array(15 * 15 * 4);\n        this._feedCompleted = false;\n\n        this.region = model.regions[0];\n        //set the most populated region\n        model.regions.forEach(function(region) {\n                if (region.population > this.region.population) {\n                    this.region = region;\n                }\n            },\n            this);\n        //set default region if no region is defined. This shouldn't ever happen if model contains any geometry.\n        if (typeof (this.region) == 'undefined') {\n            this.region = {\n                population: 1,\n                centre: [0.0, 0.0, 0.0],\n                bbox: [0.0, 0.0, 0.0, 10 * model.meter, 10 * model.meter, 10 * model.meter]\n            }\n        }\n    }\n\n    /**\n     * Static counter to keep unique ID of the model handles\n     */\n    private static _instancesNum = 0;\n\n    //this function sets this model as an active one\n    //it needs an argument 'pointers' which contains pointers to\n    //shader attributes and uniforms which are to be set.\n    //pointers = {\n    //\tnormalAttrPointer: null,\n    //\tindexlAttrPointer: null,\n    //\tproductAttrPointer: null,\n    //\tstateAttrPointer: null,\n    //\tstyleAttrPointer: null,\n    //\ttransformationAttrPointer: null,\n    //\n    //\tmatrixSamplerUniform: null,\n    //\tvertexSamplerUniform: null,\n    //\tstyleSamplerUniform: null,\n    //\tstateStyleSamplerUniform: null,\n    //\t\n    //\tvertexTextureSizeUniform: null,\n    //\tmatrixTextureSizeUniform: null,\n    //\tstyleTextureSizeUniform: null,\n    //};\n    setActive(pointers) {\n        if (this.stopped) return;\n\n        var gl = this._gl;\n        //set predefined textures\n        if (this.vertexTextureSize > 0) {\n            gl.activeTexture(gl.TEXTURE1);\n            gl.bindTexture(gl.TEXTURE_2D, this.vertexTexture);\n        }\n\n        if (this.matrixTextureSize > 0) {\n            gl.activeTexture(gl.TEXTURE2);\n            gl.bindTexture(gl.TEXTURE_2D, this.matrixTexture);\n        }\n\n        if (this.styleTextureSize > 0) {\n            gl.activeTexture(gl.TEXTURE3);\n            gl.bindTexture(gl.TEXTURE_2D, this.styleTexture);\n        }\n\n        //this texture has constant size\n        gl.activeTexture(gl.TEXTURE4);\n        gl.bindTexture(gl.TEXTURE_2D, this.stateStyleTexture);\n\n\n        //set attributes and uniforms\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.normalBuffer);\n        gl.vertexAttribPointer(pointers.normalAttrPointer, 2, gl.UNSIGNED_BYTE, false, 0, 0);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.indexBuffer);\n        gl.vertexAttribPointer(pointers.indexlAttrPointer, 1, gl.FLOAT, false, 0, 0);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.productBuffer);\n        gl.vertexAttribPointer(pointers.productAttrPointer, 1, gl.FLOAT, false, 0, 0);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.stateBuffer);\n        gl.vertexAttribPointer(pointers.stateAttrPointer, 2, gl.UNSIGNED_BYTE, false, 0, 0);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.styleBuffer);\n        gl.vertexAttribPointer(pointers.styleAttrPointer, 1, gl.UNSIGNED_SHORT, false, 0, 0);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.transformationBuffer);\n        gl.vertexAttribPointer(pointers.transformationAttrPointer, 1, gl.FLOAT, false, 0, 0);\n\n        gl.uniform1i(pointers.vertexSamplerUniform, 1);\n        gl.uniform1i(pointers.matrixSamplerUniform, 2);\n        gl.uniform1i(pointers.styleSamplerUniform, 3);\n        gl.uniform1i(pointers.stateStyleSamplerUniform, 4);\n        gl.uniform1i(pointers.vertexTextureSizeUniform, this.vertexTextureSize);\n        gl.uniform1i(pointers.matrixTextureSizeUniform, this.matrixTextureSize);\n        gl.uniform1i(pointers.styleTextureSizeUniform, this.styleTextureSize);\n    }\n\n    //this function must be called AFTER 'setActive()' function which sets up active buffers and uniforms\n    draw(mode: 'solid' | 'transparent') {\n        if (this.stopped) return;\n\n        var gl = this._gl;\n\n        if (typeof (mode) === 'undefined') {\n            //draw image frame\n            gl.drawArrays(gl.TRIANGLES, 0, this.count);\n            return;\n        }\n\n        if (mode === 'solid') {\n            gl.drawArrays(gl.TRIANGLES, 0, this._model.transparentIndex);\n            return;\n        }\n\n        if (mode === 'transparent') {\n            gl.drawArrays(gl.TRIANGLES, this._model.transparentIndex, this.count - this._model.transparentIndex);\n            return;\n        }\n    }\n\n\n    drawProduct(ID) {\n        if (this.stopped) return;\n\n        var gl = this._gl;\n        var map = this.getProductMap(ID);\n\n        //var i = 3; //3 is for a glass panel\n        //gl.drawArrays(gl.TRIANGLES, map.spans[i][0], map.spans[i][1] - map.spans[i][0]);\n\n        if (map != null) {\n            map.spans.forEach(function(span) {\n                    gl.drawArrays(gl.TRIANGLES, span[0], span[1] - span[0]);\n                },\n                this);\n        }\n    }\n\n    getProductMap(ID) {\n        var map = this._model.productMap[ID];\n        if (typeof (map) !== 'undefined') return map;\n        return null;\n    }\n\n    unload() {\n        var gl = this._gl;\n\n        gl.deleteTexture(this.vertexTexture);\n        gl.deleteTexture(this.matrixTexture);\n        gl.deleteTexture(this.styleTexture);\n        gl.deleteTexture(this.stateStyleTexture);\n\n        gl.deleteBuffer(this.normalBuffer);\n        gl.deleteBuffer(this.indexBuffer);\n        gl.deleteBuffer(this.productBuffer);\n        gl.deleteBuffer(this.styleBuffer);\n        gl.deleteBuffer(this.stateBuffer);\n        gl.deleteBuffer(this.transformationBuffer);\n    }\n\n    feedGPU() {\n        if (this._feedCompleted) {\n            throw 'GPU can bee fed only once. It discards unnecessary data which cannot be restored again.';\n        }\n\n        var gl = this._gl;\n        var model = this._model;\n\n        //fill all buffers\n        this._bufferData(this.normalBuffer, model.normals);\n        this._bufferData(this.indexBuffer, model.indices);\n        this._bufferData(this.productBuffer, model.products);\n        this._bufferData(this.stateBuffer, model.states);\n        this._bufferData(this.transformationBuffer, model.transformations);\n        this._bufferData(this.styleBuffer, model.styleIndices);\n\n        //fill in all textures\n        this.vertexTextureSize = this._bufferTexture(this.vertexTexture, model.vertices, 3);\n        this.matrixTextureSize = this._bufferTexture(this.matrixTexture, model.matrices, 4);\n        this.styleTextureSize = this._bufferTexture(this.styleTexture, model.styles);\n        //this has a constant size 15 which is defined in vertex shader\n        this._bufferTexture(this.stateStyleTexture, this.stateStyle);\n\n        //Forget everything except for states and styles (this should save some RAM).\n        //data is already loaded to GPU by now\n        model.normals = null;\n        model.indices = null;\n        model.products = null;\n        model.transformations = null;\n        model.styleIndices = null;\n\n        model.vertices = null;\n        model.matrices = null;\n\n        this._feedCompleted = true;\n    }\n\n    refreshStyles() {\n        this._bufferTexture(this.stateStyleTexture, this.stateStyle);\n    }\n\n    _bufferData(pointer, data) {\n        var gl = this._gl;\n        gl.bindBuffer(gl.ARRAY_BUFFER, pointer);\n        gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n    }\n\n    _bufferTexture(pointer, data, arity?) {\n        var gl = this._gl;\n        if (data.length == 0) return 0;\n\n        //detect floating point texture support and data type\n        var fp = this._fpt && data instanceof Float32Array;\n\n        //compute size of the image (length should be correct already)\n        var size = 0;\n        var maxSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n        if (fp) {\n            //recompute to smaller size, but make it +1 to make sure it is all right\n            size = Math.ceil(Math.sqrt(Math.ceil(data.length / arity))) + 1;\n        } else {\n            var dim = Math.sqrt(data.byteLength / 4);\n            size = Math.ceil(dim);\n        }\n\n        if (size == 0) return 0;\n        if (size > maxSize) throw 'Too much data! It cannot fit into the texture.';\n\n        gl.bindTexture(gl.TEXTURE_2D, pointer);\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false); //this is our convention\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false); //this should preserve values of alpha\n        gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, 0); //this should preserve values of colours\n\n        if (fp) {\n            //create new data buffer and fill it in with data\n            var image = null;\n            if (size * size * arity != data.length) {\n                image = new Float32Array(size * size * arity);\n                image.set(data);\n            } else {\n                image = data;\n            }\n            var type = null;\n            switch (arity) {\n            case 1:\n                type = gl.ALPHA;\n                break;\n            case 3:\n                type = gl.RGB;\n                break;\n            case 4:\n                type = gl.RGBA;\n                break;\n            }\n            gl.texImage2D(gl.TEXTURE_2D, 0, type, size, size, 0, type, gl.FLOAT, image);\n        } else {\n            gl.texImage2D(gl.TEXTURE_2D,\n                0,\n                gl.RGBA,\n                size,\n                size,\n                0,\n                gl.RGBA,\n                gl.UNSIGNED_BYTE,\n                new Uint8Array(data.buffer));\n        }\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl\n            .TEXTURE_2D,\n            gl.TEXTURE_WRAP_S,\n            gl.CLAMP_TO_EDGE); //Prevents s-coordinate wrapping (repeating).\n        gl.texParameteri(gl\n            .TEXTURE_2D,\n            gl.TEXTURE_WRAP_T,\n            gl.CLAMP_TO_EDGE); //Prevents t-coordinate wrapping (repeating).\n\n        return size;\n    }\n\n    getState(id) {\n        if (typeof (id) === 'undefined') throw 'id must be defined';\n        var map = this.getProductMap(id);\n        if (map === null) return null;\n\n        var span = map.spans[0];\n        if (typeof (span) == 'undefined') return null;\n\n        return this._model.states[span[0] * 2];\n    }\n\n    getStyle(id) {\n        if (typeof (id) === 'undefined') throw 'id must be defined';\n        var map = this.getProductMap(id);\n        if (map === null) return null;\n\n        var span = map.spans[0];\n        if (typeof (span) == 'undefined') return null;\n\n        return this._model.states[span[0] * 2 + 1];\n    }\n\n    setState(state, args) {\n        if (typeof (state) != 'number' && state < 0 && state > 255\n        ) throw 'You have to specify state as an ID of state or index in style pallete.';\n        if (typeof (args) == 'undefined')\n            throw 'You have to specify products as an array of product IDs or as a product type ID';\n\n        var maps = [];\n        //it is type\n        if (typeof (args) == 'number') {\n            for (var n in this._model.productMap) {\n                var map = this._model.productMap[n];\n                if (map.type == args) maps.push(map);\n            }\n        }\n        //it is a list of IDs\n        else {\n            for (var l = 0; l < args.length; l++) {\n                var id = args[l];\n                var map = this.getProductMap(id);\n                if (map != null) maps.push(map);\n            }\n        }\n\n        //shift +1 if it is an overlay colour style or 0 if it is a state.\n        var shift = state <= 225 ? 1 : 0;\n        maps.forEach(function(map) {\n                map.spans.forEach(function(span) {\n                        //set state or style\n                        for (var k = span[0]; k < span[1]; k++) {\n                            this._model.states[k * 2 + shift] = state;\n                        }\n                    },\n                    this);\n            },\n            this);\n\n        //buffer data to GPU\n        this._bufferData(this.stateBuffer, this._model.states);\n    }\n\n    resetStates() {\n        for (var i = 0; i < this._model.states.length; i += 2) {\n            this._model.states[i] = xState.UNDEFINED;\n        }\n        //buffer data to GPU\n        this._bufferData(this.stateBuffer, this._model.states);\n    }\n\n    resetStyles() {\n        for (var i = 0; i < this._model.states.length; i += 2) {\n            this._model.states[i + 1] = xState.UNSTYLED;\n        }\n        //buffer data to GPU\n        this._bufferData(this.stateBuffer, this._model.states);\n    };\n\n    getModelState() {\n        var result = [];\n        var products = this._model.productMap;\n        for (var i in products) {\n            if (!products.hasOwnProperty(i)) {\n                continue;\n            }\n            var map = products[i];\n            var span = map.spans[0];\n            if (typeof (span) == 'undefined') continue;\n\n            var state = this._model.states[span[0] * 2];\n            var style = this._model.states[span[0] * 2 + 1];\n\n            result.push([map.productID, state + (style << 8)]);\n        }\n        return result;\n    }\n\n    restoreModelState(state) {\n        state.forEach(function(s) {\n                var id = s[0];\n                var style = s[1] >> 8;\n                var state = s[1] - (style << 8);\n\n                var map = this.getProductMap(id);\n                if (map != null) {\n                    map.spans.forEach(function(span) {\n                            //set state or style\n                            for (var k = span[0]; k < span[1]; k++) {\n                                this._model.states[k * 2] = state;\n                                this._model.states[k * 2 + 1] = style;\n                            }\n                        },\n                        this);\n                }\n\n            },\n            this);\n\n        //buffer data to GPU\n        this._bufferData(this.stateBuffer, this._model.states);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-model-handle.ts","export var xProductInheritance = {\r\n    name: \"IfcProduct\",\r\n    id: 20,\r\n    abs: true,\r\n    children: [\r\n        {\r\n            name: \"IfcElement\",\r\n            id: 19,\r\n            abs: true,\r\n            children: [\r\n                {\r\n                    name: \"IfcDistributionElement\",\r\n                    id: 44,\r\n                    abs: false,\r\n                    children: [\r\n                        {\r\n                            name: \"IfcDistributionFlowElement\",\r\n                            id: 45,\r\n                            abs: false,\r\n                            children: [\r\n                                { name: \"IfcDistributionChamberElement\", id: 180, abs: false },\r\n                                {\r\n                                    name: \"IfcEnergyConversionDevice\",\r\n                                    id: 175,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcAirToAirHeatRecovery\", id: 1097, abs: false },\r\n                                        { name: \"IfcBoiler\", id: 1105, abs: false },\r\n                                        { name: \"IfcBurner\", id: 1109, abs: false },\r\n                                        { name: \"IfcChiller\", id: 1119, abs: false },\r\n                                        { name: \"IfcCoil\", id: 1124, abs: false },\r\n                                        { name: \"IfcCondenser\", id: 1132, abs: false },\r\n                                        { name: \"IfcCooledBeam\", id: 1141, abs: false },\r\n                                        { name: \"IfcCoolingTower\", id: 1142, abs: false },\r\n                                        { name: \"IfcEngine\", id: 1164, abs: false },\r\n                                        { name: \"IfcEvaporativeCooler\", id: 1166, abs: false },\r\n                                        { name: \"IfcEvaporator\", id: 1167, abs: false },\r\n                                        { name: \"IfcHeatExchanger\", id: 1187, abs: false },\r\n                                        { name: \"IfcHumidifier\", id: 1188, abs: false },\r\n                                        { name: \"IfcTubeBundle\", id: 1305, abs: false },\r\n                                        { name: \"IfcUnitaryEquipment\", id: 1310, abs: false },\r\n                                        { name: \"IfcElectricGenerator\", id: 1160, abs: false },\r\n                                        { name: \"IfcElectricMotor\", id: 1161, abs: false },\r\n                                        { name: \"IfcMotorConnection\", id: 1216, abs: false },\r\n                                        { name: \"IfcSolarDevice\", id: 1270, abs: false },\r\n                                        { name: \"IfcTransformer\", id: 1303, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowController\",\r\n                                    id: 121,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcElectricDistributionPoint\", id: 242, abs: false },\r\n                                        { name: \"IfcAirTerminalBox\", id: 1096, abs: false },\r\n                                        { name: \"IfcDamper\", id: 1148, abs: false },\r\n                                        { name: \"IfcFlowMeter\", id: 1182, abs: false },\r\n                                        { name: \"IfcValve\", id: 1311, abs: false },\r\n                                        { name: \"IfcElectricDistributionBoard\", id: 1157, abs: false },\r\n                                        { name: \"IfcElectricTimeControl\", id: 1162, abs: false },\r\n                                        { name: \"IfcProtectiveDevice\", id: 1235, abs: false },\r\n                                        { name: \"IfcSwitchingDevice\", id: 1290, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowFitting\",\r\n                                    id: 467,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcDuctFitting\", id: 1153, abs: false },\r\n                                        { name: \"IfcPipeFitting\", id: 1222, abs: false },\r\n                                        { name: \"IfcCableCarrierFitting\", id: 1111, abs: false },\r\n                                        { name: \"IfcCableFitting\", id: 1113, abs: false },\r\n                                        { name: \"IfcJunctionBox\", id: 1195, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowMovingDevice\",\r\n                                    id: 502,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcCompressor\", id: 1131, abs: false },\r\n                                        { name: \"IfcFan\", id: 1177, abs: false },\r\n                                        { name: \"IfcPump\", id: 1238, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowSegment\",\r\n                                    id: 574,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcDuctSegment\", id: 1154, abs: false },\r\n                                        { name: \"IfcPipeSegment\", id: 1223, abs: false },\r\n                                        { name: \"IfcCableCarrierSegment\", id: 1112, abs: false },\r\n                                        { name: \"IfcCableSegment\", id: 1115, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowStorageDevice\",\r\n                                    id: 371,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcTank\", id: 1293, abs: false },\r\n                                        { name: \"IfcElectricFlowStorageDevice\", id: 1159, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowTerminal\",\r\n                                    id: 46,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcFireSuppressionTerminal\", id: 1179, abs: false },\r\n                                        { name: \"IfcSanitaryTerminal\", id: 1262, abs: false },\r\n                                        { name: \"IfcStackTerminal\", id: 1277, abs: false },\r\n                                        { name: \"IfcWasteTerminal\", id: 1315, abs: false },\r\n                                        { name: \"IfcAirTerminal\", id: 1095, abs: false },\r\n                                        { name: \"IfcMedicalDevice\", id: 1212, abs: false },\r\n                                        { name: \"IfcSpaceHeater\", id: 1272, abs: false },\r\n                                        { name: \"IfcAudioVisualAppliance\", id: 1099, abs: false },\r\n                                        { name: \"IfcCommunicationsAppliance\", id: 1127, abs: false },\r\n                                        { name: \"IfcElectricAppliance\", id: 1156, abs: false },\r\n                                        { name: \"IfcLamp\", id: 1198, abs: false },\r\n                                        { name: \"IfcLightFixture\", id: 1199, abs: false },\r\n                                        { name: \"IfcOutlet\", id: 1219, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcFlowTreatmentDevice\",\r\n                                    id: 425,\r\n                                    abs: false,\r\n                                    children: [\r\n                                        { name: \"IfcInterceptor\", id: 1193, abs: false },\r\n                                        { name: \"IfcDuctSilencer\", id: 1155, abs: false },\r\n                                        { name: \"IfcFilter\", id: 1178, abs: false }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }, {\r\n                            name: \"IfcDistributionControlElement\",\r\n                            id: 468,\r\n                            abs: false,\r\n                            children: [\r\n                                { name: \"IfcProtectiveDeviceTrippingUnit\", id: 1236, abs: false },\r\n                                { name: \"IfcActuator\", id: 1091, abs: false },\r\n                                { name: \"IfcAlarm\", id: 1098, abs: false },\r\n                                { name: \"IfcController\", id: 1139, abs: false },\r\n                                { name: \"IfcFlowInstrument\", id: 1181, abs: false },\r\n                                { name: \"IfcSensor\", id: 1264, abs: false },\r\n                                { name: \"IfcUnitaryControlElement\", id: 1308, abs: false }\r\n                            ]\r\n                        }\r\n                    ]\r\n                }, {\r\n                    name: \"IfcElementComponent\",\r\n                    id: 424,\r\n                    abs: true,\r\n                    children: [\r\n                        { name: \"IfcDiscreteAccessory\", id: 423, abs: false },\r\n                        {\r\n                            name: \"IfcFastener\",\r\n                            id: 535,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcMechanicalFastener\", id: 536, abs: false }]\r\n                        }, {\r\n                            name: \"IfcReinforcingElement\",\r\n                            id: 262,\r\n                            abs: true,\r\n                            children: [\r\n                                { name: \"IfcReinforcingBar\", id: 571, abs: false },\r\n                                { name: \"IfcReinforcingMesh\", id: 531, abs: false },\r\n                                { name: \"IfcTendon\", id: 261, abs: false },\r\n                                { name: \"IfcTendonAnchor\", id: 675, abs: false }\r\n                            ]\r\n                        }, { name: \"IfcBuildingElementPart\", id: 220, abs: false },\r\n                        { name: \"IfcMechanicalFastener\", id: 536, abs: false },\r\n                        { name: \"IfcVibrationIsolator\", id: 1312, abs: false }\r\n                    ]\r\n                }, {\r\n                    name: \"IfcFeatureElement\",\r\n                    id: 386,\r\n                    abs: true,\r\n                    children: [\r\n                        {\r\n                            name: \"IfcFeatureElementSubtraction\",\r\n                            id: 499,\r\n                            abs: true,\r\n                            children: [\r\n                                {\r\n                                    name: \"IfcEdgeFeature\",\r\n                                    id: 764,\r\n                                    abs: true,\r\n                                    children: [\r\n                                        { name: \"IfcChamferEdgeFeature\", id: 765, abs: false },\r\n                                        { name: \"IfcRoundedEdgeFeature\", id: 766, abs: false }\r\n                                    ]\r\n                                }, {\r\n                                    name: \"IfcOpeningElement\",\r\n                                    id: 498,\r\n                                    abs: false,\r\n                                    children: [{ name: \"IfcOpeningStandardCase\", id: 1217, abs: false }]\r\n                                }, { name: \"IfcVoidingFeature\", id: 1313, abs: false }\r\n                            ]\r\n                        }, {\r\n                            name: \"IfcFeatureElementAddition\",\r\n                            id: 385,\r\n                            abs: true,\r\n                            children: [{ name: \"IfcProjectionElement\", id: 384, abs: false }]\r\n                        }, { name: \"IfcSurfaceFeature\", id: 1287, abs: false }\r\n                    ]\r\n                }, {\r\n                    name: \"IfcBuildingElement\",\r\n                    id: 26,\r\n                    abs: true,\r\n                    children: [\r\n                        {\r\n                            name: \"IfcBuildingElementComponent\",\r\n                            id: 221,\r\n                            abs: true,\r\n                            children: [\r\n                                { name: \"IfcBuildingElementPart\", id: 220, abs: false },\r\n                                {\r\n                                    name: \"IfcReinforcingElement\",\r\n                                    id: 262,\r\n                                    abs: true,\r\n                                    children: [\r\n                                        { name: \"IfcReinforcingBar\", id: 571, abs: false },\r\n                                        { name: \"IfcReinforcingMesh\", id: 531, abs: false },\r\n                                        { name: \"IfcTendon\", id: 261, abs: false },\r\n                                        { name: \"IfcTendonAnchor\", id: 675, abs: false }\r\n                                    ]\r\n                                }\r\n                            ]\r\n                        }, { name: \"IfcFooting\", id: 120, abs: false }, { name: \"IfcPile\", id: 572, abs: false },\r\n                        {\r\n                            name: \"IfcBeam\",\r\n                            id: 171,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcBeamStandardCase\", id: 1104, abs: false }]\r\n                        },\r\n                        {\r\n                            name: \"IfcColumn\",\r\n                            id: 383,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcColumnStandardCase\", id: 1126, abs: false }]\r\n                        }, { name: \"IfcCurtainWall\", id: 456, abs: false },\r\n                        {\r\n                            name: \"IfcDoor\",\r\n                            id: 213,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcDoorStandardCase\", id: 1151, abs: false }]\r\n                        },\r\n                        {\r\n                            name: \"IfcMember\",\r\n                            id: 310,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcMemberStandardCase\", id: 1214, abs: false }]\r\n                        }, {\r\n                            name: \"IfcPlate\",\r\n                            id: 351,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcPlateStandardCase\", id: 1224, abs: false }]\r\n                        }, { name: \"IfcRailing\", id: 350, abs: false }, { name: \"IfcRamp\", id: 414, abs: false },\r\n                        { name: \"IfcRampFlight\", id: 348, abs: false }, { name: \"IfcRoof\", id: 347, abs: false },\r\n                        {\r\n                            name: \"IfcSlab\",\r\n                            id: 99,\r\n                            abs: false,\r\n                            children: [\r\n                                { name: \"IfcSlabElementedCase\", id: 1268, abs: false },\r\n                                { name: \"IfcSlabStandardCase\", id: 1269, abs: false }\r\n                            ]\r\n                        }, { name: \"IfcStair\", id: 346, abs: false }, { name: \"IfcStairFlight\", id: 25, abs: false },\r\n                        {\r\n                            name: \"IfcWall\",\r\n                            id: 452,\r\n                            abs: false,\r\n                            children: [\r\n                                { name: \"IfcWallStandardCase\", id: 453, abs: false },\r\n                                { name: \"IfcWallElementedCase\", id: 1314, abs: false }\r\n                            ]\r\n                        }, {\r\n                            name: \"IfcWindow\",\r\n                            id: 667,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcWindowStandardCase\", id: 1316, abs: false }]\r\n                        }, { name: \"IfcBuildingElementProxy\", id: 560, abs: false },\r\n                        { name: \"IfcCovering\", id: 382, abs: false },\r\n                        { name: \"IfcChimney\", id: 1120, abs: false }, { name: \"IfcShadingDevice\", id: 1265, abs: false }\r\n                    ]\r\n                }, { name: \"IfcElementAssembly\", id: 18, abs: false },\r\n                {\r\n                    name: \"IfcFurnishingElement\",\r\n                    id: 253,\r\n                    abs: false,\r\n                    children: [\r\n                        { name: \"IfcFurniture\", id: 1184, abs: false },\r\n                        { name: \"IfcSystemFurnitureElement\", id: 1291, abs: false }\r\n                    ]\r\n                }, { name: \"IfcTransportElement\", id: 416, abs: false },\r\n                { name: \"IfcVirtualElement\", id: 168, abs: false },\r\n                { name: \"IfcElectricalElement\", id: 23, abs: false },\r\n                { name: \"IfcEquipmentElement\", id: 212, abs: false },\r\n                { name: \"IfcCivilElement\", id: 1122, abs: false },\r\n                { name: \"IfcGeographicElement\", id: 1185, abs: false }\r\n            ]\r\n        }, { name: \"IfcPort\", id: 179, abs: true, children: [{ name: \"IfcDistributionPort\", id: 178, abs: false }] },\r\n        { name: \"IfcProxy\", id: 447, abs: false }, {\r\n            name: \"IfcStructuralActivity\",\r\n            id: 41,\r\n            abs: true,\r\n            children: [\r\n                {\r\n                    name: \"IfcStructuralAction\",\r\n                    id: 40,\r\n                    abs: true,\r\n                    children: [\r\n                        {\r\n                            name: \"IfcStructuralLinearAction\",\r\n                            id: 463,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcStructuralLinearActionVarying\", id: 464, abs: false }]\r\n                        }, {\r\n                            name: \"IfcStructuralPlanarAction\",\r\n                            id: 39,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcStructuralPlanarActionVarying\", id: 357, abs: false }]\r\n                        }, { name: \"IfcStructuralPointAction\", id: 356, abs: false },\r\n                        {\r\n                            name: \"IfcStructuralCurveAction\",\r\n                            id: 1279,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcStructuralLinearAction\", id: 463, abs: false }]\r\n                        }, {\r\n                            name: \"IfcStructuralSurfaceAction\",\r\n                            id: 1284,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcStructuralPlanarAction\", id: 39, abs: false }]\r\n                        }\r\n                    ]\r\n                }, {\r\n                    name: \"IfcStructuralReaction\",\r\n                    id: 355,\r\n                    abs: true,\r\n                    children: [\r\n                        { name: \"IfcStructuralPointReaction\", id: 354, abs: false },\r\n                        { name: \"IfcStructuralCurveReaction\", id: 1280, abs: false },\r\n                        { name: \"IfcStructuralSurfaceReaction\", id: 1285, abs: false }\r\n                    ]\r\n                }\r\n            ]\r\n        }, {\r\n            name: \"IfcStructuralItem\",\r\n            id: 226,\r\n            abs: true,\r\n            children: [\r\n                {\r\n                    name: \"IfcStructuralConnection\",\r\n                    id: 265,\r\n                    abs: true,\r\n                    children: [\r\n                        { name: \"IfcStructuralCurveConnection\", id: 534, abs: false },\r\n                        { name: \"IfcStructuralPointConnection\", id: 533, abs: false },\r\n                        { name: \"IfcStructuralSurfaceConnection\", id: 264, abs: false }\r\n                    ]\r\n                }, {\r\n                    name: \"IfcStructuralMember\",\r\n                    id: 225,\r\n                    abs: true,\r\n                    children: [\r\n                        {\r\n                            name: \"IfcStructuralCurveMember\",\r\n                            id: 224,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcStructuralCurveMemberVarying\", id: 227, abs: false }]\r\n                        }, {\r\n                            name: \"IfcStructuralSurfaceMember\",\r\n                            id: 420,\r\n                            abs: false,\r\n                            children: [{ name: \"IfcStructuralSurfaceMemberVarying\", id: 421, abs: false }]\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        }, { name: \"IfcAnnotation\", id: 634, abs: false }, {\r\n            name: \"IfcSpatialStructureElement\",\r\n            id: 170,\r\n            abs: true,\r\n            children: [\r\n                { name: \"IfcBuilding\", id: 169, abs: false }, { name: \"IfcBuildingStorey\", id: 459, abs: false },\r\n                { name: \"IfcSite\", id: 349, abs: false }, { name: \"IfcSpace\", id: 454, abs: false }\r\n            ]\r\n        }, { name: \"IfcGrid\", id: 564, abs: false }, {\r\n            name: \"IfcSpatialElement\",\r\n            id: 1273,\r\n            abs: true,\r\n            children: [\r\n                {\r\n                    name: \"IfcSpatialStructureElement\",\r\n                    id: 170,\r\n                    abs: true,\r\n                    children: [\r\n                        { name: \"IfcBuilding\", id: 169, abs: false },\r\n                        { name: \"IfcBuildingStorey\", id: 459, abs: false },\r\n                        { name: \"IfcSite\", id: 349, abs: false }, { name: \"IfcSpace\", id: 454, abs: false }\r\n                    ]\r\n                }, {\r\n                    name: \"IfcExternalSpatialStructureElement\",\r\n                    id: 1175,\r\n                    abs: true,\r\n                    children: [{ name: \"IfcExternalSpatialElement\", id: 1174, abs: false }]\r\n                }, { name: \"IfcSpatialZone\", id: 1275, abs: false }\r\n            ]\r\n        }\r\n    ]\r\n}\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-product-inheritance.ts","/*\r\n* This file has been generated by spacker.exe utility. Do not change this file manualy as your changes\r\n* will get lost when the file is regenerated. Original content is located in *.c files.\r\n*/\r\nexport var xShaders = {\r\n\tfragment_shader: ' precision mediump float; uniform vec4 uClippingPlane; varying vec4 vFrontColor; varying vec4 vBackColor; varying vec3 vPosition; varying float vDiscard; void main(void) { if ( vDiscard > 0.001) discard; if (length(uClippingPlane) > 0.001) { vec4 p = uClippingPlane; vec3 x = vPosition; float distance = (dot(p.xyz, x) + p.w) / length(p.xyz); if (distance < 0.0){ discard; } } gl_FragColor = gl_FrontFacing ? vFrontColor : vBackColor; }',\r\n\tvertex_shader: ' attribute highp float aVertexIndex; attribute highp float aTransformationIndex; attribute highp float aStyleIndex; attribute highp float aProduct; attribute highp vec2 aState; attribute highp vec2 aNormal; uniform mat4 uMVMatrix; uniform mat4 uPMatrix; uniform vec4 ulightA; uniform vec4 ulightB; uniform vec4 uHighlightColour; uniform float uMeter; uniform bool uColorCoding; uniform int uRenderingMode; uniform highp sampler2D uVertexSampler; uniform int uVertexTextureSize; uniform highp sampler2D uMatrixSampler; uniform int uMatrixTextureSize; uniform highp sampler2D uStyleSampler; uniform int uStyleTextureSize; uniform highp sampler2D uStateStyleSampler; varying vec4 vFrontColor; varying vec4 vBackColor; varying vec3 vPosition; varying float vDiscard; vec3 getNormal(){ float U = aNormal[0]; float V = aNormal[1]; float PI = 3.1415926535897932384626433832795; float lon = U / 252.0 * 2.0 * PI; float lat = V / 252.0 * PI; float x = sin(lon) * sin(lat); float z = cos(lon) * sin(lat); float y = cos(lat); return normalize(vec3(x, y, z)); } vec4 getIdColor(){ float product = floor(aProduct + 0.5); float B = floor (product/(256.0*256.0)); float G = floor((product  - B * 256.0*256.0)/256.0); float R = mod(product, 256.0); return vec4(R/255.0, G/255.0, B/255.0, 1.0); } vec2 getTextureCoordinates(int index, int size) { float x = float(index - (index / size) * size); float y = float(index / size); float pixelSize = 1.0 / float(size); return vec2((x + 0.5) * pixelSize, (y + 0.5) * pixelSize); } vec4 getColor(){ int restyle = int(floor(aState[1] + 0.5)); if (restyle > 224){ int index = int (floor(aStyleIndex + 0.5)); vec2 coords = getTextureCoordinates(index, uStyleTextureSize); return texture2D(uStyleSampler, coords); } vec2 coords = getTextureCoordinates(restyle, 15); return texture2D(uStateStyleSampler, coords); } vec3 getVertexPosition(){ int index = int (floor(aVertexIndex +0.5)); vec2 coords = getTextureCoordinates(index, uVertexTextureSize); vec3 point = vec3(texture2D(uVertexSampler, coords)); int tIndex = int(floor(aTransformationIndex + 0.5)); if (tIndex != 65535) { tIndex *=4; mat4 transform = mat4( texture2D(uMatrixSampler, getTextureCoordinates(tIndex, uMatrixTextureSize)), texture2D(uMatrixSampler, getTextureCoordinates(tIndex+1, uMatrixTextureSize)), texture2D(uMatrixSampler, getTextureCoordinates(tIndex+2, uMatrixTextureSize)), texture2D(uMatrixSampler, getTextureCoordinates(tIndex+3, uMatrixTextureSize)) ); return vec3(transform * vec4(point, 1.0)); } return point; } void main(void) { int state = int(floor(aState[0] + 0.5)); vDiscard = 0.0; if (state == 254) { vDiscard = 1.0; vFrontColor = vec4(0.0, 0.0, 0.0, 0.0); vBackColor = vec4(0.0, 0.0, 0.0, 0.0); vPosition = vec3(0.0, 0.0, 0.0); gl_Position = vec4(0.0, 0.0, 0.0, 1.0); return; } vec3 vertex = getVertexPosition(); vec3 normal = getNormal(); vec3 backNormal = normal * -1.0; if (uColorCoding){ vec4 idColor = getIdColor(); vFrontColor = idColor; vBackColor = idColor; } else{ float lightAIntensity = ulightA[3]; vec3 lightADirection = normalize(ulightA.xyz - vertex); float lightBIntensity = ulightB[3]; vec3 lightBDirection = normalize(ulightB.xyz - vertex); float lightWeightA = max(dot(normal, lightADirection ) * lightAIntensity, 0.0); float lightWeightB = max(dot(normal, lightBDirection ) * lightBIntensity, 0.0); float backLightWeightA = max(dot(backNormal, lightADirection) * lightAIntensity, 0.0); float backLightWeightB = max(dot(backNormal, lightBDirection) * lightBIntensity, 0.0); float lightWeighting = lightWeightA + lightWeightB + 0.4; float backLightWeighting = backLightWeightA + backLightWeightB + 0.4; vec4 baseColor = vec4(1.0, 1.0, 1.0, 1.0); if (uRenderingMode == 2){ if (state == 252){ baseColor = getColor(); } else{ baseColor = vec4(0.0, 0.0, 0.3, 0.5); } } if (state == 253) { baseColor = uHighlightColour; } if (uRenderingMode != 2 && state != 253){ baseColor = getColor(); } if (baseColor.a < 0.98 && uRenderingMode == 0) { vec3 trans = -0.002 * uMeter * normalize(normal); vertex = vertex + trans; } vFrontColor = vec4(baseColor.rgb * lightWeighting, baseColor.a); vBackColor = vec4(baseColor.rgb * backLightWeighting, baseColor.a); } vPosition = vertex; gl_Position = uPMatrix * uMVMatrix * vec4(vertex, 1.0); }',\r\n\tvertex_shader_noFPT: ' attribute highp float aVertexIndex; attribute highp float aTransformationIndex; attribute highp float aStyleIndex; attribute highp float aProduct; attribute highp float aState; attribute highp vec2 aNormal; uniform mat4 uMVMatrix; uniform mat4 uPMatrix; uniform vec4 ulightA; uniform vec4 ulightB; uniform bool uColorCoding; uniform bool uFloatingPoint; uniform highp sampler2D uVertexSampler; uniform int uVertexTextureSize; uniform highp sampler2D uMatrixSampler; uniform int uMatrixTextureSize; uniform highp sampler2D uStyleSampler; uniform int uStyleTextureSize; uniform highp sampler2D uStateStyleSampler; int stateStyleTextureSize = 15; varying vec4 vColor; varying vec3 vPosition; vec3 getNormal(){ float U = aNormal[0]; float V = aNormal[1]; float PI = 3.1415926535897932384626433832795; float u = ((U / 252.0) * (2.0 * PI)) - PI; float v = ((V / 252.0) * (2.0 * PI)) - PI; float x = sin(v) * cos(u); float y = sin(v) * sin(u); float z = cos(v); return normalize(vec3(x, y, z)); } vec4 getIdColor(){ float R = mod(aProduct, 256.0) / 255.0; float G = floor(aProduct/256.0) / 255.0; float B = floor (aProduct/(256.0*256.0)) / 255.0; return vec4(R, G, B, 1.0); } vec2 getVertexTextureCoordinates(int index, int size) { float x = float(index - (index / size) * size); float y = float(index / size); float pixelSize = 1.0 / float(size); return vec2((x + 0.5) * pixelSize, (y + 0.5) * pixelSize); } int getByteFromScale(float base) { float result = base * 255.0; int correction = fract(result) >= 0.5 ? 1 : 0; return int(result) + correction; } ivec4 getPixel(int index, sampler2D sampler, int size) { vec2 coords = getVertexTextureCoordinates(index, size); vec4 pixel = texture2D(sampler, coords); return ivec4( getByteFromScale(pixel.r), getByteFromScale(pixel.g), getByteFromScale(pixel.b), getByteFromScale(pixel.a) ); } void getBits(ivec4 pixel, out int result[32]) { for (int i = 0; i < 4; i++) { int actualByte = pixel[i]; for (int j = 0; j < 8; j++) { result[31 - (j + i * 8)] =  actualByte - (actualByte / 2) * 2; actualByte /= 2; } } } float getFloatFromPixel(ivec4 pixel) { int bits[32]; getBits(pixel, bits); float sign =  bits[0] == 0 ? 1.0 : -1.0; highp float fraction = 1.0; highp float exponent = 0.0; for (int i = 1; i < 9; i++) { exponent += float(bits[9 - i]) * exp2(float (i - 1)); } exponent -= 127.0; for (int i = 9; i < 32; i++) { fraction += float(bits[i]) * exp2(float((-1)*(i-8))); } return sign * fraction * exp2(exponent); } float getFloatFromPixel(int index, sampler2D sampler, int size) { ivec4 pixel = getPixel(index, sampler, size); return getFloatFromPixel(pixel); } vec4 getColor(){ if (floor(aState + 0.5) == 0.0){ int index = int (floor(aStyleIndex + 0.5)); vec2 coords = getVertexTextureCoordinates(index, uStyleTextureSize); return texture2D(uStyleSampler, coords); } else{ return vec4(1.0,1.0,1.0,1.0); } } vec3 getVertexPosition(){ int index = int (floor(aVertexIndex +0.5))* 3; vec3 position = vec3( getFloatFromPixel(index, uVertexSampler, uVertexTextureSize), getFloatFromPixel(index + 1, uVertexSampler, uVertexTextureSize), getFloatFromPixel(index + 2, uVertexSampler, uVertexTextureSize) ); int tIndex = int(floor(aTransformationIndex + 0.5)); if (tIndex != 65535) { tIndex *= 16; mat4 transform = mat4( getFloatFromPixel(tIndex + 0, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 1, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 2, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 3, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 4, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 5, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 6, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 7, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 8, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 9, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 10, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 11, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 12, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 13, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 14, uMatrixSampler, uMatrixTextureSize), getFloatFromPixel(tIndex + 15, uMatrixSampler, uMatrixTextureSize) ); vec4 transformedPosition = transform * vec4(position, 1.0); return vec3(transformedPosition); } return position; } void main(void) { vec3 vertex = getVertexPosition(); vPosition = vertex; gl_Position = uPMatrix * uMVMatrix * vec4(vertex, 1.0); if (uColorCoding){ vColor = getIdColor(); } else{ vec3 normal = getNormal(); float lightAIntensity = ulightA[3]; vec3 lightADirection = normalize(ulightA.xyz - vPosition); float lightBIntensity = ulightB[3]; vec3 lightBDirection = normalize(ulightB.xyz - vPosition); float lightWeightA = max(dot(normal, lightADirection ) * lightAIntensity, 0.0); float lightWeightB = max(dot(normal, lightBDirection ) * lightBIntensity, 0.0); float lightWeighting = lightWeightA + lightWeightB + 0.4; vec4 baseColor = getColor(); vColor = vec4(baseColor.rgb * lightWeighting, baseColor.a); } }'\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-shaders.ts","import { xState } from './xbim-state';\r\nimport { xProductType } from './xbim-product-type';\r\nimport { xModelGeometry } from './xbim-model-geometry';\r\nimport { xModelHandle } from './xbim-model-handle';\r\nimport { xShaders } from './xbim-shaders';\r\nvar glMatrix = require('../Libs/gl-matrix');\r\ndeclare var window: any; // TODO\r\nimport '../Libs/webgl-utils';\r\ndeclare var WebGLUtils;\r\n\r\nexport class xViewer {\r\n\r\n    /**\r\n    * This is constructor of the xBIM Viewer. It gets HTMLCanvasElement or string ID as an argument. Viewer will than be initialized \r\n    * in the context of specified canvas. Any other argument will throw exception.\r\n    * @name xViewer\r\n    * @constructor\r\n    * @classdesc This is the main and the only class you need to load and render IFC models in wexBIM format. This viewer is part of\r\n    * xBIM toolkit which can be used to create wexBIM files from IFC, ifcZIP and ifcXML. WexBIM files are highly optimized for\r\n    * transmition over internet and rendering performance. Viewer uses WebGL technology for hardware accelerated 3D rendering and SVG for\r\n    * certain kinds of user interaction. This means that it won't work with obsolete and non-standard-compliant browsers like IE10 and less.\r\n    *\r\n    * @param {string | HTMLCanvasElement} canvas - string ID of the canvas or HTML canvas element.\r\n    */\r\n    constructor(canvas: string | HTMLCanvasElement) {\r\n        if (typeof (canvas) == 'undefined') {\r\n            throw 'Canvas has to be defined';\r\n        }\r\n\r\n        if (typeof (canvas['nodeName']) != 'undefined' && canvas['nodeName'] === 'CANVAS') {\r\n            this._canvas = <HTMLCanvasElement>canvas;\r\n        }\r\n        if (typeof (canvas) == 'string') {\r\n            this._canvas = <HTMLCanvasElement>document.getElementById(<string>canvas);\r\n        }\r\n        if (this._canvas == null) {\r\n            throw 'You have to specify canvas either as an ID of HTML element or the element itself';\r\n        }\r\n\r\n        /**\r\n        * This is a structure that holds settings of perspective camera.\r\n        * @member {PerspectiveCamera} xViewer#perspectiveCamera\r\n        */\r\n        /**\r\n        * This is only a structure. Don't call the constructor.\r\n        * @classdesc This is a structure that holds settings of perspective camera. If you want \r\n        * to switch viewer to use perspective camera set {@link xViewer#camera camera} to 'perspective'.\r\n        * You can modify this but it is not necessary because sensible values are \r\n        * defined when geometry model is loaded with {@link xViewer#load load()} method. If you want to \r\n        * change these values you have to do it after geometry is loaded.\r\n        * @class\r\n        * @name PerspectiveCamera\r\n        */\r\n        this.perspectiveCamera = {\r\n            /** @member {Number} PerspectiveCamera#fov - Field of view*/\r\n            fov: 45,\r\n            /** @member {Number} PerspectiveCamera#near - Near cutting plane*/\r\n            near: 0,\r\n            /** @member {Number} PerspectiveCamera#far - Far cutting plane*/\r\n            far: 0\r\n        };\r\n\r\n        /**\r\n        * This is a structure that holds settings of orthogonal camera. You can modify this but it is not necessary because sensible values are \r\n        * defined when geometry model is loaded with {@link xViewer#load load()} method. If you want to change these values you have to do it after geometry is loaded.\r\n        * @member {OrthogonalCamera} xViewer#orthogonalCamera\r\n        */\r\n        /**\r\n        * This is only a structure. Don't call the constructor.\r\n        * @classdesc This is a structure that holds settings of orthogonal camera. If you want to switch viewer to use orthogonal camera set {@link xViewer#camera camera} to 'orthogonal'.\r\n        * @class\r\n        * @name OrthogonalCamera\r\n        */\r\n        this.orthogonalCamera = {\r\n            /** @member {Number} OrthogonalCamera#left*/\r\n            left: 0,\r\n            /** @member {Number} OrthogonalCamera#right*/\r\n            right: 0,\r\n            /** @member {Number} OrthogonalCamera#top*/\r\n            top: 0,\r\n            /** @member {Number} OrthogonalCamera#bottom*/\r\n            bottom: 0,\r\n            /** @member {Number} OrthogonalCamera#near*/\r\n            near: 0,\r\n            /** @member {Number} OrthogonalCamera#far*/\r\n            far: 0\r\n        };\r\n\r\n        /**\r\n        * Type of camera to be used. Available values are <strong>'perspective'</strong> and <strong>'orthogonal'</strong> You can change this value at any time with instant effect.\r\n        * @member {string} xViewer#camera\r\n        */\r\n        this.camera = 'perspective';\r\n\r\n        /**\r\n        * Array of four integers between 0 and 255 representing RGBA colour components. This defines background colour of the viewer. You can change this value at any time with instant effect.\r\n        * @member {Number[]} xViewer#background\r\n        */\r\n        this.background = [230, 230, 230, 255];\r\n        /**\r\n        * Array of four integers between 0 and 255 representing RGBA colour components. This defines colour for highlighted elements. You can change this value at any time with instant effect.\r\n        * @member {Number[]} xViewer#highlightingColour\r\n        */\r\n        this.highlightingColour = [255, 173, 33, 255];\r\n        /**\r\n        * Array of four floats. It represents Light A's position <strong>XYZ</strong> and intensity <strong>I</strong> as [X, Y, Z, I]. Intensity should be in range 0.0 - 1.0.\r\n        * @member {Number[]} xViewer#lightA\r\n        */\r\n        this.lightA = [0, 1000000, 200000, 0.8];\r\n        /**\r\n        * Array of four floats. It represents Light B's position <strong>XYZ</strong> and intensity <strong>I</strong> as [X, Y, Z, I]. Intensity should be in range 0.0 - 1.0.\r\n        * @member {Number[]} xViewer#lightB\r\n        */\r\n        this.lightB = [0, -500000, 50000, 0.2];\r\n\r\n        /**\r\n        * Switch between different navigation modes for left mouse button. Allowed values: <strong> 'pan', 'zoom', 'orbit' (or 'fixed-orbit') , 'free-orbit' and 'none'</strong>. Default value is <strong>'orbit'</strong>;\r\n        * @member {String} xViewer#navigationMode\r\n        */\r\n        this.navigationMode = 'orbit';\r\n\r\n        /**\r\n        * Switch between different rendering modes. Allowed values: <strong> 'normal', 'x-ray'</strong>. Default value is <strong>'normal'</strong>;\r\n        * Only products with state set to state.HIGHLIGHTED or xState.XRAYVISIBLE will be rendered highlighted or in a normal colours. All other products\r\n        * will be rendered semi-transparent and single sided.\r\n        * @member {String} xViewer#renderingMode\r\n        */\r\n        this.renderingMode = 'normal';\r\n        /** \r\n        * Clipping plane [a, b, c, d] defined as normal equation of the plane ax + by + cz + d = 0. [0,0,0,0] is for no clipping plane.\r\n        * @member {Number[]} xViewer#clippingPlane\r\n        */\r\n        this.clippingPlane = [0, 0, 0, 0];\r\n\r\n        this._lastClippingPoint = [0, 0, 0];\r\n\r\n\r\n        //*************************** Do all the set up of WebGL **************************\r\n        var gl = WebGLUtils.setupWebGL(this._canvas);\r\n\r\n        //do not even initialize this object if WebGL is not supported\r\n        if (!gl) {\r\n            return;\r\n        }\r\n\r\n        this._gl = gl;\r\n\r\n        //detect floating point texture support\r\n        this._fpt = (\r\n            gl.getExtension('OES_texture_float') ||\r\n                gl.getExtension('MOZ_OES_texture_float') ||\r\n                gl.getExtension('WEBKIT_OES_texture_float')\r\n        );\r\n\r\n\r\n        //set up DEPTH_TEST and BLEND so that transparent objects look right\r\n        //this is not 100% perfect as it would be necessary to sort all objects from back to\r\n        //front when rendering them. We have sacrificed this for the sake of performance.\r\n        //Objects with no transparency in their default style are drawn first and semi-transparent last.\r\n        //This gives 90% right when there is not too much of transparency. It may not look right if you\r\n        //have a look through two windows or if you have a look from inside of the building out.\r\n        //It is granted to be alright when looking from outside of the building inside through one\r\n        //semi-transparent object like curtain wall panel or window which is the case most of the time.\r\n        //This is known limitation but there is no plan to change this behaviour.\r\n        gl.enable(gl.DEPTH_TEST);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n        gl.enable(gl.BLEND);\r\n\r\n        //cache canvas width and height and change it only when size change\r\n        // it is better to cache this value because it is used frequently and it takes a time to get a value from HTML\r\n        this._width = this._canvas.width = this._canvas.offsetWidth;\r\n        this._height = this._canvas.height = this._canvas.offsetHeight;\r\n\r\n        this._geometryLoaded = false;\r\n        //number of active models is used to indicate that state has changed\r\n        this._numberOfActiveModels = 0;\r\n        //this object is used to identify if anything changed before two frames (hence if it is necessary to redraw)\r\n        this._lastStates = {};\r\n        this._visualStateAttributes = [\r\n            'perspectiveCamera', 'orthogonalCamera', 'camera', 'background', 'lightA', 'lightB',\r\n            'renderingMode', 'clippingPlane', '_mvMatrix', '_pMatrix', '_distance', '_origin', 'highlightingColour',\r\n            '_numberOfActiveModels'\r\n        ];\r\n        this._stylingChanged = true;\r\n\r\n        //this is to indicate that user has done some interaction\r\n        this._userAction = true;\r\n\r\n        //dictionary of named events which can be registered and unregistered by using '.on('eventname', callback)'\r\n        // and '.off('eventname', callback)'. Registered call-backs are triggered by the viewer when important events occur.\r\n        this._events = {};\r\n\r\n        //array of plugins which can implement certain methods which get called at certain points like before draw, after draw and others.\r\n        this._plugins = [];\r\n\r\n        //pointers to uniforms in shaders\r\n        this._mvMatrixUniformPointer = null;\r\n        this._pMatrixUniformPointer = null;\r\n        this._lightAUniformPointer = null;\r\n        this._lightBUniformPointer = null;\r\n        this._colorCodingUniformPointer = null;\r\n        this._clippingPlaneUniformPointer = null;\r\n        this._meterUniformPointer = null;\r\n        this._renderingModeUniformPointer = null;\r\n        this._highlightingColourUniformPointer = null;\r\n\r\n        //transformation matrices\r\n        this._mvMatrix = glMatrix.mat4.create(); //world matrix\r\n        this._pMatrix = glMatrix.mat4.create(); //camera matrix (this can be either perspective or orthogonal camera)\r\n\r\n        //Navigation settings - coordinates in the WCS of the origin used for orbiting and panning\r\n        this._origin = [0, 0, 0]\r\n        //Default distance for default views (top, bottom, left, right, front, back)\r\n        this._distance = 0;\r\n        //shader program used for rendering\r\n        this._shaderProgram = null;\r\n\r\n        //Array of handles which can eventually contain handles to one or more models.\r\n        //Models are loaded using 'load()' function.\r\n        this._handles = [];\r\n\r\n        //This array keeps data for overlay styles.\r\n        this._stateStyles = new Uint8Array(15 * 15 * 4);\r\n\r\n        //This is a switch which can stop animation.\r\n        this._isRunning = true;\r\n\r\n        //********************** Run all the initialize functions *****************************\r\n        //compile shaders for use\r\n        this._initShaders();\r\n        //initialize vertex attribute and uniform pointers\r\n        this._initAttributesAndUniforms();\r\n        //initialize mouse events to capture user interaction\r\n        this._initMouseEvents();\r\n    }\r\n\r\n    public _canvas: HTMLCanvasElement;\r\n    public perspectiveCamera: { fov: number,near: number,far: number };\r\n    public orthogonalCamera: { left: number, right: number, top: number, bottom: number, near: number, far: number }\r\n    public _width: number;\r\n    private width: number;\r\n    public _height: number;\r\n    private height: number;\r\n    public _distance: number;\r\n    public camera: 'perspective' | 'orthogonal';\r\n    public background: number[];\r\n    private _isRunning: boolean;\r\n    private _stateStyles: Uint8Array;\r\n    private _geometryLoaded: boolean;\r\n    private _plugins: any[];\r\n    private _stylingChanged: boolean;\r\n    private _handles: any[];\r\n    public highlightingColour: number[];\r\n    public navigationMode: 'pan' | 'zoom' | 'orbit' | 'fixed-orbit' | 'free-orbit' | 'none';\r\n    private _userAction: boolean;\r\n    public _shaderProgram: any;\r\n    public _origin: number[];\r\n    public lightA: number[];\r\n    public lightB: number[];\r\n    private _mvMatrixUniformPointer: any;\r\n    private _pMatrixUniformPointer: any;\r\n    private _lightAUniformPointer: any;\r\n    private _lightBUniformPointer: any;\r\n    private _colorCodingUniformPointer: any;\r\n    private _clippingPlaneUniformPointer: any;\r\n    private _meterUniformPointer: any;\r\n    private _renderingModeUniformPointer: any;\r\n    private _highlightingColourUniformPointer: any;\r\n    private _events: any;\r\n    private _numberOfActiveModels: number;\r\n    private _lastStates: any;\r\n    private _visualStateAttributes: string[];\r\n    public renderingMode: 'normal' | 'x-ray';\r\n    public clippingPlane: number[];\r\n    private _lastClippingPoint: number[];\r\n    public _gl: any;\r\n    public _mvMatrix: any;\r\n    private _fpt: any;\r\n    private _pMatrix: any;\r\n    private _pointers: any;\r\n\r\n    /**\r\n    * This is a static function which should always be called before xViewer is instantiated.\r\n    * It will check all prerequisites of the viewer and will report all issues. If Prerequisities.errors contain\r\n    * any messages viewer won't work. If Prerequisities.warnings contain any messages it will work but some\r\n    * functions may be restricted or may not work or it may have poor performance.\r\n    * @function xViewer.check\r\n    * @return {Prerequisites}\r\n    */\r\n    public static check() {\r\n        /**\r\n        * This is a structure reporting errors and warnings about prerequisites of {@link xViewer xViewer}. It is result of {@link xViewer.checkPrerequisities checkPrerequisities()} static method.\r\n        *\r\n        * @name Prerequisites\r\n        * @class\r\n        */\r\n        var result = {\r\n            /**\r\n            * If this array contains any warnings xViewer will work but it might be slow or may not support full functionality.\r\n            * @member {string[]}  Prerequisites#warnings\r\n            */\r\n            warnings: [],\r\n            /**\r\n            * If this array contains any errors xViewer won't work at all or won't work as expected. \r\n            * You can use messages in this array to report problems to user. However, user won't probably \r\n            * be able to do to much with it except trying to use different browser. IE10- are not supported for example. \r\n            * The latest version of IE should be all right.\r\n            * @member {string[]}  Prerequisites#errors\r\n            */\r\n            errors: [],\r\n            /**\r\n            * If false xViewer won't work at all or won't work as expected. \r\n            * You can use messages in {@link Prerequisites#errors errors array} to report problems to user. However, user won't probably \r\n            * be able to do to much with it except trying to use different browser. IE10- are not supported for example. \r\n            * The latest version of IE should be all right.\r\n            * @member {string[]}  Prerequisites#noErrors\r\n            */\r\n            noErrors: false,\r\n            /**\r\n            * If false xViewer will work but it might be slow or may not support full functionality. Use {@link Prerequisites#warnings warnings array} to report problems.\r\n            * @member {string[]}  Prerequisites#noWarnings\r\n            */\r\n            noWarnings: false\r\n        };\r\n\r\n        //check WebGL support\r\n        var canvas = document.createElement('canvas');\r\n        if (!canvas) result.errors.push(\"Browser doesn't have support for HTMLCanvasElement. This is critical.\");\r\n        else {\r\n            var gl = WebGLUtils.setupWebGL(canvas);\r\n            if (gl == null) result.errors.push(\"Browser doesn't support WebGL. This is critical.\");\r\n            else {\r\n                //check floating point extension availability\r\n                var fpt = (\r\n                    gl.getExtension('OES_texture_float') ||\r\n                        gl.getExtension('MOZ_OES_texture_float') ||\r\n                        gl.getExtension('WEBKIT_OES_texture_float')\r\n                );\r\n                if (!fpt)\r\n                    result.warnings\r\n                        .push('Floating point texture extension is not supported. Performance of the viewer will be very bad. But it should work.');\r\n\r\n                //check number of supported vertex shader textures. Minimum is 5 but standard requires 0.\r\n                var vertTextUnits = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n                if (vertTextUnits < 4)\r\n                    result.errors.push('Browser supports only ' +\r\n                        vertTextUnits +\r\n                        ' vertex texture image units but minimal requirement for the viewer is 4.');\r\n            }\r\n        }\r\n\r\n        //check FileReader and Blob support\r\n        if (!window\r\n            .File ||\r\n            !window.FileReader ||\r\n            !window.Blob) result.errors.push(\"Browser doesn't support 'File', 'FileReader' or 'Blob' objects.\");\r\n\r\n\r\n        //check for typed arrays\r\n        if (!window.Int32Array || !window.Float32Array)\r\n            result.errors\r\n                .push(\"Browser doesn't support TypedArrays. These are crucial for binary parsing and for comunication with GPU.\");\r\n\r\n        //check SVG support\r\n        if (!document.implementation\r\n            .hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\r\n        )\r\n            result.warnings\r\n                .push(\"Browser doesn't support SVG. This is used for user interaction like interactive clipping. Functions using SVG shouldn't crash but they won't work as expected.\");\r\n\r\n        //set boolean members for convenience\r\n        if (result.errors.length == 0) result.noErrors = true;\r\n        if (result.warnings.length == 0) result.noWarnings = true;\r\n        return result;\r\n    }\r\n\r\n    /**\r\n    * Adds plugin to the viewer. Plugins can implement certain methods which get called in certain moments in time like\r\n    * before draw, after draw etc. This makes it possible to implement functionality tightly integrated into xViewer like navigation cube or others. \r\n    * @function xViewer#addPlugin\r\n    * @param {object} plugin - plug-in object\r\n    */\r\n    public addPlugin(plugin) {\r\n        this._plugins.push(plugin);\r\n\r\n        if (!plugin.init) return;\r\n        plugin.init(this);\r\n    }\r\n\r\n    /**\r\n    * Removes plugin from the viewer. Plugins can implement certain methods which get called in certain moments in time like\r\n    * before draw, after draw etc. This makes it possible to implement functionality tightly integrated into xViewer like navigation cube or others. \r\n    * @function xViewer#removePlugin\r\n    * @param {object} plugin - plug-in object\r\n    */\r\n    public removePlugin(plugin) {\r\n        var index = this._plugins.indexOf(plugin, 0);\r\n        if (index < 0) return;\r\n        this._plugins.splice(index, 1);\r\n    }\r\n\r\n    /**\r\n    * Use this function to define up to 224 optional styles which you can use to change appearance of products and types if you pass the index specified in this function to {@link xViewer#setState setState()} function.\r\n    * @function xViewer#defineStyle\r\n    * @param {Number} index - Index of the style to be defined. This has to be in range 0 - 224. Index can than be passed to change appearance of the products in model\r\n    * @param {Number[]} colour - Array of four numbers in range 0 - 255 representing RGBA colour. If there are less or more numbers exception is thrown.\r\n    */\r\n    public defineStyle(index: number, colour: number[]) {\r\n        if (typeof (index) == 'undefined' || (index < 0 && index > 224)) throw 'Style index has to be defined as a number 0-224';\r\n        if (typeof (colour) == 'undefined' || !colour.length || colour.length != 4) throw 'Colour must be defined as an array of 4 bytes';\r\n        this._stylingChanged = true;\r\n\r\n        //set style to style texture via model handle\r\n        var colData = new Uint8Array(colour);\r\n        this._stateStyles.set(colData, index * 4);\r\n\r\n        //if there are some handles already set this style in there\r\n        this._handles.forEach(function(handle) {\r\n                handle.stateStyle = this._stateStyles;\r\n                handle.refreshStyles();\r\n            },\r\n            this);\r\n    }\r\n\r\n    /**\r\n    * You can use this function to change state of products in the model. State has to have one of values from {@link xState xState} enumeration. \r\n    * Target is either enumeration from {@link xProductType xProductType} or array of product IDs. If you specify type it will effect all elements of the type.\r\n    *\r\n    * @function xViewer#setState\r\n    * @param {Number} state - One of {@link xState xState} enumeration values.\r\n    * @param {Number[] | Number} target - Target of the change. It can either be array of product IDs or product type from {@link xProductType xProductType}.\r\n    */\r\n    public setState(state: number, target: number | number[]) {\r\n        if (typeof (state) == 'undefined' || !(state >= 225 && state <= 255)) throw 'State has to be defined as 225 - 255. Use xState enum.';\r\n        this._handles.forEach(function(handle) {\r\n                handle.setState(state, target);\r\n            },\r\n            this);\r\n        this._stylingChanged = true;\r\n    }\r\n\r\n    /**\r\n    * Use this function to get state of the products in the model. You can compare result of this function \r\n    * with one of values from {@link xState xState} enumeration. 0xFF is the default value.\r\n    *\r\n    * @function xViewer#getState\r\n    * @param {Number} id - Id of the product. You would typically get the id from {@link xViewer#event:pick pick event} or similar event.\r\n    */\r\n    public getState(id: number) {\r\n        var state = null;\r\n        this._handles.forEach(function(handle) {\r\n                state = handle.getState(id);\r\n                if (state !== null) {\r\n                    return;\r\n                }\r\n            },\r\n            this);\r\n        return state;\r\n    }\r\n\r\n    /**\r\n    * Use this function to reset state of all products to 'UNDEFINED' which means visible and not highlighted. \r\n    * You can use optional hideSpaces parameter if you also want to show spaces. They will be hidden by default.\r\n    * \r\n    * @function xViewer#resetStates\r\n    * @param {Bool} [hideSpaces = true] - Default state is UNDEFINED which would also show spaces. That is often not \r\n    * desired so it can be excluded with this parameter.\r\n    */\r\n    public resetStates(hideSpaces: boolean) {\r\n        this._handles.forEach(function(handle) {\r\n                handle.resetStates();\r\n            },\r\n            this);\r\n        //hide spaces\r\n        hideSpaces = typeof (hideSpaces) != 'undefined' ? hideSpaces : true;\r\n        if (hideSpaces) {\r\n            this._handles.forEach(function(handle) {\r\n                    handle.setState(xState.HIDDEN, xProductType.IFCSPACE);\r\n                },\r\n                this);\r\n        }\r\n        this._stylingChanged = true;\r\n    }\r\n\r\n    /**\r\n     * Gets complete model state and style. Resulting object can be used to restore the state later on.\r\n     * \r\n     * @param {Number} id - Model ID which you can get from {@link xViewer#event:loaded loaded} event.\r\n     * @returns {Array} - Array representing model state in compact form suitable for serialization\r\n     */\r\n    public getModelState(id: number) {\r\n        var handle = this._handles[id];\r\n        if (typeof (handle) === 'undefined') {\r\n            throw \"Model doesn't exist\";\r\n        }\r\n\r\n        return handle.getModelState();\r\n    }\r\n\r\n    /**\r\n     * Restores model state from the data previously captured with {@link xViewer#getModelState getModelState()} function\r\n     * @param {Number} id - ID of the model\r\n     * @param {Array} state - State of the model as obtained from {@link xViewer#getModelState getModelState()} function\r\n     */\r\n    public restoreModelState(id: number, state: any[]) {\r\n        var handle = this._handles[id];\r\n        if (typeof (handle) === 'undefined') {\r\n            throw \"Model doesn't exist\";\r\n        }\r\n\r\n        handle.restoreModelState(state);\r\n        this._stylingChanged = true;\r\n    }\r\n\r\n    /**\r\n    * Use this method for restyling of the model. This doesn't change the default appearance of the products so you can think about it as an overlay. You can \r\n    * remove the overlay if you set the style to {@link xState#UNSTYLED xState.UNSTYLED} value. You can combine restyling and hiding in this way. \r\n    * Use {@link xViewer#defineStyle defineStyle()} to define styling first. \r\n    * \r\n    * @function xViewer#setStyle\r\n    * @param style - style defined in {@link xViewer#defineStyle defineStyle()} method\r\n    * @param {Number[] | Number} target - Target of the change. It can either be array of product IDs or product type from {@link xProductType xProductType}.\r\n    */\r\n    public setStyle(style, target: number | number[]) {\r\n        if (typeof (style) == 'undefined' || !(style >= 0 && style <= 225)\r\n        ) throw 'Style has to be defined as 0 - 225 where 225 is for default style.';\r\n        var c = [\r\n            this._stateStyles[style * 4],\r\n            this._stateStyles[style * 4 + 1],\r\n            this._stateStyles[style * 4 + 2],\r\n            this._stateStyles[style * 4 + 3]\r\n        ];\r\n        if (c[0] == 0 && c[1] == 0 && c[2] == 0 && c[3] == 0 && console && console.warn)\r\n            console\r\n                .warn('You have used undefined colour for restyling. Elements with this style will have transparent black colour and hence will be invisible.');\r\n\r\n        this._handles.forEach(function(handle) {\r\n                handle.setState(style, target);\r\n            },\r\n            this);\r\n        this._stylingChanged = true;\r\n    }\r\n\r\n    /**\r\n    * Use this function to get overriding colour style of the products in the model. The number you get is the index of \r\n    * your custom colour which you have defined in {@link xViewer#defineStyle defineStyle()} function. 0xFF is the default value.\r\n    *\r\n    * @function xViewer#getStyle\r\n    * @param {Number} id - Id of the product. You would typically get the id from {@link xViewer#event:pick pick event} or similar event.\r\n    */\r\n    public getStyle(id: number) {\r\n        this._handles.forEach(function(handle) {\r\n                var style = handle.getStyle(id);\r\n                if (style !== null) {\r\n                    return style;\r\n                }\r\n            },\r\n            this);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n    * Use this function to reset appearance of all products to their default styles.\r\n    *\r\n    * @function xViewer#resetStyles \r\n    */\r\n    public resetStyles() {\r\n        this._handles.forEach(function(handle) {\r\n                handle.resetStyles();\r\n            },\r\n            this);\r\n        this._stylingChanged = true;\r\n    }\r\n\r\n    /**\r\n    * \r\n    * @function xViewer#getProductType\r\n    * @return {Number} Product type ID. This is either null if no type is identified or one of {@link xProductType type ids}.\r\n    * @param {Number} prodID - Product ID. You can get this value either from semantic structure of the model or by listening to {@link xViewer#event:pick pick} event.\r\n    */\r\n    public getProductType(prodId: number) {\r\n        var pType = null;\r\n        this._handles.forEach(function(handle) {\r\n                var map = handle.getProductMap(prodId);\r\n                if (map) pType = map.type;\r\n            },\r\n            this);\r\n        return pType;\r\n    }\r\n\r\n    /**\r\n    * Use this method to set position of camera. Use it after {@link xViewer#setCameraTarget setCameraTarget()} to get desired result.\r\n    * \r\n    * @function xViewer#setCameraPosition\r\n    * @param {Number[]} coordinates - 3D coordinates of the camera in WCS\r\n    */\r\n    public setCameraPosition(coordinates: number[]) {\r\n        if (typeof (coordinates) == 'undefined') throw 'Parameter coordinates must be defined';\r\n        glMatrix.mat4.lookAt(this._mvMatrix, coordinates, this._origin, [0, 0, 1]);\r\n    }\r\n\r\n    /**\r\n    * This method sets navigation origin to the centroid of specified product's bounding box or to the centre of model if no product ID is specified.\r\n    * This method doesn't affect the view itself but it has an impact on navigation. Navigation origin is used as a centre for orbiting and it is used\r\n    * if you call functions like {@link xViewer.show show()} or {@link xViewer#zoomTo zoomTo()}.\r\n    * @function xViewer#setCameraTarget\r\n    * @param {Number} prodId [optional] Product ID. You can get ID either from semantic structure of the model or from {@link xViewer#event:pick pick event}.\r\n    * @return {Bool} True if the target exists and is set, False otherwise\r\n    */\r\n    public setCameraTarget(prodId?: number) {\r\n        var viewer = this;\r\n        //helper function for setting of the distance based on camera field of view and size of the product's bounding box\r\n        var setDistance = function(bBox) {\r\n            var size = Math.max(bBox[3], bBox[4], bBox[5]);\r\n            var ratio = Math.max(viewer._width, viewer._height) / Math.min(viewer._width, viewer._height);\r\n            viewer._distance = size / Math.tan(viewer.perspectiveCamera.fov * Math.PI / 180.0) * ratio * 1.0;\r\n        }\r\n\r\n        //set navigation origin and default distance to the product BBox\r\n        if (typeof (prodId) != 'undefined' && prodId != null) {\r\n            //get product BBox and set it's centre as a navigation origin\r\n            var bbox = null;\r\n            this._handles.every(function(handle) {\r\n                var map = handle.getProductMap(prodId);\r\n                if (map) {\r\n                    bbox = map.bBox;\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n            if (bbox) {\r\n                this._origin = [bbox[0] + bbox[3] / 2.0, bbox[1] + bbox[4] / 2.0, bbox[2] + bbox[5] / 2.0];\r\n                setDistance(bbox);\r\n                return true;\r\n            } else\r\n                return false;\r\n        }\r\n        //set navigation origin and default distance to the most populated region from the first model\r\n        else {\r\n            //get region extent and set it's centre as a navigation origin\r\n            var handle = this._handles[0];\r\n            if (handle) {\r\n                var region = handle.region\r\n                if (region) {\r\n                    this._origin = [region.centre[0], region.centre[1], region.centre[2]]\r\n                    setDistance(region.bbox);\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * This method can be used for batch setting of viewer members. It doesn't check validity of the input.\r\n    * @function xViewer#set\r\n    * @param {Object} settings - Object containing key - value pairs\r\n    */\r\n    public set(settings) {\r\n        for (var key in settings) {\r\n            this[key] = settings[key];\r\n        }\r\n    };\r\n\r\n    /**\r\n    * This method is used to load model data into viewer. Model has to be either URL to wexBIM file or Blob or File representing wexBIM file binary data. Any other type of argument will throw an exception.\r\n    * Region extend is determined based on the region of the model\r\n    * Default view if 'front'. If you want to define different view you have to set it up in handler of {@link xViewer#event:loaded loaded} event. <br>\r\n    * You can load more than one model if they occupy the same space, use the same scale and have unique product IDs. Duplicated IDs won't affect \r\n    * visualization itself but would cause unexpected user interaction (picking, zooming, ...)\r\n    * @function xViewer#load\r\n    * @param {String | Blob | File} model - Model has to be either URL to wexBIM file or Blob or File representing wexBIM file binary data.\r\n    * @param {Any} tag [optional] - Tag to be used to identify the model in {@link xViewer#event:loaded loaded} event.\r\n    * @fires xViewer#loaded\r\n    */\r\n    public load(model: string | Blob | File, tag) {\r\n        if (typeof (model) == 'undefined') throw 'You have to specify model to load.';\r\n        if (typeof (model) != 'string' && !(model instanceof Blob))\r\n            throw 'Model has to be specified either as a URL to wexBIM file or Blob object representing the wexBIM file.';\r\n        var viewer = this;\r\n\r\n        var geometry = new xModelGeometry();\r\n        geometry.onloaded = function() {\r\n            viewer._addHandle(geometry, tag);\r\n        };\r\n        geometry.onerror = function(msg) {\r\n            viewer._error(msg);\r\n        }\r\n        geometry.load(model);\r\n    }\r\n\r\n    //this is a private function used to add loaded geometry as a new handle and to set up camera and \r\n    //default view if this is the first geometry loaded\r\n    public _addHandle(geometry, tag) {\r\n        var viewer = this;\r\n        var gl = this._gl;\r\n\r\n        var handle = new xModelHandle(viewer._gl, geometry, viewer._fpt != null);\r\n        viewer._handles.push(handle);\r\n\r\n        handle.stateStyle = viewer._stateStyles;\r\n        handle.feedGPU();\r\n\r\n        //get one meter size from model and set it to shader\r\n        var meter = handle._model.meter;\r\n        gl.uniform1f(viewer._meterUniformPointer, meter);\r\n\r\n        //only set camera parameters and the view if this is the first model\r\n        if (viewer._handles.length === 1) {\r\n            //set centre and default distance based on the most populated region in the model\r\n            viewer.setCameraTarget();\r\n\r\n            //set perspective camera near and far based on 1 meter dimension and size of the model\r\n            var region = handle.region;\r\n            var maxSize = Math.max(region.bbox[3], region.bbox[4], region.bbox[5]);\r\n            viewer.perspectiveCamera.far = maxSize * 50;\r\n            viewer.perspectiveCamera.near = meter / 10.0;\r\n\r\n            //set orthogonalCamera boundaries so that it makes a sense\r\n            viewer.orthogonalCamera.far = viewer.perspectiveCamera.far;\r\n            viewer.orthogonalCamera.near = viewer.perspectiveCamera.near;\r\n            var ratio = 1.8;\r\n            viewer.orthogonalCamera.top = maxSize / ratio;\r\n            viewer.orthogonalCamera.bottom = maxSize / ratio * -1;\r\n            viewer.orthogonalCamera.left = maxSize / ratio * -1 * viewer._width / viewer._height;\r\n            viewer.orthogonalCamera.right = maxSize / ratio * viewer._width / viewer._height;\r\n\r\n            //set default view\r\n            viewer.setCameraTarget();\r\n            var dist = Math.sqrt(viewer._distance * viewer._distance / 3.0);\r\n            viewer.setCameraPosition([\r\n                region.centre[0] + dist * -1.0, region.centre[1] + dist * -1.0, region.centre[2] + dist\r\n            ]);\r\n        }\r\n\r\n        /**\r\n         * Occurs when geometry model is loaded into the viewer. This event returns object containing ID of the model.\r\n         * This ID can later be used to unload or temporarily stop the model.\r\n         * \r\n         * @event xViewer#loaded\r\n         * @type {object}\r\n         * @param {Number} id - model ID\r\n         * @param {Any} tag - tag which was passed to 'xViewer.load()' function\r\n         * \r\n        */\r\n        viewer._fire('loaded', { id: handle.id, tag: tag })\r\n        viewer._geometryLoaded = true;\r\n    };\r\n\r\n    /**\r\n     * Unloads model from the GPU. This action is not reversible.\r\n     * \r\n     * @param {Number} modelId - ID of the model which you can get from {@link xViewer#event:loaded loaded} event.\r\n     */\r\n    public unload(modelId: number) {\r\n        var handle = this._handles.filter(function(h) { return h.id === modelId }).pop();\r\n        if (typeof (handle) === 'undefined')\r\n            throw 'Model with id: ' + modelId + \" doesn't exist or was unloaded already.\"\r\n\r\n        //stop for start so it doesn't interfere with the rendering loop\r\n        handle.stopped = true;\r\n\r\n        //remove from the array\r\n        var index = this._handles.indexOf(handle);\r\n        this._handles.splice(index, 1);\r\n        this._numberOfActiveModels = this._handles.length;\r\n\r\n        //unload and delete\r\n        handle.unload();\r\n        //delete handle; // TODO\r\n    }\r\n\r\n    //this function should be only called once during initialization\r\n    //or when shader set-up changes\r\n    public _initShaders() {\r\n\r\n        var gl = this._gl;\r\n        var viewer = this;\r\n        var compile = function(shader, code) {\r\n            gl.shaderSource(shader, code);\r\n            gl.compileShader(shader);\r\n            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n                viewer._error(gl.getShaderInfoLog(shader));\r\n                return null;\r\n            }\r\n        }\r\n\r\n        //fragment shader\r\n        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n        compile(fragmentShader, xShaders.fragment_shader);\r\n\r\n        //vertex shader (the more complicated one)\r\n        var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n        if (this._fpt != null) compile(vertexShader, xShaders.vertex_shader);\r\n        else compile(vertexShader, xShaders.vertex_shader_noFPT);\r\n\r\n        //link program\r\n        this._shaderProgram = gl.createProgram();\r\n        gl.attachShader(this._shaderProgram, vertexShader);\r\n        gl.attachShader(this._shaderProgram, fragmentShader);\r\n        gl.linkProgram(this._shaderProgram);\r\n\r\n        if (!gl.getProgramParameter(this._shaderProgram, gl.LINK_STATUS)) {\r\n            this._error('Could not initialise shaders ');\r\n        }\r\n\r\n        gl.useProgram(this._shaderProgram);\r\n    }\r\n\r\n    public _initAttributesAndUniforms() {\r\n        var gl = this._gl;\r\n\r\n        //create pointers to uniform variables for transformations\r\n        this._pMatrixUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uPMatrix');\r\n        this._mvMatrixUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uMVMatrix');\r\n        this._lightAUniformPointer = gl.getUniformLocation(this._shaderProgram, 'ulightA');\r\n        this._lightBUniformPointer = gl.getUniformLocation(this._shaderProgram, 'ulightB');\r\n        this._colorCodingUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uColorCoding');\r\n        this._clippingPlaneUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uClippingPlane');\r\n        this._meterUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uMeter');\r\n        this._renderingModeUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uRenderingMode');\r\n        this._highlightingColourUniformPointer = gl.getUniformLocation(this._shaderProgram, 'uHighlightColour');\r\n\r\n        this._pointers = {\r\n            normalAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aNormal'),\r\n            indexlAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aVertexIndex'),\r\n            productAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aProduct'),\r\n            stateAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aState'),\r\n            styleAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aStyleIndex'),\r\n            transformationAttrPointer: gl.getAttribLocation(this._shaderProgram, 'aTransformationIndex'),\r\n            vertexSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uVertexSampler'),\r\n            matrixSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uMatrixSampler'),\r\n            styleSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uStyleSampler'),\r\n            stateStyleSamplerUniform: gl.getUniformLocation(this._shaderProgram, 'uStateStyleSampler'),\r\n            vertexTextureSizeUniform: gl.getUniformLocation(this._shaderProgram, 'uVertexTextureSize'),\r\n            matrixTextureSizeUniform: gl.getUniformLocation(this._shaderProgram, 'uMatrixTextureSize'),\r\n            styleTextureSizeUniform: gl.getUniformLocation(this._shaderProgram, 'uStyleTextureSize')\r\n        };\r\n\r\n        //enable vertex attributes arrays\r\n        gl.enableVertexAttribArray(this._pointers.normalAttrPointer);\r\n        gl.enableVertexAttribArray(this._pointers.indexlAttrPointer);\r\n        gl.enableVertexAttribArray(this._pointers.productAttrPointer);\r\n        gl.enableVertexAttribArray(this._pointers.stateAttrPointer);\r\n        gl.enableVertexAttribArray(this._pointers.styleAttrPointer);\r\n        gl.enableVertexAttribArray(this._pointers.transformationAttrPointer);\r\n    }\r\n\r\n    public _initMouseEvents() {\r\n        var viewer = this;\r\n\r\n        var mouseDown = false;\r\n        var lastMouseX = null;\r\n        var lastMouseY = null;\r\n        var startX = null;\r\n        var startY = null;\r\n        var button = 'L';\r\n        var id = -1;\r\n\r\n        //set initial conditions so that different gestures can be identified\r\n        function handleMouseDown(event) {\r\n            mouseDown = true;\r\n            lastMouseX = event.clientX;\r\n            lastMouseY = event.clientY;\r\n            startX = event.clientX;\r\n            startY = event.clientY;\r\n\r\n            //get coordinates within canvas (with the right orientation)\r\n            var r = viewer._canvas.getBoundingClientRect();\r\n            var viewX = startX - r.left;\r\n            var viewY = viewer._height - (startY - r.top);\r\n\r\n            //this is for picking\r\n            id = viewer._getID(viewX, viewY);\r\n\r\n            /**\r\n            * Occurs when mousedown event happens on underlying canvas.\r\n            *\r\n            * @event xViewer#mouseDown\r\n            * @type {object}\r\n            * @param {Number} id - product ID of the element or null if there wasn't any product under mouse\r\n            */\r\n            viewer._fire('mouseDown', { id: id });\r\n\r\n\r\n            //keep information about the mouse button\r\n            switch (event.button) {\r\n            case 0:\r\n                button = 'left';\r\n                break;\r\n\r\n            case 1:\r\n                button = 'middle';\r\n                break;\r\n\r\n            case 2:\r\n                button = 'right';\r\n                break;\r\n\r\n            default:\r\n                button = 'left';\r\n                break;\r\n            }\r\n\r\n            viewer._disableTextSelection();\r\n        }\r\n\r\n        function handleMouseUp(event) {\r\n            mouseDown = false;\r\n\r\n            var endX = event.clientX;\r\n            var endY = event.clientY;\r\n\r\n            var deltaX = Math.abs(endX - startX);\r\n            var deltaY = Math.abs(endY - startY);\r\n\r\n            //if it was a longer movement do not perform picking\r\n            if (deltaX < 3 && deltaY < 3 && button == 'left') {\r\n\r\n                var handled = false;\r\n                viewer._plugins.forEach(function(plugin) {\r\n                        if (!plugin.onBeforePick) {\r\n                            return;\r\n                        }\r\n                        handled = handled || plugin.onBeforePick(id);\r\n                    },\r\n                    this);\r\n\r\n                /**\r\n                * Occurs when user click on model.\r\n                *\r\n                * @event xViewer#pick\r\n                * @type {object}\r\n                * @param {Number} id - product ID of the element or null if there wasn't any product under mouse\r\n                */\r\n                if (!handled) viewer._fire('pick', { id: id });\r\n            }\r\n\r\n            viewer._enableTextSelection();\r\n        }\r\n\r\n        function handleMouseMove(event) {\r\n            if (!mouseDown) {\r\n                return;\r\n            }\r\n\r\n            if (viewer.navigationMode == 'none') {\r\n                return;\r\n            }\r\n\r\n            var newX = event.clientX;\r\n            var newY = event.clientY;\r\n\r\n            var deltaX = newX - lastMouseX;\r\n            var deltaY = newY - lastMouseY;\r\n\r\n            lastMouseX = newX;\r\n            lastMouseY = newY;\r\n\r\n            if (button == 'left') {\r\n                switch (viewer.navigationMode) {\r\n                case 'free-orbit':\r\n                    navigate('free-orbit', deltaX, deltaY);\r\n                    break;\r\n\r\n                case 'fixed-orbit':\r\n                case 'orbit':\r\n                    navigate('orbit', deltaX, deltaY);\r\n                    break;\r\n\r\n                case 'pan':\r\n                    navigate('pan', deltaX, deltaY);\r\n                    break;\r\n\r\n                case 'zoom':\r\n                    navigate('zoom', deltaX, deltaY);\r\n                    break;\r\n\r\n                default:\r\n                    break;\r\n\r\n                }\r\n            }\r\n            if (button == 'middle') {\r\n                navigate('pan', deltaX, deltaY);\r\n            }\r\n\r\n        }\r\n\r\n        function handleMouseScroll(event) {\r\n            if (viewer.navigationMode == 'none') {\r\n                return;\r\n            }\r\n            if (event.stopPropagation) {\r\n                event.stopPropagation();\r\n            }\r\n            if (event.preventDefault) {\r\n                event.preventDefault();\r\n            }\r\n\r\n            function sign(x) {\r\n                x = +x // convert to a number\r\n                if (x === 0 || isNaN(x))\r\n                    return x\r\n                return x > 0 ? 1 : -1\r\n            }\r\n\r\n            //deltaX and deltaY have very different values in different web browsers so fixed value is used for constant functionality.\r\n            navigate('zoom', sign(event.deltaX) * -1.0, sign(event.deltaY) * -1.0);\r\n        }\r\n\r\n        function navigate(type, deltaX, deltaY) {\r\n            if (!viewer._handles || !viewer._handles[0]) return;\r\n            //translation in WCS is position from [0, 0, 0]\r\n            var origin = viewer._origin;\r\n            var camera = viewer.getCameraPosition();\r\n\r\n            //get origin coordinates in view space\r\n            var mvOrigin = glMatrix.vec3.transformMat4(glMatrix.vec3.create(), origin, viewer._mvMatrix)\r\n\r\n            //movement factor needs to be dependant on the distance but one meter is a minimum so that movement wouldn't stop when camera is in 0 distance from navigation origin\r\n            var distanceVec = glMatrix.vec3.subtract(glMatrix.vec3.create(), origin, camera);\r\n            var distance = Math.max(glMatrix.vec3.length(distanceVec), viewer._handles[0]._model.meter);\r\n\r\n            //move to the navigation origin in view space\r\n            var transform = glMatrix.mat4.translate(glMatrix.mat4.create(), glMatrix.mat4.create(), mvOrigin)\r\n\r\n            //function for conversion from degrees to radians\r\n            function degToRad(deg) {\r\n                return deg * Math.PI / 180.0;\r\n            }\r\n\r\n            switch (type) {\r\n            case 'free-orbit':\r\n                transform = glMatrix.mat4.rotate(glMatrix.mat4.create(), transform, degToRad(deltaY / 4), [1, 0, 0]);\r\n                transform = glMatrix.mat4.rotate(glMatrix.mat4.create(), transform, degToRad(deltaX / 4), [0, 1, 0]);\r\n                break;\r\n\r\n            case 'fixed-orbit':\r\n            case 'orbit':\r\n                glMatrix.mat4.rotate(transform, transform, degToRad(deltaY / 4), [1, 0, 0]);\r\n\r\n                //z rotation around model z axis\r\n                var mvZ = glMatrix.vec3.transformMat3(glMatrix.vec3.create(),\r\n                    [0, 0, 1],\r\n                    glMatrix.mat3.fromMat4(glMatrix.mat3.create(), viewer._mvMatrix));\r\n                mvZ = glMatrix.vec3.normalize(glMatrix.vec3.create(), mvZ);\r\n                transform = glMatrix.mat4.rotate(glMatrix.mat4.create(), transform, degToRad(deltaX / 4), mvZ);\r\n\r\n                break;\r\n\r\n            case 'pan':\r\n                glMatrix.mat4.translate(transform, transform, [deltaX * distance / 150, 0, 0]);\r\n                glMatrix.mat4.translate(transform, transform, [0, (-1.0 * deltaY) * distance / 150, 0]);\r\n                break;\r\n\r\n            case 'zoom':\r\n                glMatrix.mat4.translate(transform, transform, [0, 0, deltaX * distance / 20]);\r\n                glMatrix.mat4.translate(transform, transform, [0, 0, deltaY * distance / 20]);\r\n                break;\r\n\r\n            default:\r\n                break;\r\n            }\r\n\r\n            //reverse the translation in view space and leave only navigation changes\r\n            var translation = glMatrix.vec3.negate(glMatrix.vec3.create(), mvOrigin);\r\n            transform = glMatrix.mat4.translate(glMatrix.mat4.create(), transform, translation);\r\n\r\n            //apply transformation in right order\r\n            viewer._mvMatrix = glMatrix.mat4.multiply(glMatrix.mat4.create(), transform, viewer._mvMatrix);\r\n        }\r\n\r\n        //watch resizing of canvas every 500ms\r\n        var elementHeight = viewer.height;\r\n        var elementWidth = viewer.width;\r\n        setInterval(function() {\r\n                if (viewer._canvas.offsetHeight !== elementHeight || viewer._canvas.offsetWidth !== elementWidth) {\r\n                    elementHeight = viewer._height = viewer._canvas.height = viewer._canvas.offsetHeight;\r\n                    elementWidth = viewer._width = viewer._canvas.width = viewer._canvas.offsetWidth;\r\n                }\r\n            },\r\n            500);\r\n\r\n\r\n        //attach callbacks\r\n        this._canvas.addEventListener('mousedown', handleMouseDown, true);\r\n        this._canvas.addEventListener('wheel', handleMouseScroll, true);\r\n        window.addEventListener('mouseup', handleMouseUp, true);\r\n        window.addEventListener('mousemove', handleMouseMove, true);\r\n\r\n        this._canvas.addEventListener('mousemove',\r\n            function() {\r\n                viewer._userAction = true;\r\n            },\r\n            true);\r\n\r\n\r\n        /**\r\n        * Occurs when user double clicks on model.\r\n        *\r\n        * @event xViewer#dblclick\r\n        * @type {object}\r\n        * @param {Number} id - product ID of the element or null if there wasn't any product under mouse\r\n        */\r\n        this._canvas.addEventListener('dblclick', function() { viewer._fire('dblclick', { id: id }); }, true);\r\n    }\r\n\r\n    /**\r\n    * This is a static draw method. You can use it if you just want to render model once with no navigation and interaction.\r\n    * If you want interactive model call {@link xViewer#start start()} method. {@link xViewer#frame Frame event} is fired when draw call is finished.\r\n    * @function xViewer#draw\r\n    * @fires xViewer#frame\r\n    */\r\n    public draw() {\r\n        if (!this._geometryLoaded || this._handles.length == 0 || !(this._stylingChanged || this._isChanged())) {\r\n            if (!this._userAction) return;\r\n        }\r\n        this._userAction = false;\r\n\r\n        //call all before-draw plugins\r\n        this._plugins.forEach(function(plugin) {\r\n                if (!plugin.onBeforeDraw) {\r\n                    return;\r\n                }\r\n                plugin.onBeforeDraw();\r\n            },\r\n            this);\r\n\r\n        //styles are up to date when new frame is drawn\r\n        this._stylingChanged = false;\r\n\r\n        var gl = this._gl;\r\n        var width = this._width;\r\n        var height = this._height;\r\n\r\n        gl.useProgram(this._shaderProgram);\r\n        gl.viewport(0, 0, width, height);\r\n        gl.clearColor(this.background[0] / 255,\r\n            this.background[1] / 255,\r\n            this.background[2] / 255,\r\n            this.background[3] / 255);\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n        //set up camera\r\n        switch (this.camera) {\r\n        case 'perspective':\r\n            glMatrix.mat4.perspective(this._pMatrix,\r\n                this.perspectiveCamera.fov * Math.PI / 180.0,\r\n                this._width / this._height,\r\n                this.perspectiveCamera.near,\r\n                this.perspectiveCamera.far);\r\n            break;\r\n\r\n        case 'orthogonal':\r\n            glMatrix.mat4.ortho(this._pMatrix,\r\n                this.orthogonalCamera.left,\r\n                this.orthogonalCamera.right,\r\n                this.orthogonalCamera.bottom,\r\n                this.orthogonalCamera.top,\r\n                this.orthogonalCamera.near,\r\n                this.orthogonalCamera.far);\r\n            break;\r\n\r\n        default:\r\n            glMatrix.mat4.perspective(this._pMatrix,\r\n                this.perspectiveCamera.fov * Math.PI / 180.0,\r\n                this._width / this._height,\r\n                this.perspectiveCamera.near,\r\n                this.perspectiveCamera.far);\r\n            break;\r\n        }\r\n\r\n        //set uniforms (these may quickly change between calls to draw)\r\n        gl.uniformMatrix4fv(this._pMatrixUniformPointer, false, this._pMatrix);\r\n        gl.uniformMatrix4fv(this._mvMatrixUniformPointer, false, this._mvMatrix);\r\n        gl.uniform4fv(this._lightAUniformPointer, new Float32Array(this.lightA));\r\n        gl.uniform4fv(this._lightBUniformPointer, new Float32Array(this.lightB));\r\n        gl.uniform4fv(this._clippingPlaneUniformPointer, new Float32Array(this.clippingPlane));\r\n\r\n        //use normal colour representation (1 would cause shader to use colour coding of IDs)\r\n        gl.uniform1i(this._colorCodingUniformPointer, 0);\r\n\r\n        //update highlighting colour\r\n        gl.uniform4fv(this._highlightingColourUniformPointer,\r\n            new Float32Array(\r\n            [\r\n                this.highlightingColour[0] / 255.0,\r\n                this.highlightingColour[1] / 255.0,\r\n                this.highlightingColour[2] / 255.0,\r\n                this.highlightingColour[3] / 255.0\r\n            ]));\r\n\r\n        //check for x-ray mode\r\n        if (this.renderingMode == 'x-ray') {\r\n            //two passes - first one for non-transparent objects, second one for all the others\r\n            gl.uniform1i(this._renderingModeUniformPointer, 2);\r\n            gl.disable(gl.CULL_FACE);\r\n            this._handles.forEach(function(handle) {\r\n                    if (!handle.stopped) {\r\n                        handle.setActive(this._pointers);\r\n                        handle.draw('solid');\r\n                    }\r\n                },\r\n                this);\r\n\r\n            //transparent objects should have only one side so that they are even more transparent.\r\n            gl.uniform1i(this._renderingModeUniformPointer, 2);\r\n            gl.enable(gl.CULL_FACE);\r\n            this._handles.forEach(function(handle) {\r\n                    if (!handle.stopped) {\r\n                        handle.setActive(this._pointers);\r\n                        handle.draw('transparent');\r\n                    }\r\n                },\r\n                this);\r\n            gl.uniform1i(this._renderingModeUniformPointer, 0);\r\n        } else {\r\n            gl.uniform1i(this._renderingModeUniformPointer, 0);\r\n            gl.disable(gl.CULL_FACE);\r\n\r\n            //two runs, first for solids from all models, second for transparent objects from all models\r\n            //this makes sure that transparent objects are always rendered at the end.\r\n            this._handles.forEach(function(handle) {\r\n                    if (!handle.stopped) {\r\n                        handle.setActive(this._pointers);\r\n                        handle.draw('solid');\r\n                    }\r\n                },\r\n                this);\r\n\r\n            this._handles.forEach(function(handle) {\r\n                    if (!handle.stopped) {\r\n                        handle.setActive(this._pointers);\r\n                        handle.draw('transparent');\r\n                    }\r\n                },\r\n                this);\r\n        }\r\n\r\n        //call all after-draw plugins\r\n        this._plugins.forEach(function(plugin) {\r\n                if (!plugin.onAfterDraw) {\r\n                    return;\r\n                }\r\n                plugin.onAfterDraw();\r\n            },\r\n            this);\r\n\r\n        /**\r\n         * Occurs after every frame in animation. Don't do anything heavy weighted in here as it will happen about 60 times in a second all the time.\r\n         *\r\n         * @event xViewer#frame \r\n         * @type {object}\r\n         */\r\n        this._fire('frame', {});\r\n    };\r\n\r\n    public _isChanged() {\r\n        var theSame = true;\r\n        this._visualStateAttributes.forEach(function(visualStateAttribute) {\r\n                var state = JSON.stringify(this[visualStateAttribute]);\r\n                var lastState = this._lastStates[visualStateAttribute];\r\n                this._lastStates[visualStateAttribute] = state;\r\n                theSame = theSame && (state === lastState)\r\n            },\r\n            this);\r\n        return !theSame;\r\n    }\r\n\r\n    /**\r\n    * Use this method get actual camera position.\r\n    * @function xViewer#getCameraPosition\r\n    */\r\n    public getCameraPosition() {\r\n        var transform = glMatrix.mat4.create();\r\n        glMatrix.mat4.multiply(transform, this._pMatrix, this._mvMatrix);\r\n        var inv = glMatrix.mat4.create()\r\n        glMatrix.mat4.invert(inv, transform);\r\n        var eye = glMatrix.vec3.create();\r\n        glMatrix.vec3.transformMat4(eye, glMatrix.vec3.create(), inv);\r\n\r\n        return eye;\r\n    }\r\n\r\n    /**\r\n    * Use this method to zoom to specified element. If you don't specify a product ID it will zoom to full extent.\r\n    * @function xViewer#zoomTo\r\n    * @param {Number} [id] Product ID\r\n    * @return {Bool} True if target exists and zoom was successful, False otherwise\r\n    */\r\n    public zoomTo(id: number) {\r\n        var found = this.setCameraTarget(id);\r\n        if (!found) return false;\r\n\r\n        var eye = this.getCameraPosition();\r\n        var dir = glMatrix.vec3.create();\r\n        glMatrix.vec3.subtract(dir, eye, this._origin);\r\n        dir = glMatrix.vec3.normalize(glMatrix.vec3.create(), dir);\r\n\r\n        var translation = glMatrix.vec3.create();\r\n        glMatrix.vec3.scale(translation, dir, this._distance);\r\n        glMatrix.vec3.add(eye, translation, this._origin);\r\n\r\n        glMatrix.mat4.lookAt(this._mvMatrix, eye, this._origin, [0, 0, 1]);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n    * Use this function to show default views.\r\n    *\r\n    * @function xViewer#show\r\n    * @param {String} type - Type of view. Allowed values are <strong>'top', 'bottom', 'front', 'back', 'left', 'right'</strong>. \r\n    * Directions of this views are defined by the coordinate system. Target and distance are defined by {@link xViewer#setCameraTarget setCameraTarget()} method to certain product ID\r\n    * or to the model extent if {@link xViewer#setCameraTarget setCameraTarget()} is called with no arguments.\r\n    */\r\n    public show(type: string) {\r\n        var origin = this._origin;\r\n        var distance = this._distance;\r\n        var camera = [0, 0, 0];\r\n        var heading = [0, 0, 1];\r\n        switch (type) {\r\n            //top and bottom are different because these are singular points for look-at function if heading is [0,0,1]\r\n        case 'top':\r\n            //only move to origin and up (negative values because we move camera against model)\r\n            glMatrix.mat4.translate(this._mvMatrix,\r\n                glMatrix.mat4.create(),\r\n                [origin[0] * -1.0, origin[1] * -1.0, (distance + origin[2]) * -1.0]);\r\n            return;\r\n        case 'bottom':\r\n            //only move to origin and up and rotate 180 degrees around Y axis\r\n            var toOrigin = glMatrix.mat4.translate(glMatrix.mat4.create(),\r\n                glMatrix.mat4.create(),\r\n                [origin[0] * -1.0, origin[1] * +1.0, (origin[2] + distance) * -1]);\r\n            var rotationY = glMatrix.mat4.rotateY(glMatrix.mat4.create(), toOrigin, Math.PI);\r\n            var rotationZ = glMatrix.mat4.rotateZ(glMatrix.mat4.create(), rotationY, Math.PI);\r\n            this\r\n                ._mvMatrix = rotationZ;\r\n            // glMatrix.mat4.translate(glMatrix.mat4.create(), rotationZ, [0, 0, -1.0 * distance]);\r\n            return;\r\n\r\n        case 'front':\r\n            camera = [origin[0], origin[1] - distance, origin[2]];\r\n            break;\r\n        case 'back':\r\n            camera = [origin[0], origin[1] + distance, origin[2]];\r\n            break;\r\n        case 'left':\r\n            camera = [origin[0] - distance, origin[1], origin[2]];\r\n            break;\r\n        case 'right':\r\n            camera = [origin[0] + distance, origin[1], origin[2]];\r\n            break;\r\n        default:\r\n            break;\r\n        }\r\n        //use look-at function to set up camera and target\r\n        glMatrix.mat4.lookAt(this._mvMatrix, camera, origin, heading);\r\n    }\r\n\r\n    public _error(msg) {\r\n        /**\r\n        * Occurs when viewer encounters error. You should listen to this because it might also report asynchronous errors which you would miss otherwise.\r\n        *\r\n        * @event xViewer#error\r\n        * @type {object}\r\n        * @param {string} message - Error message\r\n        */\r\n        this._fire('error', { message: msg });\r\n    }\r\n\r\n    //this renders the colour coded model into the memory buffer\r\n    //not to the canvas and use it to identify ID of the object from that\r\n    public _getID(x, y) {\r\n\r\n        //call all before-drawId plugins\r\n        this._plugins.forEach(function(plugin) {\r\n                if (!plugin.onBeforeDrawId) {\r\n                    return;\r\n                }\r\n                plugin.onBeforeDrawId();\r\n            },\r\n            this);\r\n\r\n        //it is not necessary to render the image in full resolution so this factor is used for less resolution. \r\n        var factor = 2;\r\n        var gl = this._gl;\r\n        var width = this._width / factor;\r\n        var height = this._height / factor;\r\n        x = x / factor;\r\n        y = y / factor;\r\n\r\n        //create framebuffer\r\n        var frameBuffer = gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\r\n\r\n        // create renderbuffer\r\n        var renderBuffer = gl.createRenderbuffer();\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\r\n        // allocate renderbuffer\r\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\r\n\r\n        var texture = gl.createTexture();\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n        // Set the parameters so we can render any image size.        \r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n\r\n\r\n        // attach renderbuffer and texture\r\n        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderBuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\r\n\r\n        if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) != gl.FRAMEBUFFER_COMPLETE) {\r\n            this._error('this combination of attachments does not work');\r\n            return null;\r\n        }\r\n\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\r\n        gl.viewport(0, 0, width, height);\r\n\r\n        gl.enable(gl.DEPTH_TEST); //we don't use any kind of blending or transparency\r\n        gl.disable(gl.BLEND);\r\n        gl.clearColor(0, 0, 0, 0); //zero colour for no-values\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n        //set uniform for colour coding\r\n        gl.uniform1i(this._colorCodingUniformPointer, 1);\r\n\r\n        //render colour coded image using latest buffered data\r\n        this._handles.forEach(function(handle) {\r\n                if (!handle.stopped) {\r\n                    handle.setActive(this._pointers);\r\n                    handle.draw();\r\n                }\r\n            },\r\n            this);\r\n\r\n        //call all after-drawId plugins\r\n        this._plugins.forEach(function(plugin) {\r\n                if (!plugin.onAfterDrawId) {\r\n                    return;\r\n                }\r\n                plugin.onAfterDrawId();\r\n            },\r\n            this);\r\n\r\n        //get colour in of the pixel\r\n        var result = new Uint8Array(4);\r\n        gl.readPixels(x, y, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, result);\r\n\r\n\r\n        //reset framebuffer to render into canvas again\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n\r\n        //free GPU memory\r\n        gl.deleteTexture(texture);\r\n        gl.deleteRenderbuffer(renderBuffer);\r\n        gl.deleteFramebuffer(frameBuffer);\r\n\r\n        //set back blending\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n        gl.enable(gl.BLEND);\r\n\r\n        //decode ID (bit shifting by multiplication)\r\n        var hasValue = result[3] != 0; //0 transparency is only for no-values\r\n        if (hasValue) {\r\n            var id = result[0] + result[1] * 256 + result[2] * 256 * 256;\r\n            var handled = false;\r\n            this._plugins.forEach(function(plugin) {\r\n                    if (!plugin.onBeforeGetId) {\r\n                        return;\r\n                    }\r\n                    handled = handled || plugin.onBeforeGetId(id);\r\n                },\r\n                this);\r\n\r\n            if (!handled)\r\n                return id;\r\n            else\r\n                return null;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Use this function to start animation of the model. If you start animation before geometry is loaded it will wait for content to render it.\r\n    * This function is bound to browser framerate of the screen so it will stop consuming any resources if you switch to another tab.\r\n    *\r\n    * @function xViewer#start\r\n    * @param {Number} id [optional] - Optional ID of the model to be stopped. You can get this ID from {@link xViewer#event:loaded loaded} event.\r\n    */\r\n    public start(id?: number) {\r\n        if (typeof (id) !== 'undefined') {\r\n            var model = this._handles.filter(function(h) { return h.id === id; }).pop();\r\n            if (typeof (model) === 'undefined')\r\n                throw \"Model doesn't exist.\";\r\n\r\n            model.stopped = false;\r\n            this._numberOfActiveModels++;\r\n            return;\r\n        }\r\n\r\n        this._isRunning = true;\r\n        var viewer = this;\r\n        var lastTime = new Date();\r\n        var counter = 0;\r\n\r\n        function tick() {\r\n            counter++;\r\n            if (counter == 30) {\r\n                counter = 0;\r\n                var newTime = new Date();\r\n                var span = newTime.getTime() - lastTime.getTime();\r\n                lastTime = newTime;\r\n                var fps = 1000 / span * 30;\r\n                /**\r\n                * Occurs after every 30th frame in animation. Use this event if you want to report FPS to the user. It might also be interesting performance measure.\r\n                *\r\n                * @event xViewer#fps \r\n                * @type {Number}\r\n                */\r\n                viewer._fire('fps', Math.floor(fps));\r\n            }\r\n\r\n            if (viewer._isRunning) {\r\n                window.requestAnimFrame(tick)\r\n                viewer.draw()\r\n            }\r\n        }\r\n\r\n        tick();\r\n    }\r\n\r\n    /**\r\n    * Use this function to stop animation of the model. User will still be able to see the latest state of the model. You can \r\n    * switch animation of the model on again by calling {@link xViewer#start start()}.\r\n    *\r\n    * @function xViewer#stop\r\n    * @param {Number} id [optional] - Optional ID of the model to be stopped. You can get this ID from {@link xViewer#event:loaded loaded} event.\r\n    */\r\n    public stop(id: number) {\r\n        if (typeof (id) == 'undefined') {\r\n            this._isRunning = false;\r\n            return;\r\n        }\r\n\r\n        var model = this._handles.filter(function(h) { return h.id === id; }).pop();\r\n        if (typeof (model) === 'undefined')\r\n            throw \"Model doesn't exist.\";\r\n\r\n        model.stopped = true;\r\n        this._numberOfActiveModels--;\r\n    }\r\n\r\n    /**\r\n     * Use this method to register to events of the viewer like {@link xViewer#event:pick pick}, {@link xViewer#event:mouseDown mouseDown}, \r\n     * {@link xViewer#event:loaded loaded} and others. You can define arbitrary number\r\n     * of event handlers for any event. You can remove handler by calling {@link xViewer#off off()} method.\r\n     *\r\n     * @function xViewer#on\r\n     * @param {String} eventName - Name of the event you would like to listen to.\r\n     * @param {Object} callback - Callback handler of the event which will consume arguments and perform any custom action.\r\n    */\r\n    public on(eventName: string, callback) {\r\n        var events = this._events;\r\n        if (!events[eventName]) {\r\n            events[eventName] = [];\r\n        }\r\n        events[eventName].push(callback);\r\n    }\r\n\r\n    /**\r\n    * Use this method to unregister handlers from events. You can add event handlers by calling the {@link xViewer#on on()} method.\r\n    *\r\n    * @function xViewer#off\r\n    * @param {String} eventName - Name of the event\r\n    * @param {Object} callback - Handler to be removed\r\n    */\r\n    public off(eventName: string, callback) {\r\n        var events = this._events;\r\n        var callbacks = events[eventName];\r\n        if (!callbacks) {\r\n            return;\r\n        }\r\n        var index = callbacks.indexOf(callback);\r\n        if (index >= 0) {\r\n            callbacks.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    //executes all handlers bound to event name\r\n    public _fire(eventName, args) {\r\n        var handlers = this._events[eventName];\r\n        if (!handlers) {\r\n            return;\r\n        }\r\n        //cal the callbacks\r\n        handlers.forEach(function(handler) {\r\n                handler(args);\r\n            },\r\n            this);\r\n    }\r\n\r\n    public _disableTextSelection() {\r\n        //disable text selection\r\n        document.documentElement.style['-webkit-touch-callout'] = 'none';\r\n        document.documentElement.style['-webkit-user-select'] = 'none';\r\n        document.documentElement.style['-khtml-user-select'] = 'none';\r\n        document.documentElement.style['-moz-user-select'] = 'none';\r\n        document.documentElement.style['-ms-user-select'] = 'none';\r\n        document.documentElement.style['user-select'] = 'none';\r\n    }\r\n\r\n    public _enableTextSelection() {\r\n        //enable text selection again\r\n        document.documentElement.style['-webkit-touch-callout'] = 'text';\r\n        document.documentElement.style['-webkit-user-select'] = 'text';\r\n        document.documentElement.style['-khtml-user-select'] = 'text';\r\n        document.documentElement.style['-moz-user-select'] = 'text';\r\n        document.documentElement.style['-ms-user-select'] = 'text';\r\n        document.documentElement.style['user-select'] = 'text';\r\n    }\r\n\r\n    public _getSVGOverlay(): any {\r\n        //check support for SVG\r\n        if (!document.implementation\r\n            .hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')) return false;\r\n        var ns = 'http://www.w3.org/2000/svg';\r\n\r\n        function getOffsetRect(elem) {\r\n            var box = elem.getBoundingClientRect();\r\n\r\n            var body = document.body;\r\n            var docElem = document.documentElement;\r\n\r\n            var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n            var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\r\n            var clientTop = docElem.clientTop || body.clientTop || 0;\r\n            var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n            var clientBottom = docElem['clientBottom'] || body['clientBottom'] || 0;\r\n            var clientRight = docElem['clientRight'] || body['clientRight'] || 0;\r\n\r\n\r\n            var top = Math.round(box.top + scrollTop - clientTop);\r\n            var left = Math.round(box.left + scrollLeft - clientLeft);\r\n            var bottom = Math.round(box.top + scrollTop - clientBottom);\r\n            var right = Math.round(box.left + scrollLeft - clientRight);\r\n\r\n            return { top: top, left: left, width: right - left, height: bottom - top };\r\n        }\r\n\r\n        //create SVG overlay\r\n        var svg = document.createElementNS(ns, 'svg');\r\n        //document.body.appendChild(svg);\r\n\r\n        var cRect = getOffsetRect(this._canvas);\r\n\r\n        svg['style'].position = 'absolute';\r\n        svg['style'].top = cRect.top + 'px';\r\n        svg['style'].left = cRect.left + 'px';\r\n        svg['style']['z-index'] = 100;\r\n        svg.setAttribute('width', this._width.toString());\r\n        svg.setAttribute('height', this._height.toString());\r\n\r\n        return svg;\r\n    }\r\n\r\n    /**\r\n    * This method can be used to get parameter of the current clipping plane. If no clipping plane is active\r\n    * this returns [[0,0,0],[0,0,0]];\r\n    *\r\n    * @function xViewer#getClip\r\n    * @return  {Number[][]} Point and normal defining current clipping plane\r\n    */\r\n    public getClip(): number[][] {\r\n        var cp = this.clippingPlane;\r\n        if (cp.every((e) => { return e === 0; })) {\r\n            return [[0, 0, 0], [0, 0, 0]];\r\n        }\r\n\r\n        var normal = glMatrix.vec3.normalize([0.0, 0.0, 0.0], [cp[0], cp[1], cp[2]]);\r\n\r\n        //test if the last clipping point fits in the condition\r\n        var lp = this._lastClippingPoint;\r\n        var test = lp[0] * cp[0] + lp[1] * cp[1] + lp[2] * cp[2] + cp[3];\r\n        if (Math.abs(test) < 1e-5) {\r\n            return [lp, normal];\r\n        }\r\n\r\n        //find the point on the plane\r\n        var x = cp[0] !== 0 ? -1.0 * cp[3] / cp[0] : 0.0;\r\n        var y = cp[1] !== 0 ? -1.0 * cp[3] / cp[1] : 0.0;\r\n        var z = cp[2] !== 0 ? -1.0 * cp[3] / cp[2] : 0.0;\r\n\r\n        return [[x, y, z], normal];\r\n    }\r\n\r\n    /**\r\n    * Use this method to clip the model. If you call the function with no arguments interactive clipping will start. This is based on SVG overlay\r\n    * so SVG support is necessary for it. But as WebGL is more advanced technology than SVG it is sound assumption that it is present in the browser.\r\n    * Use {@link xViewer.check xViewer.check()} to make sure it is supported at the very beginning of using of xViewer. Use {@link xViewer#unclip unclip()} method to \r\n    * unset clipping plane.\r\n    *\r\n    * @function xViewer#clip\r\n    * @param {Number[]} [point] - point in clipping plane\r\n    * @param {Number[]} [normal] - normal pointing to the half space which will be hidden\r\n    * @fires xViewer#clipped\r\n    */\r\n    public clip(point?: number[], normal?: number[]) {\r\n\r\n        //non interactive clipping, all information is there\r\n        if (typeof (point) != 'undefined' && typeof (normal) != 'undefined') {\r\n\r\n            this._lastClippingPoint = point;\r\n\r\n            //compute normal equation of the plane\r\n            var d = 0.0 - normal[0] * point[0] - normal[1] * point[1] - normal[2] * point[2];\r\n\r\n            //set clipping plane\r\n            this.clippingPlane = [normal[0], normal[1], normal[2], d]\r\n\r\n            /**\r\n            * Occurs when model is clipped. This event has empty object.\r\n            *\r\n            * @event xViewer#clipped\r\n            * @type {object}\r\n            */\r\n            this._fire('clipped', {});\r\n            return;\r\n        }\r\n\r\n        //********************************************** Interactive clipping ********************************************//\r\n        var ns = 'http://www.w3.org/2000/svg';\r\n        var svg = this._getSVGOverlay();\r\n        var viewer = this;\r\n        var position: { x?: number, y?: number, angle?: number } = {};\r\n        var down = false;\r\n        var g = {};\r\n\r\n        var handleMouseDown = (event) => {\r\n            if (down) return;\r\n            down = true;\r\n\r\n            viewer._disableTextSelection();\r\n\r\n            var r = svg.getBoundingClientRect();\r\n            position.x = event.clientX - r.left;\r\n            position.y = event.clientY - r.top;\r\n            position.angle = 0.0;\r\n\r\n            //create very long vertical line going through the point\r\n            g = document.createElementNS(ns, 'g');\r\n            g['setAttribute']('id', 'section');\r\n            svg.appendChild(g);\r\n\r\n            var line = document.createElementNS(ns, 'line');\r\n            g['appendChild'](line);\r\n\r\n            line.setAttribute('style', 'stroke:rgb(255,0,0);stroke-width:2');\r\n            line.setAttribute('x1', position.x.toString());\r\n            line.setAttribute('y1', '99999');\r\n            line.setAttribute('x2', position.x.toString());\r\n            line.setAttribute('y2', '-99999');\r\n        };\r\n\r\n        var handleMouseUp = (event) => {\r\n            if (!down) return;\r\n\r\n            //check if the points are not identical. \r\n            var r = svg.getBoundingClientRect();\r\n            if (position.x == event.clientX - r.left && position.y == event.clientY - r.top) {\r\n                return;\r\n            }\r\n\r\n            down = false;\r\n            viewer._enableTextSelection();\r\n\r\n\r\n            //get inverse transformation\r\n            var transform = glMatrix.mat4.create();\r\n            glMatrix.mat4.multiply(transform, viewer._pMatrix, viewer._mvMatrix);\r\n            var inverse = glMatrix.mat4.create();\r\n            glMatrix.mat4.invert(inverse, transform);\r\n\r\n            //get normalized coordinates the point in WebGL CS\r\n            var x1 = position.x / (viewer._width / 2.0) - 1.0;\r\n            var y1 = 1.0 - position.y / (viewer._height / 2.0);\r\n\r\n            //First point in WCS\r\n            var A = glMatrix.vec3.create();\r\n            glMatrix.vec3.transformMat4(A, [x1, y1, -1], inverse); //near clipping plane\r\n\r\n            //Second point in WCS\r\n            var B = glMatrix.vec3.create();\r\n            glMatrix.vec3.transformMat4(B, [x1, y1, 1], inverse); //far clipping plane\r\n\r\n            //Compute third point on plane\r\n            var angle = position.angle * Math.PI / 180.0;\r\n            var x2 = x1 + Math.cos(angle);\r\n            var y2 = y1 + Math.sin(angle);\r\n\r\n            //Third point in WCS\r\n            var C = glMatrix.vec3.create();\r\n            glMatrix.vec3.transformMat4(C, [x2, y2, 1], inverse); // far clipping plane\r\n\r\n\r\n            //Compute normal in WCS\r\n            var BA = glMatrix.vec3.subtract(glMatrix.vec3.create(), A, B);\r\n            var BC = glMatrix.vec3.subtract(glMatrix.vec3.create(), C, B);\r\n            var N = glMatrix.vec3.cross(glMatrix.vec3.create(), BA, BC);\r\n\r\n            viewer.clip(B, N);\r\n\r\n            //clean\r\n            svg.parentNode.removeChild(svg);\r\n            svg.removeEventListener('mousedown', handleMouseDown, true);\r\n            window.removeEventListener('mouseup', handleMouseUp, true);\r\n            window.removeEventListener('mousemove', handleMouseMove, true);\r\n        };\r\n\r\n        var handleMouseMove = function(event) {\r\n            if (!down) return;\r\n\r\n            var r = svg.getBoundingClientRect();\r\n            var x = event.clientX - r.left;\r\n            var y = event.clientY - r.top;\r\n\r\n            //rotate\r\n            var dX = x - position.x;\r\n            var dY = y - position.y;\r\n            var angle = Math.atan2(dX, dY) * -180.0 / Math.PI + 90.0;\r\n\r\n            //round to 5 DEG\r\n            angle = Math.round(angle / 5.0) * 5.0\r\n            position.angle = 360.0 - angle + 90;\r\n\r\n            g['setAttribute']('transform', 'rotate(' + angle + ' ' + position.x + ' ' + position.y + ')');\r\n        }\r\n\r\n        //this._canvas.parentNode.appendChild(svg);\r\n        document.documentElement.appendChild(svg)\r\n        svg.addEventListener('mousedown', handleMouseDown, true);\r\n        window.addEventListener('mouseup', handleMouseUp, true);\r\n        window.addEventListener('mousemove', handleMouseMove, true);\r\n\r\n        this.stopClipping = function() {\r\n            svg.parentNode.removeChild(svg);\r\n            svg.removeEventListener('mousedown', handleMouseDown, true);\r\n            window.removeEventListener('mouseup', handleMouseUp, true);\r\n            window.removeEventListener('mousemove', handleMouseMove, true);\r\n            //clear also itself\r\n            viewer.stopClipping = function() {};\r\n        };\r\n    }\r\n\r\n    /**\r\n    * This method is only active when interactive clipping is active. It stops interactive clipping operation.\r\n    * \r\n    * @function xViewer#stopClipping\r\n    */\r\n    //this is only a placeholder. It is actually created only when interactive clipping is active.\r\n    public stopClipping() {}\r\n\r\n    /**\r\n    * This method will cancel any clipping plane if it is defined. Use {@link xViewer#clip clip()} \r\n    * method to define clipping by point and normal of the plane or interactively if you call it with no arguments.\r\n    * @function xViewer#unclip\r\n    * @fires xViewer#unclipped\r\n    */\r\n    public unclip(): void {\r\n        this.clippingPlane = [0, 0, 0, 0];\r\n        /**\r\n          * Occurs when clipping of the model is dismissed. This event has empty object.\r\n          *\r\n          * @event xViewer#unclipped\r\n          * @type {object}\r\n          */\r\n        this._fire('unclipped', {});\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./Viewer/xbim-viewer.ts","/**\r\n * @fileoverview gl-matrix - High performance matrix and vector operations\r\n * @author Brandon Jones\r\n * @author Colin MacKenzie IV\r\n * @version 2.2.2\r\n */\r\n\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation\r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n\r\n(function(_global) {\r\n  \"use strict\";\r\n\r\n  var shim = {};\r\n  if (typeof(exports) === 'undefined') {\r\n    if(typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\r\n      shim.exports = {};\r\n      define(function() {\r\n        return shim.exports;\r\n      });\r\n    } else {\r\n      // gl-matrix lives in a browser, define its namespaces in global\r\n      shim.exports = typeof(window) !== 'undefined' ? window : _global;\r\n    }\r\n  }\r\n  else {\r\n    // gl-matrix lives in commonjs, define its namespaces in exports\r\n    shim.exports = exports;\r\n  }\r\n\r\n  (function(exports) {\r\n    /* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n\r\nif(!GLMAT_EPSILON) {\r\n    var GLMAT_EPSILON = 0.000001;\r\n}\r\n\r\nif(!GLMAT_ARRAY_TYPE) {\r\n    var GLMAT_ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\r\n}\r\n\r\nif(!GLMAT_RANDOM) {\r\n    var GLMAT_RANDOM = Math.random;\r\n}\r\n\r\n/**\r\n * @class Common utilities\r\n * @name glMatrix\r\n */\r\nvar glMatrix = {};\r\n\r\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Type} type Array type, such as Float32Array or Array\r\n */\r\nglMatrix.setMatrixArrayType = function(type) {\r\n    GLMAT_ARRAY_TYPE = type;\r\n}\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.glMatrix = glMatrix;\r\n}\r\n\r\nvar degree = Math.PI / 180;\r\n\r\n/**\r\n* Convert Degree To Radian\r\n*\r\n* @param {Number} Angle in Degrees\r\n*/\r\nglMatrix.toRadian = function(a){\r\n     return a * degree;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 2 Dimensional Vector\r\n * @name vec2\r\n */\r\n\r\nvar vec2 = {};\r\n\r\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\r\nvec2.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(2);\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {vec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\r\nvec2.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(2);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\r\nvec2.fromValues = function(x, y) {\r\n    var out = new GLMAT_ARRAY_TYPE(2);\r\n    out[0] = x;\r\n    out[1] = y;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the source vector\r\n * @returns {vec2} out\r\n */\r\nvec2.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\r\nvec2.set = function(out, x, y) {\r\n    out[0] = x;\r\n    out[1] = y;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nvec2.add = function(out, a, b) {\r\n    out[0] = a[0] + b[0];\r\n    out[1] = a[1] + b[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nvec2.subtract = function(out, a, b) {\r\n    out[0] = a[0] - b[0];\r\n    out[1] = a[1] - b[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\r\nvec2.sub = vec2.subtract;\r\n\r\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nvec2.multiply = function(out, a, b) {\r\n    out[0] = a[0] * b[0];\r\n    out[1] = a[1] * b[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\r\nvec2.mul = vec2.multiply;\r\n\r\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nvec2.divide = function(out, a, b) {\r\n    out[0] = a[0] / b[0];\r\n    out[1] = a[1] / b[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\r\nvec2.div = vec2.divide;\r\n\r\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nvec2.min = function(out, a, b) {\r\n    out[0] = Math.min(a[0], b[0]);\r\n    out[1] = Math.min(a[1], b[1]);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nvec2.max = function(out, a, b) {\r\n    out[0] = Math.max(a[0], b[0]);\r\n    out[1] = Math.max(a[1], b[1]);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\r\nvec2.scale = function(out, a, b) {\r\n    out[0] = a[0] * b;\r\n    out[1] = a[1] * b;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\r\nvec2.scaleAndAdd = function(out, a, b, scale) {\r\n    out[0] = a[0] + (b[0] * scale);\r\n    out[1] = a[1] + (b[1] * scale);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nvec2.distance = function(a, b) {\r\n    var x = b[0] - a[0],\r\n        y = b[1] - a[1];\r\n    return Math.sqrt(x*x + y*y);\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\r\nvec2.dist = vec2.distance;\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nvec2.squaredDistance = function(a, b) {\r\n    var x = b[0] - a[0],\r\n        y = b[1] - a[1];\r\n    return x*x + y*y;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\r\nvec2.sqrDist = vec2.squaredDistance;\r\n\r\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nvec2.length = function (a) {\r\n    var x = a[0],\r\n        y = a[1];\r\n    return Math.sqrt(x*x + y*y);\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\r\nvec2.len = vec2.length;\r\n\r\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nvec2.squaredLength = function (a) {\r\n    var x = a[0],\r\n        y = a[1];\r\n    return x*x + y*y;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\r\nvec2.sqrLen = vec2.squaredLength;\r\n\r\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to negate\r\n * @returns {vec2} out\r\n */\r\nvec2.negate = function(out, a) {\r\n    out[0] = -a[0];\r\n    out[1] = -a[1];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to invert\r\n * @returns {vec2} out\r\n */\r\nvec2.inverse = function(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  return out;\r\n};\r\n\r\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\r\nvec2.normalize = function(out, a) {\r\n    var x = a[0],\r\n        y = a[1];\r\n    var len = x*x + y*y;\r\n    if (len > 0) {\r\n        //TODO: evaluate use of glm_invsqrt here?\r\n        len = 1 / Math.sqrt(len);\r\n        out[0] = a[0] * len;\r\n        out[1] = a[1] * len;\r\n    }\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nvec2.dot = function (a, b) {\r\n    return a[0] * b[0] + a[1] * b[1];\r\n};\r\n\r\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec2.cross = function(out, a, b) {\r\n    var z = a[0] * b[1] - a[1] * b[0];\r\n    out[0] = out[1] = 0;\r\n    out[2] = z;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} t interpolation amount between the two inputs\r\n * @returns {vec2} out\r\n */\r\nvec2.lerp = function (out, a, b, t) {\r\n    var ax = a[0],\r\n        ay = a[1];\r\n    out[0] = ax + t * (b[0] - ax);\r\n    out[1] = ay + t * (b[1] - ay);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\r\nvec2.random = function (out, scale) {\r\n    scale = scale || 1.0;\r\n    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\r\n    out[0] = Math.cos(r) * scale;\r\n    out[1] = Math.sin(r) * scale;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nvec2.transformMat2 = function(out, a, m) {\r\n    var x = a[0],\r\n        y = a[1];\r\n    out[0] = m[0] * x + m[2] * y;\r\n    out[1] = m[1] * x + m[3] * y;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nvec2.transformMat2d = function(out, a, m) {\r\n    var x = a[0],\r\n        y = a[1];\r\n    out[0] = m[0] * x + m[2] * y + m[4];\r\n    out[1] = m[1] * x + m[3] * y + m[5];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nvec2.transformMat3 = function(out, a, m) {\r\n    var x = a[0],\r\n        y = a[1];\r\n    out[0] = m[0] * x + m[3] * y + m[6];\r\n    out[1] = m[1] * x + m[4] * y + m[7];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nvec2.transformMat4 = function(out, a, m) {\r\n    var x = a[0], \r\n        y = a[1];\r\n    out[0] = m[0] * x + m[4] * y + m[12];\r\n    out[1] = m[1] * x + m[5] * y + m[13];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nvec2.forEach = (function() {\r\n    var vec = vec2.create();\r\n\r\n    return function(a, stride, offset, count, fn, arg) {\r\n        var i, l;\r\n        if(!stride) {\r\n            stride = 2;\r\n        }\r\n\r\n        if(!offset) {\r\n            offset = 0;\r\n        }\r\n        \r\n        if(count) {\r\n            l = Math.min((count * stride) + offset, a.length);\r\n        } else {\r\n            l = a.length;\r\n        }\r\n\r\n        for(i = offset; i < l; i += stride) {\r\n            vec[0] = a[i]; vec[1] = a[i+1];\r\n            fn(vec, vec, arg);\r\n            a[i] = vec[0]; a[i+1] = vec[1];\r\n        }\r\n        \r\n        return a;\r\n    };\r\n})();\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec2} vec vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nvec2.str = function (a) {\r\n    return 'vec2(' + a[0] + ', ' + a[1] + ')';\r\n};\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.vec2 = vec2;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 3 Dimensional Vector\r\n * @name vec3\r\n */\r\n\r\nvar vec3 = {};\r\n\r\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\r\nvec3.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(3);\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {vec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\r\nvec3.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(3);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\r\nvec3.fromValues = function(x, y, z) {\r\n    var out = new GLMAT_ARRAY_TYPE(3);\r\n    out[0] = x;\r\n    out[1] = y;\r\n    out[2] = z;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the source vector\r\n * @returns {vec3} out\r\n */\r\nvec3.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\r\nvec3.set = function(out, x, y, z) {\r\n    out[0] = x;\r\n    out[1] = y;\r\n    out[2] = z;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.add = function(out, a, b) {\r\n    out[0] = a[0] + b[0];\r\n    out[1] = a[1] + b[1];\r\n    out[2] = a[2] + b[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.subtract = function(out, a, b) {\r\n    out[0] = a[0] - b[0];\r\n    out[1] = a[1] - b[1];\r\n    out[2] = a[2] - b[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\r\nvec3.sub = vec3.subtract;\r\n\r\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.multiply = function(out, a, b) {\r\n    out[0] = a[0] * b[0];\r\n    out[1] = a[1] * b[1];\r\n    out[2] = a[2] * b[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\r\nvec3.mul = vec3.multiply;\r\n\r\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.divide = function(out, a, b) {\r\n    out[0] = a[0] / b[0];\r\n    out[1] = a[1] / b[1];\r\n    out[2] = a[2] / b[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\r\nvec3.div = vec3.divide;\r\n\r\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.min = function(out, a, b) {\r\n    out[0] = Math.min(a[0], b[0]);\r\n    out[1] = Math.min(a[1], b[1]);\r\n    out[2] = Math.min(a[2], b[2]);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.max = function(out, a, b) {\r\n    out[0] = Math.max(a[0], b[0]);\r\n    out[1] = Math.max(a[1], b[1]);\r\n    out[2] = Math.max(a[2], b[2]);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\r\nvec3.scale = function(out, a, b) {\r\n    out[0] = a[0] * b;\r\n    out[1] = a[1] * b;\r\n    out[2] = a[2] * b;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\r\nvec3.scaleAndAdd = function(out, a, b, scale) {\r\n    out[0] = a[0] + (b[0] * scale);\r\n    out[1] = a[1] + (b[1] * scale);\r\n    out[2] = a[2] + (b[2] * scale);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nvec3.distance = function(a, b) {\r\n    var x = b[0] - a[0],\r\n        y = b[1] - a[1],\r\n        z = b[2] - a[2];\r\n    return Math.sqrt(x*x + y*y + z*z);\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\r\nvec3.dist = vec3.distance;\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nvec3.squaredDistance = function(a, b) {\r\n    var x = b[0] - a[0],\r\n        y = b[1] - a[1],\r\n        z = b[2] - a[2];\r\n    return x*x + y*y + z*z;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\r\nvec3.sqrDist = vec3.squaredDistance;\r\n\r\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nvec3.length = function (a) {\r\n    var x = a[0],\r\n        y = a[1],\r\n        z = a[2];\r\n    return Math.sqrt(x*x + y*y + z*z);\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\r\nvec3.len = vec3.length;\r\n\r\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nvec3.squaredLength = function (a) {\r\n    var x = a[0],\r\n        y = a[1],\r\n        z = a[2];\r\n    return x*x + y*y + z*z;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\r\nvec3.sqrLen = vec3.squaredLength;\r\n\r\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to negate\r\n * @returns {vec3} out\r\n */\r\nvec3.negate = function(out, a) {\r\n    out[0] = -a[0];\r\n    out[1] = -a[1];\r\n    out[2] = -a[2];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to invert\r\n * @returns {vec3} out\r\n */\r\nvec3.inverse = function(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  return out;\r\n};\r\n\r\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\r\nvec3.normalize = function(out, a) {\r\n    var x = a[0],\r\n        y = a[1],\r\n        z = a[2];\r\n    var len = x*x + y*y + z*z;\r\n    if (len > 0) {\r\n        //TODO: evaluate use of glm_invsqrt here?\r\n        len = 1 / Math.sqrt(len);\r\n        out[0] = a[0] * len;\r\n        out[1] = a[1] * len;\r\n        out[2] = a[2] * len;\r\n    }\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nvec3.dot = function (a, b) {\r\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\r\n};\r\n\r\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nvec3.cross = function(out, a, b) {\r\n    var ax = a[0], ay = a[1], az = a[2],\r\n        bx = b[0], by = b[1], bz = b[2];\r\n\r\n    out[0] = ay * bz - az * by;\r\n    out[1] = az * bx - ax * bz;\r\n    out[2] = ax * by - ay * bx;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} t interpolation amount between the two inputs\r\n * @returns {vec3} out\r\n */\r\nvec3.lerp = function (out, a, b, t) {\r\n    var ax = a[0],\r\n        ay = a[1],\r\n        az = a[2];\r\n    out[0] = ax + t * (b[0] - ax);\r\n    out[1] = ay + t * (b[1] - ay);\r\n    out[2] = az + t * (b[2] - az);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\r\nvec3.random = function (out, scale) {\r\n    scale = scale || 1.0;\r\n\r\n    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\r\n    var z = (GLMAT_RANDOM() * 2.0) - 1.0;\r\n    var zScale = Math.sqrt(1.0-z*z) * scale;\r\n\r\n    out[0] = Math.cos(r) * zScale;\r\n    out[1] = Math.sin(r) * zScale;\r\n    out[2] = z * scale;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nvec3.transformMat4 = function(out, a, m) {\r\n    var x = a[0], y = a[1], z = a[2],\r\n        w = m[3] * x + m[7] * y + m[11] * z + m[15];\r\n    w = w || 1.0;\r\n    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\r\n    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\r\n    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nvec3.transformMat3 = function(out, a, m) {\r\n    var x = a[0], y = a[1], z = a[2];\r\n    out[0] = x * m[0] + y * m[3] + z * m[6];\r\n    out[1] = x * m[1] + y * m[4] + z * m[7];\r\n    out[2] = x * m[2] + y * m[5] + z * m[8];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec3 with a quat\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\r\nvec3.transformQuat = function(out, a, q) {\r\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\r\n\r\n    var x = a[0], y = a[1], z = a[2],\r\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\r\n\r\n        // calculate quat * vec\r\n        ix = qw * x + qy * z - qz * y,\r\n        iy = qw * y + qz * x - qx * z,\r\n        iz = qw * z + qx * y - qy * x,\r\n        iw = -qx * x - qy * y - qz * z;\r\n\r\n    // calculate result * inverse quat\r\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\r\nvec3.rotateX = function(out, a, b, c){\r\n   var p = [], r=[];\r\n\t  //Translate point to the origin\r\n\t  p[0] = a[0] - b[0];\r\n\t  p[1] = a[1] - b[1];\r\n  \tp[2] = a[2] - b[2];\r\n\r\n\t  //perform rotation\r\n\t  r[0] = p[0];\r\n\t  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\r\n\t  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\r\n\r\n\t  //translate to correct position\r\n\t  out[0] = r[0] + b[0];\r\n\t  out[1] = r[1] + b[1];\r\n\t  out[2] = r[2] + b[2];\r\n\r\n  \treturn out;\r\n};\r\n\r\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\r\nvec3.rotateY = function(out, a, b, c){\r\n  \tvar p = [], r=[];\r\n  \t//Translate point to the origin\r\n  \tp[0] = a[0] - b[0];\r\n  \tp[1] = a[1] - b[1];\r\n  \tp[2] = a[2] - b[2];\r\n  \r\n  \t//perform rotation\r\n  \tr[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\r\n  \tr[1] = p[1];\r\n  \tr[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\r\n  \r\n  \t//translate to correct position\r\n  \tout[0] = r[0] + b[0];\r\n  \tout[1] = r[1] + b[1];\r\n  \tout[2] = r[2] + b[2];\r\n  \r\n  \treturn out;\r\n};\r\n\r\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\r\nvec3.rotateZ = function(out, a, b, c){\r\n  \tvar p = [], r=[];\r\n  \t//Translate point to the origin\r\n  \tp[0] = a[0] - b[0];\r\n  \tp[1] = a[1] - b[1];\r\n  \tp[2] = a[2] - b[2];\r\n  \r\n  \t//perform rotation\r\n  \tr[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\r\n  \tr[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\r\n  \tr[2] = p[2];\r\n  \r\n  \t//translate to correct position\r\n  \tout[0] = r[0] + b[0];\r\n  \tout[1] = r[1] + b[1];\r\n  \tout[2] = r[2] + b[2];\r\n  \r\n  \treturn out;\r\n};\r\n\r\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nvec3.forEach = (function() {\r\n    var vec = vec3.create();\r\n\r\n    return function(a, stride, offset, count, fn, arg) {\r\n        var i, l;\r\n        if(!stride) {\r\n            stride = 3;\r\n        }\r\n\r\n        if(!offset) {\r\n            offset = 0;\r\n        }\r\n        \r\n        if(count) {\r\n            l = Math.min((count * stride) + offset, a.length);\r\n        } else {\r\n            l = a.length;\r\n        }\r\n\r\n        for(i = offset; i < l; i += stride) {\r\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\r\n            fn(vec, vec, arg);\r\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\r\n        }\r\n        \r\n        return a;\r\n    };\r\n})();\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec3} vec vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nvec3.str = function (a) {\r\n    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\r\n};\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.vec3 = vec3;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 4 Dimensional Vector\r\n * @name vec4\r\n */\r\n\r\nvar vec4 = {};\r\n\r\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\r\nvec4.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(4);\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {vec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\r\nvec4.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(4);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\r\nvec4.fromValues = function(x, y, z, w) {\r\n    var out = new GLMAT_ARRAY_TYPE(4);\r\n    out[0] = x;\r\n    out[1] = y;\r\n    out[2] = z;\r\n    out[3] = w;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the source vector\r\n * @returns {vec4} out\r\n */\r\nvec4.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\r\nvec4.set = function(out, x, y, z, w) {\r\n    out[0] = x;\r\n    out[1] = y;\r\n    out[2] = z;\r\n    out[3] = w;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nvec4.add = function(out, a, b) {\r\n    out[0] = a[0] + b[0];\r\n    out[1] = a[1] + b[1];\r\n    out[2] = a[2] + b[2];\r\n    out[3] = a[3] + b[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nvec4.subtract = function(out, a, b) {\r\n    out[0] = a[0] - b[0];\r\n    out[1] = a[1] - b[1];\r\n    out[2] = a[2] - b[2];\r\n    out[3] = a[3] - b[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\r\nvec4.sub = vec4.subtract;\r\n\r\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nvec4.multiply = function(out, a, b) {\r\n    out[0] = a[0] * b[0];\r\n    out[1] = a[1] * b[1];\r\n    out[2] = a[2] * b[2];\r\n    out[3] = a[3] * b[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\r\nvec4.mul = vec4.multiply;\r\n\r\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nvec4.divide = function(out, a, b) {\r\n    out[0] = a[0] / b[0];\r\n    out[1] = a[1] / b[1];\r\n    out[2] = a[2] / b[2];\r\n    out[3] = a[3] / b[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\r\nvec4.div = vec4.divide;\r\n\r\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nvec4.min = function(out, a, b) {\r\n    out[0] = Math.min(a[0], b[0]);\r\n    out[1] = Math.min(a[1], b[1]);\r\n    out[2] = Math.min(a[2], b[2]);\r\n    out[3] = Math.min(a[3], b[3]);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nvec4.max = function(out, a, b) {\r\n    out[0] = Math.max(a[0], b[0]);\r\n    out[1] = Math.max(a[1], b[1]);\r\n    out[2] = Math.max(a[2], b[2]);\r\n    out[3] = Math.max(a[3], b[3]);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\r\nvec4.scale = function(out, a, b) {\r\n    out[0] = a[0] * b;\r\n    out[1] = a[1] * b;\r\n    out[2] = a[2] * b;\r\n    out[3] = a[3] * b;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\r\nvec4.scaleAndAdd = function(out, a, b, scale) {\r\n    out[0] = a[0] + (b[0] * scale);\r\n    out[1] = a[1] + (b[1] * scale);\r\n    out[2] = a[2] + (b[2] * scale);\r\n    out[3] = a[3] + (b[3] * scale);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nvec4.distance = function(a, b) {\r\n    var x = b[0] - a[0],\r\n        y = b[1] - a[1],\r\n        z = b[2] - a[2],\r\n        w = b[3] - a[3];\r\n    return Math.sqrt(x*x + y*y + z*z + w*w);\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\r\nvec4.dist = vec4.distance;\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nvec4.squaredDistance = function(a, b) {\r\n    var x = b[0] - a[0],\r\n        y = b[1] - a[1],\r\n        z = b[2] - a[2],\r\n        w = b[3] - a[3];\r\n    return x*x + y*y + z*z + w*w;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\r\nvec4.sqrDist = vec4.squaredDistance;\r\n\r\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nvec4.length = function (a) {\r\n    var x = a[0],\r\n        y = a[1],\r\n        z = a[2],\r\n        w = a[3];\r\n    return Math.sqrt(x*x + y*y + z*z + w*w);\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\r\nvec4.len = vec4.length;\r\n\r\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nvec4.squaredLength = function (a) {\r\n    var x = a[0],\r\n        y = a[1],\r\n        z = a[2],\r\n        w = a[3];\r\n    return x*x + y*y + z*z + w*w;\r\n};\r\n\r\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\r\nvec4.sqrLen = vec4.squaredLength;\r\n\r\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to negate\r\n * @returns {vec4} out\r\n */\r\nvec4.negate = function(out, a) {\r\n    out[0] = -a[0];\r\n    out[1] = -a[1];\r\n    out[2] = -a[2];\r\n    out[3] = -a[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to invert\r\n * @returns {vec4} out\r\n */\r\nvec4.inverse = function(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  out[3] = 1.0 / a[3];\r\n  return out;\r\n};\r\n\r\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\r\nvec4.normalize = function(out, a) {\r\n    var x = a[0],\r\n        y = a[1],\r\n        z = a[2],\r\n        w = a[3];\r\n    var len = x*x + y*y + z*z + w*w;\r\n    if (len > 0) {\r\n        len = 1 / Math.sqrt(len);\r\n        out[0] = a[0] * len;\r\n        out[1] = a[1] * len;\r\n        out[2] = a[2] * len;\r\n        out[3] = a[3] * len;\r\n    }\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nvec4.dot = function (a, b) {\r\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\r\n};\r\n\r\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} t interpolation amount between the two inputs\r\n * @returns {vec4} out\r\n */\r\nvec4.lerp = function (out, a, b, t) {\r\n    var ax = a[0],\r\n        ay = a[1],\r\n        az = a[2],\r\n        aw = a[3];\r\n    out[0] = ax + t * (b[0] - ax);\r\n    out[1] = ay + t * (b[1] - ay);\r\n    out[2] = az + t * (b[2] - az);\r\n    out[3] = aw + t * (b[3] - aw);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\r\nvec4.random = function (out, scale) {\r\n    scale = scale || 1.0;\r\n\r\n    //TODO: This is a pretty awful way of doing this. Find something better.\r\n    out[0] = GLMAT_RANDOM();\r\n    out[1] = GLMAT_RANDOM();\r\n    out[2] = GLMAT_RANDOM();\r\n    out[3] = GLMAT_RANDOM();\r\n    vec4.normalize(out, out);\r\n    vec4.scale(out, out, scale);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\r\nvec4.transformMat4 = function(out, a, m) {\r\n    var x = a[0], y = a[1], z = a[2], w = a[3];\r\n    out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\r\n    out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\r\n    out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\r\n    out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\r\nvec4.transformQuat = function(out, a, q) {\r\n    var x = a[0], y = a[1], z = a[2],\r\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\r\n\r\n        // calculate quat * vec\r\n        ix = qw * x + qy * z - qz * y,\r\n        iy = qw * y + qz * x - qx * z,\r\n        iz = qw * z + qx * y - qy * x,\r\n        iw = -qx * x - qy * y - qz * z;\r\n\r\n    // calculate result * inverse quat\r\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nvec4.forEach = (function() {\r\n    var vec = vec4.create();\r\n\r\n    return function(a, stride, offset, count, fn, arg) {\r\n        var i, l;\r\n        if(!stride) {\r\n            stride = 4;\r\n        }\r\n\r\n        if(!offset) {\r\n            offset = 0;\r\n        }\r\n        \r\n        if(count) {\r\n            l = Math.min((count * stride) + offset, a.length);\r\n        } else {\r\n            l = a.length;\r\n        }\r\n\r\n        for(i = offset; i < l; i += stride) {\r\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2]; vec[3] = a[i+3];\r\n            fn(vec, vec, arg);\r\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2]; a[i+3] = vec[3];\r\n        }\r\n        \r\n        return a;\r\n    };\r\n})();\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec4} vec vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nvec4.str = function (a) {\r\n    return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n};\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.vec4 = vec4;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 2x2 Matrix\r\n * @name mat2\r\n */\r\n\r\nvar mat2 = {};\r\n\r\n/**\r\n * Creates a new identity mat2\r\n *\r\n * @returns {mat2} a new 2x2 matrix\r\n */\r\nmat2.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(4);\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new mat2 initialized with values from an existing matrix\r\n *\r\n * @param {mat2} a matrix to clone\r\n * @returns {mat2} a new 2x2 matrix\r\n */\r\nmat2.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(4);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one mat2 to another\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nmat2.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set a mat2 to the identity matrix\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @returns {mat2} out\r\n */\r\nmat2.identity = function(out) {\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transpose the values of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nmat2.transpose = function(out, a) {\r\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n    if (out === a) {\r\n        var a1 = a[1];\r\n        out[1] = a[2];\r\n        out[2] = a1;\r\n    } else {\r\n        out[0] = a[0];\r\n        out[1] = a[2];\r\n        out[2] = a[1];\r\n        out[3] = a[3];\r\n    }\r\n    \r\n    return out;\r\n};\r\n\r\n/**\r\n * Inverts a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nmat2.invert = function(out, a) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n\r\n        // Calculate the determinant\r\n        det = a0 * a3 - a2 * a1;\r\n\r\n    if (!det) {\r\n        return null;\r\n    }\r\n    det = 1.0 / det;\r\n    \r\n    out[0] =  a3 * det;\r\n    out[1] = -a1 * det;\r\n    out[2] = -a2 * det;\r\n    out[3] =  a0 * det;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the adjugate of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nmat2.adjoint = function(out, a) {\r\n    // Caching this value is nessecary if out == a\r\n    var a0 = a[0];\r\n    out[0] =  a[3];\r\n    out[1] = -a[1];\r\n    out[2] = -a[2];\r\n    out[3] =  a0;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the determinant of a mat2\r\n *\r\n * @param {mat2} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nmat2.determinant = function (a) {\r\n    return a[0] * a[3] - a[2] * a[1];\r\n};\r\n\r\n/**\r\n * Multiplies two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\r\nmat2.multiply = function (out, a, b) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\r\n    out[0] = a0 * b0 + a2 * b1;\r\n    out[1] = a1 * b0 + a3 * b1;\r\n    out[2] = a0 * b2 + a2 * b3;\r\n    out[3] = a1 * b2 + a3 * b3;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link mat2.multiply}\r\n * @function\r\n */\r\nmat2.mul = mat2.multiply;\r\n\r\n/**\r\n * Rotates a mat2 by the given angle\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\r\nmat2.rotate = function (out, a, rad) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n        s = Math.sin(rad),\r\n        c = Math.cos(rad);\r\n    out[0] = a0 *  c + a2 * s;\r\n    out[1] = a1 *  c + a3 * s;\r\n    out[2] = a0 * -s + a2 * c;\r\n    out[3] = a1 * -s + a3 * c;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales the mat2 by the dimensions in the given vec2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat2} out\r\n **/\r\nmat2.scale = function(out, a, v) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n        v0 = v[0], v1 = v[1];\r\n    out[0] = a0 * v0;\r\n    out[1] = a1 * v0;\r\n    out[2] = a2 * v1;\r\n    out[3] = a3 * v1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns a string representation of a mat2\r\n *\r\n * @param {mat2} mat matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nmat2.str = function (a) {\r\n    return 'mat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n};\r\n\r\n/**\r\n * Returns Frobenius norm of a mat2\r\n *\r\n * @param {mat2} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nmat2.frob = function (a) {\r\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2)))\r\n};\r\n\r\n/**\r\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n * @param {mat2} L the lower triangular matrix \r\n * @param {mat2} D the diagonal matrix \r\n * @param {mat2} U the upper triangular matrix \r\n * @param {mat2} a the input matrix to factorize\r\n */\r\n\r\nmat2.LDU = function (L, D, U, a) { \r\n    L[2] = a[2]/a[0]; \r\n    U[0] = a[0]; \r\n    U[1] = a[1]; \r\n    U[3] = a[3] - L[2] * U[1]; \r\n    return [L, D, U];       \r\n}; \r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.mat2 = mat2;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 2x3 Matrix\r\n * @name mat2d\r\n * \r\n * @description \r\n * A mat2d contains six elements defined as:\r\n * <pre>\r\n * [a, c, tx,\r\n *  b, d, ty]\r\n * </pre>\r\n * This is a short form for the 3x3 matrix:\r\n * <pre>\r\n * [a, c, tx,\r\n *  b, d, ty,\r\n *  0, 0, 1]\r\n * </pre>\r\n * The last row is ignored so the array is shorter and operations are faster.\r\n */\r\n\r\nvar mat2d = {};\r\n\r\n/**\r\n * Creates a new identity mat2d\r\n *\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\r\nmat2d.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(6);\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    out[4] = 0;\r\n    out[5] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new mat2d initialized with values from an existing matrix\r\n *\r\n * @param {mat2d} a matrix to clone\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\r\nmat2d.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(6);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one mat2d to another\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\r\nmat2d.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set a mat2d to the identity matrix\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @returns {mat2d} out\r\n */\r\nmat2d.identity = function(out) {\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    out[4] = 0;\r\n    out[5] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Inverts a mat2d\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\r\nmat2d.invert = function(out, a) {\r\n    var aa = a[0], ab = a[1], ac = a[2], ad = a[3],\r\n        atx = a[4], aty = a[5];\r\n\r\n    var det = aa * ad - ab * ac;\r\n    if(!det){\r\n        return null;\r\n    }\r\n    det = 1.0 / det;\r\n\r\n    out[0] = ad * det;\r\n    out[1] = -ab * det;\r\n    out[2] = -ac * det;\r\n    out[3] = aa * det;\r\n    out[4] = (ac * aty - ad * atx) * det;\r\n    out[5] = (ab * atx - aa * aty) * det;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the determinant of a mat2d\r\n *\r\n * @param {mat2d} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nmat2d.determinant = function (a) {\r\n    return a[0] * a[3] - a[1] * a[2];\r\n};\r\n\r\n/**\r\n * Multiplies two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\r\nmat2d.multiply = function (out, a, b) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n        b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5];\r\n    out[0] = a0 * b0 + a2 * b1;\r\n    out[1] = a1 * b0 + a3 * b1;\r\n    out[2] = a0 * b2 + a2 * b3;\r\n    out[3] = a1 * b2 + a3 * b3;\r\n    out[4] = a0 * b4 + a2 * b5 + a4;\r\n    out[5] = a1 * b4 + a3 * b5 + a5;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link mat2d.multiply}\r\n * @function\r\n */\r\nmat2d.mul = mat2d.multiply;\r\n\r\n\r\n/**\r\n * Rotates a mat2d by the given angle\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\r\nmat2d.rotate = function (out, a, rad) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n        s = Math.sin(rad),\r\n        c = Math.cos(rad);\r\n    out[0] = a0 *  c + a2 * s;\r\n    out[1] = a1 *  c + a3 * s;\r\n    out[2] = a0 * -s + a2 * c;\r\n    out[3] = a1 * -s + a3 * c;\r\n    out[4] = a4;\r\n    out[5] = a5;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to translate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat2d} out\r\n **/\r\nmat2d.scale = function(out, a, v) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n        v0 = v[0], v1 = v[1];\r\n    out[0] = a0 * v0;\r\n    out[1] = a1 * v0;\r\n    out[2] = a2 * v1;\r\n    out[3] = a3 * v1;\r\n    out[4] = a4;\r\n    out[5] = a5;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Translates the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to translate\r\n * @param {vec2} v the vec2 to translate the matrix by\r\n * @returns {mat2d} out\r\n **/\r\nmat2d.translate = function(out, a, v) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\r\n        v0 = v[0], v1 = v[1];\r\n    out[0] = a0;\r\n    out[1] = a1;\r\n    out[2] = a2;\r\n    out[3] = a3;\r\n    out[4] = a0 * v0 + a2 * v1 + a4;\r\n    out[5] = a1 * v0 + a3 * v1 + a5;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns a string representation of a mat2d\r\n *\r\n * @param {mat2d} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nmat2d.str = function (a) {\r\n    return 'mat2d(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + \r\n                    a[3] + ', ' + a[4] + ', ' + a[5] + ')';\r\n};\r\n\r\n/**\r\n * Returns Frobenius norm of a mat2d\r\n *\r\n * @param {mat2d} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nmat2d.frob = function (a) { \r\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + 1))\r\n}; \r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.mat2d = mat2d;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 3x3 Matrix\r\n * @name mat3\r\n */\r\n\r\nvar mat3 = {};\r\n\r\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nmat3.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(9);\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 1;\r\n    out[5] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {mat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\r\nmat3.fromMat4 = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[4];\r\n    out[4] = a[5];\r\n    out[5] = a[6];\r\n    out[6] = a[8];\r\n    out[7] = a[9];\r\n    out[8] = a[10];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {mat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nmat3.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(9);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[8] = a[8];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nmat3.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[8] = a[8];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\r\nmat3.identity = function(out) {\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 1;\r\n    out[5] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nmat3.transpose = function(out, a) {\r\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n    if (out === a) {\r\n        var a01 = a[1], a02 = a[2], a12 = a[5];\r\n        out[1] = a[3];\r\n        out[2] = a[6];\r\n        out[3] = a01;\r\n        out[5] = a[7];\r\n        out[6] = a02;\r\n        out[7] = a12;\r\n    } else {\r\n        out[0] = a[0];\r\n        out[1] = a[3];\r\n        out[2] = a[6];\r\n        out[3] = a[1];\r\n        out[4] = a[4];\r\n        out[5] = a[7];\r\n        out[6] = a[2];\r\n        out[7] = a[5];\r\n        out[8] = a[8];\r\n    }\r\n    \r\n    return out;\r\n};\r\n\r\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nmat3.invert = function(out, a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n        a10 = a[3], a11 = a[4], a12 = a[5],\r\n        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\r\n        b01 = a22 * a11 - a12 * a21,\r\n        b11 = -a22 * a10 + a12 * a20,\r\n        b21 = a21 * a10 - a11 * a20,\r\n\r\n        // Calculate the determinant\r\n        det = a00 * b01 + a01 * b11 + a02 * b21;\r\n\r\n    if (!det) { \r\n        return null; \r\n    }\r\n    det = 1.0 / det;\r\n\r\n    out[0] = b01 * det;\r\n    out[1] = (-a22 * a01 + a02 * a21) * det;\r\n    out[2] = (a12 * a01 - a02 * a11) * det;\r\n    out[3] = b11 * det;\r\n    out[4] = (a22 * a00 - a02 * a20) * det;\r\n    out[5] = (-a12 * a00 + a02 * a10) * det;\r\n    out[6] = b21 * det;\r\n    out[7] = (-a21 * a00 + a01 * a20) * det;\r\n    out[8] = (a11 * a00 - a01 * a10) * det;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nmat3.adjoint = function(out, a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n        a10 = a[3], a11 = a[4], a12 = a[5],\r\n        a20 = a[6], a21 = a[7], a22 = a[8];\r\n\r\n    out[0] = (a11 * a22 - a12 * a21);\r\n    out[1] = (a02 * a21 - a01 * a22);\r\n    out[2] = (a01 * a12 - a02 * a11);\r\n    out[3] = (a12 * a20 - a10 * a22);\r\n    out[4] = (a00 * a22 - a02 * a20);\r\n    out[5] = (a02 * a10 - a00 * a12);\r\n    out[6] = (a10 * a21 - a11 * a20);\r\n    out[7] = (a01 * a20 - a00 * a21);\r\n    out[8] = (a00 * a11 - a01 * a10);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {mat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nmat3.determinant = function (a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n        a10 = a[3], a11 = a[4], a12 = a[5],\r\n        a20 = a[6], a21 = a[7], a22 = a[8];\r\n\r\n    return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\r\n};\r\n\r\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nmat3.multiply = function (out, a, b) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n        a10 = a[3], a11 = a[4], a12 = a[5],\r\n        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\r\n        b00 = b[0], b01 = b[1], b02 = b[2],\r\n        b10 = b[3], b11 = b[4], b12 = b[5],\r\n        b20 = b[6], b21 = b[7], b22 = b[8];\r\n\r\n    out[0] = b00 * a00 + b01 * a10 + b02 * a20;\r\n    out[1] = b00 * a01 + b01 * a11 + b02 * a21;\r\n    out[2] = b00 * a02 + b01 * a12 + b02 * a22;\r\n\r\n    out[3] = b10 * a00 + b11 * a10 + b12 * a20;\r\n    out[4] = b10 * a01 + b11 * a11 + b12 * a21;\r\n    out[5] = b10 * a02 + b11 * a12 + b12 * a22;\r\n\r\n    out[6] = b20 * a00 + b21 * a10 + b22 * a20;\r\n    out[7] = b20 * a01 + b21 * a11 + b22 * a21;\r\n    out[8] = b20 * a02 + b21 * a12 + b22 * a22;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\r\nmat3.mul = mat3.multiply;\r\n\r\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to translate\r\n * @param {vec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\r\nmat3.translate = function(out, a, v) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n        a10 = a[3], a11 = a[4], a12 = a[5],\r\n        a20 = a[6], a21 = a[7], a22 = a[8],\r\n        x = v[0], y = v[1];\r\n\r\n    out[0] = a00;\r\n    out[1] = a01;\r\n    out[2] = a02;\r\n\r\n    out[3] = a10;\r\n    out[4] = a11;\r\n    out[5] = a12;\r\n\r\n    out[6] = x * a00 + y * a10 + a20;\r\n    out[7] = x * a01 + y * a11 + a21;\r\n    out[8] = x * a02 + y * a12 + a22;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nmat3.rotate = function (out, a, rad) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2],\r\n        a10 = a[3], a11 = a[4], a12 = a[5],\r\n        a20 = a[6], a21 = a[7], a22 = a[8],\r\n\r\n        s = Math.sin(rad),\r\n        c = Math.cos(rad);\r\n\r\n    out[0] = c * a00 + s * a10;\r\n    out[1] = c * a01 + s * a11;\r\n    out[2] = c * a02 + s * a12;\r\n\r\n    out[3] = c * a10 - s * a00;\r\n    out[4] = c * a11 - s * a01;\r\n    out[5] = c * a12 - s * a02;\r\n\r\n    out[6] = a20;\r\n    out[7] = a21;\r\n    out[8] = a22;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\r\nmat3.scale = function(out, a, v) {\r\n    var x = v[0], y = v[1];\r\n\r\n    out[0] = x * a[0];\r\n    out[1] = x * a[1];\r\n    out[2] = x * a[2];\r\n\r\n    out[3] = y * a[3];\r\n    out[4] = y * a[4];\r\n    out[5] = y * a[5];\r\n\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[8] = a[8];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\r\nmat3.fromMat2d = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = 0;\r\n\r\n    out[3] = a[2];\r\n    out[4] = a[3];\r\n    out[5] = 0;\r\n\r\n    out[6] = a[4];\r\n    out[7] = a[5];\r\n    out[8] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n* Calculates a 3x3 matrix from the given quaternion\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {quat} q Quaternion to create matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\r\nmat3.fromQuat = function (out, q) {\r\n    var x = q[0], y = q[1], z = q[2], w = q[3],\r\n        x2 = x + x,\r\n        y2 = y + y,\r\n        z2 = z + z,\r\n\r\n        xx = x * x2,\r\n        yx = y * x2,\r\n        yy = y * y2,\r\n        zx = z * x2,\r\n        zy = z * y2,\r\n        zz = z * z2,\r\n        wx = w * x2,\r\n        wy = w * y2,\r\n        wz = w * z2;\r\n\r\n    out[0] = 1 - yy - zz;\r\n    out[3] = yx - wz;\r\n    out[6] = zx + wy;\r\n\r\n    out[1] = yx + wz;\r\n    out[4] = 1 - xx - zz;\r\n    out[7] = zy - wx;\r\n\r\n    out[2] = zx - wy;\r\n    out[5] = zy + wx;\r\n    out[8] = 1 - xx - yy;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {mat4} a Mat4 to derive the normal matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\r\nmat3.normalFromMat4 = function (out, a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\r\n\r\n        b00 = a00 * a11 - a01 * a10,\r\n        b01 = a00 * a12 - a02 * a10,\r\n        b02 = a00 * a13 - a03 * a10,\r\n        b03 = a01 * a12 - a02 * a11,\r\n        b04 = a01 * a13 - a03 * a11,\r\n        b05 = a02 * a13 - a03 * a12,\r\n        b06 = a20 * a31 - a21 * a30,\r\n        b07 = a20 * a32 - a22 * a30,\r\n        b08 = a20 * a33 - a23 * a30,\r\n        b09 = a21 * a32 - a22 * a31,\r\n        b10 = a21 * a33 - a23 * a31,\r\n        b11 = a22 * a33 - a23 * a32,\r\n\r\n        // Calculate the determinant\r\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n    if (!det) { \r\n        return null; \r\n    }\r\n    det = 1.0 / det;\r\n\r\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n    out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n    out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\r\n    out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n    out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n    out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\r\n    out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n    out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n    out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {mat3} mat matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nmat3.str = function (a) {\r\n    return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + \r\n                    a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + \r\n                    a[6] + ', ' + a[7] + ', ' + a[8] + ')';\r\n};\r\n\r\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {mat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nmat3.frob = function (a) {\r\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2)))\r\n};\r\n\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.mat3 = mat3;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class 4x4 Matrix\r\n * @name mat4\r\n */\r\n\r\nvar mat4 = {};\r\n\r\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nmat4.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(16);\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = 1;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[10] = 1;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n    out[15] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {mat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nmat4.clone = function(a) {\r\n    var out = new GLMAT_ARRAY_TYPE(16);\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[8] = a[8];\r\n    out[9] = a[9];\r\n    out[10] = a[10];\r\n    out[11] = a[11];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nmat4.copy = function(out, a) {\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[8] = a[8];\r\n    out[9] = a[9];\r\n    out[10] = a[10];\r\n    out[11] = a[11];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\r\nmat4.identity = function(out) {\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = 1;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[10] = 1;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n    out[15] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nmat4.transpose = function(out, a) {\r\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n    if (out === a) {\r\n        var a01 = a[1], a02 = a[2], a03 = a[3],\r\n            a12 = a[6], a13 = a[7],\r\n            a23 = a[11];\r\n\r\n        out[1] = a[4];\r\n        out[2] = a[8];\r\n        out[3] = a[12];\r\n        out[4] = a01;\r\n        out[6] = a[9];\r\n        out[7] = a[13];\r\n        out[8] = a02;\r\n        out[9] = a12;\r\n        out[11] = a[14];\r\n        out[12] = a03;\r\n        out[13] = a13;\r\n        out[14] = a23;\r\n    } else {\r\n        out[0] = a[0];\r\n        out[1] = a[4];\r\n        out[2] = a[8];\r\n        out[3] = a[12];\r\n        out[4] = a[1];\r\n        out[5] = a[5];\r\n        out[6] = a[9];\r\n        out[7] = a[13];\r\n        out[8] = a[2];\r\n        out[9] = a[6];\r\n        out[10] = a[10];\r\n        out[11] = a[14];\r\n        out[12] = a[3];\r\n        out[13] = a[7];\r\n        out[14] = a[11];\r\n        out[15] = a[15];\r\n    }\r\n    \r\n    return out;\r\n};\r\n\r\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nmat4.invert = function(out, a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\r\n\r\n        b00 = a00 * a11 - a01 * a10,\r\n        b01 = a00 * a12 - a02 * a10,\r\n        b02 = a00 * a13 - a03 * a10,\r\n        b03 = a01 * a12 - a02 * a11,\r\n        b04 = a01 * a13 - a03 * a11,\r\n        b05 = a02 * a13 - a03 * a12,\r\n        b06 = a20 * a31 - a21 * a30,\r\n        b07 = a20 * a32 - a22 * a30,\r\n        b08 = a20 * a33 - a23 * a30,\r\n        b09 = a21 * a32 - a22 * a31,\r\n        b10 = a21 * a33 - a23 * a31,\r\n        b11 = a22 * a33 - a23 * a32,\r\n\r\n        // Calculate the determinant\r\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n    if (!det) { \r\n        return null; \r\n    }\r\n    det = 1.0 / det;\r\n\r\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\r\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\r\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\r\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\r\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\r\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\r\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nmat4.adjoint = function(out, a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n    out[0]  =  (a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22));\r\n    out[1]  = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\r\n    out[2]  =  (a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12));\r\n    out[3]  = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\r\n    out[4]  = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\r\n    out[5]  =  (a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22));\r\n    out[6]  = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\r\n    out[7]  =  (a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12));\r\n    out[8]  =  (a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21));\r\n    out[9]  = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\r\n    out[10] =  (a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11));\r\n    out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\r\n    out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\r\n    out[13] =  (a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21));\r\n    out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\r\n    out[15] =  (a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11));\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {mat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nmat4.determinant = function (a) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\r\n\r\n        b00 = a00 * a11 - a01 * a10,\r\n        b01 = a00 * a12 - a02 * a10,\r\n        b02 = a00 * a13 - a03 * a10,\r\n        b03 = a01 * a12 - a02 * a11,\r\n        b04 = a01 * a13 - a03 * a11,\r\n        b05 = a02 * a13 - a03 * a12,\r\n        b06 = a20 * a31 - a21 * a30,\r\n        b07 = a20 * a32 - a22 * a30,\r\n        b08 = a20 * a33 - a23 * a30,\r\n        b09 = a21 * a32 - a22 * a31,\r\n        b10 = a21 * a33 - a23 * a31,\r\n        b11 = a22 * a33 - a23 * a32;\r\n\r\n    // Calculate the determinant\r\n    return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n};\r\n\r\n/**\r\n * Multiplies two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nmat4.multiply = function (out, a, b) {\r\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\r\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\r\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\r\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n    // Cache only the current line of the second matrix\r\n    var b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];  \r\n    out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n    out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n    out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n    out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\r\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\r\n    out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n    out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n    out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n    out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\r\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\r\n    out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n    out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n    out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n    out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\r\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\r\n    out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n    out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n    out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n    out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\r\nmat4.mul = mat4.multiply;\r\n\r\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\r\nmat4.translate = function (out, a, v) {\r\n    var x = v[0], y = v[1], z = v[2],\r\n        a00, a01, a02, a03,\r\n        a10, a11, a12, a13,\r\n        a20, a21, a22, a23;\r\n\r\n    if (a === out) {\r\n        out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\r\n        out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\r\n        out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\r\n        out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\r\n    } else {\r\n        a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\r\n        a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\r\n        a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\r\n\r\n        out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\r\n        out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\r\n        out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\r\n\r\n        out[12] = a00 * x + a10 * y + a20 * z + a[12];\r\n        out[13] = a01 * x + a11 * y + a21 * z + a[13];\r\n        out[14] = a02 * x + a12 * y + a22 * z + a[14];\r\n        out[15] = a03 * x + a13 * y + a23 * z + a[15];\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Scales the mat4 by the dimensions in the given vec3\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {vec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\r\nmat4.scale = function(out, a, v) {\r\n    var x = v[0], y = v[1], z = v[2];\r\n\r\n    out[0] = a[0] * x;\r\n    out[1] = a[1] * x;\r\n    out[2] = a[2] * x;\r\n    out[3] = a[3] * x;\r\n    out[4] = a[4] * y;\r\n    out[5] = a[5] * y;\r\n    out[6] = a[6] * y;\r\n    out[7] = a[7] * y;\r\n    out[8] = a[8] * z;\r\n    out[9] = a[9] * z;\r\n    out[10] = a[10] * z;\r\n    out[11] = a[11] * z;\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a mat4 by the given angle\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nmat4.rotate = function (out, a, rad, axis) {\r\n    var x = axis[0], y = axis[1], z = axis[2],\r\n        len = Math.sqrt(x * x + y * y + z * z),\r\n        s, c, t,\r\n        a00, a01, a02, a03,\r\n        a10, a11, a12, a13,\r\n        a20, a21, a22, a23,\r\n        b00, b01, b02,\r\n        b10, b11, b12,\r\n        b20, b21, b22;\r\n\r\n    if (Math.abs(len) < GLMAT_EPSILON) { return null; }\r\n    \r\n    len = 1 / len;\r\n    x *= len;\r\n    y *= len;\r\n    z *= len;\r\n\r\n    s = Math.sin(rad);\r\n    c = Math.cos(rad);\r\n    t = 1 - c;\r\n\r\n    a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\r\n    a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\r\n    a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\r\n\r\n    // Construct the elements of the rotation matrix\r\n    b00 = x * x * t + c; b01 = y * x * t + z * s; b02 = z * x * t - y * s;\r\n    b10 = x * y * t - z * s; b11 = y * y * t + c; b12 = z * y * t + x * s;\r\n    b20 = x * z * t + y * s; b21 = y * z * t - x * s; b22 = z * z * t + c;\r\n\r\n    // Perform rotation-specific matrix multiplication\r\n    out[0] = a00 * b00 + a10 * b01 + a20 * b02;\r\n    out[1] = a01 * b00 + a11 * b01 + a21 * b02;\r\n    out[2] = a02 * b00 + a12 * b01 + a22 * b02;\r\n    out[3] = a03 * b00 + a13 * b01 + a23 * b02;\r\n    out[4] = a00 * b10 + a10 * b11 + a20 * b12;\r\n    out[5] = a01 * b10 + a11 * b11 + a21 * b12;\r\n    out[6] = a02 * b10 + a12 * b11 + a22 * b12;\r\n    out[7] = a03 * b10 + a13 * b11 + a23 * b12;\r\n    out[8] = a00 * b20 + a10 * b21 + a20 * b22;\r\n    out[9] = a01 * b20 + a11 * b21 + a21 * b22;\r\n    out[10] = a02 * b20 + a12 * b21 + a22 * b22;\r\n    out[11] = a03 * b20 + a13 * b21 + a23 * b22;\r\n\r\n    if (a !== out) { // If the source and destination differ, copy the unchanged last row\r\n        out[12] = a[12];\r\n        out[13] = a[13];\r\n        out[14] = a[14];\r\n        out[15] = a[15];\r\n    }\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nmat4.rotateX = function (out, a, rad) {\r\n    var s = Math.sin(rad),\r\n        c = Math.cos(rad),\r\n        a10 = a[4],\r\n        a11 = a[5],\r\n        a12 = a[6],\r\n        a13 = a[7],\r\n        a20 = a[8],\r\n        a21 = a[9],\r\n        a22 = a[10],\r\n        a23 = a[11];\r\n\r\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\r\n        out[0]  = a[0];\r\n        out[1]  = a[1];\r\n        out[2]  = a[2];\r\n        out[3]  = a[3];\r\n        out[12] = a[12];\r\n        out[13] = a[13];\r\n        out[14] = a[14];\r\n        out[15] = a[15];\r\n    }\r\n\r\n    // Perform axis-specific matrix multiplication\r\n    out[4] = a10 * c + a20 * s;\r\n    out[5] = a11 * c + a21 * s;\r\n    out[6] = a12 * c + a22 * s;\r\n    out[7] = a13 * c + a23 * s;\r\n    out[8] = a20 * c - a10 * s;\r\n    out[9] = a21 * c - a11 * s;\r\n    out[10] = a22 * c - a12 * s;\r\n    out[11] = a23 * c - a13 * s;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nmat4.rotateY = function (out, a, rad) {\r\n    var s = Math.sin(rad),\r\n        c = Math.cos(rad),\r\n        a00 = a[0],\r\n        a01 = a[1],\r\n        a02 = a[2],\r\n        a03 = a[3],\r\n        a20 = a[8],\r\n        a21 = a[9],\r\n        a22 = a[10],\r\n        a23 = a[11];\r\n\r\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\r\n        out[4]  = a[4];\r\n        out[5]  = a[5];\r\n        out[6]  = a[6];\r\n        out[7]  = a[7];\r\n        out[12] = a[12];\r\n        out[13] = a[13];\r\n        out[14] = a[14];\r\n        out[15] = a[15];\r\n    }\r\n\r\n    // Perform axis-specific matrix multiplication\r\n    out[0] = a00 * c - a20 * s;\r\n    out[1] = a01 * c - a21 * s;\r\n    out[2] = a02 * c - a22 * s;\r\n    out[3] = a03 * c - a23 * s;\r\n    out[8] = a00 * s + a20 * c;\r\n    out[9] = a01 * s + a21 * c;\r\n    out[10] = a02 * s + a22 * c;\r\n    out[11] = a03 * s + a23 * c;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nmat4.rotateZ = function (out, a, rad) {\r\n    var s = Math.sin(rad),\r\n        c = Math.cos(rad),\r\n        a00 = a[0],\r\n        a01 = a[1],\r\n        a02 = a[2],\r\n        a03 = a[3],\r\n        a10 = a[4],\r\n        a11 = a[5],\r\n        a12 = a[6],\r\n        a13 = a[7];\r\n\r\n    if (a !== out) { // If the source and destination differ, copy the unchanged last row\r\n        out[8]  = a[8];\r\n        out[9]  = a[9];\r\n        out[10] = a[10];\r\n        out[11] = a[11];\r\n        out[12] = a[12];\r\n        out[13] = a[13];\r\n        out[14] = a[14];\r\n        out[15] = a[15];\r\n    }\r\n\r\n    // Perform axis-specific matrix multiplication\r\n    out[0] = a00 * c + a10 * s;\r\n    out[1] = a01 * c + a11 * s;\r\n    out[2] = a02 * c + a12 * s;\r\n    out[3] = a03 * c + a13 * s;\r\n    out[4] = a10 * c - a00 * s;\r\n    out[5] = a11 * c - a01 * s;\r\n    out[6] = a12 * c - a02 * s;\r\n    out[7] = a13 * c - a03 * s;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     var quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nmat4.fromRotationTranslation = function (out, q, v) {\r\n    // Quaternion math\r\n    var x = q[0], y = q[1], z = q[2], w = q[3],\r\n        x2 = x + x,\r\n        y2 = y + y,\r\n        z2 = z + z,\r\n\r\n        xx = x * x2,\r\n        xy = x * y2,\r\n        xz = x * z2,\r\n        yy = y * y2,\r\n        yz = y * z2,\r\n        zz = z * z2,\r\n        wx = w * x2,\r\n        wy = w * y2,\r\n        wz = w * z2;\r\n\r\n    out[0] = 1 - (yy + zz);\r\n    out[1] = xy + wz;\r\n    out[2] = xz - wy;\r\n    out[3] = 0;\r\n    out[4] = xy - wz;\r\n    out[5] = 1 - (xx + zz);\r\n    out[6] = yz + wx;\r\n    out[7] = 0;\r\n    out[8] = xz + wy;\r\n    out[9] = yz - wx;\r\n    out[10] = 1 - (xx + yy);\r\n    out[11] = 0;\r\n    out[12] = v[0];\r\n    out[13] = v[1];\r\n    out[14] = v[2];\r\n    out[15] = 1;\r\n    \r\n    return out;\r\n};\r\n\r\nmat4.fromQuat = function (out, q) {\r\n    var x = q[0], y = q[1], z = q[2], w = q[3],\r\n        x2 = x + x,\r\n        y2 = y + y,\r\n        z2 = z + z,\r\n\r\n        xx = x * x2,\r\n        yx = y * x2,\r\n        yy = y * y2,\r\n        zx = z * x2,\r\n        zy = z * y2,\r\n        zz = z * z2,\r\n        wx = w * x2,\r\n        wy = w * y2,\r\n        wz = w * z2;\r\n\r\n    out[0] = 1 - yy - zz;\r\n    out[1] = yx + wz;\r\n    out[2] = zx - wy;\r\n    out[3] = 0;\r\n\r\n    out[4] = yx - wz;\r\n    out[5] = 1 - xx - zz;\r\n    out[6] = zy + wx;\r\n    out[7] = 0;\r\n\r\n    out[8] = zx + wy;\r\n    out[9] = zy - wx;\r\n    out[10] = 1 - xx - yy;\r\n    out[11] = 0;\r\n\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n    out[15] = 1;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nmat4.frustum = function (out, left, right, bottom, top, near, far) {\r\n    var rl = 1 / (right - left),\r\n        tb = 1 / (top - bottom),\r\n        nf = 1 / (near - far);\r\n    out[0] = (near * 2) * rl;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = (near * 2) * tb;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = (right + left) * rl;\r\n    out[9] = (top + bottom) * tb;\r\n    out[10] = (far + near) * nf;\r\n    out[11] = -1;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = (far * near * 2) * nf;\r\n    out[15] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nmat4.perspective = function (out, fovy, aspect, near, far) {\r\n    var f = 1.0 / Math.tan(fovy / 2),\r\n        nf = 1 / (near - far);\r\n    out[0] = f / aspect;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = f;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[10] = (far + near) * nf;\r\n    out[11] = -1;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = (2 * far * near) * nf;\r\n    out[15] = 0;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nmat4.ortho = function (out, left, right, bottom, top, near, far) {\r\n    var lr = 1 / (left - right),\r\n        bt = 1 / (bottom - top),\r\n        nf = 1 / (near - far);\r\n    out[0] = -2 * lr;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = -2 * bt;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[10] = 2 * nf;\r\n    out[11] = 0;\r\n    out[12] = (left + right) * lr;\r\n    out[13] = (top + bottom) * bt;\r\n    out[14] = (far + near) * nf;\r\n    out[15] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nmat4.lookAt = function (out, eye, center, up) {\r\n    var x0, x1, x2, y0, y1, y2, z0, z1, z2, len,\r\n        eyex = eye[0],\r\n        eyey = eye[1],\r\n        eyez = eye[2],\r\n        upx = up[0],\r\n        upy = up[1],\r\n        upz = up[2],\r\n        centerx = center[0],\r\n        centery = center[1],\r\n        centerz = center[2];\r\n\r\n    if (Math.abs(eyex - centerx) < GLMAT_EPSILON &&\r\n        Math.abs(eyey - centery) < GLMAT_EPSILON &&\r\n        Math.abs(eyez - centerz) < GLMAT_EPSILON) {\r\n        return mat4.identity(out);\r\n    }\r\n\r\n    z0 = eyex - centerx;\r\n    z1 = eyey - centery;\r\n    z2 = eyez - centerz;\r\n\r\n    len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\r\n    z0 *= len;\r\n    z1 *= len;\r\n    z2 *= len;\r\n\r\n    x0 = upy * z2 - upz * z1;\r\n    x1 = upz * z0 - upx * z2;\r\n    x2 = upx * z1 - upy * z0;\r\n    len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\r\n    if (!len) {\r\n        x0 = 0;\r\n        x1 = 0;\r\n        x2 = 0;\r\n    } else {\r\n        len = 1 / len;\r\n        x0 *= len;\r\n        x1 *= len;\r\n        x2 *= len;\r\n    }\r\n\r\n    y0 = z1 * x2 - z2 * x1;\r\n    y1 = z2 * x0 - z0 * x2;\r\n    y2 = z0 * x1 - z1 * x0;\r\n\r\n    len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\r\n    if (!len) {\r\n        y0 = 0;\r\n        y1 = 0;\r\n        y2 = 0;\r\n    } else {\r\n        len = 1 / len;\r\n        y0 *= len;\r\n        y1 *= len;\r\n        y2 *= len;\r\n    }\r\n\r\n    out[0] = x0;\r\n    out[1] = y0;\r\n    out[2] = z0;\r\n    out[3] = 0;\r\n    out[4] = x1;\r\n    out[5] = y1;\r\n    out[6] = z1;\r\n    out[7] = 0;\r\n    out[8] = x2;\r\n    out[9] = y2;\r\n    out[10] = z2;\r\n    out[11] = 0;\r\n    out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\r\n    out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\r\n    out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\r\n    out[15] = 1;\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {mat4} mat matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nmat4.str = function (a) {\r\n    return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' +\r\n                    a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' +\r\n                    a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + \r\n                    a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\r\n};\r\n\r\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {mat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nmat4.frob = function (a) {\r\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2) + Math.pow(a[9], 2) + Math.pow(a[10], 2) + Math.pow(a[11], 2) + Math.pow(a[12], 2) + Math.pow(a[13], 2) + Math.pow(a[14], 2) + Math.pow(a[15], 2) ))\r\n};\r\n\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.mat4 = mat4;\r\n}\r\n;\r\n/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\r\n\r\nRedistribution and use in source and binary forms, with or without modification,\r\nare permitted provided that the following conditions are met:\r\n\r\n  * Redistributions of source code must retain the above copyright notice, this\r\n    list of conditions and the following disclaimer.\r\n  * Redistributions in binary form must reproduce the above copyright notice,\r\n    this list of conditions and the following disclaimer in the documentation \r\n    and/or other materials provided with the distribution.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \r\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\r\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\r\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\r\n\r\n/**\r\n * @class Quaternion\r\n * @name quat\r\n */\r\n\r\nvar quat = {};\r\n\r\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\r\nquat.create = function() {\r\n    var out = new GLMAT_ARRAY_TYPE(4);\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {vec3} a the initial vector\r\n * @param {vec3} b the destination vector\r\n * @returns {quat} out\r\n */\r\nquat.rotationTo = (function() {\r\n    var tmpvec3 = vec3.create();\r\n    var xUnitVec3 = vec3.fromValues(1,0,0);\r\n    var yUnitVec3 = vec3.fromValues(0,1,0);\r\n\r\n    return function(out, a, b) {\r\n        var dot = vec3.dot(a, b);\r\n        if (dot < -0.999999) {\r\n            vec3.cross(tmpvec3, xUnitVec3, a);\r\n            if (vec3.length(tmpvec3) < 0.000001)\r\n                vec3.cross(tmpvec3, yUnitVec3, a);\r\n            vec3.normalize(tmpvec3, tmpvec3);\r\n            quat.setAxisAngle(out, tmpvec3, Math.PI);\r\n            return out;\r\n        } else if (dot > 0.999999) {\r\n            out[0] = 0;\r\n            out[1] = 0;\r\n            out[2] = 0;\r\n            out[3] = 1;\r\n            return out;\r\n        } else {\r\n            vec3.cross(tmpvec3, a, b);\r\n            out[0] = tmpvec3[0];\r\n            out[1] = tmpvec3[1];\r\n            out[2] = tmpvec3[2];\r\n            out[3] = 1 + dot;\r\n            return quat.normalize(out, out);\r\n        }\r\n    };\r\n})();\r\n\r\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {vec3} view  the vector representing the viewing direction\r\n * @param {vec3} right the vector representing the local \"right\" direction\r\n * @param {vec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\r\nquat.setAxes = (function() {\r\n    var matr = mat3.create();\r\n\r\n    return function(out, view, right, up) {\r\n        matr[0] = right[0];\r\n        matr[3] = right[1];\r\n        matr[6] = right[2];\r\n\r\n        matr[1] = up[0];\r\n        matr[4] = up[1];\r\n        matr[7] = up[2];\r\n\r\n        matr[2] = -view[0];\r\n        matr[5] = -view[1];\r\n        matr[8] = -view[2];\r\n\r\n        return quat.normalize(out, quat.fromMat3(out, matr));\r\n    };\r\n})();\r\n\r\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nquat.clone = vec4.clone;\r\n\r\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nquat.fromValues = vec4.fromValues;\r\n\r\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.copy = vec4.copy;\r\n\r\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.set = vec4.set;\r\n\r\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nquat.identity = function(out) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {vec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\r\nquat.setAxisAngle = function(out, axis, rad) {\r\n    rad = rad * 0.5;\r\n    var s = Math.sin(rad);\r\n    out[0] = s * axis[0];\r\n    out[1] = s * axis[1];\r\n    out[2] = s * axis[2];\r\n    out[3] = Math.cos(rad);\r\n    return out;\r\n};\r\n\r\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.add = vec4.add;\r\n\r\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n */\r\nquat.multiply = function(out, a, b) {\r\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n        bx = b[0], by = b[1], bz = b[2], bw = b[3];\r\n\r\n    out[0] = ax * bw + aw * bx + ay * bz - az * by;\r\n    out[1] = ay * bw + aw * by + az * bx - ax * bz;\r\n    out[2] = az * bw + aw * bz + ax * by - ay * bx;\r\n    out[3] = aw * bw - ax * bx - ay * by - az * bz;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\r\nquat.mul = quat.multiply;\r\n\r\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {quat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.scale = vec4.scale;\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nquat.rotateX = function (out, a, rad) {\r\n    rad *= 0.5; \r\n\r\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n        bx = Math.sin(rad), bw = Math.cos(rad);\r\n\r\n    out[0] = ax * bw + aw * bx;\r\n    out[1] = ay * bw + az * bx;\r\n    out[2] = az * bw - ay * bx;\r\n    out[3] = aw * bw - ax * bx;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nquat.rotateY = function (out, a, rad) {\r\n    rad *= 0.5; \r\n\r\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n        by = Math.sin(rad), bw = Math.cos(rad);\r\n\r\n    out[0] = ax * bw - az * by;\r\n    out[1] = ay * bw + aw * by;\r\n    out[2] = az * bw + ax * by;\r\n    out[3] = aw * bw - ay * by;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nquat.rotateZ = function (out, a, rad) {\r\n    rad *= 0.5; \r\n\r\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n        bz = Math.sin(rad), bw = Math.cos(rad);\r\n\r\n    out[0] = ax * bw + ay * bz;\r\n    out[1] = ay * bw - ax * bz;\r\n    out[2] = az * bw + aw * bz;\r\n    out[3] = aw * bw - az * bz;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\r\nquat.calculateW = function (out, a) {\r\n    var x = a[0], y = a[1], z = a[2];\r\n\r\n    out[0] = x;\r\n    out[1] = y;\r\n    out[2] = z;\r\n    out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\r\nquat.dot = vec4.dot;\r\n\r\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.lerp = vec4.lerp;\r\n\r\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount between the two inputs\r\n * @returns {quat} out\r\n */\r\nquat.slerp = function (out, a, b, t) {\r\n    // benchmarks:\r\n    //    http://jsperf.com/quaternion-slerp-implementations\r\n\r\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\r\n        bx = b[0], by = b[1], bz = b[2], bw = b[3];\r\n\r\n    var        omega, cosom, sinom, scale0, scale1;\r\n\r\n    // calc cosine\r\n    cosom = ax * bx + ay * by + az * bz + aw * bw;\r\n    // adjust signs (if necessary)\r\n    if ( cosom < 0.0 ) {\r\n        cosom = -cosom;\r\n        bx = - bx;\r\n        by = - by;\r\n        bz = - bz;\r\n        bw = - bw;\r\n    }\r\n    // calculate coefficients\r\n    if ( (1.0 - cosom) > 0.000001 ) {\r\n        // standard case (slerp)\r\n        omega  = Math.acos(cosom);\r\n        sinom  = Math.sin(omega);\r\n        scale0 = Math.sin((1.0 - t) * omega) / sinom;\r\n        scale1 = Math.sin(t * omega) / sinom;\r\n    } else {        \r\n        // \"from\" and \"to\" quaternions are very close \r\n        //  ... so we can do a linear interpolation\r\n        scale0 = 1.0 - t;\r\n        scale1 = t;\r\n    }\r\n    // calculate final values\r\n    out[0] = scale0 * ax + scale1 * bx;\r\n    out[1] = scale0 * ay + scale1 * by;\r\n    out[2] = scale0 * az + scale1 * bz;\r\n    out[3] = scale0 * aw + scale1 * bw;\r\n    \r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\r\nquat.invert = function(out, a) {\r\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\r\n        dot = a0*a0 + a1*a1 + a2*a2 + a3*a3,\r\n        invDot = dot ? 1.0/dot : 0;\r\n    \r\n    // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\r\n\r\n    out[0] = -a0*invDot;\r\n    out[1] = -a1*invDot;\r\n    out[2] = -a2*invDot;\r\n    out[3] = a3*invDot;\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\r\nquat.conjugate = function (out, a) {\r\n    out[0] = -a[0];\r\n    out[1] = -a[1];\r\n    out[2] = -a[2];\r\n    out[3] = a[3];\r\n    return out;\r\n};\r\n\r\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {quat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n * @function\r\n */\r\nquat.length = vec4.length;\r\n\r\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\r\nquat.len = quat.length;\r\n\r\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {quat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\r\nquat.squaredLength = vec4.squaredLength;\r\n\r\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\r\nquat.sqrLen = quat.squaredLength;\r\n\r\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.normalize = vec4.normalize;\r\n\r\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {mat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\r\nquat.fromMat3 = function(out, m) {\r\n    // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\r\n    // article \"Quaternion Calculus and Fast Animation\".\r\n    var fTrace = m[0] + m[4] + m[8];\r\n    var fRoot;\r\n\r\n    if ( fTrace > 0.0 ) {\r\n        // |w| > 1/2, may as well choose w > 1/2\r\n        fRoot = Math.sqrt(fTrace + 1.0);  // 2w\r\n        out[3] = 0.5 * fRoot;\r\n        fRoot = 0.5/fRoot;  // 1/(4w)\r\n        out[0] = (m[5]-m[7])*fRoot;\r\n        out[1] = (m[6]-m[2])*fRoot;\r\n        out[2] = (m[1]-m[3])*fRoot;\r\n    } else {\r\n        // |w| <= 1/2\r\n        var i = 0;\r\n        if ( m[4] > m[0] )\r\n          i = 1;\r\n        if ( m[8] > m[i*3+i] )\r\n          i = 2;\r\n        var j = (i+1)%3;\r\n        var k = (i+2)%3;\r\n        \r\n        fRoot = Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k] + 1.0);\r\n        out[i] = 0.5 * fRoot;\r\n        fRoot = 0.5 / fRoot;\r\n        out[3] = (m[j*3+k] - m[k*3+j]) * fRoot;\r\n        out[j] = (m[j*3+i] + m[i*3+j]) * fRoot;\r\n        out[k] = (m[k*3+i] + m[i*3+k]) * fRoot;\r\n    }\r\n    \r\n    return out;\r\n};\r\n\r\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {quat} vec vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nquat.str = function (a) {\r\n    return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n};\r\n\r\nif(typeof(exports) !== 'undefined') {\r\n    exports.quat = quat;\r\n}\r\n;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  })(shim.exports);\r\n})(this);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./Libs/gl-matrix.js\n// module id = 11\n// module chunks = 0","/*\r\n * Copyright 2010, Google Inc.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are\r\n * met:\r\n *\r\n *     * Redistributions of source code must retain the above copyright\r\n * notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above\r\n * copyright notice, this list of conditions and the following disclaimer\r\n * in the documentation and/or other materials provided with the\r\n * distribution.\r\n *     * Neither the name of Google Inc. nor the names of its\r\n * contributors may be used to endorse or promote products derived from\r\n * this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\n\r\n/**\r\n * @fileoverview This file contains functions every webgl program will need\r\n * a version of one way or another.\r\n *\r\n * Instead of setting up a context manually it is recommended to\r\n * use. This will check for success or failure. On failure it\r\n * will attempt to present an approriate message to the user.\r\n *\r\n *       gl = WebGLUtils.setupWebGL(canvas);\r\n *\r\n * For animated WebGL apps use of setTimeout or setInterval are\r\n * discouraged. It is recommended you structure your rendering\r\n * loop like this.\r\n *\r\n *       function render() {\r\n *         window.requestAnimFrame(render, canvas);\r\n *\r\n *         // do rendering\r\n *         ...\r\n *       }\r\n *       render();\r\n *\r\n * This will call your rendering function up to the refresh rate\r\n * of your display but will stop rendering if your app is not\r\n * visible.\r\n */\r\n\r\nWebGLUtils = function() {\r\n\r\n/**\r\n * Creates the HTLM for a failure message\r\n * @param {string} canvasContainerId id of container of th\r\n *        canvas.\r\n * @return {string} The html.\r\n */\r\nvar makeFailHTML = function(msg) {\r\n  return '' +\r\n    '<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>' +\r\n    '<td align=\"center\">' +\r\n    '<div style=\"display: table-cell; vertical-align: middle;\">' +\r\n    '<div style=\"\">' + msg + '</div>' +\r\n    '</div>' +\r\n    '</td></tr></table>';\r\n};\r\n\r\n/**\r\n * Mesasge for getting a webgl browser\r\n * @type {string}\r\n */\r\nvar GET_A_WEBGL_BROWSER = '' +\r\n  'This page requires a browser that supports WebGL.<br/>' +\r\n  '<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>';\r\n\r\n/**\r\n * Mesasge for need better hardware\r\n * @type {string}\r\n */\r\nvar OTHER_PROBLEM = '' +\r\n  \"It doesn't appear your computer can support WebGL.<br/>\" +\r\n  '<a href=\"http://get.webgl.org/troubleshooting/\">Click here for more information.</a>';\r\n\r\n/**\r\n * Creates a webgl context. If creation fails it will\r\n * change the contents of the container of the <canvas>\r\n * tag to an error message with the correct links for WebGL.\r\n * @param {Element} canvas. The canvas element to create a\r\n *     context from.\r\n * @param {WebGLContextCreationAttirbutes} opt_attribs Any\r\n *     creation attributes you want to pass in.\r\n * @param {function:(msg)} opt_onError An function to call\r\n *     if there is an error during creation.\r\n * @return {WebGLRenderingContext} The created context.\r\n */\r\nvar setupWebGL = function(canvas, opt_attribs, opt_onError) {\r\n  function handleCreationError(msg) {\r\n    var container = canvas.parentNode;\r\n    if (container) {\r\n      var str = window.WebGLRenderingContext ?\r\n           OTHER_PROBLEM :\r\n           GET_A_WEBGL_BROWSER;\r\n      if (msg) {\r\n        str += \"<br/><br/>Status: \" + msg;\r\n      }\r\n      container.innerHTML = makeFailHTML(str);\r\n    }\r\n  };\r\n\r\n  opt_onError = opt_onError || handleCreationError;\r\n\r\n  if (canvas.addEventListener) {\r\n    canvas.addEventListener(\"webglcontextcreationerror\", function(event) {\r\n          opt_onError(event.statusMessage);\r\n        }, false);\r\n  }\r\n  var context = create3DContext(canvas, opt_attribs);\r\n  if (!context) {\r\n    if (!window.WebGLRenderingContext) {\r\n      opt_onError(\"\");\r\n    }\r\n  }\r\n  return context;\r\n};\r\n\r\n/**\r\n * Creates a webgl context.\r\n * @param {!Canvas} canvas The canvas tag to get context\r\n *     from. If one is not passed in one will be created.\r\n * @return {!WebGLContext} The created context.\r\n */\r\nvar create3DContext = function(canvas, opt_attribs) {\r\n  var names = [\"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n  var context = null;\r\n  for (var ii = 0; ii < names.length; ++ii) {\r\n    try {\r\n      context = canvas.getContext(names[ii], opt_attribs);\r\n    } catch(e) {}\r\n    if (context) {\r\n      break;\r\n    }\r\n  }\r\n  return context;\r\n}\r\n\r\nreturn {\r\n  create3DContext: create3DContext,\r\n  setupWebGL: setupWebGL\r\n};\r\n}();\r\n\r\n/**\r\n * Provides requestAnimationFrame in a cross browser way.\r\n */\r\nwindow.requestAnimFrame = (function() {\r\n  return window.requestAnimationFrame ||\r\n         window.webkitRequestAnimationFrame ||\r\n         window.mozRequestAnimationFrame ||\r\n         window.oRequestAnimationFrame ||\r\n         window.msRequestAnimationFrame ||\r\n         function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {\r\n           window.setTimeout(callback, 1000/60);\r\n         };\r\n})();\r\n\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./Libs/webgl-utils.js\n// module id = 12\n// module chunks = 0","/*\r\n* This file has been generated by spacker.exe utility. Do not change this file manualy as your changes\r\n* will get lost when the file is regenerated. Original content is located in *.c files.\r\n*/\r\nexport var xCubeShaders = {\r\n\tcube_fshader: ' precision mediump float; uniform float uAlpha; uniform sampler2D uTexture; uniform bool uColorCoding; uniform float uHighlighting; varying vec2 vTexCoord; varying vec4 vIdColor; void main(void) { if (uColorCoding) { gl_FragColor = vIdColor; } else { vec4 pixel = texture2D(uTexture, vTexCoord); if (vIdColor.x < 0.0) { gl_FragColor = vec4(pixel.rgb * uHighlighting, uAlpha); } else { gl_FragColor = vec4(pixel.rgb, uAlpha); } } }',\r\n\tcube_vshader: ' attribute highp vec3 aVertex; attribute highp vec2 aTexCoord; attribute highp float aId; uniform mat3 uRotation; uniform mat4 uPMatrix; uniform bool uColorCoding; uniform float uSelection; varying vec2 vTexCoord; varying vec4 vIdColor; vec4 getIdColor(float id){ float product = floor(id + 0.5); float B = floor(product / (256.0*256.0)); float G = floor((product - B * 256.0*256.0) / 256.0); float R = mod(product, 256.0); return vec4(R / 255.0, G / 255.0, B / 255.0, 1.0); } void main(void) { vec4 point = vec4(uRotation * aVertex, 1.0); gl_Position = uPMatrix * point; vTexCoord = aTexCoord; if (uColorCoding) { vIdColor = getIdColor(aId); return; } bool isSelected = abs(uSelection - aId) < 0.1; if (isSelected){ vIdColor = vec4(-1.0, -1.0, -1.0, -1.0); } else{ vIdColor = vec4(1.0, 1.0, 1.0, 1.0); } }'\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Plugins/NavigationCube/xbim-navigation-cube-shaders.ts","export var xCubeTextures = {\r\n    en: 'data:image/png;base64,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',\r\n}\n\n\n// WEBPACK FOOTER //\n// ./Plugins/NavigationCube/xbim-navigation-cube-textures.ts","import { xViewer } from '../../Viewer/xbim-viewer';\r\nimport { xCubeTextures } from './xbim-navigation-cube-textures';\r\nimport { xCubeShaders } from './xbim-navigation-cube-shaders';\r\nvar glMatrix = require('../../Libs/gl-matrix');\r\n\r\nexport class xNavigationCube {\r\n\r\n    /**\r\n     * This is constructor of the Navigation Cube plugin for {@link xViewer xBIM Viewer}. It gets optional Image as an argument.\r\n     * The image will be used as a texture of the navigation cube. If you don't specify eny image default one will be used.\r\n     * Image has to be square and its size has to be power of 2. \r\n     * @name xNavigationCube\r\n     * @constructor\r\n     * @classdesc This is a plugin for xViewer which renders interactive navigation cube. It is customizable in terms of alpha \r\n     * behaviour and its position on the viewer canvas. Use of plugin:\r\n     *  \r\n     *     var cube = new xNavigationCube();\r\n     *     viewer.addPlugin(cube);\r\n     * \r\n     * You can specify your own texture of the cube as an [Image](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/Image)\r\n     * object argumen in constructor. If you don't specify any image default texture will be used (you can also use this one and enhance it if you want):\r\n     * \r\n     * ![Cube texture](cube_texture.png) \r\n     *\r\n     * @param {Image} [image = null] - optional image to be used for a cube texture.\r\n    */\r\n    constructor(image?) {\r\n        this._image = image;\r\n    }\r\n\r\n    private _image: any;\r\n    private TOP = 1600000;\r\n    private BOTTOM = 1600001;\r\n    private LEFT = 1600002;\r\n    private RIGHT = 1600003;\r\n    private FRONT = 1600004;\r\n    private BACK = 1600005;\r\n\r\n    private TOP_LEFT_FRONT = 1600006;\r\n    private TOP_RIGHT_FRONT = 1600007;\r\n    private TOP_LEFT_BACK = 1600008;\r\n    private TOP_RIGHT_BACK = 1600009;\r\n    private BOTTOM_LEFT_FRONT = 1600010;\r\n    private BOTTOM_RIGHT_FRONT = 1600011;\r\n    private BOTTOM_LEFT_BACK = 1600012;\r\n    private BOTTOM_RIGHT_BACK = 1600013;\r\n\r\n    private TOP_LEFT = 1600014;\r\n    private TOP_RIGHT = 1600015;\r\n    private TOP_FRONT = 1600016;\r\n    private TOP_BACK = 1600017;\r\n    private BOTTOM_LEFT = 1600018;\r\n    private BOTTOM_RIGHT = 1600019;\r\n    private BOTTOM_FRONT = 1600020;\r\n    private BOTTOM_BACK = 1600021;\r\n\r\n    private FRONT_RIGHT = 1600022;\r\n    private FRONT_LEFT = 1600023;\r\n    private BACK_RIGHT = 1600024;\r\n    private BACK_LEFT = 1600025;\r\n\r\n    private _initialized: boolean = false;\r\n\r\n    /**\r\n    * Size of the cube relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.15. \r\n    * @member {Number} xNavigationCube#ratio\r\n    */\r\n    private ratio = 0.15;\r\n    /**\r\n    * Active parts of the navigation cube are highlighted so that user can recognize which part is active. \r\n    * This should be a positive number between [0,2]. If the value is less than 1 active area is darker.\r\n    * If the value is greater than 1 active area is lighter. Default value is 1.2. \r\n    * @member {Number} xNavigationCube#highlighting\r\n    */\r\n    private highlighting = 1.2;\r\n\r\n    /**\r\n    * Navigation cube has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n    * This is for the hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent \r\n    * when user hovers over. Default value is 1.0. \r\n    * @member {Number} xNavigationCube#activeAlpha\r\n    */\r\n    private activeAlpha = 1.0;\r\n\r\n    /**\r\n    * Navigation cube has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n    * This is for the non-hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent \r\n    * when user is not hovering over. Default value is 0.3. \r\n    * @member {Number} xNavigationCube#passiveAlpha\r\n    */\r\n    private passiveAlpha = 0.3;\r\n\r\n    /**\r\n    * It is possible to place navigation cube to any of the corners of the canvas using this property. Default value is cube.BOTTOM_RIGHT. \r\n    * Allowed values are cube.BOTTOM_RIGHT, cube.BOTTOM_LEFT, cube.TOP_RIGHT and cube.TOP_LEFT.\r\n    * @member {Enum} xNavigationCube#position\r\n    */\r\n    private position = this.BOTTOM_RIGHT;\r\n\r\n    private viewer: xViewer;\r\n    private _shader: any;\r\n    private _alpha: number;\r\n    private _selection: number;\r\n\r\n    private _pMatrixUniformPointer: any;\r\n    private _rotationUniformPointer: any;\r\n    private _colourCodingUniformPointer: any;\r\n    private _alphaUniformPointer: any;\r\n    private _selectionUniformPointer: any;\r\n    private _textureUniformPointer: any;\r\n    private _highlightingUniformPointer: any;\r\n\r\n    private _vertexAttrPointer: any;\r\n    private _texCoordAttrPointer: any;\r\n    private _idAttrPointer: any;\r\n\r\n    private _indexBuffer: any;\r\n    private _vertexBuffer: any;\r\n    private _texCoordBuffer: any;\r\n    private _idBuffer: any;\r\n\r\n    private _texture: any;\r\n\r\n    private _drag: boolean;\r\n\r\n    private _originalNavigation: any;\r\n\r\n    public init(xviewer) {\r\n        var self = this;\r\n        this.viewer = xviewer;\r\n        var gl = this.viewer._gl;\r\n\r\n        //create own shader \r\n        this._shader = null;\r\n        this._initShader();\r\n\r\n        this._alpha = this.passiveAlpha;\r\n        this._selection = 0.0;\r\n\r\n        //set own shader for init\r\n        gl.useProgram(this._shader);\r\n\r\n        //create uniform and attribute pointers\r\n        this._pMatrixUniformPointer = gl.getUniformLocation(this._shader, \"uPMatrix\");\r\n        this._rotationUniformPointer = gl.getUniformLocation(this._shader, \"uRotation\");\r\n        this._colourCodingUniformPointer = gl.getUniformLocation(this._shader, \"uColorCoding\");\r\n        this._alphaUniformPointer = gl.getUniformLocation(this._shader, \"uAlpha\");\r\n        this._selectionUniformPointer = gl.getUniformLocation(this._shader, \"uSelection\");\r\n        this._textureUniformPointer = gl.getUniformLocation(this._shader, \"uTexture\");\r\n        this._highlightingUniformPointer = gl.getUniformLocation(this._shader, \"uHighlighting\");\r\n\r\n        this._vertexAttrPointer = gl.getAttribLocation(this._shader, \"aVertex\"),\r\n            this._texCoordAttrPointer = gl.getAttribLocation(this._shader, \"aTexCoord\"),\r\n            this._idAttrPointer = gl.getAttribLocation(this._shader, \"aId\"),\r\n            gl.enableVertexAttribArray(this._vertexAttrPointer);\r\n        gl.enableVertexAttribArray(this._texCoordAttrPointer);\r\n        gl.enableVertexAttribArray(this._idAttrPointer);\r\n\r\n        //feed data into the GPU and keep pointers\r\n        this._indexBuffer = gl.createBuffer();\r\n        this._vertexBuffer = gl.createBuffer();\r\n        this._texCoordBuffer = gl.createBuffer();\r\n        this._idBuffer = gl.createBuffer();\r\n\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indices, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.vertices, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._texCoordBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.txtCoords, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._idBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.ids(), gl.STATIC_DRAW);\r\n\r\n        //create texture\r\n        var self = this;\r\n        this._texture = gl.createTexture();\r\n        if (typeof (this._image) === \"undefined\") {\r\n            //add HTML UI to viewer port\r\n            var data = xCubeTextures.en;\r\n            var image = new Image();\r\n            self._image = image;\r\n            image.addEventListener(\"load\",\r\n                function() {\r\n                    //load image texture into GPU\r\n                    gl.bindTexture(gl.TEXTURE_2D, self._texture);\r\n                    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n                    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, self._image);\r\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n                    gl.generateMipmap(gl.TEXTURE_2D);\r\n                });\r\n            image.src = data;\r\n        } else {\r\n            //load image texture into GPU\r\n            gl.bindTexture(gl.TEXTURE_2D, self._texture);\r\n            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, self._image);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n        }\r\n\r\n\r\n        //reset original shader program \r\n        gl.useProgram(this.viewer._shaderProgram);\r\n\r\n        xviewer._canvas.addEventListener('mousemove',\r\n            function(event) {\r\n                var startX = event.clientX;\r\n                var startY = event.clientY;\r\n\r\n                //get coordinates within canvas (with the right orientation)\r\n                var r = xviewer._canvas.getBoundingClientRect();\r\n                var viewX = startX - r.left;\r\n                var viewY = xviewer._height - (startY - r.top);\r\n\r\n                //this is for picking\r\n                var id = xviewer._getID(viewX, viewY);\r\n\r\n                if (id >= self.TOP && id <= self.BACK_LEFT) {\r\n                    self._alpha = self.activeAlpha;\r\n                    self._selection = id;\r\n                } else {\r\n                    self._alpha = self.passiveAlpha;\r\n                    self._selection = 0;\r\n                }\r\n            },\r\n            true);\r\n\r\n        self._drag = false;\r\n\r\n        xviewer._canvas.addEventListener('mousedown',\r\n            function(event) {\r\n                var startX = event.clientX;\r\n                var startY = event.clientY;\r\n\r\n                //get coordinates within canvas (with the right orientation)\r\n                var r = xviewer._canvas.getBoundingClientRect();\r\n                var viewX = startX - r.left;\r\n                var viewY = xviewer._height - (startY - r.top);\r\n\r\n                //this is for picking\r\n                var id = xviewer._getID(viewX, viewY);\r\n\r\n                if (id >= self.TOP && id <= self.BACK_LEFT) {\r\n                    //change viewer navigation mode to be 'orbit'\r\n                    self._drag = true;\r\n                    self._originalNavigation = xviewer.navigationMode;\r\n                    xviewer.navigationMode = \"orbit\";\r\n                }\r\n            },\r\n            true);\r\n\r\n        window.addEventListener('mouseup',\r\n            function(event) {\r\n                if (self._drag === true) {\r\n                    xviewer.navigationMode = self._originalNavigation;\r\n                }\r\n                self._drag = false;\r\n            },\r\n            true);\r\n\r\n        this._initialized = true;\r\n\r\n    }\r\n\r\n    onBeforeDraw() {}\r\n\r\n    onBeforePick(id) {\r\n        if (id >= this.TOP && id <= this.BACK_LEFT) {\r\n\r\n            var dir = glMatrix.vec3.create();\r\n            var distance = this.viewer._distance;\r\n            var diagonalRatio = 1.3;\r\n\r\n            switch (id) {\r\n            case this.TOP:\r\n                this.viewer.show('top');\r\n                return true;\r\n            case this.BOTTOM:\r\n                this.viewer.show('bottom');\r\n                return true;\r\n            case this.LEFT:\r\n                this.viewer.show('left');\r\n                return true;\r\n            case this.RIGHT:\r\n                this.viewer.show('right');\r\n                return true;\r\n            case this.FRONT:\r\n                this.viewer.show('front');\r\n                return true;\r\n            case this.BACK:\r\n                this.viewer.show('back');\r\n                return true;\r\n            case this.TOP_LEFT_FRONT:\r\n                dir = glMatrix.vec3.fromValues(-1, -1, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_RIGHT_FRONT:\r\n                dir = glMatrix.vec3.fromValues(1, -1, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_LEFT_BACK:\r\n                dir = glMatrix.vec3.fromValues(-1, 1, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_RIGHT_BACK:\r\n                dir = glMatrix.vec3.fromValues(1, 1, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_LEFT_FRONT:\r\n                dir = glMatrix.vec3.fromValues(-1, -1, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_RIGHT_FRONT:\r\n                dir = glMatrix.vec3.fromValues(1, -1, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_LEFT_BACK:\r\n                dir = glMatrix.vec3.fromValues(-1, 1, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_RIGHT_BACK:\r\n                dir = glMatrix.vec3.fromValues(1, 1, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_LEFT:\r\n                dir = glMatrix.vec3.fromValues(-1, 0, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_RIGHT:\r\n                dir = glMatrix.vec3.fromValues(1, 0, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_FRONT:\r\n                dir = glMatrix.vec3.fromValues(0, -1, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.TOP_BACK:\r\n                dir = glMatrix.vec3.fromValues(0, 1, 1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_LEFT:\r\n                dir = glMatrix.vec3.fromValues(-1, 0, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_RIGHT:\r\n                dir = glMatrix.vec3.fromValues(1, 0, -1);\r\n                break;\r\n            case this.BOTTOM_FRONT:\r\n                dir = glMatrix.vec3.fromValues(0, -1, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BOTTOM_BACK:\r\n                dir = glMatrix.vec3.fromValues(0, 1, -1);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.FRONT_RIGHT:\r\n                dir = glMatrix.vec3.fromValues(1, -1, 0);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.FRONT_LEFT:\r\n                dir = glMatrix.vec3.fromValues(-1, -1, 0);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BACK_RIGHT:\r\n                dir = glMatrix.vec3.fromValues(1, 1, 0);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            case this.BACK_LEFT:\r\n                dir = glMatrix.vec3.fromValues(-1, 1, 0);\r\n                distance *= diagonalRatio;\r\n                break;\r\n            default:\r\n                break;\r\n            }\r\n\r\n            var o = this.viewer._origin;\r\n            var heading = glMatrix.vec3.fromValues(0, 0, 1);\r\n            var origin = glMatrix.vec3.fromValues(o[0], o[1], o[2]);\r\n\r\n            dir = glMatrix.vec3.normalize(glMatrix.vec3.create(), dir);\r\n            var shift = glMatrix.vec3.scale(glMatrix.vec3.create(), dir, distance);\r\n            var camera = glMatrix.vec3.add(glMatrix.vec3.create(), origin, shift);\r\n\r\n            //use look-at function to set up camera and target\r\n            glMatrix.mat4.lookAt(this.viewer._mvMatrix, camera, origin, heading);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onAfterDraw() {\r\n        var gl = this.setActive();\r\n        //set uniform for colour coding to false\r\n        gl.uniform1i(this._colourCodingUniformPointer, 0);\r\n        this.draw();\r\n        this.setInactive();\r\n    }\r\n\r\n    onBeforeDrawId() {}\r\n\r\n    onAfterDrawId() {\r\n        var gl = this.setActive();\r\n        //set uniform for colour coding to false\r\n        gl.uniform1i(this._colourCodingUniformPointer, 1);\r\n        this.draw();\r\n        this.setInactive();\r\n    }\r\n\r\n    onBeforeGetId(id) {}\r\n\r\n    setActive() {\r\n        var gl = this.viewer._gl;\r\n        //set own shader\r\n        gl.useProgram(this._shader);\r\n\r\n        return gl;\r\n    }\r\n\r\n    setInactive() {\r\n        var gl = this.viewer._gl;\r\n        //set viewer shader\r\n        gl.useProgram(this.viewer._shaderProgram);\r\n    }\r\n\r\n    draw() {\r\n        if (!this._initialized) return;\r\n\r\n        var gl = this.viewer._gl;\r\n\r\n        //set navigation data from xViewer to this shader\r\n        var pMatrix = glMatrix.mat4.create();\r\n        var height = 1.0 / this.ratio;\r\n        var width = height / this.viewer._height * this.viewer._width;\r\n\r\n        //create orthogonal projection matrix\r\n        switch (this.position) {\r\n        case this.BOTTOM_RIGHT:\r\n            glMatrix.mat4.ortho(pMatrix,\r\n                (this.ratio - 1.0) * width, //left\r\n                this.ratio * width, //right\r\n                this.ratio * -1.0 * height, //bottom\r\n                (1.0 - this.ratio) * height, //top\r\n                -1, //near\r\n                1); //far\r\n            break;\r\n        case this.BOTTOM_LEFT:\r\n            glMatrix.mat4.ortho(pMatrix,\r\n                -1.0 * this.ratio * width, //left\r\n                (1.0 - this.ratio) * width, //right\r\n                this.ratio * -1.0 * height, //bottom\r\n                (1.0 - this.ratio) * height, //top\r\n                -1, //near\r\n                1); //far\r\n            break;\r\n        case this.TOP_LEFT:\r\n            glMatrix.mat4.ortho(pMatrix,\r\n                -1.0 * this.ratio * width, //left\r\n                (1.0 - this.ratio) * width, //right\r\n                (this.ratio - 1.0) * height, //bottom\r\n                this.ratio * height, //top\r\n                -1, //near\r\n                1); //far\r\n            break;\r\n        case this.TOP_RIGHT:\r\n            glMatrix.mat4.ortho(pMatrix,\r\n                (this.ratio - 1.0) * width, //left\r\n                this.ratio * width, //right\r\n                (this.ratio - 1.0) * height, //bottom\r\n                this.ratio * height, //top\r\n                -1, //near\r\n                1); //far\r\n            break;\r\n        default:\r\n        }\r\n\r\n        //extract just a rotation from model-view matrix\r\n        var rotation = glMatrix.mat3.fromMat4(glMatrix.mat3\r\n            .create(),\r\n            this.viewer._mvMatrix); // TODO Check -> fromMat4(mat3) -> Is this correct?\r\n        gl.uniformMatrix4fv(this._pMatrixUniformPointer, false, pMatrix);\r\n        gl.uniformMatrix3fv(this._rotationUniformPointer, false, rotation);\r\n        gl.uniform1f(this._alphaUniformPointer, this._alpha);\r\n        gl.uniform1f(this._highlightingUniformPointer, this.highlighting);\r\n        gl.uniform1f(this._selectionUniformPointer, this._selection);\r\n\r\n        //bind data buffers\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);\r\n        gl.vertexAttribPointer(this._vertexAttrPointer, 3, gl.FLOAT, false, 0, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._idBuffer);\r\n        gl.vertexAttribPointer(this._idAttrPointer, 1, gl.FLOAT, false, 0, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._texCoordBuffer);\r\n        gl.vertexAttribPointer(this._texCoordAttrPointer, 2, gl.FLOAT, false, 0, 0);\r\n\r\n        //bind texture\r\n        gl.activeTexture(gl.TEXTURE1);\r\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\r\n        gl.uniform1i(this._textureUniformPointer, 1);\r\n\r\n        var cfEnabled = gl.getParameter(gl.CULL_FACE);\r\n        if (!cfEnabled) gl.enable(gl.CULL_FACE);\r\n\r\n        //draw the cube as an element array\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);\r\n        gl.drawElements(gl.TRIANGLES, this.indices.length, gl.UNSIGNED_SHORT, 0);\r\n\r\n        if (!cfEnabled) gl.disable(gl.CULL_FACE);\r\n\r\n    }\r\n\r\n    _initShader() {\r\n\r\n        var gl = this.viewer._gl;\r\n        var viewer = this.viewer;\r\n        var compile = function(shader, code) {\r\n            gl.shaderSource(shader, code);\r\n            gl.compileShader(shader);\r\n            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n                viewer._error(gl.getShaderInfoLog(shader));\r\n                return null;\r\n            }\r\n        }\r\n\r\n        //fragment shader\r\n        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n        compile(fragmentShader, xCubeShaders.cube_fshader);\r\n\r\n        //vertex shader (the more complicated one)\r\n        var vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n        compile(vertexShader, xCubeShaders.cube_vshader);\r\n\r\n        //link program\r\n        this._shader = gl.createProgram();\r\n        gl.attachShader(this._shader, vertexShader);\r\n        gl.attachShader(this._shader, fragmentShader);\r\n        gl.linkProgram(this._shader);\r\n\r\n        if (!gl.getProgramParameter(this._shader, gl.LINK_STATUS)) {\r\n            viewer._error('Could not initialise shaders for a navigation cube plugin');\r\n        }\r\n    }\r\n\r\n\r\n    vertices = new Float32Array([\r\n        // Front face\r\n        -0.3, -0.5, -0.3,\r\n        0.3, -0.5, -0.3,\r\n        0.3, -0.5, 0.3,\r\n        -0.3, -0.5, 0.3,\r\n\r\n        // Back face\r\n        -0.3, 0.5, -0.3,\r\n        -0.3, 0.5, 0.3,\r\n        0.3, 0.5, 0.3,\r\n        0.3, 0.5, -0.3,\r\n\r\n\r\n        // Top face\r\n        -0.3, -0.3, 0.5,\r\n        0.3, -0.3, 0.5,\r\n        0.3, 0.3, 0.5,\r\n        -0.3, 0.3, 0.5,\r\n\r\n        // Bottom face\r\n        -0.3, -0.3, -0.5,\r\n        -0.3, 0.3, -0.5,\r\n        0.3, 0.3, -0.5,\r\n        0.3, -0.3, -0.5,\r\n\r\n        // Right face\r\n        0.5, -0.3, -0.3,\r\n        0.5, 0.3, -0.3,\r\n        0.5, 0.3, 0.3,\r\n        0.5, -0.3, 0.3,\r\n\r\n        // Left face\r\n        -0.5, -0.3, -0.3,\r\n        -0.5, -0.3, 0.3,\r\n        -0.5, 0.3, 0.3,\r\n        -0.5, 0.3, -0.3,\r\n\r\n        //top - left - front (--+)\r\n        -0.5, -0.5, 0.5,\r\n        -0.3, -0.5, 0.5,\r\n        -0.3, -0.3, 0.5,\r\n        -0.5, -0.3, 0.5,\r\n        -0.5, -0.5, 0.3,\r\n        -0.5, -0.5, 0.5,\r\n        -0.5, -0.3, 0.5,\r\n        -0.5, -0.3, 0.3,\r\n        -0.5, -0.5, 0.3,\r\n        -0.3, -0.5, 0.3,\r\n        -0.3, -0.5, 0.5,\r\n        -0.5, -0.5, 0.5,\r\n\r\n        //top-right-front (+-+)\r\n        0.3, -0.5, 0.5,\r\n        0.5, -0.5, 0.5,\r\n        0.5, -0.3, 0.5,\r\n        0.3, -0.3, 0.5,\r\n        0.5, -0.5, 0.3,\r\n        0.5, -0.3, 0.3,\r\n        0.5, -0.3, 0.5,\r\n        0.5, -0.5, 0.5,\r\n        0.3, -0.5, 0.3,\r\n        0.5, -0.5, 0.3,\r\n        0.5, -0.5, 0.5,\r\n        0.3, -0.5, 0.5,\r\n\r\n        //top-left-back (-++)\r\n        -0.5, 0.3, 0.5,\r\n        -0.3, 0.3, 0.5,\r\n        -0.3, 0.5, 0.5,\r\n        -0.5, 0.5, 0.5,\r\n        -0.5, 0.3, 0.3,\r\n        -0.5, 0.3, 0.5,\r\n        -0.5, 0.5, 0.5,\r\n        -0.5, 0.5, 0.3,\r\n        -0.5, 0.5, 0.3,\r\n        -0.5, 0.5, 0.5,\r\n        -0.3, 0.5, 0.5,\r\n        -0.3, 0.5, 0.3,\r\n\r\n        //top-right-back (+++)\r\n        0.3, 0.3, 0.5,\r\n        0.5, 0.3, 0.5,\r\n        0.5, 0.5, 0.5,\r\n        0.3, 0.5, 0.5,\r\n        0.5, 0.3, 0.3,\r\n        0.5, 0.5, 0.3,\r\n        0.5, 0.5, 0.5,\r\n        0.5, 0.3, 0.5,\r\n        0.3, 0.5, 0.3,\r\n        0.3, 0.5, 0.5,\r\n        0.5, 0.5, 0.5,\r\n        0.5, 0.5, 0.3,\r\n\r\n        //bottom - left - front (---)\r\n        -0.5, -0.5, -0.5,\r\n        -0.3, -0.5, -0.5,\r\n        -0.3, -0.3, -0.5,\r\n        -0.5, -0.3, -0.5,\r\n        -0.5, -0.5, -0.5,\r\n        -0.5, -0.5, -0.3,\r\n        -0.5, -0.3, -0.3,\r\n        -0.5, -0.3, -0.5,\r\n        -0.5, -0.5, -0.5,\r\n        -0.3, -0.5, -0.5,\r\n        -0.3, -0.5, -0.3,\r\n        -0.5, -0.5, -0.3,\r\n\r\n        //bottom-right-front (+--)\r\n        0.3, -0.5, -0.5,\r\n        0.5, -0.5, -0.5,\r\n        0.5, -0.3, -0.5,\r\n        0.3, -0.3, -0.5,\r\n        0.5, -0.5, -0.5,\r\n        0.5, -0.3, -0.5,\r\n        0.5, -0.3, -0.3,\r\n        0.5, -0.5, -0.3,\r\n        0.3, -0.5, -0.5,\r\n        0.5, -0.5, -0.5,\r\n        0.5, -0.5, -0.3,\r\n        0.3, -0.5, -0.3,\r\n\r\n        //bottom-left-back (-+-)\r\n        -0.5, 0.3, -0.5,\r\n        -0.3, 0.3, -0.5,\r\n        -0.3, 0.5, -0.5,\r\n        -0.5, 0.5, -0.5,\r\n        -0.5, 0.3, -0.5,\r\n        -0.5, 0.3, -0.3,\r\n        -0.5, 0.5, -0.3,\r\n        -0.5, 0.5, -0.5,\r\n        -0.5, 0.5, -0.5,\r\n        -0.5, 0.5, -0.3,\r\n        -0.3, 0.5, -0.3,\r\n        -0.3, 0.5, -0.5,\r\n\r\n        //bottom-right-back (++-)\r\n        0.3, 0.3, -0.5,\r\n        0.5, 0.3, -0.5,\r\n        0.5, 0.5, -0.5,\r\n        0.3, 0.5, -0.5,\r\n        0.5, 0.3, -0.5,\r\n        0.5, 0.5, -0.5,\r\n        0.5, 0.5, -0.3,\r\n        0.5, 0.3, -0.3,\r\n        0.3, 0.5, -0.5,\r\n        0.3, 0.5, -0.3,\r\n        0.5, 0.5, -0.3,\r\n        0.5, 0.5, -0.5,\r\n\r\n        //top-right (+0+)\r\n        0.3, -0.3, 0.5,\r\n        0.5, -0.3, 0.5,\r\n        0.5, 0.3, 0.5,\r\n        0.3, 0.3, 0.5,\r\n        0.5, -0.3, 0.3,\r\n        0.5, 0.3, 0.3,\r\n        0.5, 0.3, 0.5,\r\n        0.5, -0.3, 0.5,\r\n\r\n        //top-left (-0+)\r\n        -0.5, -0.3, 0.5,\r\n        -0.3, -0.3, 0.5,\r\n        -0.3, 0.3, 0.5,\r\n        -0.5, 0.3, 0.5,\r\n        -0.5, -0.3, 0.3,\r\n        -0.5, -0.3, 0.5,\r\n        -0.5, 0.3, 0.5,\r\n        -0.5, 0.3, 0.3,\r\n\r\n        //top-front (0-+)\r\n        -0.3, -0.5, 0.5,\r\n        0.3, -0.5, 0.5,\r\n        0.3, -0.3, 0.5,\r\n        -0.3, -0.3, 0.5,\r\n        -0.3, -0.5, 0.3,\r\n        0.3, -0.5, 0.3,\r\n        0.3, -0.5, 0.5,\r\n        -0.3, -0.5, 0.5,\r\n\r\n        //top-back (0++)\r\n        -0.3, 0.3, 0.5,\r\n        0.3, 0.3, 0.5,\r\n        0.3, 0.5, 0.5,\r\n        -0.3, 0.5, 0.5,\r\n        -0.3, 0.5, 0.3,\r\n        -0.3, 0.5, 0.5,\r\n        0.3, 0.5, 0.5,\r\n        0.3, 0.5, 0.3,\r\n\r\n        //bottom-right (+0-)\r\n        0.3, -0.3, -0.5,\r\n        0.5, -0.3, -0.5,\r\n        0.5, 0.3, -0.5,\r\n        0.3, 0.3, -0.5,\r\n        0.5, -0.3, -0.5,\r\n        0.5, 0.3, -0.5,\r\n        0.5, 0.3, -0.3,\r\n        0.5, -0.3, -0.3,\r\n\r\n        //bottom-left (-0-)\r\n        -0.5, -0.3, -0.5,\r\n        -0.5, 0.3, -0.5,\r\n        -0.3, 0.3, -0.5,\r\n        -0.3, -0.3, -0.5,\r\n        -0.5, -0.3, -0.5,\r\n        -0.5, -0.3, -0.3,\r\n        -0.5, 0.3, -0.3,\r\n        -0.5, 0.3, -0.5,\r\n\r\n        //bottom-front (0--)\r\n        -0.3, -0.5, -0.5,\r\n        0.3, -0.5, -0.5,\r\n        0.3, -0.3, -0.5,\r\n        -0.3, -0.3, -0.5,\r\n        -0.3, -0.5, -0.5,\r\n        0.3, -0.5, -0.5,\r\n        0.3, -0.5, -0.3,\r\n        -0.3, -0.5, -0.3,\r\n\r\n        //bottom-back (0+-)\r\n        -0.3, 0.3, -0.5,\r\n        0.3, 0.3, -0.5,\r\n        0.3, 0.5, -0.5,\r\n        -0.3, 0.5, -0.5,\r\n        -0.3, 0.5, -0.5,\r\n        -0.3, 0.5, -0.3,\r\n        0.3, 0.5, -0.3,\r\n        0.3, 0.5, -0.5,\r\n\r\n        //front-right (+-0)\r\n        0.3, -0.5, -0.3,\r\n        0.5, -0.5, -0.3,\r\n        0.5, -0.5, 0.3,\r\n        0.3, -0.5, 0.3,\r\n        0.5, -0.5, -0.3,\r\n        0.5, -0.3, -0.3,\r\n        0.5, -0.3, 0.3,\r\n        0.5, -0.5, 0.3,\r\n\r\n        //front-left (--0)\r\n        -0.5, -0.5, -0.3,\r\n        -0.3, -0.5, -0.3,\r\n        -0.3, -0.5, 0.3,\r\n        -0.5, -0.5, 0.3,\r\n        -0.5, -0.5, -0.3,\r\n        -0.5, -0.5, 0.3,\r\n        -0.5, -0.3, 0.3,\r\n        -0.5, -0.3, -0.3,\r\n\r\n        //back-right (++0)\r\n        0.3, 0.5, -0.3,\r\n        0.3, 0.5, 0.3,\r\n        0.5, 0.5, 0.3,\r\n        0.5, 0.5, -0.3,\r\n        0.5, 0.3, -0.3,\r\n        0.5, 0.5, -0.3,\r\n        0.5, 0.5, 0.3,\r\n        0.5, 0.3, 0.3,\r\n\r\n        //back-left (-+0)\r\n        -0.5, 0.5, -0.3,\r\n        -0.5, 0.5, 0.3,\r\n        -0.3, 0.5, 0.3,\r\n        -0.3, 0.5, -0.3,\r\n        -0.5, 0.3, -0.3,\r\n        -0.5, 0.3, 0.3,\r\n        -0.5, 0.5, 0.3,\r\n        -0.5, 0.5, -0.3,\r\n    ]);\r\n\r\n\r\n//// Front face\r\n//-0.5, -0.5, -0.5,\r\n// 0.5, -0.5, -0.5,\r\n// 0.5, -0.5, 0.5,\r\n//-0.5, -0.5, 0.5,\r\n//\r\n//// Back face\r\n//-0.5, 0.5, -0.5,\r\n//-0.5, 0.5, 0.5,\r\n// 0.5, 0.5, 0.5,\r\n// 0.5, 0.5, -0.5,\r\n//\r\n//// Top face\r\n//-0.5, -0.5, 0.5,\r\n// 0.5, -0.5, 0.5,\r\n// 0.5, 0.5, 0.5,\r\n//-0.5, 0.5, 0.5,\r\n//\r\n//// Bottom face\r\n//-0.5, -0.5, -0.5,\r\n//-0.5, 0.5, -0.5,\r\n// 0.5, 0.5, -0.5,\r\n// 0.5, -0.5, -0.5,\r\n//\r\n//// Right face\r\n// 0.5, -0.5, -0.5,\r\n// 0.5, 0.5, -0.5,\r\n// 0.5, 0.5, 0.5,\r\n// 0.5, -0.5, 0.5,\r\n//\r\n//// Left face\r\n//-0.5, -0.5, -0.5,\r\n//-0.5, -0.5, 0.5,\r\n//-0.5, 0.5, 0.5,\r\n//-0.5, 0.5, -0.5,\r\n\r\n    indices = new Uint16Array([\r\n        0, 1, 2, 0, 2, 3, // Front face\r\n        4, 5, 6, 4, 6, 7, // Back face\r\n        8, 9, 10, 8, 10, 11, // Top face\r\n        12, 13, 14, 12, 14, 15, // Bottom face\r\n        16, 17, 18, 16, 18, 19, // Right face\r\n        20, 21, 22, 20, 22, 23, // Left face\r\n\r\n        //top - left - front \r\n        0 + 24, 1 + 24, 2 + 24, 0 + 24, 2 + 24, 3 + 24,\r\n        4 + 24, 5 + 24, 6 + 24, 4 + 24, 6 + 24, 7 + 24,\r\n        8 + 24, 9 + 24, 10 + 24, 8 + 24, 10 + 24, 11 + 24,\r\n\r\n        //top-right-front \r\n        0 + 36, 1 + 36, 2 + 36, 0 + 36, 2 + 36, 3 + 36,\r\n        4 + 36, 5 + 36, 6 + 36, 4 + 36, 6 + 36, 7 + 36,\r\n        8 + 36, 9 + 36, 10 + 36, 8 + 36, 10 + 36, 11 + 36,\r\n\r\n        //top-left-back \r\n        0 + 48, 1 + 48, 2 + 48, 0 + 48, 2 + 48, 3 + 48,\r\n        4 + 48, 5 + 48, 6 + 48, 4 + 48, 6 + 48, 7 + 48,\r\n        8 + 48, 9 + 48, 10 + 48, 8 + 48, 10 + 48, 11 + 48,\r\n\r\n        //top-right-back\r\n        0 + 60, 1 + 60, 2 + 60, 0 + 60, 2 + 60, 3 + 60,\r\n        4 + 60, 5 + 60, 6 + 60, 4 + 60, 6 + 60, 7 + 60,\r\n        8 + 60, 9 + 60, 10 + 60, 8 + 60, 10 + 60, 11 + 60,\r\n\r\n        //bottom - left - front\r\n        0 + 72, 2 + 72, 1 + 72, 0 + 72, 3 + 72, 2 + 72,\r\n        4 + 72, 5 + 72, 6 + 72, 4 + 72, 6 + 72, 7 + 72,\r\n        8 + 72, 9 + 72, 10 + 72, 8 + 72, 10 + 72, 11 + 72,\r\n\r\n        //bottom-right-front \r\n        0 + 84, 2 + 84, 1 + 84, 0 + 84, 3 + 84, 2 + 84,\r\n        4 + 84, 5 + 84, 6 + 84, 4 + 84, 6 + 84, 7 + 84,\r\n        8 + 84, 9 + 84, 10 + 84, 8 + 84, 10 + 84, 11 + 84,\r\n\r\n        //bottom-left-back \r\n        0 + 96, 2 + 96, 1 + 96, 0 + 96, 3 + 96, 2 + 96,\r\n        4 + 96, 5 + 96, 6 + 96, 4 + 96, 6 + 96, 7 + 96,\r\n        8 + 96, 9 + 96, 10 + 96, 8 + 96, 10 + 96, 11 + 96,\r\n\r\n        //bottom-right-back\r\n        0 + 108, 2 + 108, 1 + 108, 0 + 108, 3 + 108, 2 + 108,\r\n        4 + 108, 5 + 108, 6 + 108, 4 + 108, 6 + 108, 7 + 108,\r\n        8 + 108, 9 + 108, 10 + 108, 8 + 108, 10 + 108, 11 + 108,\r\n\r\n        //top-right\r\n        0 + 120, 1 + 120, 2 + 120, 0 + 120, 2 + 120, 3 + 120,\r\n        4 + 120, 5 + 120, 6 + 120, 4 + 120, 6 + 120, 7 + 120,\r\n\r\n        //top-left\r\n        0 + 128, 1 + 128, 2 + 128, 0 + 128, 2 + 128, 3 + 128,\r\n        4 + 128, 5 + 128, 6 + 128, 4 + 128, 6 + 128, 7 + 128,\r\n\r\n        //top-front\r\n        0 + 136, 1 + 136, 2 + 136, 0 + 136, 2 + 136, 3 + 136,\r\n        4 + 136, 5 + 136, 6 + 136, 4 + 136, 6 + 136, 7 + 136,\r\n\r\n        //top-back\r\n        0 + 144, 1 + 144, 2 + 144, 0 + 144, 2 + 144, 3 + 144,\r\n        4 + 144, 5 + 144, 6 + 144, 4 + 144, 6 + 144, 7 + 144,\r\n\r\n        //bottom-right\r\n        0 + 152, 2 + 152, 1 + 152, 0 + 152, 3 + 152, 2 + 152,\r\n        4 + 152, 5 + 152, 6 + 152, 4 + 152, 6 + 152, 7 + 152,\r\n\r\n        //bottom-left\r\n        0 + 160, 1 + 160, 2 + 160, 0 + 160, 2 + 160, 3 + 160,\r\n        4 + 160, 5 + 160, 6 + 160, 4 + 160, 6 + 160, 7 + 160,\r\n\r\n        //bottom-front\r\n        0 + 168, 2 + 168, 1 + 168, 0 + 168, 3 + 168, 2 + 168,\r\n        4 + 168, 5 + 168, 6 + 168, 4 + 168, 6 + 168, 7 + 168,\r\n\r\n        //bottom-back\r\n        0 + 176, 2 + 176, 1 + 176, 0 + 176, 3 + 176, 2 + 176,\r\n        4 + 176, 5 + 176, 6 + 176, 4 + 176, 6 + 176, 7 + 176,\r\n\r\n        //front-right\r\n        0 + 184, 1 + 184, 2 + 184, 0 + 184, 2 + 184, 3 + 184,\r\n        4 + 184, 5 + 184, 6 + 184, 4 + 184, 6 + 184, 7 + 184,\r\n\r\n        //front-left\r\n        0 + 192, 1 + 192, 2 + 192, 0 + 192, 2 + 192, 3 + 192,\r\n        4 + 192, 5 + 192, 6 + 192, 4 + 192, 6 + 192, 7 + 192,\r\n\r\n        //back-right\r\n        0 + 200, 1 + 200, 2 + 200, 0 + 200, 2 + 200, 3 + 200,\r\n        4 + 200, 5 + 200, 6 + 200, 4 + 200, 6 + 200, 7 + 200,\r\n\r\n        //back-left\r\n        0 + 208, 1 + 208, 2 + 208, 0 + 208, 2 + 208, 3 + 208,\r\n        4 + 208, 5 + 208, 6 + 208, 4 + 208, 6 + 208, 7 + 208,\r\n    ]);\r\n\r\n//// Front face\r\n//1.0 / 3.0, 0.0 / 3.0,\r\n//2.0 / 3.0, 0.0 / 3.0,\r\n//2.0 / 3.0, 1.0 / 3.0,\r\n//1.0 / 3.0, 1.0 / 3.0,\r\n//\r\n//// Back face\r\n//1.0, 0.0 / 3.0,\r\n//1.0, 1.0 / 3.0,\r\n//2.0 / 3.0, 1.0 / 3.0,\r\n//2.0 / 3.0, 0.0 / 3.0,\r\n//\r\n//\r\n//// Top face\r\n//2.0 / 3.0, 1.0 / 3.0,\r\n//1.0, 1.0 / 3.0,\r\n//1.0, 2.0 / 3.0,\r\n//2.0 / 3.0, 2.0 / 3.0,\r\n//\r\n//// Bottom face\r\n//0.0, 1.0 / 3.0,\r\n//0.0, 0.0 / 3.0,\r\n//1.0 / 3.0, 0.0 / 3.0,\r\n//1.0 / 3.0, 1.0 / 3.0,\r\n//\r\n//// Right face\r\n//0.0, 1.0 / 3.0,\r\n//1.0 / 3.0, 1.0 / 3.0,\r\n//1.0 / 3.0, 2.0 / 3.0,\r\n//0.0, 2.0 / 3.0,\r\n//\r\n//// Left face\r\n//2.0 / 3.0, 1.0 / 3.0,\r\n//2.0 / 3.0, 2.0 / 3.0,\r\n//1.0 / 3.0, 2.0 / 3.0,\r\n//1.0 / 3.0, 1.0 / 3.0\r\n\r\n    txtCoords = new Float32Array([\r\n        // Front face\r\n        1.0 / 3.0 + 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n        2.0 / 3.0 - 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n        2.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n        1.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\r\n        // Back face\r\n        1.0 - 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 - 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n        2.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n        2.0 / 3.0 + 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n\r\n\r\n        // Top face\r\n        2.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 - 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 - 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n        2.0 / 3.0 + 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\r\n        // Bottom face\r\n        0.0 + 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n        0.0 + 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 / 3.0 - 1.0 / 15.0, 0.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 - 1.0 / 15.0,\r\n\r\n        // Right face\r\n        0.0 + 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n        1.0 / 3.0 - 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n        0.0 + 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n\r\n        // Left face\r\n        2.0 / 3.0 - 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n        2.0 / 3.0 - 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n        1.0 / 3.0 + 1.0 / 15.0, 2.0 / 3.0 - 1.0 / 15.0,\r\n        1.0 / 3.0 + 1.0 / 15.0, 1.0 / 3.0 + 1.0 / 15.0,\r\n\r\n        //top - left - front \r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //top-right-front \r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //top-left-back \r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //top-right-back \r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //bottom - left - front \r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //bottom-right-front \r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //bottom-left-back \r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //bottom-right-back \r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 1.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //top-right\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //top-left\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //top-front\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //top-back\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //bottom-right\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //bottom-left\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //bottom-front\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //bottom-back\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n\r\n        //front-right\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //front-left\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //back-right\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n\r\n        //back-left\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        2.0 / 3.0 + 2.0 / 30.0, 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n        1.0 / 3.0 + 2.0 / 30.0, 1.0 / 3.0 + 1.0 / 30.0,\r\n    ]);\r\n\r\n    ids() {\r\n        return new Float32Array([\r\n            this.FRONT, // Front face\r\n            this.FRONT,\r\n            this.FRONT,\r\n            this.FRONT,\r\n            this.BACK, // Back face\r\n            this.BACK,\r\n            this.BACK,\r\n            this.BACK,\r\n            this.TOP, // Top face\r\n            this.TOP,\r\n            this.TOP,\r\n            this.TOP,\r\n            this.BOTTOM, // Bottom face\r\n            this.BOTTOM,\r\n            this.BOTTOM,\r\n            this.BOTTOM,\r\n            this.RIGHT, // Right face\r\n            this.RIGHT,\r\n            this.RIGHT,\r\n            this.RIGHT,\r\n            this.LEFT, // Left face\r\n            this.LEFT,\r\n            this.LEFT,\r\n            this.LEFT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_LEFT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_RIGHT_FRONT,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_LEFT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.TOP_RIGHT_BACK,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_LEFT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_RIGHT_FRONT,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_LEFT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.BOTTOM_RIGHT_BACK,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_RIGHT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_LEFT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_FRONT,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.TOP_BACK,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_RIGHT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_LEFT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_FRONT,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.BOTTOM_BACK,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_RIGHT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.FRONT_LEFT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_RIGHT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n            this.BACK_LEFT,\r\n        ]);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Plugins/NavigationCube/xbim-navigation-cube.ts","export var xHomeTextures = {\r\n    en: 'data:image/png;base64,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SsR29L9i99nLfjBJ0+QW4Niu1q8u94GWHaMS8Uz6W/d7LHeMpKn0Bfpb/59fzoMs6wJ2iTgcuBVDJM2zPYBbhx4s2ZJjVCJOAD4JbLucAZJmwrbAJ4cuLMmSYlQi3gZcCKxa6hNLmjmrgAuHPizaoq4ZlYgNgQ8CY/k5A0kz40zg9K7WRxf6BxYcoxKxOf2tvLH9BKakmfJ3wAldrd9ayAcvKEYlYifgSmCsZ1MkzZx/AY7qav3v9X3geq8ZlYj96Q+7GiJJi3Ug/SHb/df3geuMUYl4Pv1h151HNEzS/NmZ/pDtOt/P7EljVCJeR/9Psy1GPEzS/NkCuHLoylo94ZrRcNj194GJvweupLnwHuC3fviQ7eNiVCJWAn8NNPntAJLmxgXAq7taH/q///H9GJWIbYDLgOe02SZpzqwBjutq/ToMMSoRu9Mfdt2r6TRJ8+Yu+kO298S/wmHA5cD2jUdJmk9fAY7ZCHiM6XtDtOcBv916hJTUu4HrW49YpMc26mr9+9YrFqtE7Nh6g5TYnV2tN7QesVgT//XWkrQ2xkhSCsZIUgrGSFIKxkhSCsZIUgrGSFIKxkhSCsZIUgrGSFIKxkhSChu1HpDdhltuCRGtZ0xcffRRHnvggZE/7garVxMbbjjyx02vVh69//7WK1IzRuux1333EStXtp4xcQ/ecQd3Hzj6Xwiz25o1rDrggJE/bnb1oYe4c5W/gHld/GeapBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFIyRpBSMkaQUjJGkFDZqPSC7r51xBrFiResZE/fIvfeO5XHvP/98vn3DDWN57Mzqww+3npBe1Fpbb1i0EnEScEHrHVJSJ3e1Xth6xGL5zzRJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKRgjSSkYI0kpGCNJKfwvQct8OdSrePoAAAAASUVORK5CYII='\r\n};\n\n\n// WEBPACK FOOTER //\n// ./Plugins/NavigationHome/xbim-navigation-home-textures.ts","import { xViewer } from '../../Viewer/xbim-viewer';\r\nimport { xHomeTextures } from './xbim-navigation-home-textures';\r\nvar glMatrix = require('../../Libs/gl-matrix');\r\n\r\nexport class xNavigationHome {\r\n\r\n    /**\r\n     * This is constructor of the Home plugin for {@link xViewer xBIM Viewer}. It gets optional Image object as an argument. If no image\r\n     * is specified there is a default one (which is not very prety). \r\n     * @name xNavigationHome\r\n     * @constructor\r\n     * @classdesc This is a plugin for xViewer which renders interactive home button. It is customizable in terms of alpha \r\n     * behaviour and its position on the viewer canvas as well as definition of the distance and view direction. Use of plugin:\r\n     *  \r\n     *     var home = new xNavigationHome();\r\n     *     viewer.addPlugin(home);\r\n     * \r\n     *\r\n     * @param {Image} [image = null] - optional image to be used for a button.\r\n    */\r\n    constructor(image: HTMLImageElement) {\r\n        //private variables\r\n        this._image = image;\r\n    }\r\n\r\n    private _image: HTMLImageElement;\r\n    private _viewer: xViewer;\r\n    /**\r\n    * Size of the the home button relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.2. \r\n    * @member {Number} xNavigationHome#ratio\r\n    */\r\n    public ratio: number = 0.2;\r\n    /**\r\n    * Position of the the home button relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.05. \r\n    * @member {Number} xNavigationHome#placementX\r\n    */\r\n    public placementX: number = 0.05;\r\n\r\n    /**\r\n    * Position of the the home button relative to the size of viewer canvas. This has to be a positive number between [0,1] Default value is 0.05. \r\n    * @member {Number} xNavigationHome#placementY\r\n    */\r\n    public placementY: number = 0.05;\r\n\r\n    /**\r\n    * Navigation home button has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n    * This is for the hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent \r\n    * when user hovers over. Default value is 1.0. \r\n    * @member {Number} xNavigationHome#activeAlpha\r\n    */\r\n    public activeAlpha: number = 1.0;\r\n\r\n    /**\r\n    * Navigation home button has two transparency states. One is when user hovers over the cube and the second when the cursor is anywhere else.\r\n    * This is for the non-hovering shate and it should be a positive number between [0,1]. If the value is less than 1 cube will be semitransparent \r\n    * when user is not hovering over. Default value is 0.3. \r\n    * @member {Number} xNavigationHome#passiveAlpha\r\n    */\r\n    public passiveAlpha: number = 0.3;\r\n\r\n    /**\r\n    * Distance to be used for a home view. If null, default viewer distance for a full extent mode is used. Default value: null\r\n    * @member {Number} xNavigationHome#distance\r\n    */\r\n    public distance: number = null;\r\n\r\n    /**\r\n    * View direction to be used for a home view. Default value: [1, 1, -1]\r\n    * @member {Number} xNavigationHome#viewDirection\r\n    */\r\n    public viewDirection: number[] = [1, 1, -1];\r\n\r\n    public init(xviewer: xViewer) {\r\n        this._viewer = xviewer;\r\n        var self = this;\r\n\r\n        if (typeof (this._image) === \"undefined\") {\r\n            //add HTML UI to viewer port\r\n            var data = xHomeTextures[\"en\"];\r\n\r\n            var image = new Image();\r\n            self._image = image;\r\n            image.addEventListener(\"load\",\r\n                function() {\r\n                    self._adjust();\r\n                });\r\n            image.src = data;\r\n        } else {\r\n            self._adjust();\r\n        }\r\n\r\n        //add image to document\r\n        document.documentElement.appendChild(this._image);\r\n\r\n        //add click event listener\r\n        self._image.addEventListener(\"click\",\r\n            function() {\r\n                var viewer = self._viewer;\r\n                //set target to full extent\r\n                viewer.setCameraTarget();\r\n                var origin = viewer._origin;\r\n                var distance = self.distance != null ? self.distance : viewer._distance;\r\n\r\n                var normDirection = glMatrix.vec3.normalize(glMatrix.vec3.create(), self.viewDirection);\r\n                var position = glMatrix.vec3.scale(glMatrix.vec3.create(), normDirection, -1.0 * distance);\r\n\r\n                viewer.setCameraPosition(position);\r\n            });\r\n\r\n        //set active state styling\r\n        self._image.addEventListener(\"mouseover\",\r\n            function() {\r\n                self._image.style.opacity = self.activeAlpha.toString(); //For real browsers;\r\n                self._image.style.filter = \"alpha(opacity=\" + Math.round(self.activeAlpha * 100.0) + \")\"; //For IE;\r\n            });\r\n\r\n        //set passive state styling\r\n        self._image.addEventListener(\"mouseleave\",\r\n            function () {\r\n                self._image.style.opacity = self.passiveAlpha.toString(); //For real browsers;\r\n                self._image.style.filter = \"alpha(opacity=\" + Math.round(self.passiveAlpha * 100.0) + \")\"; //For IE;\r\n            });\r\n\r\n        //set initial styling\r\n        self._image.style.opacity = this.passiveAlpha.toString(); //For real browsers;\r\n        self._image.style.filter = \"alpha(opacity=\" + Math.round(this.passiveAlpha * 100.0) + \")\"; //For IE;\r\n    }\r\n\r\n    private _adjust() {\r\n        var canvas = this._viewer._canvas;\r\n\r\n        function getOffsetRect(elem) {\r\n            var box = elem.getBoundingClientRect();\r\n\r\n            var body = document.body;\r\n            var docElem = document.documentElement;\r\n\r\n            var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n            var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\r\n            var clientTop = docElem.clientTop || body.clientTop || 0;\r\n            var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\r\n\r\n            var top = Math.round(box.top + scrollTop - clientTop);\r\n            var left = Math.round(box.left + scrollLeft - clientLeft);\r\n            var width = Math.round(box.width);\r\n            var height = Math.round(box.height);\r\n\r\n            return { top: top, left: left, width: width, height: height };\r\n        }\r\n\r\n        //get position, width and height\r\n        var rect = getOffsetRect(canvas);\r\n\r\n        //set image size to what it should be (both relative to height so it is not destorted)\r\n        this._image.style.width = Math.round(rect.height * this.ratio) + \"px\";\r\n        this._image.style.height = Math.round(rect.height * this.ratio) + \"px\";\r\n\r\n        //place image to the desired position\r\n        this._image.style.position = \"absolute\";\r\n        this._image.style.left = Math.round(rect.left + rect.width * this.placementX) + \"px\";\r\n        this._image.style.top = Math.round(rect.top + rect.height * this.placementY) + \"px\";\r\n\r\n    }\r\n\r\n    public onBeforeDraw() {}\r\n\r\n    public onBeforePick(id) {}\r\n\r\n    public onAfterDraw() { this._adjust(); }\r\n\r\n    public onBeforeDrawId() {}\r\n\r\n    public onAfterDrawId() {}\r\n\r\n    public onBeforeGetId(id) {}\r\n\r\n    public draw() {}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Plugins/NavigationHome/xbim-navigation-home.ts","export class xAttributeDictionary {\r\n\r\n    constructor(lang, culture) {\r\n        var dictionaries = [\r\n            {\r\n                lang: 'cs',\r\n                culture: 'cz',\r\n                terms: {\r\n                    AssetDescription: \"Popis\",\r\n                    AssetInstallationDate: \"Datum instalace\",\r\n                    AssetName: \"Nzev\",\r\n                    AssetSerialNumber: \"Sriov slo\",\r\n                    AssetTypeCategory: \"Kategorie\",\r\n                    AssetTypeColorCode: \"Kd barvy\",\r\n                    AssetTypeDescription: \"Popis\",\r\n                    AssetTypeFeaturesDescription: \"Popis vlastnost\",\r\n                    AssetTypeGradeDescription: \"Popis kvality\",\r\n                    AssetTypeMaterialDescription: \"Popis materilu\",\r\n                    AssetTypeName: \"Nzev\",\r\n                    AssetTypeShapeDescription: \"Popis tvaru\",\r\n                    AssetTypeSizeDescription: \"Popis velikosti\",\r\n                    AssetWarrantyStartDate: \"Zatek zruky\",\r\n                    AttributeCategory: \"Kategorie\",\r\n                    AttributeDescription: \"Popis\",\r\n                    AttributeName: \"Nzev\",\r\n                    FacilityCategory: \"Kategorie\",\r\n                    FacilityDefaultAreaUnit: \"Peddefinovan jednotka plochy\",\r\n                    FacilityDefaultLinearUnit: \"Peddefinovan jednotka dlky\",\r\n                    FacilityDefaultVolumeUnit: \"Peddefinovan jednotka objemu\",\r\n                    FacilityDeliverablePhaseName: \"Nzev fze vsledku\",\r\n                    FacilityDescription: \"Popis nemovitosti\",\r\n                    FacilityName: \"Nzev\",\r\n                    FloorCategory: \"Kategorie\",\r\n                    FloorDescription: \"Popis\",\r\n                    FloorName: \"Nzev\",\r\n                    ProjectDescription: \"Popis projektu\",\r\n                    ProjectName: \"Nzev projektu\",\r\n                    SiteDescription: \"Popis stavby\",\r\n                    SpaceCategory: \"Kategorie mstnosti\",\r\n                    SpaceDescription: \"Popis mstnosti\",\r\n                    SpaceName: \"Nzev mstnosti\",\r\n                    SpaceSignageName: \"Space Signage Name\",\r\n                    StringValue: \"String Value\",\r\n                    SystemCategory: \"System Category\",\r\n                    SystemDescription: \"System Description\",\r\n                    SystemName: \"System Name\",\r\n                    UnitName: \"Unit Name\",\r\n                    ZoneCategory: \"Zone Category\",\r\n                    ZoneDescription: \"Zone Description\",\r\n                    ZoneName: \"Zone Name\",\r\n                    externalID: \"External ID\",\r\n                    externalIDReference: \"External ID Reference\",\r\n                    propertySetName: \"Property Set\",\r\n                    True: \"Ano\",\r\n                    False: \"Ne\"\r\n                }\r\n            },\r\n            {\r\n                lang: 'en',\r\n                culture: 'uk',\r\n                terms: {\r\n                    AssetDescription: \"Asset Description\",\r\n                    AssetInstallationDate: \"Asset Installation Date\",\r\n                    AssetName: \"Asset Name\",\r\n                    AssetSerialNumber: \"Asset Serial Number\",\r\n                    AssetTypeCategory: \"Asset Type Category\",\r\n                    AssetTypeColorCode: \"Asset Type Color Code\",\r\n                    AssetTypeDescription: \"Asset Type Description\",\r\n                    AssetTypeFeaturesDescription: \"Asset Type Features Description\",\r\n                    AssetTypeGradeDescription: \"Asset Type Grade Description\",\r\n                    AssetTypeMaterialDescription: \"Asset Type Material Description\",\r\n                    AssetTypeName: \"Asset Type Name\",\r\n                    AssetTypeShapeDescription: \"Asset Type Shape Description\",\r\n                    AssetTypeSizeDescription: \"Asset Type Size Description\",\r\n                    AssetWarrantyStartDate: \"Asset Warranty Start Date\",\r\n                    AttributeCategory: \"Attribute Category\",\r\n                    AttributeDescription: \"Attribute Description\",\r\n                    AttributeName: \"Attribute Name\",\r\n                    FacilityCategory: \"Facility Category\",\r\n                    FacilityDefaultAreaUnit: \"Facility Default Area Unit\",\r\n                    FacilityDefaultLinearUnit: \"Facility Default Linear Unit\",\r\n                    FacilityDefaultVolumeUnit: \"Facility Default Volume Unit\",\r\n                    FacilityDeliverablePhaseName: \"Facility Deliverable Phase Name\",\r\n                    FacilityDescription: \"Facility Description\",\r\n                    FacilityName: \"Facility Name\",\r\n                    FloorCategory: \"Floor Category\",\r\n                    FloorDescription: \"Floor Description\",\r\n                    FloorName: \"Floor Name\",\r\n                    ProjectDescription: \"Project Description\",\r\n                    ProjectName: \"Project Name\",\r\n                    SiteDescription: \"Site Description\",\r\n                    SpaceCategory: \"Space Category\",\r\n                    SpaceDescription: \"Space Description\",\r\n                    SpaceName: \"Space Name\",\r\n                    SpaceSignageName: \"Space Signage Name\",\r\n                    StringValue: \"String Value\",\r\n                    SystemCategory: \"System Category\",\r\n                    SystemDescription: \"System Description\",\r\n                    SystemName: \"System Name\",\r\n                    UnitName: \"Unit Name\",\r\n                    ZoneCategory: \"Zone Category\",\r\n                    ZoneDescription: \"Zone Description\",\r\n                    ZoneName: \"Zone Name\",\r\n                    externalID: \"External ID\",\r\n                    externalIDReference: \"External ID Reference\",\r\n                    propertySetName: \"Property Set\",\r\n                    True: \"True\",\r\n                    False: \"False\"\r\n                }\r\n            }\r\n        ];\r\n\r\n        var def = dictionaries.filter(function(e) { return e.lang == 'en' && e.culture == 'uk'; })[0].terms;\r\n        if (typeof (lang) == 'undefined' && typeof (culture) == 'undefined')\r\n            return def;\r\n\r\n        //try to find the best fit\r\n        var candidates = dictionaries.filter(function(e) { return e.lang == lang });\r\n        //return default dictionary\r\n        if (candidates.length == 0)\r\n            return def;\r\n        //return language match\r\n        if (candidates.length == 1 || typeof (culture) == 'undefined')\r\n            return candidates[0].terms;\r\n\r\n        var candidates2 = candidates.filter(function(e) { return e.culture == culture });\r\n        //return culture match\r\n        if (candidates2.length == 1)\r\n            return candidates2[0].terms;\r\n        else\r\n            return candidates[0].terms;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-attribute-dictionary.ts","import { xVisualTemplates } from './xbim-visual-templates';\r\nimport { xVisualModel } from './xbim-visual-model';\r\nimport { xCobieUkUtils } from './xbim-cobieuk-utils';\r\nimport { xCobieUtils } from './xbim-cobie-utils';\r\n\r\n// TODO\r\ndeclare var $, jQuery: any;\r\n\r\nexport class xBrowser {\r\n    /**\r\n    * This is the main class you need to use to render semantic structure of the building model\r\n    * \r\n    * @name xBrowser\r\n    * @constructor\r\n    * @classdesc This is a reader of COBie data encoded in JSON format in COBieLite data structure. You can easily combine this with 3D viewer xViewer to get full\r\n    * user experience. This class is loosely coupled with jQuery UI. It is not a mandatory dependency for the rendering itself. Tree views are basically\r\n    * nested unordered lists which is a natural representation for hierarchical data and lists are rendered as a table with one column. Classes are assigned\r\n    * to different parts in a way that you can use to style in any way you want.\r\n    *\r\n    * If you want to do all the rendering yourself you can still take advantage of preprocessing which happens after COBie data is loaded. COBie data model\r\n    * is converted to the simplified structure which is more homogenous and better suitable for templating and visual representation. For more detailed \r\n    * information have a look on {@link xVisualModel xVisualModel} and related classes. Visual model is passed as an argument to {@link xBrowser#event.loaded loaded} event.\r\n    *\r\n    * @param {string} [lang] - language code. This framework contains dictionary for parameters and attributes. It will be used for COBie processing and rendering. If your language or culture is not available default values are \"en\", \"uk\"\r\n    * @param {string} [culture] - culture code. Default combination of language and culture is \"en\", \"uk\".\r\n    */\r\n    constructor(lang?, culture?) {\r\n    this._lang = lang;\r\n    this._culture = culture;\r\n    this._templates = {};\r\n\r\n    //compile templates\r\n    var templateStrings = xVisualTemplates();\r\n    for (var t in templateStrings) {\r\n        var templateString = templateStrings[t];\r\n        this._templates[t] = this._compileTemplate(templateString);\r\n    }\r\n}\r\n\r\n    private _iconMap = {\r\n        def: 'ui-icon-document',\r\n        facility: 'ui-icon-home',\r\n        space: 'ui-icon-document-b',\r\n        floor: 'ui-icon-image',\r\n        assettype: 'ui-icon-copy',\r\n        asset: 'ui-icon-script',\r\n        document: 'ui-icon-document',\r\n        issue: 'ui-icon-clipboard',\r\n        contact: 'ui-icon-person',\r\n        system: 'ui-icon-wrench',\r\n        zone: 'ui-icon-newwin'\r\n    };\r\n\r\n    private _model: xVisualModel = new xVisualModel(null);\r\n    private _events: any[] = [];\r\n    private _lang: any;\r\n    private _culture: any;\r\n    private _templates: any = {};\r\n\r\n_compileTemplate (str) {\r\n    // Based on Simple JavaScript Templating\r\n    // John Resig - http://ejohn.org/ - MIT Licensed\r\n    // http://ejohn.org/blog/javascript-micro-templating/\r\n    return new Function(\"_data_\",\r\n        \"var _p_=[],print=function(){_p_.push.apply(_p_,arguments);};\" +\r\n\r\n        // Introduce the data as local variables using with(){}\r\n        \"with(_data_){_p_.push('\" +\r\n\r\n        // Convert the template into pure JavaScript\r\n        str\r\n            .replace(/[\\r\\t\\n]/g, \" \")\r\n            .split(\"<%\").join(\"\\t\")\r\n            .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n            .replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n            .split(\"\\t\").join(\"');\")\r\n            .split(\"%>\").join(\"_p_.push('\")\r\n            .split(\"\\r\").join(\"\\\\'\")\r\n        + \"');}return _p_.join('');\");\r\n};\r\n\r\n\r\n\r\n/**\r\n* This function renders spatial structure as a tree view (facility -> floors -> spaces -> assets). If you use jQuery UI it can be turned into collapsable tree control\r\n* with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderSpatialStructure\r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n* @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n*/\r\nrenderSpatialStructure (container, initTree) {\r\n    if (!this._model) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\r\n    this._renderTreeView(container, this._model.facility, initTree);\r\n};\r\n\r\n/**\r\n* This function renders asset types as a tree view (asset type -> asset). If you use jQuery UI it can be turned into collapsable tree control\r\n* with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderAssetTypes\r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n* @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n*/\r\nrenderAssetTypes (container, initTree) {\r\n    if (!this._model) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n\r\n    this._renderTreeView(container, this._model.assetTypes, initTree);\r\n};\r\n\r\n/**\r\n* This function renders asset types as a list view (asset type -> asset). If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderContacts\r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderContacts (container) {\r\n    if (!this._model) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    this._renderListView(container, this._model.contacts, this._templates.contact);\r\n};\r\n\r\n/**\r\n* This function renders systems as a tree view (systems -> assets). If you use jQuery UI it can be turned into collapsable tree control\r\n* with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderSystems\r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n* @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n*/\r\nrenderSystems (container, initTree) {\r\n    if (!this._model) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    this._renderTreeView(container, this._model.systems, initTree);\r\n};\r\n\r\n/**\r\n* This function renders zones as a tree view (zones -> spaces -> assets). If you use jQuery UI it can be turned into collapsable tree control\r\n* with UI icons. But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderZones\r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n* @param {Bool} initTree - if true and jQuery UI is referenced tree will be rendered using UI icons as a collapsable tree control.\r\n*/\r\nrenderZones (container, initTree) {\r\n    if (!this._model) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    this._renderTreeView(container, this._model.zones, initTree);\r\n};\r\n\r\n\r\n/**\r\n* This function renders assignments as a list view. This represents different kinds of relations between this and other entities\r\n* If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderAssignments\r\n* @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n* {@link xBrowser#event:entityClick entityClick}, \r\n* {@link xBrowser#event:entityDblclick entityDblclick}, \r\n* {@link xBrowser#event:entityMouseDown entityMouseDown}, \r\n* {@link xBrowser#event:entityMouseUp entityMouseUp}, \r\n* {@link xBrowser#event:entityMouseMove entityMouseMove}, \r\n* {@link xBrowser#event:entityTouch entityTouch}, \r\n* {@link xBrowser#event:entityActive entityActive} \r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderAssignments (entity, container) {\r\n    if (!this._model) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    container = this._getContainer(container);\r\n    container.innerHTML = \"\";\r\n\r\n    var sets = entity.assignments;\r\n    if (sets.length == 0) return;\r\n    for (var i = 0; i < sets.length; i++) {\r\n        var set = sets[i];\r\n        if (set.assignments.length == 0) continue;\r\n\r\n        var div = document.createElement(\"div\");\r\n        div.classList.add('xbim-assignment');\r\n        div.classList.add('ui-widget');\r\n        div.classList.add('ui-corner-all');\r\n        div.classList.add('ui-widget-content');\r\n\r\n        var header = document.createElement('h3');\r\n        header.classList.add('xbim-assignment-header');\r\n        header.classList.add('ui-corner-all');\r\n        header.classList.add('ui-widget-header');\r\n        header.classList.add('ui-state-default');\r\n        header.innerHTML = set.name ? set.name : 'Undefined';\r\n        div.appendChild(header);\r\n\r\n        var data = document.createElement('div');\r\n        data.classList.add('xbim-assignment-content');\r\n        this._renderListView(data, set.assignments)\r\n        div.appendChild(data);\r\n\r\n        container.appendChild(div);\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n* This function renders documents as a list view. If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderDocuments\r\n* @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n* {@link xBrowser#event:entityClick entityClick}, \r\n* {@link xBrowser#event:entityDblclick entityDblclick}, \r\n* {@link xBrowser#event:entityMouseDown entityMouseDown}, \r\n* {@link xBrowser#event:entityMouseUp entityMouseUp}, \r\n* {@link xBrowser#event:entityMouseMove entityMouseMove}, \r\n* {@link xBrowser#event:entityTouch entityTouch}, \r\n* {@link xBrowser#event:entityActive entityActive} \r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderDocuments (entity, container) {\r\n    if (!entity) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    var docs = entity.documents;\r\n    if (docs) {\r\n        this._renderListView(container, docs, null);\r\n    }\r\n};\r\n\r\n/**\r\n* This function renders issues assigned to the entity as a list view. If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want. Just keep in mind that HTML elements\r\n* created by this function have a handlers attached which will fire UI events of {@link xBrowser xBrowser}. If you do any\r\n* heavy transformation of the resulting HTML make sure you keep this if other parts of your code rely on these events.\r\n* @function xBrowser#renderIssues\r\n* @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n* {@link xBrowser#event:entityClick entityClick}, \r\n* {@link xBrowser#event:entityDblclick entityDblclick}, \r\n* {@link xBrowser#event:entityMouseDown entityMouseDown}, \r\n* {@link xBrowser#event:entityMouseUp entityMouseUp}, \r\n* {@link xBrowser#event:entityMouseMove entityMouseMove}, \r\n* {@link xBrowser#event:entityTouch entityTouch}, \r\n* {@link xBrowser#event:entityActive entityActive} \r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderIssues (entity, container) {\r\n    if (!entity) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    var issues = entity.issues;\r\n    if (issues) {\r\n        this._renderListView(container, issues, null);\r\n    }\r\n};\r\n\r\n\r\n/**\r\n* This function renders attributes assigned to the entity as a list view. Attributes are COBie equivalent for Property Sets and can contain\r\n* arbitrary data. If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want. \r\n* @function xBrowser#renderAttributes\r\n* @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n* {@link xBrowser#event:entityClick entityClick}, \r\n* {@link xBrowser#event:entityDblclick entityDblclick}, \r\n* {@link xBrowser#event:entityMouseDown entityMouseDown}, \r\n* {@link xBrowser#event:entityMouseUp entityMouseUp}, \r\n* {@link xBrowser#event:entityMouseMove entityMouseMove}, \r\n* {@link xBrowser#event:entityTouch entityTouch}, \r\n* {@link xBrowser#event:entityActive entityActive} \r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderAttributes (entity, container) {\r\n    if (!entity) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    var html = self._templates.attribute(entity);\r\n    container.innerHTML = html;\r\n};\r\n\r\n/**\r\n* This function renders properties assigned to the entity as a list view. Properties are predefined in COBie data model. If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want. \r\n* @function xBrowser#renderProperties\r\n* @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n* {@link xBrowser#event:entityClick entityClick}, \r\n* {@link xBrowser#event:entityDblclick entityDblclick}, \r\n* {@link xBrowser#event:entityMouseDown entityMouseDown}, \r\n* {@link xBrowser#event:entityMouseUp entityMouseUp}, \r\n* {@link xBrowser#event:entityMouseMove entityMouseMove}, \r\n* {@link xBrowser#event:entityTouch entityTouch}, \r\n* {@link xBrowser#event:entityActive entityActive} \r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderProperties (entity, container) {\r\n    if (!entity) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    var html = self._templates.property(entity);\r\n    container.innerHTML = html;\r\n};\r\n\r\n/**\r\n* This function renders properties and attributes assigned to the entity as a list view. This combines data which can be rendered separately \r\n* by {@link xBrowser#renderProperties renderProperties()} or {@link xBrowser#renderAttributes renderAttributes()} but it is sometimes convenient\r\n* to render both into one single layout.  If you use jQuery UI it will use UI icons. \r\n* But it is not mandatory and you can style it any way you want.\r\n* \r\n* @function xBrowser#renderPropertiesAttributes\r\n* @param {xVisualEntity} entity - visual entity. You can obtain this entity directly from xVisualModel or in a handler of one of these events:\r\n* {@link xBrowser#event:entityClick entityClick}, \r\n* {@link xBrowser#event:entityDblclick entityDblclick}, \r\n* {@link xBrowser#event:entityMouseDown entityMouseDown}, \r\n* {@link xBrowser#event:entityMouseUp entityMouseUp}, \r\n* {@link xBrowser#event:entityMouseMove entityMouseMove}, \r\n* {@link xBrowser#event:entityTouch entityTouch}, \r\n* {@link xBrowser#event:entityActive entityActive} \r\n* @param {string|HTMLElement} container - string ID of the contaier or HTMLElement representing container. Resulting HTML will be placed inside of this element. Be aware that this will erase any actual content of the container element.\r\n*/\r\nrenderPropertiesAttributes (entity, container) {\r\n    if (!entity) throw 'No data to be rendered. Use this function in an event handler of \"loaded\" event.';\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    var html = self._templates.propertyattribute(entity);\r\n    container.innerHTML = html;\r\n};\r\n\r\n_registerEntityCallBacks (element, entity) {\r\n    var self = this;\r\n    element.entity = entity;\r\n    //element.addEventListener('', function (e) { self._fire('', { entity: entity, event: e , element: element}); e.stopPropagation(); });\r\n\r\n    /**\r\n    * Occurs when user clicks on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n    * @event xBrowser#entityClick\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element \r\n    */\r\n    /**\r\n    * Occurs when user clicks on a HTML element representing {@link xVisualEntity xVisualEntity} or if {@link xBrowser#activateEntity activateEntity()} is called. \r\n    * @event xBrowser#entityActive\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element - This argument might be null if event is fired in code by call to {@link xBrowser#activateEntity activateEntity()}. \r\n    */\r\n    /**\r\n    * Occurs when user double clicks on a HTML element representing {@link xVisualEntity xVisualEntity}.\r\n    * @event xBrowser#entityDblclick\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element - This argument might be null if event is fired in code by call to {@link xBrowser#activateEntity activateEntity()}. \r\n    */\r\n    element.addEventListener('click', function (e) {\r\n        self._fire('entityClick', { entity: entity, event: e, element: element });\r\n        self._fire('entityActive', { entity: entity, event: e, element: element });\r\n        e.stopPropagation();\r\n    });\r\n    element.addEventListener('dblclick', function (e) {\r\n        self._fire('entityDblclick', { entity: entity, event: e, element: element });\r\n        self._fire('entityActive', { entity: entity, event: e, element: element });\r\n        e.stopPropagation();\r\n    });\r\n\r\n    /**\r\n    * Occurs when mouseDown event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n    * @event xBrowser#entityMouseDown\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element \r\n    */\r\n    element.addEventListener('mouseDown', function (e) { self._fire('entityMouseDown', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n    /**\r\n    * Occurs when mouseUp event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n    * @event xBrowser#entityMouseUp\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element \r\n    */\r\n    element.addEventListener('mouseUp', function (e) { self._fire('entityMouseUp', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n    /**\r\n    * Occurs when mouseMove event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n    * @event xBrowser#entityMouseMove\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element \r\n    */\r\n    element.addEventListener('mouseMove', function (e) { self._fire('entityMouseMove', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n    /**\r\n    * Occurs when touch event occurs on a HTML element representing {@link xVisualEntity xVisualEntity}\r\n    * @event xBrowser#entityTouch\r\n    * @type {object}\r\n    * @param {xVisualEntity} entity \r\n    * @param {object} event \r\n    * @param {HTMLElement} element \r\n    */\r\n    element.addEventListener('touch', function (e) { self._fire('entityTouch', { entity: entity, event: e, element: element }); e.stopPropagation(); });\r\n};\r\n\r\n_uiTree (container) {\r\n    if (!container) return;\r\n    //this only works if jQuery UI is available\r\n    if (!jQuery || !jQuery.ui) return;\r\n\r\n    var $container = typeof (container) == 'string' ? $(\"#\" + container) : $(container);\r\n    var elements = typeof (container) == 'string' ? $(\"#\" + container + \" li\") : $(container).find('li');\r\n\r\n    //return if tree has been initialized already\r\n    if ($container.hasClass('xbim-tree')) return;\r\n    $container.addClass('xbim-tree');\r\n\r\n    var iconOpen = \"ui-icon-triangle-1-s\";\r\n    var iconClosed = \"ui-icon-triangle-1-e\";\r\n    var iconLeaf = \"ui-icon-document\";\r\n\r\n    elements\r\n        .prepend(function () {\r\n            if ($(this).children('ul').length > 0) {\r\n                $(this).addClass('xbim-tree-node');\r\n                return '<span class=\"ui-icon ' + iconClosed + '\" style=\"float: left;\"></span>';\r\n            }\r\n            else {\r\n                $(this).addClass('xbim-tree-leaf');\r\n                return '';\r\n            }\r\n        })\r\n        .css('list-style-type', 'none')\r\n        .css('cursor', 'default')\r\n        .children('ul').hide();\r\n\r\n    elements.find('span.' + iconClosed).on(\"click\", function (e) {\r\n        e.stopPropagation();\r\n        $(this).parent().children('ul').slideToggle();\r\n\r\n        if ($(this).hasClass(iconClosed))\r\n            $(this).removeClass(iconClosed).addClass(iconOpen);\r\n        else\r\n            $(this).removeClass(iconOpen).addClass(iconClosed);\r\n    });\r\n\r\n    //open first level if there is only one element\r\n    var firstLevel = $container.children('ul').children('li');\r\n    if (firstLevel.length == 1) firstLevel.children('span.' + iconClosed).click();\r\n};\r\n\r\n_renderListView (container, entities, entityTemplate?) {\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    entityTemplate = entityTemplate ? entityTemplate : self._templates.entity;\r\n\r\n    var table = document.createElement('table');\r\n    container.innerHTML = \"\";\r\n    container.appendChild(table);\r\n\r\n    for (var i = 0; i < entities.length; i++) {\r\n        var entity = entities[i];\r\n        var html = entityTemplate(entity);\r\n\r\n        var tr = document.createElement('tr');\r\n        table.appendChild(tr);\r\n        var td = document.createElement('td');\r\n        tr.appendChild(td);\r\n\r\n        td.innerHTML = html;\r\n        this._registerEntityCallBacks(td, entity);\r\n\r\n        if (jQuery && jQuery.ui) {\r\n            var icon = this._iconMap[entity.type] ? this._iconMap[entity.type] : this._iconMap['def'];\r\n            $(td).prepend('<span class=\"ui-icon ' + icon + '\" style=\"float: left;\"></span>');\r\n        }\r\n    }\r\n};\r\n\r\n_renderTreeView (container, roots, initSimpleTree, entityTemplate?) {\r\n    var self = this;\r\n    container = this._getContainer(container);\r\n    entityTemplate = entityTemplate ? entityTemplate : self._templates.entity;\r\n    initSimpleTree = initSimpleTree ? initSimpleTree : true;\r\n\r\n    var renderEntities = function (entities, ul?: HTMLUListElement) {\r\n        for (var i = 0; i < entities.length; i++) {\r\n            var entity = entities[i];\r\n            var html = entityTemplate(entity);\r\n\r\n            var li = document.createElement('li');\r\n            li.innerHTML = html;\r\n            self._registerEntityCallBacks(li, entity);\r\n\r\n            if (!ul) {\r\n                var ul = document.createElement('ul');\r\n                container.appendChild(ul);\r\n            }\r\n\r\n            ul.appendChild(li);\r\n\r\n            //recursive call if this element has any children\r\n            if (entity.children && entity.children.length > 0) {\r\n                var inUl = document.createElement('ul');\r\n                li.appendChild(inUl);\r\n                renderEntities(entity.children, inUl)\r\n            }\r\n\r\n            if (jQuery && jQuery.ui) {\r\n                var icon = self._iconMap[entity.type] ? self._iconMap[entity.type] : self._iconMap['def'];\r\n                $(li).prepend('<span class=\"ui-icon ' + icon + '\" style=\"float: left;\"></span>');\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    renderEntities(roots);\r\n    if (initSimpleTree) this._uiTree(container);\r\n};\r\n\r\n/**\r\n* Use this function to activate entity from code. This will cause {@link xBrowser#event:entityActive entityActive} event to be fired.\r\n* That might be usefull to update data relying on any kind of selection.\r\n* @function xBrowser#activateEntity\r\n* @param {Number} id - ID of the entity to be activated\r\n*/\r\nactivateEntity (id) {\r\n    if (!this._model) return;\r\n    var entity = this._model.getEntity(id);\r\n    if (!entity) return;\r\n\r\n    this._fire('entityActive', { entity: entity });\r\n};\r\n\r\n_getContainer (container) {\r\n    if (typeof (container) == 'object') return container;\r\n    if (typeof (container) == 'string') {\r\n        container = document.getElementById(container);\r\n        if (container) return container;\r\n    }\r\n    if (!container) return document.documentElement;\r\n};\r\n\r\n/**\r\n* Use this function to load data from JSON representation of COBieLite. Listen to {@link xBrowser#event:loaded loaded} event to start\r\n* using the browser.\r\n* @function xBrowser#load\r\n* @param {string|File|Blob} source - path to JSON data or File or Blob object to be used to load the data from\r\n* @fires xBrowser#loaded\r\n*/\r\nload (source) {\r\n    if (typeof (source) == 'undefined') throw 'You have to define a source to JSON data.';\r\n    var self = this;\r\n\r\n    //if it is a file, load its content\r\n    if (source instanceof Blob || source instanceof File) {\r\n        var fReader = new FileReader();\r\n        fReader.onloadend = function () {\r\n            if (fReader.result) {\r\n                //set data buffer for next processing\r\n                var data = JSON.parse(fReader.result);\r\n\r\n                //set right utils according to the data type\r\n                var uk = typeof (data.FacilityDefaultLinearUnit) === \"undefined\";\r\n                var utils = uk ? new xCobieUkUtils(self._lang, self._culture) : new xCobieUtils(self._lang, self._culture);\r\n\r\n                self._model = utils.getVisualModel(data);\r\n                self._fire('loaded', { model: self._model });\r\n            }\r\n        };\r\n        fReader.readAsText(source);\r\n        return;\r\n    }\r\n\r\n    //it should be a string now. Throw an exception if it isn't\r\n    if (typeof (source) !== 'string') throw \"Unexpected type of source. It should be File, Blob of string URL\";\r\n\r\n    //if it is a string than use ajax to load the data\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('GET', source, true);\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.readyState == 4 && xhr.status == 200) {\r\n            var data = xhr.response;\r\n\r\n            //----- IE fix\r\n            if (typeof (data) == 'string')\r\n                data = JSON.parse(data);\r\n            //------\r\n\r\n            //decide about the version if utils\r\n            var uk = typeof (data.FacilityDefaultLinearUnit) === \"undefined\";\r\n            var utils = uk ? new xCobieUkUtils(self._lang, self._culture) : new xCobieUtils(self._lang, self._culture);\r\n\r\n            self._model = utils.getVisualModel(data);\r\n\r\n            /**\r\n            * Occurs when JSON data model is loaded\r\n            * @event xBrowser#loaded\r\n            * @type {object}\r\n            * @param {xVisualModel} model - preprocessed {@link xVisualModel model} prepared for visual representation\r\n            * @param {object} model - original COBie data\r\n            */\r\n            self._fire('loaded', { model: self._model });\r\n        }\r\n        //throw exception as a warning\r\n        if (xhr.readyState == 4 && xhr.status != 200) {\r\n            var msg = 'Failed to fetch semantic JSON data from server. Server code: ' + xhr.status +\r\n                '. This might be due to CORS policy of your browser if you run this as a local file.';\r\n            throw msg;\r\n        }\r\n    };\r\n    xhr.responseType = 'json';\r\n    xhr.send();\r\n};\r\n\r\n\r\n/**\r\n* Use this method to register to events of the browser. You can define arbitrary number\r\n* of event handlers for any event. You can remove handler by calling {@link xBrowser#onRemove onRemove()} method.\r\n*\r\n* @function xBrowser#on\r\n* @param {String} eventName - Name of the event you would like to listen to.\r\n* @param {Object} callback - Callback handler of the event which will consume arguments and perform any custom action.\r\n*/\r\non (eventName, callback) {\r\n    var events = this._events;\r\n    if (!events[eventName]) {\r\n        events[eventName] = [];\r\n    }\r\n    events[eventName].push(callback);\r\n};\r\n\r\n/**\r\n* Use this method to unregisted handlers from events. You can add event handlers by call to {@link xBrowser#on on()} method.\r\n*\r\n* @function xBrowser#onRemove\r\n* @param {String} eventName - Name of the event\r\n* @param {Object} callback - Handler to be removed\r\n*/\r\nonRemove (eventName, callback) {\r\n    var events = this._events;\r\n    var callbacks = events[eventName];\r\n    if (!callbacks) {\r\n        return;\r\n    }\r\n    var index = callbacks.indexOf(callback);\r\n    if (index >= 0) {\r\n        callbacks.splice(index, 1);\r\n    }\r\n};\r\n\r\n//executes all handlers bound to event name\r\n_fire (eventName, args) {\r\n    var handlers = this._events[eventName];\r\n    if (!handlers) {\r\n        return;\r\n    }\r\n    //call the callbacks\r\n    handlers.forEach(function (handler) {\r\n        handler(args);\r\n    }, this);\r\n};\r\n}\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-browser.ts","export function xVisualTemplates() {\r\n    return {\r\n        property:\r\n        '<%if (properties && properties.length > 0) {%>\\\r\n<table> \\\r\n    <% for (var p in properties) { var prop = properties[p];%> \\\r\n    <tr> \\\r\n        <td><%=prop.name%></td>\\\r\n        <td><%=prop.value%></td>\\\r\n    </tr>\\\r\n    <%}%>\\\r\n</table> \\\r\n<%}%>',\r\n        attribute:\r\n        '<% if (attributes && attributes.length > 0) {\\\r\n    var psets = [];\\\r\n    for(var i = 0; i < attributes.length; i++){\\\r\n        var attr = attributes[i]; var pset = attr.propertySet; if (pset) {if(psets.indexOf(pset) == -1){psets.push(pset);}}\\\r\n    }\\\r\n%>\\\r\n<table> \\\r\n    <% for (var p in psets) { var psetName = psets[p]; var pset = attributes.filter(function(e){ return e.propertySet == psetName;});\\\r\n%>\\\r\n<tr><th colspan=\"2\"><%=psetName%></th></tr>\\\r\n<%for (var a in pset) { var attr = pset[a];%> \\\r\n    <tr title=\"<%=attr.description%>\"> \\\r\n        <td><%=attr.name%></td>\\\r\n        <td><%=attr.value%></td>\\\r\n    </tr>\\\r\n    <%}}%>\\\r\n</table>\\\r\n<%}%>',\r\n        propertyattribute:\r\n        '<%if (properties.length > 0 || attributes.length > 0) {%><table> \\\r\n    <% for (var p in properties) { var prop = properties[p];%> \\\r\n    <tr> \\\r\n        <td><%=prop.name%></td>\\\r\n        <td><%=prop.value%></td>\\\r\n    </tr>\\\r\n    <%}%>\\\r\n<%}\\\r\nif (attributes && attributes.length > 0) {\\\r\n    var psets = [];\\\r\n    for(var i = 0; i < attributes.length; i++){\\\r\n        var attr = attributes[i]; if (!attr.propertySet) attr.propertySet = \"General\";\\\r\n        var pset = attr.propertySet; if (pset) {if(psets.indexOf(pset) == -1){psets.push(pset);}}\\\r\n    }\\\r\n%>\\\r\n    <% for (var p in psets) { var psetName = psets[p]; var pset = attributes.filter(function(e){ return e.propertySet == psetName;});\\\r\n%>\\\r\n<tr><th colspan=\"2\"><%=psetName%></th></tr>\\\r\n<%for (var a in pset) { var attr = pset[a];%> \\\r\n    <tr title=\"<%=attr.description%>\"> \\\r\n        <td><%=attr.name%></td>\\\r\n        <td><%=attr.value%></td>\\\r\n    </tr>\\\r\n    <%}}%>\\\r\n</table>\\\r\n<%}%>',\r\n        entity: '<span class=\"xbim-entity\" title=\"<%=typeof(description) != \"undefined\" ? description : \"\"%>\"> <%= name? name: (function f() { return type.charAt(0).toUpperCase() + type.slice(1); })() %> </span>',\r\n        contact:\r\n        '<% var nameA = properties.filter(function(e){return e.id == \"ContactGivenName\";})[0] || properties.filter(function(e){return e.id == \"GivenName\";})[0]; \\\r\nvar surnameA = properties.filter(function(e){return e.id == \"ContactFamilyName\";})[0] || properties.filter(function(e){return e.id == \"FamilyName\";})[0]; \\\r\nvar emailA = properties.filter(function(e){return e.id == \"ContactEmail\";})[0] || properties.filter(function(e){return e.id == \"Email\";})[0]; \\\r\nvar name = nameA ? nameA.value : \"\";\\\r\nvar surname = surnameA ? surnameA.value : \"\";\\\r\nvar email = emailA ? emailA.value : \"\"; %>\\\r\n<span class=\"xbim-entity\" title=\"<%=email%>\"> <%=name%> <%=surname%> <% if (!name && !surname) print(\"No name\"); %> </span>'\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-visual-templates.ts","import { xVisualEntity } from './xbim-visual-entity';\r\n\r\nexport class xVisualModel {\r\n    /**\r\n    * Visual model containing preprocessed COBie data in more uniform form usable for templating and rendering\r\n    * \r\n    * @name xVisualModel\r\n    * @constructor\r\n    * @classdesc Visual model containing preprocessed COBie data in more uniform form usable for templating and rendering\r\n    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n    */\r\n    constructor(values) {\r\n        if (typeof (values) == 'object') {\r\n            for (var a in values) {\r\n                this[a] = values[a];\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @member {xVisualEntity[]} xVisualModel#facility - An array of facilities. There is always one faclity but it is convenient to have all\r\n    * members of xVisualModel to be an array so they can be accessed in an uniform way.\r\n    */\r\n    public facility: xVisualEntity[] = [];\r\n    /** @member {xVisualEntity[]} xVisualModel#zones - An array of zones defined in COBie model. They contain spaces as their children. */\r\n    public zones: xVisualEntity[] = [];\r\n    /** @member {xVisualEntity[]} xVisualModel#systems - An array of systems */\r\n    public systems: xVisualEntity[] = [];\r\n    /** @member {xVisualEntity[]} xVisualModel#contacts - An array of all contacts used in the COBie model*/\r\n    public contacts: xVisualEntity[] = [];\r\n    /** @member {xVisualEntity[]} xVisualModel#assetTypes - An array of all asset types. These contain assets as their children */\r\n    public assetTypes: xVisualEntity[] = [];\r\n\r\n    public getEntity(id) {\r\n        if (typeof (id) == 'undefined' || id == null) return null;\r\n        id = id.toString();\r\n\r\n        var get = (collection, id) => {\r\n            for (var i = 0; i < collection.length; i++) {\r\n                var entity = collection[i];\r\n                if (entity.id == id) return entity;\r\n                var result = get(entity.children, id);\r\n                if (result) return result;\r\n            }\r\n            return null;\r\n        };\r\n\r\n        for (var i in this) {\r\n            if (typeof (this[i]) == 'function') continue;\r\n            var result = get(this[i], id);\r\n            if (result) return result;\r\n        }\r\n        return null;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-visual-model.ts","import { xVisualEntity } from './xbim-visual-entity';\r\nimport { xVisualModel } from './xbim-visual-model';\r\nimport { xAttributeDictionary } from './xbim-attribute-dictionary';\r\nimport { xVisualAssignmentSet } from './xbim-visual-assignment-set';\r\nimport { xVisualAttribute } from './xbim-visual-attribute';\r\nimport { xVisualProperty } from './xbim-visual-property';\r\n\r\nexport class xCobieUkUtils {\r\n    constructor(lang, culture) {\r\n        this._dictionary = new xAttributeDictionary(lang, culture);\r\n    }\r\n\r\n    private _dictionary: xAttributeDictionary;\r\n    private _contacts: any[] = [];\r\n\r\n    public settings = {\r\n        decimalPlaces: 4\r\n    };\r\n\r\n    getVisualEntity(entity, type) {\r\n        if (!entity || !type) throw 'entity must be defined';\r\n        return new xVisualEntity({\r\n            id: entity.ExternalId,\r\n            type: type,\r\n            name: this\r\n                .getValidationStatus(entity) +\r\n                entity.Name, //prepend validation status. This will make it easier for later.\r\n            description: entity.Description,\r\n            attributes: this.getAttributes(entity),\r\n            properties: this.getProperties(entity),\r\n            assignments: this.getAssignments(entity, type),\r\n            documents: this.getDocuments(entity, type),\r\n            issues: this.getIssues(entity)\r\n        });\r\n    }\r\n\r\n    getValidationStatus(entity) {\r\n        if (entity.Categories == null) return '';\r\n\r\n        for (var i = 0; i < entity.Categories.length; i++) {\r\n            var category = entity.Categories[i];\r\n            if (typeof (category.Code) !== 'undefined' && category.Code.toLowerCase() === 'failed')\r\n                return '[F] ';\r\n            if (typeof (category.Code) !== 'undefined' && category.Code.toLowerCase() === 'passed')\r\n                return '[T] ';\r\n        }\r\n        return '';\r\n    }\r\n\r\n    getVisualModel(data) {\r\n        if (!data) throw 'data must be defined';\r\n\r\n        //contacts are used very often as a references in assignments\r\n        //so it is good to have them in the wide scope for processing\r\n        this._contacts = this.getContacts(data);\r\n\r\n        var types = this.getAssetTypes(data);\r\n        //this will also add assets to spaces where they should be\r\n        var facility = this.getSpatialStructure(data, types);\r\n        return new xVisualModel({\r\n            facility: facility,\r\n            zones: this.getZones(data, facility),\r\n            systems: this.getSystems(data, types),\r\n            assetTypes: types,\r\n            contacts: this._contacts\r\n        });\r\n    }\r\n\r\n    getContacts(data) {\r\n        if (!data) throw 'data must be defined';\r\n        var result = [];\r\n        var contacts = data.Contacts;\r\n        if (!contacts) return result;\r\n\r\n        for (var i = 0; i < contacts.length; i++) {\r\n            var vContact = this.getVisualEntity(contacts[i], 'contact');\r\n            result.push(vContact);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getSpatialStructure(data, types) {\r\n        if (!data) throw 'data must be defined';\r\n        if (!types) throw 'types must be defined';\r\n\r\n        var facility = this.getVisualEntity(data, 'facility');\r\n\r\n        var floors: xVisualEntity[] = data.Floors;\r\n        if (!floors || floors.length == 0)\r\n            return [facility];\r\n\r\n        for (var i in floors) {\r\n            var floor = floors[i];\r\n            var vFloor = this.getVisualEntity(floor, 'floor');\r\n            facility.children.push(vFloor);\r\n\r\n            var spaces: xVisualEntity[] = floor['Spaces'];\r\n            if (!spaces) continue;\r\n\r\n            for (var s in spaces) {\r\n                var space = spaces[s];\r\n                var vSpace = this.getVisualEntity(space, 'space');\r\n                vFloor.children.push(vSpace);\r\n            }\r\n        }\r\n\r\n        //add asset types and assets to spaces \r\n        for (var t in types) {\r\n            var type = types[t];\r\n            for (var i in type.children) {\r\n                var instance = type.children[i];\r\n\r\n                //check assignments\r\n                var assignmentSet = instance.assignments.filter(function(e) { return e.id == 'Space' })[0];\r\n                if (!assignmentSet) continue;\r\n                var key = assignmentSet.assignments[0];\r\n                if (!key) continue;\r\n\r\n                var spaceProp = key.properties.filter(function(e) { return e.id == 'Name' })[0];\r\n                if (!spaceProp) continue;\r\n\r\n                var spaceName = spaceProp.value.split(',')[0];\r\n\r\n                for (var j = 0; j < facility.children.length; j++) {\r\n                    var floor = facility.children[j];\r\n\r\n                    var space = floor.children.filter(function(e) { return e.name == spaceName })[0];\r\n                    if (!space) continue;\r\n\r\n                    space.children.push(instance);\r\n                    assignmentSet.assignments[0] = space;\r\n                    break;;\r\n                }\r\n\r\n\r\n            }\r\n        }\r\n\r\n        //facility is a root element of the tree spatial structure\r\n        return [facility];\r\n    }\r\n\r\n    getZones(data, facility) {\r\n        if (!data) throw 'data must be defined';\r\n        if (!facility) throw 'data must be defined';\r\n        var result = [];\r\n\r\n        var zones = data.Zones;\r\n        if (!zones) return result;\r\n\r\n        for (var z in zones) {\r\n            var zone = zones[z];\r\n            var vZone = this.getVisualEntity(zone, 'zone');\r\n            result.push(vZone);\r\n\r\n            //add spaces as a children\r\n            var keys = zone.Spaces;\r\n            if (!keys || keys.length == 0) continue;\r\n\r\n            for (var ki in keys) {\r\n                var key = keys[ki];\r\n                for (var i = 0; i < facility.length; i++) { //facilities (always 1)\r\n                    var f = facility[i];\r\n                    for (var j = 0; j < f.children.length; j++) { //floors\r\n                        var floor = f.children[j];\r\n                        for (var k = 0; k < floor.children.length; k++) { //spaces\r\n                            var space = floor.children[k];\r\n                            if (space.name != key.Name) continue;\r\n\r\n                            //add space as a children\r\n                            vZone.children.push(space);\r\n                            //add zone to space as an assignment\r\n                            var assignmentSet = space.assignments.filter(function(e) { return e.id == 'Zone'; })[0];\r\n                            if (!assignmentSet) {\r\n                                assignmentSet = new xVisualAssignmentSet();\r\n                                assignmentSet.id = 'Zone';\r\n                                assignmentSet.name = 'Zones';\r\n                                space.assignments.push(assignmentSet);\r\n                            }\r\n                            assignmentSet.assignments.push(vZone);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getSystems(data, types) {\r\n        if (!data) throw 'data must be defined';\r\n        if (!types) throw 'types must be defined';\r\n        var result = [];\r\n\r\n        var systems = data.Systems;\r\n        if (!systems) return result;\r\n\r\n        var instances = [];\r\n        for (var k = 0; k < types.length; k++) {\r\n            var type = types[k];\r\n            for (var c in type.children) {\r\n                instances.push(type.children[c]);\r\n            }\r\n        }\r\n\r\n        for (var s in systems) {\r\n            var system = systems[s];\r\n            var vSystem = this.getVisualEntity(system, 'system');\r\n            result.push(vSystem);\r\n\r\n            //add assets to systems \r\n            var componentKeys = system.Components;\r\n            for (var j = 0; j < componentKeys.length; j++) {\r\n                var key = componentKeys[j];\r\n                var candidates = instances.filter(function(e) { return e.name == key.Name; });\r\n                if (!candidates) continue;\r\n                var instance = candidates[0];\r\n                if (!instance) continue;\r\n\r\n                //add asset to system\r\n                vSystem.children.push(instance);\r\n                //add system to asset assignments\r\n                var assignmentSet = instance.assignments.filter(function(e) { return e.id == 'System'; })[0];\r\n                if (!assignmentSet) {\r\n                    assignmentSet = new xVisualAssignmentSet();\r\n                    assignmentSet.id = 'System';\r\n                    assignmentSet.Name = 'Systems';\r\n                    instance.assignments.push(assignmentSet);\r\n                }\r\n                assignmentSet.assignments.push(vSystem);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getAssetTypes(data) {\r\n        if (!data) throw 'data must be defined';\r\n        var result = [];\r\n        var tr = this.getTranslator();\r\n\r\n        var types = data.AssetTypes;\r\n        if (!types) return result;\r\n\r\n        for (var t in types) {\r\n            var type = types[t];\r\n            var vType = this.getVisualEntity(type, 'assettype');\r\n            result.push(vType);\r\n\r\n            //process instances of type\r\n            var instances = type.Assets;\r\n            if (!instances) continue;\r\n            for (var i in instances) {\r\n                var instance = instances[i];\r\n                var vInstance = this.getVisualEntity(instance, 'asset');\r\n                vType.children.push(vInstance);\r\n\r\n                //add assignment to the type\r\n                var assignment = new xVisualAssignmentSet();\r\n                assignment.id = 'AssetType';\r\n                assignment.name = tr(assignment.id);\r\n                assignment.assignments.push(vType);\r\n                vInstance.assignments.push(assignment);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getProperties(entity) {\r\n        if (!entity) throw 'entity must be defined';\r\n        var tr = this.getTranslator();\r\n        var result = [];\r\n\r\n        for (var a in entity) {\r\n            var attr = entity[a];\r\n            var valStr = this.getValueString(attr);\r\n            if (valStr) {\r\n                var nameStr = tr(a);\r\n                result.push(new xVisualProperty({ name: nameStr, value: valStr, id: a }));\r\n            }\r\n        }\r\n        var catProperties = this.getCategoryProperties(entity);\r\n        for (var i = 0; i < catProperties.length; i++) {\r\n            result.push(catProperties[i]);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getCategoryProperties(entity) {\r\n        var cats = entity.Categories;\r\n        if (!cats) return [];\r\n\r\n        var result = [];\r\n        for (var i = 0; i < cats.length; i++) {\r\n            var cat = cats[i];\r\n            var valStr = cat.Code + cat.Description ? ': ' + cat.Description : '';\r\n            result.push(new xVisualProperty({ name: cat.Classification || 'Free category', value: valStr, id: i }));\r\n        }\r\n        return [];\r\n    }\r\n\r\n    getAttributes(entity) {\r\n        if (!entity) throw 'entity must be defined';\r\n\r\n        var result = [];\r\n        var attributes = entity.Attributes;\r\n        if (!attributes) return result;\r\n\r\n        for (var a in attributes) {\r\n            var attribute = attributes[a];\r\n\r\n            result.push(new xVisualAttribute({\r\n                name: attribute.Name,\r\n                description: attribute.Description,\r\n                value: this.getValueString(attribute),\r\n                propertySet: attribute.ExternalEntity,\r\n                categories: this.getCategoryProperties(attribute),\r\n                issues: attribute.Issues ? this.getIssues({ Issues: attribute.Issues }) : []\r\n            }));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getAssignments(entity, type) {\r\n        if (!entity || !type) throw 'entity and type must be defined';\r\n        var tr = this.getTranslator();\r\n        var result = [];\r\n\r\n        //assignment can either be an array of keys or a single embeded object\r\n        for (var attrName in entity) {\r\n            if (!entity.hasOwnProperty(attrName)) continue;\r\n            var assignmentSet = new xVisualAssignmentSet();\r\n            var attr = entity[attrName];\r\n\r\n            //set of assignments (keys)\r\n            if (attr instanceof Array && attr.length > 0 && typeof (attr[0].KeyType) !== 'undefined') {\r\n                assignmentSet.id = attr[0].KeyType;\r\n                assignmentSet.name = tr(attrName);\r\n                for (var i = 0; i < attr.length; i++) {\r\n                    //if it is a contact than add a contact if available\r\n                    if (attr[i].KeyType === 'Contact') {\r\n                        var contact = this.findContact(attr['Email']);\r\n                        if (contact) {\r\n                            assignmentSet.assignments.push(contact);\r\n                            continue;\r\n                        }\r\n                    }\r\n\r\n                    var vAssignment = this.getVisualEntity(attr[i], attr[i].KeyType.toLowerCase());\r\n                    vAssignment.isKey = true;\r\n                    assignmentSet.assignments.push(vAssignment);\r\n                }\r\n                result.push(assignmentSet);\r\n                continue;\r\n            }\r\n\r\n            //single key assignment\r\n            if (typeof (attr.KeyType) !== 'undefined') {\r\n                assignmentSet.id = attr.KeyType;\r\n                assignmentSet.name = tr(attrName);\r\n\r\n                //add a contact if it is defined\r\n                if (attr.KeyType === 'Contact' && this._contacts) {\r\n                    var contact = this.findContact(attr.Email);\r\n                    if (contact) {\r\n                        assignmentSet.assignments.push(contact);\r\n                        result.push(assignmentSet);\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                var vEntity = this.getVisualEntity(attr, attr.KeyType.toLowerCase());\r\n                assignmentSet.assignments.push(vEntity);\r\n                result.push(assignmentSet);\r\n                continue;\r\n            }\r\n\r\n            //cope with objects that encapsulate set of information (like a warranty, site, space and eventually others)\r\n            if (!(attr instanceof Array) && (attr instanceof Object)) {\r\n                assignmentSet.id = attr.KeyType;\r\n                assignmentSet.name = tr(attrName);\r\n                var vEntity = this.getVisualEntity(attr, 'inner');\r\n                assignmentSet.assignments.push(vEntity);\r\n                result.push(assignmentSet);\r\n                continue;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    findContact(email) {\r\n        for (var i = 0; i < this._contacts.length; i++) {\r\n            var contact = this._contacts[i];\r\n            var emailProp = contact.properties.filter(function(e) { return e.name === 'Email'; })[0]\r\n            if (emailProp && emailProp.value === email)\r\n                return contact;\r\n        }\r\n    }\r\n\r\n    getDocuments(entity, type) {\r\n        if (!entity || !type) throw 'entity and type must be defined';\r\n        var result = [];\r\n\r\n        var documents = entity.Documents\r\n        if (!documents) return result;\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var doc = documents[i]\r\n            var vDoc = this.getVisualEntity(doc, 'document')\r\n            result.push(vDoc);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getIssues(entity) {\r\n        if (!entity) throw 'entity and type must be defined';\r\n        var result = [];\r\n\r\n        var issues = entity.Issues\r\n        if (!issues) return result;\r\n\r\n        for (var i = 0; i < issues.length; i++) {\r\n            var issue = issues[i]\r\n            var vIssue = this.getVisualEntity(issue, 'issue')\r\n            result.push(vIssue);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    setLanguage(lang, culture) {\r\n        this._dictionary = new xAttributeDictionary(lang, culture);\r\n    }\r\n\r\n    getValueString(value) {\r\n        if (typeof (value) == 'undefined' || value == null)\r\n            return '';\r\n\r\n        var units = value.Unit || '';\r\n\r\n        //this is for different kinds of attributes using latest serializer implementation\r\n        if (typeof (value.StringAttributeValue) !== 'undefined') return value.StringAttributeValue.Value || '';\r\n        if (typeof (value.BooleanAttributeValue) !== 'undefined') return value.BooleanAttributeValue.Value || '';\r\n        if (typeof (value.DateTimeAttributeValue) !== 'undefined') return value.DateTimeAttributeValue.Value || '';\r\n        if (typeof (value.DecimalAttributeValue) !== 'undefined') {\r\n            var number = value.DecimalAttributeValue.Value;\r\n            if (number) {\r\n                number = number.toFixed(this.settings.decimalPlaces);\r\n                return number.toString() + ' ' + units;\r\n            }\r\n            return '';\r\n        }\r\n        if (typeof (value.IntegerAttributeValue) !== 'undefined') {\r\n            var number = value.IntegerAttributeValue.Value;\r\n            if (number) {\r\n                return number.toString() + ' ' + units;\r\n            }\r\n            return '';\r\n        }\r\n\r\n        //return null for arrays and objects (which are both 'object')\r\n        if (typeof (value) == 'object')\r\n            return null;\r\n\r\n        return value;\r\n    }\r\n\r\n    getTranslator() {\r\n        var self = this;\r\n        return function(term) {\r\n            return self._dictionary[term] ? self._dictionary[term] : term.replace(/([a-z0-9])([A-Z])/g, '$1 $2');\r\n        };\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-cobieuk-utils.ts","import { xVisualProperty } from './xbim-visual-property';\r\nimport { xVisualAttribute } from './xbim-visual-attribute';\r\nimport { xVisualAssignmentSet } from './xbim-visual-assignment-set';\r\n\r\nexport class xVisualEntity {\r\n\r\n    /**\r\n    * Visual model containing entity data\r\n    * \r\n    * @name xVisualEntity\r\n    * @constructor\r\n    * @classdesc Visual model containing entity data\r\n    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n    */\r\n    constructor(values: any) {\r\n        if (typeof (values) == 'object') {\r\n            for (var a in values) {\r\n                this[a] = values[a];\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @member {string} xVisualEntity#id - ID extracted from object attributes*/\r\n    public id: string = '';\r\n    /** @member {string} xVisualEntity#type - type of the object like asset, assettype, floor, facility, assembly and others. It is always one lower case word.*/\r\n    public type: string = '';\r\n    /** @member {string} xVisualEntity#name - Name extracted from object attributes*/\r\n    public name: string = '';\r\n    /** @member {string} xVisualEntity#description - Description extracted from attributes*/\r\n    public description: string = '';\r\n    /** @member {xVisualAttribute[]} xVisualEntity#attributes */\r\n    public attributes: xVisualAttribute[] = [];\r\n    /** @member {xVisualProperty[]} xVisualEntity#properties */\r\n    public properties: xVisualProperty[] = [];\r\n    /** @member {xVisualEntity[]} xVisualEntity#documents */\r\n    public documents: xVisualEntity[] = [];\r\n    /** @member {xVisualEntity[]} xVisualEntity#issues */\r\n    public issues: xVisualEntity[] = [];\r\n    /** @member {xVisualAssignmentSet[]} xVisualEntity#assignments - An array of {@link xVisualAsignmentSet visual assignment sets} */\r\n    public assignments: xVisualAssignmentSet[] = [];\r\n    /** @member {xVisualEntity[]} xVisualEntity#children - this can be used to build hierarchical structures like facility -> floors -> spaces -> assets */\r\n    public children: xVisualEntity[] = [];\r\n    /** @member {xVisualEntity[]} xVisualEntity#warranties - this is applicable for asset type only. */\r\n    public warranties: xVisualEntity[] = [];\r\n    \r\n    public isKey: boolean = false; //indicates if this is only a key for the actual entity\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-visual-entity.ts","import { xVisualEntity } from './xbim-visual-entity';\r\n\r\n/**\r\n* @name xVisualAssignmentSet\r\n* @constructor\r\n* @classdesc Visual model describing named sets of assignments\r\n*/\r\nexport class xVisualAssignmentSet{\r\n    /** @member {string} xVisualAssignmentSet#name */\r\n    public name: string = '';\r\n    /** @member {string} xVisualAssignmentSet#id */\r\n    public id: string = '';\r\n    /** @member {xVisualEntity[]} xVisualAssignmentSet#assignments */\r\n    public assignments: xVisualEntity[] = [];\r\n};\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-visual-assignment-set.ts","import { xVisualEntity } from './xbim-visual-entity';\r\n\r\nexport class xVisualAttribute {\r\n    /**\r\n    * @name xVisualAttribute\r\n    * @constructor\r\n    * @classdesc Visual model describing attribute of the object\r\n    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n    */\r\n    constructor(values) {\r\n        if (typeof (values) == 'object') {\r\n            for (var a in values) {\r\n                this[a] = values[a];\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @member {string} xVisualAttribute#name */\r\n    public name: string = '';\r\n    /** @member {string} xVisualAttribute#description */\r\n    public description: string = '';\r\n    /** @member {string} xVisualAttribute#value */\r\n    public value: string = '';\r\n    /** @member {string} xVisualAttribute#propertySet - original property set name from IFC file */\r\n    public propertySet: string = '';\r\n    /** @member {string} xVisualAttribute#category */\r\n    public category: string = '';\r\n    /** @member {xVisualEntity[]} xVisualAttribute#issues */\r\n    public issues: xVisualEntity[] = [];\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-visual-attribute.ts","export class xVisualProperty {\r\n    /**\r\n    * @name xVisualProperty\r\n    * @constructor\r\n    * @classdesc Visual model describing property of the object\r\n    * @param {object} [values] - Object which can be used to initialize content of the object. It can be also used to create shallow copy of the object.\r\n    */\r\n    constructor(values: any) {\r\n        if (typeof (values) == 'object') {\r\n            for (var a in values) {\r\n                this[a] = values[a];\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @member {string} xVisualProperty#name - name might be translated if you specify a language and culture in {@link xBrowser xBrowser} constructor */\r\n    public name: string = '';\r\n    /** @member {string} xVisualProperty#value - string containing eventually units*/\r\n    public value: string = '';\r\n    /** @member {string} xVisualProperty#id - original name from COBie before any transformation*/\r\n    public id: string = '';\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-visual-property.ts","import { xVisualEntity } from './xbim-visual-entity';\r\nimport { xVisualModel } from './xbim-visual-model';\r\nimport { xAttributeDictionary } from './xbim-attribute-dictionary';\r\nimport { xVisualAssignmentSet } from './xbim-visual-assignment-set';\r\nimport { xVisualAttribute } from './xbim-visual-attribute';\r\nimport { xVisualProperty } from './xbim-visual-property';\r\n\r\nexport class xCobieUtils {\r\n\r\n    constructor(lang, culture) {\r\n        this._dictionary = new xAttributeDictionary(lang, culture);\r\n    }\r\n\r\n    private _dictionary: xAttributeDictionary;\r\n\r\n    public settings = {\r\n        decimalPlaces: 4\r\n    };\r\n\r\n    getVisualEntity(entity, type) {\r\n        if (!entity || !type) throw 'entity must be defined';\r\n        var id = entity.externalID || entity.externalIDReference;\r\n        var name = '';\r\n        var description = '';\r\n        for (var a in entity) {\r\n            if (!entity.hasOwnProperty(a)) {\r\n                continue;\r\n            }\r\n            if (a.toLowerCase() === (type + 'name').toLowerCase())\r\n                name = entity[a];\r\n            if (a.toLowerCase() === (type + 'description').toLowerCase())\r\n                description = entity[a];\r\n            if (name.length !== 0 && description.length !== 0)\r\n                break;\r\n        }\r\n\r\n        return new xVisualEntity({\r\n            id: id,\r\n            type: type,\r\n            name: name,\r\n            description: description,\r\n            attributes: this.getAttributes(entity),\r\n            properties: this.getProperties(entity),\r\n            assignments: this.getAssignments(entity, type),\r\n            documents: this.getDocuments(entity, type),\r\n            issues: this.getIssues(entity)\r\n        });\r\n    }\r\n\r\n    getVisualModel(data) {\r\n        if (!data) throw 'data must be defined';\r\n\r\n        var types = this.getAssetTypes(data);\r\n        var facility = this.getSpatialStructure(data, types);\r\n        return new xVisualModel({\r\n            facility: facility,\r\n            zones: this.getZones(data, facility),\r\n            systems: this.getSystems(data, types),\r\n            assetTypes: types,\r\n            contacts: this.getContacts(data)\r\n        });\r\n    }\r\n\r\n    getContacts(data) {\r\n        if (!data) throw 'data must be defined';\r\n        var result = [];\r\n\r\n        var contacts = data.Contacts;\r\n        if (contacts) contacts = contacts.Contact;\r\n        if (!contacts) return result;\r\n\r\n        contacts.forEach(function(contact) {\r\n                var vContact = this.getVisualEntity(contact, 'contact');\r\n                result.push(vContact);\r\n            },\r\n            this);\r\n\r\n        return result;\r\n    }\r\n\r\n    getSpatialStructure(data, types) {\r\n        if (!data) throw 'data must be defined';\r\n\r\n        var facility = this.getVisualEntity(data, 'facility');\r\n\r\n        var floors = data.Floors;\r\n        if (!floors)\r\n            return [facility];\r\n        floors = floors.Floor;\r\n        if (!floors || floors.length == 0)\r\n            return [facility];\r\n\r\n        floors.forEach(function(floor) {\r\n                var vFloor = this.getVisualEntity(floor, 'floor');\r\n                facility.children.push(vFloor);\r\n\r\n                var spaces = floor.Spaces;\r\n                if (!spaces) return;\r\n                spaces = spaces.Space;\r\n                if (!spaces) return;\r\n\r\n                spaces.forEach(function(space) {\r\n                        var vSpace = this.getVisualEntity(space, 'space');\r\n                        vFloor.children.push(vSpace);\r\n                    },\r\n                    this);\r\n            },\r\n            this);\r\n\r\n        //add asset types and assets to spaces \r\n        types = types ? types : this.getAssetTypes(data);\r\n        types.forEach(function(type) {\r\n                type.children.forEach(function(instance) {\r\n                        //check assignments\r\n                        var assignmentSet = instance.assignments.filter(function(e) { return e.id === 'Space' })[0];\r\n                        if (!assignmentSet) return;\r\n                        var key = assignmentSet.assignments[0];\r\n                        if (!key) return;\r\n\r\n                        var spaceProp = key.properties.filter(function(e) { return e.id === 'SpaceName' })[0];\r\n                        var floorProp = key.properties.filter(function(e) { return e.id === 'FloorName' })[0];\r\n                        if (!floorProp || !spaceProp) return;\r\n\r\n                        var spaceName = spaceProp.value;\r\n                        var floorName = floorProp.value;\r\n\r\n                        var floor = facility.children.filter(function(e) { return e.name === floorName; })[0];\r\n                        if (!floor) return;\r\n\r\n                        var space = floor.children.filter(function(e) { return e.name === spaceName })[0];\r\n                        if (!space) return;\r\n\r\n                        space.children.push(instance);\r\n                        assignmentSet.assignments[0] = space;\r\n                    },\r\n                    this);\r\n            },\r\n            this);\r\n\r\n        //facility is a root element of the tree spatial structure\r\n        return [facility];\r\n    }\r\n\r\n    getZones(data, facility) {\r\n        if (!data) throw 'data must be defined';\r\n        var result = [];\r\n\r\n        var zones = data.Zones;\r\n        if (!zones) return result;\r\n        zones = zones.Zone;\r\n        if (!zones) return result;\r\n\r\n        zones.forEach(function(zone) {\r\n                var vZone = this.getVisualEntity(zone, 'zone');\r\n                result.push(vZone);\r\n            },\r\n            this);\r\n\r\n        //add spaces as a children of zones\r\n        facility.forEach(function(f) { //facilities (always 1)\r\n                f.children.forEach(function(floor) { //floors\r\n                        floor.children.forEach(function(space) { //floors\r\n                                var assignmentSet = space.assignments\r\n                                    .filter(function(e) { return e.id === 'Zone'; })[0];\r\n                                if (!assignmentSet) return;\r\n                                var key = assignmentSet.assignments[0];\r\n                                if (!key) return;\r\n                                if (!key.id) return;\r\n\r\n                                var zone = result.filter(function(e) { return e.id === key.id; })[0];\r\n                                if (zone) {\r\n                                    //add space to visual children\r\n                                    zone.children.push(space);\r\n                                    //replace key with actual object\r\n                                    assignmentSet.assignments[0] = zone;\r\n                                }\r\n                            },\r\n                            this);\r\n                    },\r\n                    this);\r\n            },\r\n            this);\r\n\r\n        return result;\r\n    }\r\n\r\n    getSystems(data, types) {\r\n        if (!data) throw 'data must be defined';\r\n        var result = [];\r\n\r\n        var systems = data.Systems;\r\n        if (!systems) return result;\r\n        systems = systems.System;\r\n        if (!systems) return result;\r\n\r\n        systems.forEach(function(system) {\r\n                var vSystem = this.getVisualEntity(system, 'system');\r\n                result.push(vSystem);\r\n            },\r\n            this);\r\n\r\n        //add asset types and assets to spaces \r\n        types = types ? types : this.getAssetTypes(data);\r\n        types.forEach(function(type) {\r\n                type.children.forEach(function(instance) {\r\n                        //check assignments\r\n                        var assignmentSet = instance.assignments.filter(function(e) { return e.id === 'System' })[0];\r\n                        if (!assignmentSet) return;\r\n                        var key = assignmentSet.assignments[0];\r\n                        if (!key) return;\r\n\r\n                        if (!key.id) return;\r\n                        var system = result.filter(function(e) { return e.id === key.id; })[0];\r\n                        if (system) {\r\n                            //add instance to system's visual children\r\n                            system.children.push(instance);\r\n                            //replace key with actual object\r\n                            assignmentSet.assignments[0] = system;\r\n                        }\r\n                    },\r\n                    this);\r\n            },\r\n            this);\r\n\r\n        return result;\r\n    }\r\n\r\n    getAssetTypes(data) {\r\n        if (!data) throw 'data must be defined';\r\n        var result = [];\r\n        var tr = this.getTranslator();\r\n\r\n        var types = data.AssetTypes;\r\n        if (!types) return result;\r\n        types = types.AssetType;\r\n        if (!types) return result;\r\n\r\n        types.forEach(function(type) {\r\n                var vType = this.getVisualEntity(type, 'assettype');\r\n                result.push(vType);\r\n\r\n                //process instances of type\r\n                var instances = type.Assets;\r\n                if (!instances) return;\r\n                instances = instances.Asset;\r\n                if (!instances) return;\r\n                instances.forEach(function(instance) {\r\n                        var vInstance = this.getVisualEntity(instance, 'asset');\r\n                        vType.children.push(vInstance);\r\n\r\n                        //add assignment to the type\r\n                        var assignment = new xVisualAssignmentSet();\r\n                        assignment.id = 'AssetType';\r\n                        assignment.name = tr(assignment.id);\r\n                        assignment.assignments.push(vType);\r\n                        vInstance.assignments.push(assignment);\r\n                    },\r\n                    this);\r\n            },\r\n            this);\r\n\r\n        return result;\r\n    }\r\n\r\n    getProperties(entity) {\r\n        if (!entity) throw 'entity must be defined';\r\n        var tr = this.getTranslator();\r\n        var result = [];\r\n\r\n        for (var a in entity) {\r\n            if (!entity.hasOwnProperty(a)) {\r\n                continue;\r\n            }\r\n            var attr = entity[a];\r\n            var valStr = this.getValueString(attr);\r\n\r\n            //it is an object not an attribute\r\n            if (!valStr) continue;\r\n\r\n            var nameStr = tr(a);\r\n            result.push(new xVisualProperty({ name: nameStr, value: valStr, id: a }));\r\n        };\r\n        return result;\r\n    }\r\n\r\n    getAttributes(entity) {\r\n        if (!entity) throw 'entity must be defined';\r\n\r\n        var result = [];\r\n        var attributes = null;\r\n        for (var a in entity) {\r\n            if (!entity.hasOwnProperty(a)) {\r\n                continue;\r\n            }\r\n            if (entity[a].Attribute) {\r\n                attributes = entity[a].Attribute;\r\n                break;\r\n            }\r\n        }\r\n        if (!attributes) return result;\r\n        attributes.forEach(function(attribute) {\r\n                result.push(new xVisualAttribute({\r\n                    name: attribute.AttributeName,\r\n                    description: attribute.AttributeDescription,\r\n                    value: this.getValueString(attribute.AttributeValue),\r\n                    propertySet: attribute.propertySetName,\r\n                    category: attribute.AttributeCategory,\r\n                    issues: attribute.AttributeIssues ? this.getAttributes(attribute.AttributeIssues) : []\r\n                }));\r\n            },\r\n            this);\r\n        return result;\r\n    }\r\n\r\n    getAssignments(entity, type) {\r\n        if (!entity || !type) throw 'entity and type must be defined';\r\n        var tr = this.getTranslator();\r\n        var result = [];\r\n\r\n        for (var attr in entity) {\r\n            if (!entity.hasOwnProperty(attr)) {\r\n                continue;\r\n            }\r\n            var collection = new xVisualAssignmentSet();\r\n            //assignment collection\r\n            var r = new RegExp('^(' + type + ')(.*)(assignments)$', 'i');\r\n            if (r.test(attr)) {\r\n                collection.id = attr.replace(r, '$2');\r\n                collection.name = tr(collection.id + 's');\r\n                for (var a in entity[attr]) {\r\n                    if (!entity[attr].hasOwnProperty(a)) {\r\n                        continue;\r\n                    }\r\n                    var assignmentSet = entity[attr][a];\r\n                    var name = a.replace('Assignment', '').toLowerCase();\r\n                    for (var a in assignmentSet) {\r\n                        if (!assignmentSet.hasOwnProperty(a)) {\r\n                            continue;\r\n                        }\r\n                        var assignment = assignmentSet[a];\r\n                        var vAssignment = this.getVisualEntity(assignment, name);\r\n                        vAssignment.isKey = true;\r\n                        collection.assignments.push(vAssignment);\r\n                    }\r\n                }\r\n            }\r\n            //single assignment\r\n            r = new RegExp('(.*)(assignment)$', 'i');\r\n            if (r.test(attr)) {\r\n                collection.id = attr.replace(r, '$1');\r\n                collection.name = tr(collection.id);\r\n                var vEntity = this.getVisualEntity(entity[attr], collection.id.toLowerCase());\r\n                collection.assignments.push(vEntity);\r\n            }\r\n\r\n            if (collection.assignments.length !== 0) {\r\n                result.push(collection);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getDocuments(entity, type) {\r\n        if (!entity || !type) throw 'entity and type must be defined';\r\n        var result = [];\r\n\r\n        for (var attr in entity) {\r\n            if (!entity.hasOwnProperty(attr)) {\r\n                continue;\r\n            }\r\n            var r = new RegExp('^(' + type + ')(documents)$', 'i');\r\n            if (r.test(attr)) {\r\n                var documents = entity[attr].Document\r\n                if (!documents) continue;\r\n                for (var i = 0; i < documents.length; i++) {\r\n                    var doc = documents[i]\r\n                    var vDoc = this.getVisualEntity(doc, 'document')\r\n                    result.push(vDoc);\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    getIssues(entity) {\r\n        if (!entity) throw 'entity and type must be defined';\r\n        var result = [];\r\n\r\n        for (var attr in entity) {\r\n            if (!entity.hasOwnProperty(attr)) {\r\n                continue;\r\n            }\r\n            if (entity[attr].Issue) {\r\n                var issues = entity[attr].Issue\r\n                for (var i = 0; i < issues.length; i++) {\r\n                    var issue = issues[i]\r\n                    var vIssue = this.getVisualEntity(issue, 'issue')\r\n                    result.push(vIssue);\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    setLanguage(lang, culture) {\r\n        this._dictionary = new xAttributeDictionary(lang, culture);\r\n    }\r\n\r\n    getValueString(value) {\r\n        if (typeof (value) == 'undefined' || value == null)\r\n            return '';\r\n        var tr = this.getTranslator();\r\n\r\n        //this of for attributes prior to serialization enhancements\r\n        if (typeof (value.Item) !== 'undefined') value = value.Item;\r\n\r\n        //this is for different kinds of attributes using latest serializer implementation\r\n        if (typeof (value.AttributeBooleanValue) !== 'undefined') value = value.AttributeBooleanValue;\r\n        if (typeof (value.AttributeDateValue) !== 'undefined') value = value.AttributeDateValue;\r\n        if (typeof (value.AttributeDateTimeValue) !== 'undefined') value = value.AttributeDateTimeValue;\r\n        if (typeof (value.AttributeDecimalValue) !== 'undefined') value = value.AttributeDecimalValue;\r\n        if (typeof (value.AttributeIntegerValue) !== 'undefined') value = value.AttributeIntegerValue;\r\n        if (typeof (value.AttributeMonetaryValue) !== 'undefined') value = value.AttributeMonetaryValue;\r\n        if (typeof (value.AttributeStringValue) !== 'undefined') value = value.AttributeStringValue;\r\n        if (typeof (value.AttributeTimeValue) !== 'undefined') value = value.AttributeTimeValue;\r\n\r\n\r\n        var baseVal = '';\r\n        if (typeof (value) == 'string') baseVal = value;\r\n        if (typeof (value.BooleanValue) !== 'undefined') baseVal = value.BooleanValue ? tr('True') : tr('False');\r\n        if (typeof (value.StringValue) !== 'undefined') baseVal = value.StringValue;\r\n        if (typeof (value.DecimalValue) !== 'undefined')\r\n            baseVal = value.DecimalValue.toFixed(this.settings.decimalPlaces).toString();\r\n        if (typeof (value.IntegerValue) !== 'undefined') baseVal = value.IntegerValue.toString();\r\n\r\n        if (value.UnitName) baseVal += ' ' + value.UnitName;\r\n\r\n        return baseVal.length > 0 ? baseVal : '';\r\n    }\r\n\r\n    getTranslator() {\r\n        var self = this;\r\n        return function(term) {\r\n            return self._dictionary[term] ? self._dictionary[term] : term.replace(/([a-z0-9])([A-Z])/g, '$1 $2');\r\n        };\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./Browser/xbim-cobie-utils.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./Resources/doctemplate/static/styles/xbrowser-styles.css\n// module id = 28\n// module chunks = 0"],"sourceRoot":""}